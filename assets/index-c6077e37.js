function zG(i,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in i)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(i,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var tp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function WG(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),n}var oP={exports:{}},i$={},aP={exports:{}},Vn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE=Symbol.for("react.element"),XG=Symbol.for("react.portal"),jG=Symbol.for("react.fragment"),YG=Symbol.for("react.strict_mode"),KG=Symbol.for("react.profiler"),JG=Symbol.for("react.provider"),ZG=Symbol.for("react.context"),qG=Symbol.for("react.forward_ref"),QG=Symbol.for("react.suspense"),eH=Symbol.for("react.memo"),tH=Symbol.for("react.lazy"),fO=Symbol.iterator;function nH(i){return i===null||typeof i!="object"?null:(i=fO&&i[fO]||i["@@iterator"],typeof i=="function"?i:null)}var lP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cP=Object.assign,uP={};function Jg(i,e,n){this.props=i,this.context=e,this.refs=uP,this.updater=n||lP}Jg.prototype.isReactComponent={};Jg.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Jg.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function hP(){}hP.prototype=Jg.prototype;function rw(i,e,n){this.props=i,this.context=e,this.refs=uP,this.updater=n||lP}var sw=rw.prototype=new hP;sw.constructor=rw;cP(sw,Jg.prototype);sw.isPureReactComponent=!0;var pO=Array.isArray,dP=Object.prototype.hasOwnProperty,ow={current:null},fP={key:!0,ref:!0,__self:!0,__source:!0};function pP(i,e,n){var r,s={},a=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(a=""+e.key),e)dP.call(e,r)&&!fP.hasOwnProperty(r)&&(s[r]=e[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var d=Array(u),h=0;h<u;h++)d[h]=arguments[h+2];s.children=d}if(i&&i.defaultProps)for(r in u=i.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:pE,type:i,key:a,ref:l,props:s,_owner:ow.current}}function iH(i,e){return{$$typeof:pE,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function aw(i){return typeof i=="object"&&i!==null&&i.$$typeof===pE}function rH(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(n){return e[n]})}var mO=/\/+/g;function wA(i,e){return typeof i=="object"&&i!==null&&i.key!=null?rH(""+i.key):e.toString(36)}function q0(i,e,n,r,s){var a=typeof i;(a==="undefined"||a==="boolean")&&(i=null);var l=!1;if(i===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(i.$$typeof){case pE:case XG:l=!0}}if(l)return l=i,s=s(l),i=r===""?"."+wA(l,0):r,pO(s)?(n="",i!=null&&(n=i.replace(mO,"$&/")+"/"),q0(s,e,n,"",function(h){return h})):s!=null&&(aw(s)&&(s=iH(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(mO,"$&/")+"/")+i)),e.push(s)),1;if(l=0,r=r===""?".":r+":",pO(i))for(var u=0;u<i.length;u++){a=i[u];var d=r+wA(a,u);l+=q0(a,e,n,d,s)}else if(d=nH(i),typeof d=="function")for(i=d.call(i),u=0;!(a=i.next()).done;)a=a.value,d=r+wA(a,u++),l+=q0(a,e,n,d,s);else if(a==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Oy(i,e,n){if(i==null)return i;var r=[],s=0;return q0(i,r,"","",function(a){return e.call(n,a,s++)}),r}function sH(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(n){(i._status===0||i._status===-1)&&(i._status=1,i._result=n)},function(n){(i._status===0||i._status===-1)&&(i._status=2,i._result=n)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var co={current:null},Q0={transition:null},oH={ReactCurrentDispatcher:co,ReactCurrentBatchConfig:Q0,ReactCurrentOwner:ow};function mP(){throw Error("act(...) is not supported in production builds of React.")}Vn.Children={map:Oy,forEach:function(i,e,n){Oy(i,function(){e.apply(this,arguments)},n)},count:function(i){var e=0;return Oy(i,function(){e++}),e},toArray:function(i){return Oy(i,function(e){return e})||[]},only:function(i){if(!aw(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Vn.Component=Jg;Vn.Fragment=jG;Vn.Profiler=KG;Vn.PureComponent=rw;Vn.StrictMode=YG;Vn.Suspense=QG;Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oH;Vn.act=mP;Vn.cloneElement=function(i,e,n){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=cP({},i.props),s=i.key,a=i.ref,l=i._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,l=ow.current),e.key!==void 0&&(s=""+e.key),i.type&&i.type.defaultProps)var u=i.type.defaultProps;for(d in e)dP.call(e,d)&&!fP.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&u!==void 0?u[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var h=0;h<d;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:pE,type:i.type,key:s,ref:a,props:r,_owner:l}};Vn.createContext=function(i){return i={$$typeof:ZG,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:JG,_context:i},i.Consumer=i};Vn.createElement=pP;Vn.createFactory=function(i){var e=pP.bind(null,i);return e.type=i,e};Vn.createRef=function(){return{current:null}};Vn.forwardRef=function(i){return{$$typeof:qG,render:i}};Vn.isValidElement=aw;Vn.lazy=function(i){return{$$typeof:tH,_payload:{_status:-1,_result:i},_init:sH}};Vn.memo=function(i,e){return{$$typeof:eH,type:i,compare:e===void 0?null:e}};Vn.startTransition=function(i){var e=Q0.transition;Q0.transition={};try{i()}finally{Q0.transition=e}};Vn.unstable_act=mP;Vn.useCallback=function(i,e){return co.current.useCallback(i,e)};Vn.useContext=function(i){return co.current.useContext(i)};Vn.useDebugValue=function(){};Vn.useDeferredValue=function(i){return co.current.useDeferredValue(i)};Vn.useEffect=function(i,e){return co.current.useEffect(i,e)};Vn.useId=function(){return co.current.useId()};Vn.useImperativeHandle=function(i,e,n){return co.current.useImperativeHandle(i,e,n)};Vn.useInsertionEffect=function(i,e){return co.current.useInsertionEffect(i,e)};Vn.useLayoutEffect=function(i,e){return co.current.useLayoutEffect(i,e)};Vn.useMemo=function(i,e){return co.current.useMemo(i,e)};Vn.useReducer=function(i,e,n){return co.current.useReducer(i,e,n)};Vn.useRef=function(i){return co.current.useRef(i)};Vn.useState=function(i){return co.current.useState(i)};Vn.useSyncExternalStore=function(i,e,n){return co.current.useSyncExternalStore(i,e,n)};Vn.useTransition=function(){return co.current.useTransition()};Vn.version="18.3.1";aP.exports=Vn;var q=aP.exports;const lw=pd(q),aH=zG({__proto__:null,default:lw},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lH=q,cH=Symbol.for("react.element"),uH=Symbol.for("react.fragment"),hH=Object.prototype.hasOwnProperty,dH=lH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fH={key:!0,ref:!0,__self:!0,__source:!0};function gP(i,e,n){var r,s={},a=null,l=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)hH.call(e,r)&&!fH.hasOwnProperty(r)&&(s[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:cH,type:i,key:a,ref:l,props:s,_owner:dH.current}}i$.Fragment=uH;i$.jsx=gP;i$.jsxs=gP;oP.exports=i$;var V=oP.exports,_P={exports:{}},aa={},TP={exports:{}},vP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var se=K-1>>>1,Y=G[se];if(0<s(Y,Z))G[se]=Z,G[K]=Y,K=se;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var se=0,Y=G.length,me=Y>>>1;se<me;){var fe=2*(se+1)-1,Ae=G[fe],Ce=fe+1,Ie=G[Ce];if(0>s(Ae,K))Ce<Y&&0>s(Ie,Ae)?(G[se]=Ie,G[Ce]=K,se=Ce):(G[se]=Ae,G[fe]=K,se=fe);else if(Ce<Y&&0>s(Ie,K))G[se]=Ie,G[Ce]=K,se=Ce;else break e}}return Z}function s(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],h=[],f=1,p=null,m=3,v=!1,y=!1,$=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(G){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=G)r(h),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=n(h)}}function x(G){if($=!1,C(G),!y)if(n(d)!==null)y=!0,ue(I);else{var Z=n(h);Z!==null&&Re(x,Z.startTime-G)}}function I(G,Z){y=!1,$&&($=!1,S(k),k=-1),v=!0;var K=m;try{for(C(Z),p=n(d);p!==null&&(!(p.expirationTime>Z)||G&&!ce());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var Y=se(p.expirationTime<=Z);Z=i.unstable_now(),typeof Y=="function"?p.callback=Y:p===n(d)&&r(d),C(Z)}else r(d);p=n(d)}if(p!==null)var me=!0;else{var fe=n(h);fe!==null&&Re(x,fe.startTime-Z),me=!1}return me}finally{p=null,m=K,v=!1}}var O=!1,F=null,k=-1,D=5,U=-1;function ce(){return!(i.unstable_now()-U<D)}function re(){if(F!==null){var G=i.unstable_now();U=G;var Z=!0;try{Z=F(!0,G)}finally{Z?ae():(O=!1,F=null)}}else O=!1}var ae;if(typeof A=="function")ae=function(){A(re)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,de=ne.port2;ne.port1.onmessage=re,ae=function(){de.postMessage(null)}}else ae=function(){E(re,0)};function ue(G){F=G,O||(O=!0,ae())}function Re(G,Z){k=E(function(){G(i.unstable_now())},Z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_continueExecution=function(){y||v||(y=!0,ue(I))},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return n(d)},i.unstable_next=function(G){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var K=m;m=Z;try{return G()}finally{m=K}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=m;m=G;try{return Z()}finally{m=K}},i.unstable_scheduleCallback=function(G,Z,K){var se=i.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?se+K:se):K=se,G){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=K+Y,G={id:f++,callback:Z,priorityLevel:G,startTime:K,expirationTime:Y,sortIndex:-1},K>se?(G.sortIndex=K,e(h,G),n(d)===null&&G===n(h)&&($?(S(k),k=-1):$=!0,Re(x,K-se))):(G.sortIndex=Y,e(d,G),y||v||(y=!0,ue(I))),G},i.unstable_shouldYield=ce,i.unstable_wrapCallback=function(G){var Z=m;return function(){var K=m;m=Z;try{return G.apply(this,arguments)}finally{m=K}}}})(vP);TP.exports=vP;var pH=TP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mH=q,oa=pH;function Mt(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var EP=new Set,Pv={};function xp(i,e){Dg(i,e),Dg(i+"Capture",e)}function Dg(i,e){for(Pv[i]=e,i=0;i<e.length;i++)EP.add(e[i])}var wu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cR=Object.prototype.hasOwnProperty,gH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gO={},_O={};function _H(i){return cR.call(_O,i)?!0:cR.call(gO,i)?!1:gH.test(i)?_O[i]=!0:(gO[i]=!0,!1)}function TH(i,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function vH(i,e,n,r){if(e===null||typeof e>"u"||TH(i,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function uo(i,e,n,r,s,a,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=i,this.type=e,this.sanitizeURL=a,this.removeEmptyString=l}var As={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){As[i]=new uo(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];As[e]=new uo(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){As[i]=new uo(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){As[i]=new uo(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){As[i]=new uo(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){As[i]=new uo(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){As[i]=new uo(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){As[i]=new uo(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){As[i]=new uo(i,5,!1,i.toLowerCase(),null,!1,!1)});var cw=/[\-:]([a-z])/g;function uw(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(cw,uw);As[e]=new uo(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(cw,uw);As[e]=new uo(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(cw,uw);As[e]=new uo(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){As[i]=new uo(i,1,!1,i.toLowerCase(),null,!1,!1)});As.xlinkHref=new uo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){As[i]=new uo(i,1,!1,i.toLowerCase(),null,!0,!0)});function hw(i,e,n,r){var s=As.hasOwnProperty(e)?As[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vH(e,n,s,r)&&(n=null),r||s===null?_H(e)&&(n===null?i.removeAttribute(e):i.setAttribute(e,""+n)):s.mustUseProperty?i[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?i.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?i.setAttributeNS(r,e,n):i.setAttribute(e,n))))}var Pu=mH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ly=Symbol.for("react.element"),ug=Symbol.for("react.portal"),hg=Symbol.for("react.fragment"),dw=Symbol.for("react.strict_mode"),uR=Symbol.for("react.profiler"),yP=Symbol.for("react.provider"),SP=Symbol.for("react.context"),fw=Symbol.for("react.forward_ref"),hR=Symbol.for("react.suspense"),dR=Symbol.for("react.suspense_list"),pw=Symbol.for("react.memo"),Fh=Symbol.for("react.lazy"),$P=Symbol.for("react.offscreen"),TO=Symbol.iterator;function wT(i){return i===null||typeof i!="object"?null:(i=TO&&i[TO]||i["@@iterator"],typeof i=="function"?i:null)}var rr=Object.assign,MA;function fv(i){if(MA===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);MA=e&&e[1]||""}return`
`+MA+i}var IA=!1;function OA(i,e){if(!i||IA)return"";IA=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(i,[],e)}else{try{e.call()}catch(h){r=h}i.call(e.prototype)}else{try{throw Error()}catch(h){r=h}i()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),a=r.stack.split(`
`),l=s.length-1,u=a.length-1;1<=l&&0<=u&&s[l]!==a[u];)u--;for(;1<=l&&0<=u;l--,u--)if(s[l]!==a[u]){if(l!==1||u!==1)do if(l--,u--,0>u||s[l]!==a[u]){var d=`
`+s[l].replace(" at new "," at ");return i.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",i.displayName)),d}while(1<=l&&0<=u);break}}}finally{IA=!1,Error.prepareStackTrace=n}return(i=i?i.displayName||i.name:"")?fv(i):""}function EH(i){switch(i.tag){case 5:return fv(i.type);case 16:return fv("Lazy");case 13:return fv("Suspense");case 19:return fv("SuspenseList");case 0:case 2:case 15:return i=OA(i.type,!1),i;case 11:return i=OA(i.type.render,!1),i;case 1:return i=OA(i.type,!0),i;default:return""}}function fR(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case hg:return"Fragment";case ug:return"Portal";case uR:return"Profiler";case dw:return"StrictMode";case hR:return"Suspense";case dR:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case SP:return(i.displayName||"Context")+".Consumer";case yP:return(i._context.displayName||"Context")+".Provider";case fw:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case pw:return e=i.displayName||null,e!==null?e:fR(i.type)||"Memo";case Fh:e=i._payload,i=i._init;try{return fR(i(e))}catch{}}return null}function yH(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fR(e);case 8:return e===dw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ad(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function bP(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SH(i){var e=bP(i)?"checked":"value",n=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,a.call(this,l)}}),Object.defineProperty(i,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Ny(i){i._valueTracker||(i._valueTracker=SH(i))}function AP(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return i&&(r=bP(i)?i.checked?"true":"false":i.value),i=r,i!==n?(e.setValue(i),!0):!1}function ES(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function pR(i,e){var n=e.checked;return rr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??i._wrapperState.initialChecked})}function vO(i,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ad(e.value!=null?e.value:n),i._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CP(i,e){e=e.checked,e!=null&&hw(i,"checked",e,!1)}function mR(i,e){CP(i,e);var n=ad(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&i.value===""||i.value!=n)&&(i.value=""+n):i.value!==""+n&&(i.value=""+n);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?gR(i,e.type,n):e.hasOwnProperty("defaultValue")&&gR(i,e.type,ad(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function EO(i,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,n||e===i.value||(i.value=e),i.defaultValue=e}n=i.name,n!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,n!==""&&(i.name=n)}function gR(i,e,n){(e!=="number"||ES(i.ownerDocument)!==i)&&(n==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+n&&(i.defaultValue=""+n))}var pv=Array.isArray;function Rg(i,e,n,r){if(i=i.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<i.length;n++)s=e.hasOwnProperty("$"+i[n].value),i[n].selected!==s&&(i[n].selected=s),s&&r&&(i[n].defaultSelected=!0)}else{for(n=""+ad(n),e=null,s=0;s<i.length;s++){if(i[s].value===n){i[s].selected=!0,r&&(i[s].defaultSelected=!0);return}e!==null||i[s].disabled||(e=i[s])}e!==null&&(e.selected=!0)}}function _R(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Mt(91));return rr({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function yO(i,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Mt(92));if(pv(n)){if(1<n.length)throw Error(Mt(93));n=n[0]}e=n}e==null&&(e=""),n=e}i._wrapperState={initialValue:ad(n)}}function RP(i,e){var n=ad(e.value),r=ad(e.defaultValue);n!=null&&(n=""+n,n!==i.value&&(i.value=n),e.defaultValue==null&&i.defaultValue!==n&&(i.defaultValue=n)),r!=null&&(i.defaultValue=""+r)}function SO(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function xP(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TR(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?xP(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var ky,wP=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return i(e,n,r,s)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(ky=ky||document.createElement("div"),ky.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ky.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Dv(i,e){if(e){var n=i.firstChild;if(n&&n===i.lastChild&&n.nodeType===3){n.nodeValue=e;return}}i.textContent=e}var vv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$H=["Webkit","ms","Moz","O"];Object.keys(vv).forEach(function(i){$H.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),vv[e]=vv[i]})});function MP(i,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vv.hasOwnProperty(i)&&vv[i]?(""+e).trim():e+"px"}function IP(i,e){i=i.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=MP(n,e[n],r);n==="float"&&(n="cssFloat"),r?i.setProperty(n,s):i[n]=s}}var bH=rr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vR(i,e){if(e){if(bH[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Mt(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Mt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Mt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Mt(62))}}function ER(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yR=null;function mw(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var SR=null,xg=null,wg=null;function $O(i){if(i=_E(i)){if(typeof SR!="function")throw Error(Mt(280));var e=i.stateNode;e&&(e=l$(e),SR(i.stateNode,i.type,e))}}function OP(i){xg?wg?wg.push(i):wg=[i]:xg=i}function LP(){if(xg){var i=xg,e=wg;if(wg=xg=null,$O(i),e)for(i=0;i<e.length;i++)$O(e[i])}}function NP(i,e){return i(e)}function kP(){}var LA=!1;function PP(i,e,n){if(LA)return i(e,n);LA=!0;try{return NP(i,e,n)}finally{LA=!1,(xg!==null||wg!==null)&&(kP(),LP())}}function Bv(i,e){var n=i.stateNode;if(n===null)return null;var r=l$(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(n&&typeof n!="function")throw Error(Mt(231,e,typeof n));return n}var $R=!1;if(wu)try{var MT={};Object.defineProperty(MT,"passive",{get:function(){$R=!0}}),window.addEventListener("test",MT,MT),window.removeEventListener("test",MT,MT)}catch{$R=!1}function AH(i,e,n,r,s,a,l,u,d){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(f){this.onError(f)}}var Ev=!1,yS=null,SS=!1,bR=null,CH={onError:function(i){Ev=!0,yS=i}};function RH(i,e,n,r,s,a,l,u,d){Ev=!1,yS=null,AH.apply(CH,arguments)}function xH(i,e,n,r,s,a,l,u,d){if(RH.apply(this,arguments),Ev){if(Ev){var h=yS;Ev=!1,yS=null}else throw Error(Mt(198));SS||(SS=!0,bR=h)}}function wp(i){var e=i,n=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(n=e.return),i=e.return;while(i)}return e.tag===3?n:null}function DP(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function bO(i){if(wp(i)!==i)throw Error(Mt(188))}function wH(i){var e=i.alternate;if(!e){if(e=wp(i),e===null)throw Error(Mt(188));return e!==i?null:i}for(var n=i,r=e;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return bO(s),i;if(a===r)return bO(s),e;a=a.sibling}throw Error(Mt(188))}if(n.return!==r.return)n=s,r=a;else{for(var l=!1,u=s.child;u;){if(u===n){l=!0,n=s,r=a;break}if(u===r){l=!0,r=s,n=a;break}u=u.sibling}if(!l){for(u=a.child;u;){if(u===n){l=!0,n=a,r=s;break}if(u===r){l=!0,r=a,n=s;break}u=u.sibling}if(!l)throw Error(Mt(189))}}if(n.alternate!==r)throw Error(Mt(190))}if(n.tag!==3)throw Error(Mt(188));return n.stateNode.current===n?i:e}function BP(i){return i=wH(i),i!==null?FP(i):null}function FP(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=FP(i);if(e!==null)return e;i=i.sibling}return null}var UP=oa.unstable_scheduleCallback,AO=oa.unstable_cancelCallback,MH=oa.unstable_shouldYield,IH=oa.unstable_requestPaint,vr=oa.unstable_now,OH=oa.unstable_getCurrentPriorityLevel,gw=oa.unstable_ImmediatePriority,GP=oa.unstable_UserBlockingPriority,$S=oa.unstable_NormalPriority,LH=oa.unstable_LowPriority,HP=oa.unstable_IdlePriority,r$=null,bc=null;function NH(i){if(bc&&typeof bc.onCommitFiberRoot=="function")try{bc.onCommitFiberRoot(r$,i,void 0,(i.current.flags&128)===128)}catch{}}var Ll=Math.clz32?Math.clz32:DH,kH=Math.log,PH=Math.LN2;function DH(i){return i>>>=0,i===0?32:31-(kH(i)/PH|0)|0}var Py=64,Dy=4194304;function mv(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function bS(i,e){var n=i.pendingLanes;if(n===0)return 0;var r=0,s=i.suspendedLanes,a=i.pingedLanes,l=n&268435455;if(l!==0){var u=l&~s;u!==0?r=mv(u):(a&=l,a!==0&&(r=mv(a)))}else l=n&~s,l!==0?r=mv(l):a!==0&&(r=mv(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)n=31-Ll(e),s=1<<n,r|=i[n],e&=~s;return r}function BH(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FH(i,e){for(var n=i.suspendedLanes,r=i.pingedLanes,s=i.expirationTimes,a=i.pendingLanes;0<a;){var l=31-Ll(a),u=1<<l,d=s[l];d===-1?(!(u&n)||u&r)&&(s[l]=BH(u,e)):d<=e&&(i.expiredLanes|=u),a&=~u}}function AR(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function VP(){var i=Py;return Py<<=1,!(Py&4194240)&&(Py=64),i}function NA(i){for(var e=[],n=0;31>n;n++)e.push(i);return e}function mE(i,e,n){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Ll(e),i[e]=n}function UH(i,e){var n=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<n;){var s=31-Ll(n),a=1<<s;e[s]=0,r[s]=-1,i[s]=-1,n&=~a}}function _w(i,e){var n=i.entangledLanes|=e;for(i=i.entanglements;n;){var r=31-Ll(n),s=1<<r;s&e|i[r]&e&&(i[r]|=e),n&=~s}}var bi=0;function zP(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var WP,Tw,XP,jP,YP,CR=!1,By=[],Jh=null,Zh=null,qh=null,Fv=new Map,Uv=new Map,Hh=[],GH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function CO(i,e){switch(i){case"focusin":case"focusout":Jh=null;break;case"dragenter":case"dragleave":Zh=null;break;case"mouseover":case"mouseout":qh=null;break;case"pointerover":case"pointerout":Fv.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uv.delete(e.pointerId)}}function IT(i,e,n,r,s,a){return i===null||i.nativeEvent!==a?(i={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},e!==null&&(e=_E(e),e!==null&&Tw(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),i)}function HH(i,e,n,r,s){switch(e){case"focusin":return Jh=IT(Jh,i,e,n,r,s),!0;case"dragenter":return Zh=IT(Zh,i,e,n,r,s),!0;case"mouseover":return qh=IT(qh,i,e,n,r,s),!0;case"pointerover":var a=s.pointerId;return Fv.set(a,IT(Fv.get(a)||null,i,e,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Uv.set(a,IT(Uv.get(a)||null,i,e,n,r,s)),!0}return!1}function KP(i){var e=Xf(i.target);if(e!==null){var n=wp(e);if(n!==null){if(e=n.tag,e===13){if(e=DP(n),e!==null){i.blockedOn=e,YP(i.priority,function(){XP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){i.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}i.blockedOn=null}function eS(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var n=RR(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(n===null){n=i.nativeEvent;var r=new n.constructor(n.type,n);yR=r,n.target.dispatchEvent(r),yR=null}else return e=_E(n),e!==null&&Tw(e),i.blockedOn=n,!1;e.shift()}return!0}function RO(i,e,n){eS(i)&&n.delete(e)}function VH(){CR=!1,Jh!==null&&eS(Jh)&&(Jh=null),Zh!==null&&eS(Zh)&&(Zh=null),qh!==null&&eS(qh)&&(qh=null),Fv.forEach(RO),Uv.forEach(RO)}function OT(i,e){i.blockedOn===e&&(i.blockedOn=null,CR||(CR=!0,oa.unstable_scheduleCallback(oa.unstable_NormalPriority,VH)))}function Gv(i){function e(s){return OT(s,i)}if(0<By.length){OT(By[0],i);for(var n=1;n<By.length;n++){var r=By[n];r.blockedOn===i&&(r.blockedOn=null)}}for(Jh!==null&&OT(Jh,i),Zh!==null&&OT(Zh,i),qh!==null&&OT(qh,i),Fv.forEach(e),Uv.forEach(e),n=0;n<Hh.length;n++)r=Hh[n],r.blockedOn===i&&(r.blockedOn=null);for(;0<Hh.length&&(n=Hh[0],n.blockedOn===null);)KP(n),n.blockedOn===null&&Hh.shift()}var Mg=Pu.ReactCurrentBatchConfig,AS=!0;function zH(i,e,n,r){var s=bi,a=Mg.transition;Mg.transition=null;try{bi=1,vw(i,e,n,r)}finally{bi=s,Mg.transition=a}}function WH(i,e,n,r){var s=bi,a=Mg.transition;Mg.transition=null;try{bi=4,vw(i,e,n,r)}finally{bi=s,Mg.transition=a}}function vw(i,e,n,r){if(AS){var s=RR(i,e,n,r);if(s===null)zA(i,e,r,CS,n),CO(i,r);else if(HH(s,i,e,n,r))r.stopPropagation();else if(CO(i,r),e&4&&-1<GH.indexOf(i)){for(;s!==null;){var a=_E(s);if(a!==null&&WP(a),a=RR(i,e,n,r),a===null&&zA(i,e,r,CS,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else zA(i,e,r,null,n)}}var CS=null;function RR(i,e,n,r){if(CS=null,i=mw(r),i=Xf(i),i!==null)if(e=wp(i),e===null)i=null;else if(n=e.tag,n===13){if(i=DP(e),i!==null)return i;i=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return CS=i,null}function JP(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OH()){case gw:return 1;case GP:return 4;case $S:case LH:return 16;case HP:return 536870912;default:return 16}default:return 16}}var zh=null,Ew=null,tS=null;function ZP(){if(tS)return tS;var i,e=Ew,n=e.length,r,s="value"in zh?zh.value:zh.textContent,a=s.length;for(i=0;i<n&&e[i]===s[i];i++);var l=n-i;for(r=1;r<=l&&e[n-r]===s[a-r];r++);return tS=s.slice(i,1<r?1-r:void 0)}function nS(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Fy(){return!0}function xO(){return!1}function la(i){function e(n,r,s,a,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var u in i)i.hasOwnProperty(u)&&(n=i[u],this[u]=n?n(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Fy:xO,this.isPropagationStopped=xO,this}return rr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fy)},persist:function(){},isPersistent:Fy}),e}var Zg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yw=la(Zg),gE=rr({},Zg,{view:0,detail:0}),XH=la(gE),kA,PA,LT,s$=rr({},gE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sw,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==LT&&(LT&&i.type==="mousemove"?(kA=i.screenX-LT.screenX,PA=i.screenY-LT.screenY):PA=kA=0,LT=i),kA)},movementY:function(i){return"movementY"in i?i.movementY:PA}}),wO=la(s$),jH=rr({},s$,{dataTransfer:0}),YH=la(jH),KH=rr({},gE,{relatedTarget:0}),DA=la(KH),JH=rr({},Zg,{animationName:0,elapsedTime:0,pseudoElement:0}),ZH=la(JH),qH=rr({},Zg,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),QH=la(qH),e3=rr({},Zg,{data:0}),MO=la(e3),t3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r3(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=i3[i])?!!e[i]:!1}function Sw(){return r3}var s3=rr({},gE,{key:function(i){if(i.key){var e=t3[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=nS(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?n3[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sw,charCode:function(i){return i.type==="keypress"?nS(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?nS(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),o3=la(s3),a3=rr({},s$,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IO=la(a3),l3=rr({},gE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sw}),c3=la(l3),u3=rr({},Zg,{propertyName:0,elapsedTime:0,pseudoElement:0}),h3=la(u3),d3=rr({},s$,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),f3=la(d3),p3=[9,13,27,32],$w=wu&&"CompositionEvent"in window,yv=null;wu&&"documentMode"in document&&(yv=document.documentMode);var m3=wu&&"TextEvent"in window&&!yv,qP=wu&&(!$w||yv&&8<yv&&11>=yv),OO=String.fromCharCode(32),LO=!1;function QP(i,e){switch(i){case"keyup":return p3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eD(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var dg=!1;function g3(i,e){switch(i){case"compositionend":return eD(e);case"keypress":return e.which!==32?null:(LO=!0,OO);case"textInput":return i=e.data,i===OO&&LO?null:i;default:return null}}function _3(i,e){if(dg)return i==="compositionend"||!$w&&QP(i,e)?(i=ZP(),tS=Ew=zh=null,dg=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qP&&e.locale!=="ko"?null:e.data;default:return null}}var T3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function NO(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!T3[i.type]:e==="textarea"}function tD(i,e,n,r){OP(r),e=RS(e,"onChange"),0<e.length&&(n=new yw("onChange","change",null,n,r),i.push({event:n,listeners:e}))}var Sv=null,Hv=null;function v3(i){dD(i,0)}function o$(i){var e=mg(i);if(AP(e))return i}function E3(i,e){if(i==="change")return e}var nD=!1;if(wu){var BA;if(wu){var FA="oninput"in document;if(!FA){var kO=document.createElement("div");kO.setAttribute("oninput","return;"),FA=typeof kO.oninput=="function"}BA=FA}else BA=!1;nD=BA&&(!document.documentMode||9<document.documentMode)}function PO(){Sv&&(Sv.detachEvent("onpropertychange",iD),Hv=Sv=null)}function iD(i){if(i.propertyName==="value"&&o$(Hv)){var e=[];tD(e,Hv,i,mw(i)),PP(v3,e)}}function y3(i,e,n){i==="focusin"?(PO(),Sv=e,Hv=n,Sv.attachEvent("onpropertychange",iD)):i==="focusout"&&PO()}function S3(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return o$(Hv)}function $3(i,e){if(i==="click")return o$(e)}function b3(i,e){if(i==="input"||i==="change")return o$(e)}function A3(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Dl=typeof Object.is=="function"?Object.is:A3;function Vv(i,e){if(Dl(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var n=Object.keys(i),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!cR.call(e,s)||!Dl(i[s],e[s]))return!1}return!0}function DO(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function BO(i,e){var n=DO(i);i=0;for(var r;n;){if(n.nodeType===3){if(r=i+n.textContent.length,i<=e&&r>=e)return{node:n,offset:e-i};i=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=DO(n)}}function rD(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?rD(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function sD(){for(var i=window,e=ES();e instanceof i.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)i=e.contentWindow;else break;e=ES(i.document)}return e}function bw(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function C3(i){var e=sD(),n=i.focusedElem,r=i.selectionRange;if(e!==n&&n&&n.ownerDocument&&rD(n.ownerDocument.documentElement,n)){if(r!==null&&bw(n)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(i,n.value.length);else if(i=(e=n.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!i.extend&&a>r&&(s=r,r=a,a=s),s=BO(n,a);var l=BO(n,r);s&&l&&(i.rangeCount!==1||i.anchorNode!==s.node||i.anchorOffset!==s.offset||i.focusNode!==l.node||i.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),i.removeAllRanges(),a>r?(i.addRange(e),i.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),i.addRange(e)))}}for(e=[],i=n;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)i=e[n],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var R3=wu&&"documentMode"in document&&11>=document.documentMode,fg=null,xR=null,$v=null,wR=!1;function FO(i,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wR||fg==null||fg!==ES(r)||(r=fg,"selectionStart"in r&&bw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$v&&Vv($v,r)||($v=r,r=RS(xR,"onSelect"),0<r.length&&(e=new yw("onSelect","select",null,e,n),i.push({event:e,listeners:r}),e.target=fg)))}function Uy(i,e){var n={};return n[i.toLowerCase()]=e.toLowerCase(),n["Webkit"+i]="webkit"+e,n["Moz"+i]="moz"+e,n}var pg={animationend:Uy("Animation","AnimationEnd"),animationiteration:Uy("Animation","AnimationIteration"),animationstart:Uy("Animation","AnimationStart"),transitionend:Uy("Transition","TransitionEnd")},UA={},oD={};wu&&(oD=document.createElement("div").style,"AnimationEvent"in window||(delete pg.animationend.animation,delete pg.animationiteration.animation,delete pg.animationstart.animation),"TransitionEvent"in window||delete pg.transitionend.transition);function a$(i){if(UA[i])return UA[i];if(!pg[i])return i;var e=pg[i],n;for(n in e)if(e.hasOwnProperty(n)&&n in oD)return UA[i]=e[n];return i}var aD=a$("animationend"),lD=a$("animationiteration"),cD=a$("animationstart"),uD=a$("transitionend"),hD=new Map,UO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function md(i,e){hD.set(i,e),xp(e,[i])}for(var GA=0;GA<UO.length;GA++){var HA=UO[GA],x3=HA.toLowerCase(),w3=HA[0].toUpperCase()+HA.slice(1);md(x3,"on"+w3)}md(aD,"onAnimationEnd");md(lD,"onAnimationIteration");md(cD,"onAnimationStart");md("dblclick","onDoubleClick");md("focusin","onFocus");md("focusout","onBlur");md(uD,"onTransitionEnd");Dg("onMouseEnter",["mouseout","mouseover"]);Dg("onMouseLeave",["mouseout","mouseover"]);Dg("onPointerEnter",["pointerout","pointerover"]);Dg("onPointerLeave",["pointerout","pointerover"]);xp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xp("onBeforeInput",["compositionend","keypress","textInput","paste"]);xp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M3=new Set("cancel close invalid load scroll toggle".split(" ").concat(gv));function GO(i,e,n){var r=i.type||"unknown-event";i.currentTarget=n,xH(r,e,void 0,i),i.currentTarget=null}function dD(i,e){e=(e&4)!==0;for(var n=0;n<i.length;n++){var r=i[n],s=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var l=r.length-1;0<=l;l--){var u=r[l],d=u.instance,h=u.currentTarget;if(u=u.listener,d!==a&&s.isPropagationStopped())break e;GO(s,u,h),a=d}else for(l=0;l<r.length;l++){if(u=r[l],d=u.instance,h=u.currentTarget,u=u.listener,d!==a&&s.isPropagationStopped())break e;GO(s,u,h),a=d}}}if(SS)throw i=bR,SS=!1,bR=null,i}function Bi(i,e){var n=e[NR];n===void 0&&(n=e[NR]=new Set);var r=i+"__bubble";n.has(r)||(fD(e,i,2,!1),n.add(r))}function VA(i,e,n){var r=0;e&&(r|=4),fD(n,i,r,e)}var Gy="_reactListening"+Math.random().toString(36).slice(2);function zv(i){if(!i[Gy]){i[Gy]=!0,EP.forEach(function(n){n!=="selectionchange"&&(M3.has(n)||VA(n,!1,i),VA(n,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Gy]||(e[Gy]=!0,VA("selectionchange",!1,e))}}function fD(i,e,n,r){switch(JP(e)){case 1:var s=zH;break;case 4:s=WH;break;default:s=vw}n=s.bind(null,e,n,i),s=void 0,!$R||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?i.addEventListener(e,n,{capture:!0,passive:s}):i.addEventListener(e,n,!0):s!==void 0?i.addEventListener(e,n,{passive:s}):i.addEventListener(e,n,!1)}function zA(i,e,n,r,s){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var d=l.tag;if((d===3||d===4)&&(d=l.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;l=l.return}for(;u!==null;){if(l=Xf(u),l===null)return;if(d=l.tag,d===5||d===6){r=a=l;continue e}u=u.parentNode}}r=r.return}PP(function(){var h=a,f=mw(n),p=[];e:{var m=hD.get(i);if(m!==void 0){var v=yw,y=i;switch(i){case"keypress":if(nS(n)===0)break e;case"keydown":case"keyup":v=o3;break;case"focusin":y="focus",v=DA;break;case"focusout":y="blur",v=DA;break;case"beforeblur":case"afterblur":v=DA;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=wO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=YH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=c3;break;case aD:case lD:case cD:v=ZH;break;case uD:v=h3;break;case"scroll":v=XH;break;case"wheel":v=f3;break;case"copy":case"cut":case"paste":v=QH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=IO}var $=(e&4)!==0,E=!$&&i==="scroll",S=$?m!==null?m+"Capture":null:m;$=[];for(var A=h,C;A!==null;){C=A;var x=C.stateNode;if(C.tag===5&&x!==null&&(C=x,S!==null&&(x=Bv(A,S),x!=null&&$.push(Wv(A,x,C)))),E)break;A=A.return}0<$.length&&(m=new v(m,y,null,n,f),p.push({event:m,listeners:$}))}}if(!(e&7)){e:{if(m=i==="mouseover"||i==="pointerover",v=i==="mouseout"||i==="pointerout",m&&n!==yR&&(y=n.relatedTarget||n.fromElement)&&(Xf(y)||y[Mu]))break e;if((v||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=h,y=y?Xf(y):null,y!==null&&(E=wp(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=h),v!==y)){if($=wO,x="onMouseLeave",S="onMouseEnter",A="mouse",(i==="pointerout"||i==="pointerover")&&($=IO,x="onPointerLeave",S="onPointerEnter",A="pointer"),E=v==null?m:mg(v),C=y==null?m:mg(y),m=new $(x,A+"leave",v,n,f),m.target=E,m.relatedTarget=C,x=null,Xf(f)===h&&($=new $(S,A+"enter",y,n,f),$.target=C,$.relatedTarget=E,x=$),E=x,v&&y)t:{for($=v,S=y,A=0,C=$;C;C=km(C))A++;for(C=0,x=S;x;x=km(x))C++;for(;0<A-C;)$=km($),A--;for(;0<C-A;)S=km(S),C--;for(;A--;){if($===S||S!==null&&$===S.alternate)break t;$=km($),S=km(S)}$=null}else $=null;v!==null&&HO(p,m,v,$,!1),y!==null&&E!==null&&HO(p,E,y,$,!0)}}e:{if(m=h?mg(h):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var I=E3;else if(NO(m))if(nD)I=b3;else{I=S3;var O=y3}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(I=$3);if(I&&(I=I(i,h))){tD(p,I,n,f);break e}O&&O(i,m,h),i==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&gR(m,"number",m.value)}switch(O=h?mg(h):window,i){case"focusin":(NO(O)||O.contentEditable==="true")&&(fg=O,xR=h,$v=null);break;case"focusout":$v=xR=fg=null;break;case"mousedown":wR=!0;break;case"contextmenu":case"mouseup":case"dragend":wR=!1,FO(p,n,f);break;case"selectionchange":if(R3)break;case"keydown":case"keyup":FO(p,n,f)}var F;if($w)e:{switch(i){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else dg?QP(i,n)&&(k="onCompositionEnd"):i==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(qP&&n.locale!=="ko"&&(dg||k!=="onCompositionStart"?k==="onCompositionEnd"&&dg&&(F=ZP()):(zh=f,Ew="value"in zh?zh.value:zh.textContent,dg=!0)),O=RS(h,k),0<O.length&&(k=new MO(k,i,null,n,f),p.push({event:k,listeners:O}),F?k.data=F:(F=eD(n),F!==null&&(k.data=F)))),(F=m3?g3(i,n):_3(i,n))&&(h=RS(h,"onBeforeInput"),0<h.length&&(f=new MO("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:h}),f.data=F))}dD(p,e)})}function Wv(i,e,n){return{instance:i,listener:e,currentTarget:n}}function RS(i,e){for(var n=e+"Capture",r=[];i!==null;){var s=i,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Bv(i,n),a!=null&&r.unshift(Wv(i,a,s)),a=Bv(i,e),a!=null&&r.push(Wv(i,a,s))),i=i.return}return r}function km(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function HO(i,e,n,r,s){for(var a=e._reactName,l=[];n!==null&&n!==r;){var u=n,d=u.alternate,h=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&h!==null&&(u=h,s?(d=Bv(n,a),d!=null&&l.unshift(Wv(n,d,u))):s||(d=Bv(n,a),d!=null&&l.push(Wv(n,d,u)))),n=n.return}l.length!==0&&i.push({event:e,listeners:l})}var I3=/\r\n?/g,O3=/\u0000|\uFFFD/g;function VO(i){return(typeof i=="string"?i:""+i).replace(I3,`
`).replace(O3,"")}function Hy(i,e,n){if(e=VO(e),VO(i)!==e&&n)throw Error(Mt(425))}function xS(){}var MR=null,IR=null;function OR(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var LR=typeof setTimeout=="function"?setTimeout:void 0,L3=typeof clearTimeout=="function"?clearTimeout:void 0,zO=typeof Promise=="function"?Promise:void 0,N3=typeof queueMicrotask=="function"?queueMicrotask:typeof zO<"u"?function(i){return zO.resolve(null).then(i).catch(k3)}:LR;function k3(i){setTimeout(function(){throw i})}function WA(i,e){var n=e,r=0;do{var s=n.nextSibling;if(i.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){i.removeChild(s),Gv(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Gv(e)}function Qh(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function WO(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var n=i.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return i;e--}else n==="/$"&&e++}i=i.previousSibling}return null}var qg=Math.random().toString(36).slice(2),Ec="__reactFiber$"+qg,Xv="__reactProps$"+qg,Mu="__reactContainer$"+qg,NR="__reactEvents$"+qg,P3="__reactListeners$"+qg,D3="__reactHandles$"+qg;function Xf(i){var e=i[Ec];if(e)return e;for(var n=i.parentNode;n;){if(e=n[Mu]||n[Ec]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(i=WO(i);i!==null;){if(n=i[Ec])return n;i=WO(i)}return e}i=n,n=i.parentNode}return null}function _E(i){return i=i[Ec]||i[Mu],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function mg(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Mt(33))}function l$(i){return i[Xv]||null}var kR=[],gg=-1;function gd(i){return{current:i}}function Vi(i){0>gg||(i.current=kR[gg],kR[gg]=null,gg--)}function ki(i,e){gg++,kR[gg]=i.current,i.current=e}var ld={},Vs=gd(ld),Ao=gd(!1),gp=ld;function Bg(i,e){var n=i.type.contextTypes;if(!n)return ld;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=e[a];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=s),s}function Co(i){return i=i.childContextTypes,i!=null}function wS(){Vi(Ao),Vi(Vs)}function XO(i,e,n){if(Vs.current!==ld)throw Error(Mt(168));ki(Vs,e),ki(Ao,n)}function pD(i,e,n){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Mt(108,yH(i)||"Unknown",s));return rr({},n,r)}function MS(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ld,gp=Vs.current,ki(Vs,i),ki(Ao,Ao.current),!0}function jO(i,e,n){var r=i.stateNode;if(!r)throw Error(Mt(169));n?(i=pD(i,e,gp),r.__reactInternalMemoizedMergedChildContext=i,Vi(Ao),Vi(Vs),ki(Vs,i)):Vi(Ao),ki(Ao,n)}var Eu=null,c$=!1,XA=!1;function mD(i){Eu===null?Eu=[i]:Eu.push(i)}function B3(i){c$=!0,mD(i)}function _d(){if(!XA&&Eu!==null){XA=!0;var i=0,e=bi;try{var n=Eu;for(bi=1;i<n.length;i++){var r=n[i];do r=r(!0);while(r!==null)}Eu=null,c$=!1}catch(s){throw Eu!==null&&(Eu=Eu.slice(i+1)),UP(gw,_d),s}finally{bi=e,XA=!1}}return null}var _g=[],Tg=0,IS=null,OS=0,Da=[],Ba=0,_p=null,Au=1,Cu="";function Bf(i,e){_g[Tg++]=OS,_g[Tg++]=IS,IS=i,OS=e}function gD(i,e,n){Da[Ba++]=Au,Da[Ba++]=Cu,Da[Ba++]=_p,_p=i;var r=Au;i=Cu;var s=32-Ll(r)-1;r&=~(1<<s),n+=1;var a=32-Ll(e)+s;if(30<a){var l=s-s%5;a=(r&(1<<l)-1).toString(32),r>>=l,s-=l,Au=1<<32-Ll(e)+s|n<<s|r,Cu=a+i}else Au=1<<a|n<<s|r,Cu=i}function Aw(i){i.return!==null&&(Bf(i,1),gD(i,1,0))}function Cw(i){for(;i===IS;)IS=_g[--Tg],_g[Tg]=null,OS=_g[--Tg],_g[Tg]=null;for(;i===_p;)_p=Da[--Ba],Da[Ba]=null,Cu=Da[--Ba],Da[Ba]=null,Au=Da[--Ba],Da[Ba]=null}var na=null,Qo=null,Yi=!1,Il=null;function _D(i,e){var n=Ua(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=i,e=i.deletions,e===null?(i.deletions=[n],i.flags|=16):e.push(n)}function YO(i,e){switch(i.tag){case 5:var n=i.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,na=i,Qo=Qh(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,na=i,Qo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_p!==null?{id:Au,overflow:Cu}:null,i.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ua(18,null,null,0),n.stateNode=e,n.return=i,i.child=n,na=i,Qo=null,!0):!1;default:return!1}}function PR(i){return(i.mode&1)!==0&&(i.flags&128)===0}function DR(i){if(Yi){var e=Qo;if(e){var n=e;if(!YO(i,e)){if(PR(i))throw Error(Mt(418));e=Qh(n.nextSibling);var r=na;e&&YO(i,e)?_D(r,n):(i.flags=i.flags&-4097|2,Yi=!1,na=i)}}else{if(PR(i))throw Error(Mt(418));i.flags=i.flags&-4097|2,Yi=!1,na=i}}}function KO(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;na=i}function Vy(i){if(i!==na)return!1;if(!Yi)return KO(i),Yi=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!OR(i.type,i.memoizedProps)),e&&(e=Qo)){if(PR(i))throw TD(),Error(Mt(418));for(;e;)_D(i,e),e=Qh(e.nextSibling)}if(KO(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Mt(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var n=i.data;if(n==="/$"){if(e===0){Qo=Qh(i.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}i=i.nextSibling}Qo=null}}else Qo=na?Qh(i.stateNode.nextSibling):null;return!0}function TD(){for(var i=Qo;i;)i=Qh(i.nextSibling)}function Fg(){Qo=na=null,Yi=!1}function Rw(i){Il===null?Il=[i]:Il.push(i)}var F3=Pu.ReactCurrentBatchConfig;function NT(i,e,n){if(i=n.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Mt(309));var r=n.stateNode}if(!r)throw Error(Mt(147,i));var s=r,a=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(l){var u=s.refs;l===null?delete u[a]:u[a]=l},e._stringRef=a,e)}if(typeof i!="string")throw Error(Mt(284));if(!n._owner)throw Error(Mt(290,i))}return i}function zy(i,e){throw i=Object.prototype.toString.call(e),Error(Mt(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function JO(i){var e=i._init;return e(i._payload)}function vD(i){function e(S,A){if(i){var C=S.deletions;C===null?(S.deletions=[A],S.flags|=16):C.push(A)}}function n(S,A){if(!i)return null;for(;A!==null;)e(S,A),A=A.sibling;return null}function r(S,A){for(S=new Map;A!==null;)A.key!==null?S.set(A.key,A):S.set(A.index,A),A=A.sibling;return S}function s(S,A){return S=id(S,A),S.index=0,S.sibling=null,S}function a(S,A,C){return S.index=C,i?(C=S.alternate,C!==null?(C=C.index,C<A?(S.flags|=2,A):C):(S.flags|=2,A)):(S.flags|=1048576,A)}function l(S){return i&&S.alternate===null&&(S.flags|=2),S}function u(S,A,C,x){return A===null||A.tag!==6?(A=QA(C,S.mode,x),A.return=S,A):(A=s(A,C),A.return=S,A)}function d(S,A,C,x){var I=C.type;return I===hg?f(S,A,C.props.children,x,C.key):A!==null&&(A.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Fh&&JO(I)===A.type)?(x=s(A,C.props),x.ref=NT(S,A,C),x.return=S,x):(x=cS(C.type,C.key,C.props,null,S.mode,x),x.ref=NT(S,A,C),x.return=S,x)}function h(S,A,C,x){return A===null||A.tag!==4||A.stateNode.containerInfo!==C.containerInfo||A.stateNode.implementation!==C.implementation?(A=eC(C,S.mode,x),A.return=S,A):(A=s(A,C.children||[]),A.return=S,A)}function f(S,A,C,x,I){return A===null||A.tag!==7?(A=ip(C,S.mode,x,I),A.return=S,A):(A=s(A,C),A.return=S,A)}function p(S,A,C){if(typeof A=="string"&&A!==""||typeof A=="number")return A=QA(""+A,S.mode,C),A.return=S,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ly:return C=cS(A.type,A.key,A.props,null,S.mode,C),C.ref=NT(S,null,A),C.return=S,C;case ug:return A=eC(A,S.mode,C),A.return=S,A;case Fh:var x=A._init;return p(S,x(A._payload),C)}if(pv(A)||wT(A))return A=ip(A,S.mode,C,null),A.return=S,A;zy(S,A)}return null}function m(S,A,C,x){var I=A!==null?A.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return I!==null?null:u(S,A,""+C,x);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Ly:return C.key===I?d(S,A,C,x):null;case ug:return C.key===I?h(S,A,C,x):null;case Fh:return I=C._init,m(S,A,I(C._payload),x)}if(pv(C)||wT(C))return I!==null?null:f(S,A,C,x,null);zy(S,C)}return null}function v(S,A,C,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return S=S.get(C)||null,u(A,S,""+x,I);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ly:return S=S.get(x.key===null?C:x.key)||null,d(A,S,x,I);case ug:return S=S.get(x.key===null?C:x.key)||null,h(A,S,x,I);case Fh:var O=x._init;return v(S,A,C,O(x._payload),I)}if(pv(x)||wT(x))return S=S.get(C)||null,f(A,S,x,I,null);zy(A,x)}return null}function y(S,A,C,x){for(var I=null,O=null,F=A,k=A=0,D=null;F!==null&&k<C.length;k++){F.index>k?(D=F,F=null):D=F.sibling;var U=m(S,F,C[k],x);if(U===null){F===null&&(F=D);break}i&&F&&U.alternate===null&&e(S,F),A=a(U,A,k),O===null?I=U:O.sibling=U,O=U,F=D}if(k===C.length)return n(S,F),Yi&&Bf(S,k),I;if(F===null){for(;k<C.length;k++)F=p(S,C[k],x),F!==null&&(A=a(F,A,k),O===null?I=F:O.sibling=F,O=F);return Yi&&Bf(S,k),I}for(F=r(S,F);k<C.length;k++)D=v(F,S,k,C[k],x),D!==null&&(i&&D.alternate!==null&&F.delete(D.key===null?k:D.key),A=a(D,A,k),O===null?I=D:O.sibling=D,O=D);return i&&F.forEach(function(ce){return e(S,ce)}),Yi&&Bf(S,k),I}function $(S,A,C,x){var I=wT(C);if(typeof I!="function")throw Error(Mt(150));if(C=I.call(C),C==null)throw Error(Mt(151));for(var O=I=null,F=A,k=A=0,D=null,U=C.next();F!==null&&!U.done;k++,U=C.next()){F.index>k?(D=F,F=null):D=F.sibling;var ce=m(S,F,U.value,x);if(ce===null){F===null&&(F=D);break}i&&F&&ce.alternate===null&&e(S,F),A=a(ce,A,k),O===null?I=ce:O.sibling=ce,O=ce,F=D}if(U.done)return n(S,F),Yi&&Bf(S,k),I;if(F===null){for(;!U.done;k++,U=C.next())U=p(S,U.value,x),U!==null&&(A=a(U,A,k),O===null?I=U:O.sibling=U,O=U);return Yi&&Bf(S,k),I}for(F=r(S,F);!U.done;k++,U=C.next())U=v(F,S,k,U.value,x),U!==null&&(i&&U.alternate!==null&&F.delete(U.key===null?k:U.key),A=a(U,A,k),O===null?I=U:O.sibling=U,O=U);return i&&F.forEach(function(re){return e(S,re)}),Yi&&Bf(S,k),I}function E(S,A,C,x){if(typeof C=="object"&&C!==null&&C.type===hg&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Ly:e:{for(var I=C.key,O=A;O!==null;){if(O.key===I){if(I=C.type,I===hg){if(O.tag===7){n(S,O.sibling),A=s(O,C.props.children),A.return=S,S=A;break e}}else if(O.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Fh&&JO(I)===O.type){n(S,O.sibling),A=s(O,C.props),A.ref=NT(S,O,C),A.return=S,S=A;break e}n(S,O);break}else e(S,O);O=O.sibling}C.type===hg?(A=ip(C.props.children,S.mode,x,C.key),A.return=S,S=A):(x=cS(C.type,C.key,C.props,null,S.mode,x),x.ref=NT(S,A,C),x.return=S,S=x)}return l(S);case ug:e:{for(O=C.key;A!==null;){if(A.key===O)if(A.tag===4&&A.stateNode.containerInfo===C.containerInfo&&A.stateNode.implementation===C.implementation){n(S,A.sibling),A=s(A,C.children||[]),A.return=S,S=A;break e}else{n(S,A);break}else e(S,A);A=A.sibling}A=eC(C,S.mode,x),A.return=S,S=A}return l(S);case Fh:return O=C._init,E(S,A,O(C._payload),x)}if(pv(C))return y(S,A,C,x);if(wT(C))return $(S,A,C,x);zy(S,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,A!==null&&A.tag===6?(n(S,A.sibling),A=s(A,C),A.return=S,S=A):(n(S,A),A=QA(C,S.mode,x),A.return=S,S=A),l(S)):n(S,A)}return E}var Ug=vD(!0),ED=vD(!1),LS=gd(null),NS=null,vg=null,xw=null;function ww(){xw=vg=NS=null}function Mw(i){var e=LS.current;Vi(LS),i._currentValue=e}function BR(i,e,n){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===n)break;i=i.return}}function Ig(i,e){NS=i,xw=vg=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(bo=!0),i.firstContext=null)}function Ha(i){var e=i._currentValue;if(xw!==i)if(i={context:i,memoizedValue:e,next:null},vg===null){if(NS===null)throw Error(Mt(308));vg=i,NS.dependencies={lanes:0,firstContext:i}}else vg=vg.next=i;return e}var jf=null;function Iw(i){jf===null?jf=[i]:jf.push(i)}function yD(i,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Iw(e)):(n.next=s.next,s.next=n),e.interleaved=n,Iu(i,r)}function Iu(i,e){i.lanes|=e;var n=i.alternate;for(n!==null&&(n.lanes|=e),n=i,i=i.return;i!==null;)i.childLanes|=e,n=i.alternate,n!==null&&(n.childLanes|=e),n=i,i=i.return;return n.tag===3?n.stateNode:null}var Uh=!1;function Ow(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SD(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ru(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function ed(i,e,n){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,si&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Iu(i,n)}return s=r.interleaved,s===null?(e.next=e,Iw(r)):(e.next=s.next,s.next=e),r.interleaved=e,Iu(i,n)}function iS(i,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,n|=r,e.lanes=n,_w(i,n)}}function ZO(i,e){var n=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=l:a=a.next=l,n=n.next}while(n!==null);a===null?s=a=e:a=a.next=e}else s=a=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},i.updateQueue=n;return}i=n.lastBaseUpdate,i===null?n.firstBaseUpdate=e:i.next=e,n.lastBaseUpdate=e}function kS(i,e,n,r){var s=i.updateQueue;Uh=!1;var a=s.firstBaseUpdate,l=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var d=u,h=d.next;d.next=null,l===null?a=h:l.next=h,l=d;var f=i.alternate;f!==null&&(f=f.updateQueue,u=f.lastBaseUpdate,u!==l&&(u===null?f.firstBaseUpdate=h:u.next=h,f.lastBaseUpdate=d))}if(a!==null){var p=s.baseState;l=0,f=h=d=null,u=a;do{var m=u.lane,v=u.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:v,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var y=i,$=u;switch(m=e,v=n,$.tag){case 1:if(y=$.payload,typeof y=="function"){p=y.call(v,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=$.payload,m=typeof y=="function"?y.call(v,p,m):y,m==null)break e;p=rr({},p,m);break e;case 2:Uh=!0}}u.callback!==null&&u.lane!==0&&(i.flags|=64,m=s.effects,m===null?s.effects=[u]:m.push(u))}else v={eventTime:v,lane:m,tag:u.tag,payload:u.payload,callback:u.callback,next:null},f===null?(h=f=v,d=p):f=f.next=v,l|=m;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;m=u,u=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(1);if(f===null&&(d=p),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);vp|=l,i.lanes=l,i.memoizedState=p}}function qO(i,e,n){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Mt(191,s));s.call(r)}}}var TE={},Ac=gd(TE),jv=gd(TE),Yv=gd(TE);function Yf(i){if(i===TE)throw Error(Mt(174));return i}function Lw(i,e){switch(ki(Yv,e),ki(jv,i),ki(Ac,TE),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:TR(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=TR(e,i)}Vi(Ac),ki(Ac,e)}function Gg(){Vi(Ac),Vi(jv),Vi(Yv)}function $D(i){Yf(Yv.current);var e=Yf(Ac.current),n=TR(e,i.type);e!==n&&(ki(jv,i),ki(Ac,n))}function Nw(i){jv.current===i&&(Vi(Ac),Vi(jv))}var Qi=gd(0);function PS(i){for(var e=i;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jA=[];function kw(){for(var i=0;i<jA.length;i++)jA[i]._workInProgressVersionPrimary=null;jA.length=0}var rS=Pu.ReactCurrentDispatcher,YA=Pu.ReactCurrentBatchConfig,Tp=0,nr=null,jr=null,os=null,DS=!1,bv=!1,Kv=0,U3=0;function Ds(){throw Error(Mt(321))}function Pw(i,e){if(e===null)return!1;for(var n=0;n<e.length&&n<i.length;n++)if(!Dl(i[n],e[n]))return!1;return!0}function Dw(i,e,n,r,s,a){if(Tp=a,nr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rS.current=i===null||i.memoizedState===null?z3:W3,i=n(r,s),bv){a=0;do{if(bv=!1,Kv=0,25<=a)throw Error(Mt(301));a+=1,os=jr=null,e.updateQueue=null,rS.current=X3,i=n(r,s)}while(bv)}if(rS.current=BS,e=jr!==null&&jr.next!==null,Tp=0,os=jr=nr=null,DS=!1,e)throw Error(Mt(300));return i}function Bw(){var i=Kv!==0;return Kv=0,i}function vc(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?nr.memoizedState=os=i:os=os.next=i,os}function Va(){if(jr===null){var i=nr.alternate;i=i!==null?i.memoizedState:null}else i=jr.next;var e=os===null?nr.memoizedState:os.next;if(e!==null)os=e,jr=i;else{if(i===null)throw Error(Mt(310));jr=i,i={memoizedState:jr.memoizedState,baseState:jr.baseState,baseQueue:jr.baseQueue,queue:jr.queue,next:null},os===null?nr.memoizedState=os=i:os=os.next=i}return os}function Jv(i,e){return typeof e=="function"?e(i):e}function KA(i){var e=Va(),n=e.queue;if(n===null)throw Error(Mt(311));n.lastRenderedReducer=i;var r=jr,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var l=s.next;s.next=a.next,a.next=l}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var u=l=null,d=null,h=a;do{var f=h.lane;if((Tp&f)===f)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:i(r,h.action);else{var p={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(u=d=p,l=r):d=d.next=p,nr.lanes|=f,vp|=f}h=h.next}while(h!==null&&h!==a);d===null?l=r:d.next=u,Dl(r,e.memoizedState)||(bo=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=d,n.lastRenderedState=r}if(i=n.interleaved,i!==null){s=i;do a=s.lane,nr.lanes|=a,vp|=a,s=s.next;while(s!==i)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function JA(i){var e=Va(),n=e.queue;if(n===null)throw Error(Mt(311));n.lastRenderedReducer=i;var r=n.dispatch,s=n.pending,a=e.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do a=i(a,l.action),l=l.next;while(l!==s);Dl(a,e.memoizedState)||(bo=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function bD(){}function AD(i,e){var n=nr,r=Va(),s=e(),a=!Dl(r.memoizedState,s);if(a&&(r.memoizedState=s,bo=!0),r=r.queue,Fw(xD.bind(null,n,r,i),[i]),r.getSnapshot!==e||a||os!==null&&os.memoizedState.tag&1){if(n.flags|=2048,Zv(9,RD.bind(null,n,r,s,e),void 0,null),as===null)throw Error(Mt(349));Tp&30||CD(n,e,s)}return s}function CD(i,e,n){i.flags|=16384,i={getSnapshot:e,value:n},e=nr.updateQueue,e===null?(e={lastEffect:null,stores:null},nr.updateQueue=e,e.stores=[i]):(n=e.stores,n===null?e.stores=[i]:n.push(i))}function RD(i,e,n,r){e.value=n,e.getSnapshot=r,wD(e)&&MD(i)}function xD(i,e,n){return n(function(){wD(e)&&MD(i)})}function wD(i){var e=i.getSnapshot;i=i.value;try{var n=e();return!Dl(i,n)}catch{return!0}}function MD(i){var e=Iu(i,1);e!==null&&Nl(e,i,1,-1)}function QO(i){var e=vc();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jv,lastRenderedState:i},e.queue=i,i=i.dispatch=V3.bind(null,nr,i),[e.memoizedState,i]}function Zv(i,e,n,r){return i={tag:i,create:e,destroy:n,deps:r,next:null},e=nr.updateQueue,e===null?(e={lastEffect:null,stores:null},nr.updateQueue=e,e.lastEffect=i.next=i):(n=e.lastEffect,n===null?e.lastEffect=i.next=i:(r=n.next,n.next=i,i.next=r,e.lastEffect=i)),i}function ID(){return Va().memoizedState}function sS(i,e,n,r){var s=vc();nr.flags|=i,s.memoizedState=Zv(1|e,n,void 0,r===void 0?null:r)}function u$(i,e,n,r){var s=Va();r=r===void 0?null:r;var a=void 0;if(jr!==null){var l=jr.memoizedState;if(a=l.destroy,r!==null&&Pw(r,l.deps)){s.memoizedState=Zv(e,n,a,r);return}}nr.flags|=i,s.memoizedState=Zv(1|e,n,a,r)}function eL(i,e){return sS(8390656,8,i,e)}function Fw(i,e){return u$(2048,8,i,e)}function OD(i,e){return u$(4,2,i,e)}function LD(i,e){return u$(4,4,i,e)}function ND(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function kD(i,e,n){return n=n!=null?n.concat([i]):null,u$(4,4,ND.bind(null,e,i),n)}function Uw(){}function PD(i,e){var n=Va();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pw(e,r[1])?r[0]:(n.memoizedState=[i,e],i)}function DD(i,e){var n=Va();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pw(e,r[1])?r[0]:(i=i(),n.memoizedState=[i,e],i)}function BD(i,e,n){return Tp&21?(Dl(n,e)||(n=VP(),nr.lanes|=n,vp|=n,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,bo=!0),i.memoizedState=n)}function G3(i,e){var n=bi;bi=n!==0&&4>n?n:4,i(!0);var r=YA.transition;YA.transition={};try{i(!1),e()}finally{bi=n,YA.transition=r}}function FD(){return Va().memoizedState}function H3(i,e,n){var r=nd(i);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UD(i))GD(e,n);else if(n=yD(i,e,n,r),n!==null){var s=ao();Nl(n,i,r,s),HD(n,e,r)}}function V3(i,e,n){var r=nd(i),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UD(i))GD(e,s);else{var a=i.alternate;if(i.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var l=e.lastRenderedState,u=a(l,n);if(s.hasEagerState=!0,s.eagerState=u,Dl(u,l)){var d=e.interleaved;d===null?(s.next=s,Iw(e)):(s.next=d.next,d.next=s),e.interleaved=s;return}}catch{}finally{}n=yD(i,e,s,r),n!==null&&(s=ao(),Nl(n,i,r,s),HD(n,e,r))}}function UD(i){var e=i.alternate;return i===nr||e!==null&&e===nr}function GD(i,e){bv=DS=!0;var n=i.pending;n===null?e.next=e:(e.next=n.next,n.next=e),i.pending=e}function HD(i,e,n){if(n&4194240){var r=e.lanes;r&=i.pendingLanes,n|=r,e.lanes=n,_w(i,n)}}var BS={readContext:Ha,useCallback:Ds,useContext:Ds,useEffect:Ds,useImperativeHandle:Ds,useInsertionEffect:Ds,useLayoutEffect:Ds,useMemo:Ds,useReducer:Ds,useRef:Ds,useState:Ds,useDebugValue:Ds,useDeferredValue:Ds,useTransition:Ds,useMutableSource:Ds,useSyncExternalStore:Ds,useId:Ds,unstable_isNewReconciler:!1},z3={readContext:Ha,useCallback:function(i,e){return vc().memoizedState=[i,e===void 0?null:e],i},useContext:Ha,useEffect:eL,useImperativeHandle:function(i,e,n){return n=n!=null?n.concat([i]):null,sS(4194308,4,ND.bind(null,e,i),n)},useLayoutEffect:function(i,e){return sS(4194308,4,i,e)},useInsertionEffect:function(i,e){return sS(4,2,i,e)},useMemo:function(i,e){var n=vc();return e=e===void 0?null:e,i=i(),n.memoizedState=[i,e],i},useReducer:function(i,e,n){var r=vc();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=H3.bind(null,nr,i),[r.memoizedState,i]},useRef:function(i){var e=vc();return i={current:i},e.memoizedState=i},useState:QO,useDebugValue:Uw,useDeferredValue:function(i){return vc().memoizedState=i},useTransition:function(){var i=QO(!1),e=i[0];return i=G3.bind(null,i[1]),vc().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,n){var r=nr,s=vc();if(Yi){if(n===void 0)throw Error(Mt(407));n=n()}else{if(n=e(),as===null)throw Error(Mt(349));Tp&30||CD(r,e,n)}s.memoizedState=n;var a={value:n,getSnapshot:e};return s.queue=a,eL(xD.bind(null,r,a,i),[i]),r.flags|=2048,Zv(9,RD.bind(null,r,a,n,e),void 0,null),n},useId:function(){var i=vc(),e=as.identifierPrefix;if(Yi){var n=Cu,r=Au;n=(r&~(1<<32-Ll(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Kv++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=U3++,e=":"+e+"r"+n.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},W3={readContext:Ha,useCallback:PD,useContext:Ha,useEffect:Fw,useImperativeHandle:kD,useInsertionEffect:OD,useLayoutEffect:LD,useMemo:DD,useReducer:KA,useRef:ID,useState:function(){return KA(Jv)},useDebugValue:Uw,useDeferredValue:function(i){var e=Va();return BD(e,jr.memoizedState,i)},useTransition:function(){var i=KA(Jv)[0],e=Va().memoizedState;return[i,e]},useMutableSource:bD,useSyncExternalStore:AD,useId:FD,unstable_isNewReconciler:!1},X3={readContext:Ha,useCallback:PD,useContext:Ha,useEffect:Fw,useImperativeHandle:kD,useInsertionEffect:OD,useLayoutEffect:LD,useMemo:DD,useReducer:JA,useRef:ID,useState:function(){return JA(Jv)},useDebugValue:Uw,useDeferredValue:function(i){var e=Va();return jr===null?e.memoizedState=i:BD(e,jr.memoizedState,i)},useTransition:function(){var i=JA(Jv)[0],e=Va().memoizedState;return[i,e]},useMutableSource:bD,useSyncExternalStore:AD,useId:FD,unstable_isNewReconciler:!1};function xl(i,e){if(i&&i.defaultProps){e=rr({},e),i=i.defaultProps;for(var n in i)e[n]===void 0&&(e[n]=i[n]);return e}return e}function FR(i,e,n,r){e=i.memoizedState,n=n(r,e),n=n==null?e:rr({},e,n),i.memoizedState=n,i.lanes===0&&(i.updateQueue.baseState=n)}var h$={isMounted:function(i){return(i=i._reactInternals)?wp(i)===i:!1},enqueueSetState:function(i,e,n){i=i._reactInternals;var r=ao(),s=nd(i),a=Ru(r,s);a.payload=e,n!=null&&(a.callback=n),e=ed(i,a,s),e!==null&&(Nl(e,i,s,r),iS(e,i,s))},enqueueReplaceState:function(i,e,n){i=i._reactInternals;var r=ao(),s=nd(i),a=Ru(r,s);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=ed(i,a,s),e!==null&&(Nl(e,i,s,r),iS(e,i,s))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var n=ao(),r=nd(i),s=Ru(n,r);s.tag=2,e!=null&&(s.callback=e),e=ed(i,s,r),e!==null&&(Nl(e,i,r,n),iS(e,i,r))}};function tL(i,e,n,r,s,a,l){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,a,l):e.prototype&&e.prototype.isPureReactComponent?!Vv(n,r)||!Vv(s,a):!0}function VD(i,e,n){var r=!1,s=ld,a=e.contextType;return typeof a=="object"&&a!==null?a=Ha(a):(s=Co(e)?gp:Vs.current,r=e.contextTypes,a=(r=r!=null)?Bg(i,s):ld),e=new e(n,a),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=h$,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=a),e}function nL(i,e,n,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==i&&h$.enqueueReplaceState(e,e.state,null)}function UR(i,e,n,r){var s=i.stateNode;s.props=n,s.state=i.memoizedState,s.refs={},Ow(i);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Ha(a):(a=Co(e)?gp:Vs.current,s.context=Bg(i,a)),s.state=i.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(FR(i,e,a,n),s.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&h$.enqueueReplaceState(s,s.state,null),kS(i,n,s,r),s.state=i.memoizedState),typeof s.componentDidMount=="function"&&(i.flags|=4194308)}function Hg(i,e){try{var n="",r=e;do n+=EH(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:i,source:e,stack:s,digest:null}}function ZA(i,e,n){return{value:i,source:null,stack:n??null,digest:e??null}}function GR(i,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var j3=typeof WeakMap=="function"?WeakMap:Map;function zD(i,e,n){n=Ru(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){US||(US=!0,ZR=r),GR(i,e)},n}function WD(i,e,n){n=Ru(-1,n),n.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){GR(i,e)}}var a=i.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){GR(i,e),typeof r!="function"&&(td===null?td=new Set([this]):td.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function iL(i,e,n){var r=i.pingCache;if(r===null){r=i.pingCache=new j3;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),i=aV.bind(null,i,e,n),e.then(i,i))}function rL(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function sL(i,e,n,r,s){return i.mode&1?(i.flags|=65536,i.lanes=s,i):(i===e?i.flags|=65536:(i.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ru(-1,1),e.tag=2,ed(n,e,1))),n.lanes|=1),i)}var Y3=Pu.ReactCurrentOwner,bo=!1;function so(i,e,n,r){e.child=i===null?ED(e,null,n,r):Ug(e,i.child,n,r)}function oL(i,e,n,r,s){n=n.render;var a=e.ref;return Ig(e,s),r=Dw(i,e,n,r,a,s),n=Bw(),i!==null&&!bo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~s,Ou(i,e,s)):(Yi&&n&&Aw(e),e.flags|=1,so(i,e,r,s),e.child)}function aL(i,e,n,r,s){if(i===null){var a=n.type;return typeof a=="function"&&!Yw(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,XD(i,e,a,r,s)):(i=cS(n.type,null,r,e,e.mode,s),i.ref=e.ref,i.return=e,e.child=i)}if(a=i.child,!(i.lanes&s)){var l=a.memoizedProps;if(n=n.compare,n=n!==null?n:Vv,n(l,r)&&i.ref===e.ref)return Ou(i,e,s)}return e.flags|=1,i=id(a,r),i.ref=e.ref,i.return=e,e.child=i}function XD(i,e,n,r,s){if(i!==null){var a=i.memoizedProps;if(Vv(a,r)&&i.ref===e.ref)if(bo=!1,e.pendingProps=r=a,(i.lanes&s)!==0)i.flags&131072&&(bo=!0);else return e.lanes=i.lanes,Ou(i,e,s)}return HR(i,e,n,r,s)}function jD(i,e,n){var r=e.pendingProps,s=r.children,a=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(yg,qo),qo|=n;else{if(!(n&1073741824))return i=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,ki(yg,qo),qo|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ki(yg,qo),qo|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,ki(yg,qo),qo|=r;return so(i,e,s,n),e.child}function YD(i,e){var n=e.ref;(i===null&&n!==null||i!==null&&i.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function HR(i,e,n,r,s){var a=Co(n)?gp:Vs.current;return a=Bg(e,a),Ig(e,s),n=Dw(i,e,n,r,a,s),r=Bw(),i!==null&&!bo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~s,Ou(i,e,s)):(Yi&&r&&Aw(e),e.flags|=1,so(i,e,n,s),e.child)}function lL(i,e,n,r,s){if(Co(n)){var a=!0;MS(e)}else a=!1;if(Ig(e,s),e.stateNode===null)oS(i,e),VD(e,n,r),UR(e,n,r,s),r=!0;else if(i===null){var l=e.stateNode,u=e.memoizedProps;l.props=u;var d=l.context,h=n.contextType;typeof h=="object"&&h!==null?h=Ha(h):(h=Co(n)?gp:Vs.current,h=Bg(e,h));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function";p||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||d!==h)&&nL(e,l,r,h),Uh=!1;var m=e.memoizedState;l.state=m,kS(e,r,l,s),d=e.memoizedState,u!==r||m!==d||Ao.current||Uh?(typeof f=="function"&&(FR(e,n,f,r),d=e.memoizedState),(u=Uh||tL(e,n,u,r,m,d,h))?(p||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),l.props=r,l.state=d,l.context=h,r=u):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,SD(i,e),u=e.memoizedProps,h=e.type===e.elementType?u:xl(e.type,u),l.props=h,p=e.pendingProps,m=l.context,d=n.contextType,typeof d=="object"&&d!==null?d=Ha(d):(d=Co(n)?gp:Vs.current,d=Bg(e,d));var v=n.getDerivedStateFromProps;(f=typeof v=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==p||m!==d)&&nL(e,l,r,d),Uh=!1,m=e.memoizedState,l.state=m,kS(e,r,l,s);var y=e.memoizedState;u!==p||m!==y||Ao.current||Uh?(typeof v=="function"&&(FR(e,n,v,r),y=e.memoizedState),(h=Uh||tL(e,n,h,r,m,y,d)||!1)?(f||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,y,d),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,y,d)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),l.props=r,l.state=y,l.context=d,r=h):(typeof l.componentDidUpdate!="function"||u===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),r=!1)}return VR(i,e,n,r,a,s)}function VR(i,e,n,r,s,a){YD(i,e);var l=(e.flags&128)!==0;if(!r&&!l)return s&&jO(e,n,!1),Ou(i,e,a);r=e.stateNode,Y3.current=e;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&l?(e.child=Ug(e,i.child,null,a),e.child=Ug(e,null,u,a)):so(i,e,u,a),e.memoizedState=r.state,s&&jO(e,n,!0),e.child}function KD(i){var e=i.stateNode;e.pendingContext?XO(i,e.pendingContext,e.pendingContext!==e.context):e.context&&XO(i,e.context,!1),Lw(i,e.containerInfo)}function cL(i,e,n,r,s){return Fg(),Rw(s),e.flags|=256,so(i,e,n,r),e.child}var zR={dehydrated:null,treeContext:null,retryLane:0};function WR(i){return{baseLanes:i,cachePool:null,transitions:null}}function JD(i,e,n){var r=e.pendingProps,s=Qi.current,a=!1,l=(e.flags&128)!==0,u;if((u=l)||(u=i!==null&&i.memoizedState===null?!1:(s&2)!==0),u?(a=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(s|=1),ki(Qi,s&1),i===null)return DR(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,i=r.fallback,a?(r=e.mode,a=e.child,l={mode:"hidden",children:l},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=p$(l,r,0,null),i=ip(i,r,n,null),a.return=e,i.return=e,a.sibling=i,e.child=a,e.child.memoizedState=WR(n),e.memoizedState=zR,i):Gw(e,l));if(s=i.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return K3(i,e,l,r,u,s,n);if(a){a=r.fallback,l=e.mode,s=i.child,u=s.sibling;var d={mode:"hidden",children:r.children};return!(l&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=id(s,d),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?a=id(u,a):(a=ip(a,l,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,l=i.child.memoizedState,l=l===null?WR(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=i.childLanes&~n,e.memoizedState=zR,r}return a=i.child,i=a.sibling,r=id(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,i!==null&&(n=e.deletions,n===null?(e.deletions=[i],e.flags|=16):n.push(i)),e.child=r,e.memoizedState=null,r}function Gw(i,e){return e=p$({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Wy(i,e,n,r){return r!==null&&Rw(r),Ug(e,i.child,null,n),i=Gw(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function K3(i,e,n,r,s,a,l){if(n)return e.flags&256?(e.flags&=-257,r=ZA(Error(Mt(422))),Wy(i,e,l,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(a=r.fallback,s=e.mode,r=p$({mode:"visible",children:r.children},s,0,null),a=ip(a,s,l,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&Ug(e,i.child,null,l),e.child.memoizedState=WR(l),e.memoizedState=zR,a);if(!(e.mode&1))return Wy(i,e,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,a=Error(Mt(419)),r=ZA(a,r,void 0),Wy(i,e,l,r)}if(u=(l&i.childLanes)!==0,bo||u){if(r=as,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Iu(i,s),Nl(r,i,s,-1))}return jw(),r=ZA(Error(Mt(421))),Wy(i,e,l,r)}return s.data==="$?"?(e.flags|=128,e.child=i.child,e=lV.bind(null,i),s._reactRetry=e,null):(i=a.treeContext,Qo=Qh(s.nextSibling),na=e,Yi=!0,Il=null,i!==null&&(Da[Ba++]=Au,Da[Ba++]=Cu,Da[Ba++]=_p,Au=i.id,Cu=i.overflow,_p=e),e=Gw(e,r.children),e.flags|=4096,e)}function uL(i,e,n){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),BR(i.return,e,n)}function qA(i,e,n,r,s){var a=i.memoizedState;a===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function ZD(i,e,n){var r=e.pendingProps,s=r.revealOrder,a=r.tail;if(so(i,e,r.children,n),r=Qi.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&uL(i,n,e);else if(i.tag===19)uL(i,n,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(ki(Qi,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)i=n.alternate,i!==null&&PS(i)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),qA(e,!1,s,n,a);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(i=s.alternate,i!==null&&PS(i)===null){e.child=s;break}i=s.sibling,s.sibling=n,n=s,s=i}qA(e,!0,n,null,a);break;case"together":qA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oS(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Ou(i,e,n){if(i!==null&&(e.dependencies=i.dependencies),vp|=e.lanes,!(n&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(Mt(153));if(e.child!==null){for(i=e.child,n=id(i,i.pendingProps),e.child=n,n.return=e;i.sibling!==null;)i=i.sibling,n=n.sibling=id(i,i.pendingProps),n.return=e;n.sibling=null}return e.child}function J3(i,e,n){switch(e.tag){case 3:KD(e),Fg();break;case 5:$D(e);break;case 1:Co(e.type)&&MS(e);break;case 4:Lw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ki(LS,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ki(Qi,Qi.current&1),e.flags|=128,null):n&e.child.childLanes?JD(i,e,n):(ki(Qi,Qi.current&1),i=Ou(i,e,n),i!==null?i.sibling:null);ki(Qi,Qi.current&1);break;case 19:if(r=(n&e.childLanes)!==0,i.flags&128){if(r)return ZD(i,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ki(Qi,Qi.current),r)break;return null;case 22:case 23:return e.lanes=0,jD(i,e,n)}return Ou(i,e,n)}var qD,XR,QD,eB;qD=function(i,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)i.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};XR=function(){};QD=function(i,e,n,r){var s=i.memoizedProps;if(s!==r){i=e.stateNode,Yf(Ac.current);var a=null;switch(n){case"input":s=pR(i,s),r=pR(i,r),a=[];break;case"select":s=rr({},s,{value:void 0}),r=rr({},r,{value:void 0}),a=[];break;case"textarea":s=_R(i,s),r=_R(i,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=xS)}vR(n,r);var l;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var u=s[h];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Pv.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var d=r[h];if(u=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==u&&(d!=null||u!=null))if(h==="style")if(u){for(l in u)!u.hasOwnProperty(l)||d&&d.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in d)d.hasOwnProperty(l)&&u[l]!==d[l]&&(n||(n={}),n[l]=d[l])}else n||(a||(a=[]),a.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(a=a||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(a=a||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Pv.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&Bi("scroll",i),a||u===d||(a=[])):(a=a||[]).push(h,d))}n&&(a=a||[]).push("style",n);var h=a;(e.updateQueue=h)&&(e.flags|=4)}};eB=function(i,e,n,r){n!==r&&(e.flags|=4)};function kT(i,e){if(!Yi)switch(i.tailMode){case"hidden":e=i.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?i.tail=null:n.sibling=null;break;case"collapsed":n=i.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Bs(i){var e=i.alternate!==null&&i.alternate.child===i.child,n=0,r=0;if(e)for(var s=i.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=i,s=s.sibling;else for(s=i.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=i,s=s.sibling;return i.subtreeFlags|=r,i.childLanes=n,e}function Z3(i,e,n){var r=e.pendingProps;switch(Cw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bs(e),null;case 1:return Co(e.type)&&wS(),Bs(e),null;case 3:return r=e.stateNode,Gg(),Vi(Ao),Vi(Vs),kw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(Vy(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Il!==null&&(ex(Il),Il=null))),XR(i,e),Bs(e),null;case 5:Nw(e);var s=Yf(Yv.current);if(n=e.type,i!==null&&e.stateNode!=null)QD(i,e,n,r,s),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Mt(166));return Bs(e),null}if(i=Yf(Ac.current),Vy(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Ec]=e,r[Xv]=a,i=(e.mode&1)!==0,n){case"dialog":Bi("cancel",r),Bi("close",r);break;case"iframe":case"object":case"embed":Bi("load",r);break;case"video":case"audio":for(s=0;s<gv.length;s++)Bi(gv[s],r);break;case"source":Bi("error",r);break;case"img":case"image":case"link":Bi("error",r),Bi("load",r);break;case"details":Bi("toggle",r);break;case"input":vO(r,a),Bi("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Bi("invalid",r);break;case"textarea":yO(r,a),Bi("invalid",r)}vR(n,a),s=null;for(var l in a)if(a.hasOwnProperty(l)){var u=a[l];l==="children"?typeof u=="string"?r.textContent!==u&&(a.suppressHydrationWarning!==!0&&Hy(r.textContent,u,i),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&Hy(r.textContent,u,i),s=["children",""+u]):Pv.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&Bi("scroll",r)}switch(n){case"input":Ny(r),EO(r,a,!0);break;case"textarea":Ny(r),SO(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=xS)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=xP(n)),i==="http://www.w3.org/1999/xhtml"?n==="script"?(i=l.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=l.createElement(n,{is:r.is}):(i=l.createElement(n),n==="select"&&(l=i,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):i=l.createElementNS(i,n),i[Ec]=e,i[Xv]=r,qD(i,e,!1,!1),e.stateNode=i;e:{switch(l=ER(n,r),n){case"dialog":Bi("cancel",i),Bi("close",i),s=r;break;case"iframe":case"object":case"embed":Bi("load",i),s=r;break;case"video":case"audio":for(s=0;s<gv.length;s++)Bi(gv[s],i);s=r;break;case"source":Bi("error",i),s=r;break;case"img":case"image":case"link":Bi("error",i),Bi("load",i),s=r;break;case"details":Bi("toggle",i),s=r;break;case"input":vO(i,r),s=pR(i,r),Bi("invalid",i);break;case"option":s=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},s=rr({},r,{value:void 0}),Bi("invalid",i);break;case"textarea":yO(i,r),s=_R(i,r),Bi("invalid",i);break;default:s=r}vR(n,s),u=s;for(a in u)if(u.hasOwnProperty(a)){var d=u[a];a==="style"?IP(i,d):a==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&wP(i,d)):a==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&Dv(i,d):typeof d=="number"&&Dv(i,""+d):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Pv.hasOwnProperty(a)?d!=null&&a==="onScroll"&&Bi("scroll",i):d!=null&&hw(i,a,d,l))}switch(n){case"input":Ny(i),EO(i,r,!1);break;case"textarea":Ny(i),SO(i);break;case"option":r.value!=null&&i.setAttribute("value",""+ad(r.value));break;case"select":i.multiple=!!r.multiple,a=r.value,a!=null?Rg(i,!!r.multiple,a,!1):r.defaultValue!=null&&Rg(i,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(i.onclick=xS)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bs(e),null;case 6:if(i&&e.stateNode!=null)eB(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Mt(166));if(n=Yf(Yv.current),Yf(Ac.current),Vy(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ec]=e,(a=r.nodeValue!==n)&&(i=na,i!==null))switch(i.tag){case 3:Hy(r.nodeValue,n,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Hy(r.nodeValue,n,(i.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ec]=e,e.stateNode=r}return Bs(e),null;case 13:if(Vi(Qi),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Yi&&Qo!==null&&e.mode&1&&!(e.flags&128))TD(),Fg(),e.flags|=98560,a=!1;else if(a=Vy(e),r!==null&&r.dehydrated!==null){if(i===null){if(!a)throw Error(Mt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Mt(317));a[Ec]=e}else Fg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bs(e),a=!1}else Il!==null&&(ex(Il),Il=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||Qi.current&1?Kr===0&&(Kr=3):jw())),e.updateQueue!==null&&(e.flags|=4),Bs(e),null);case 4:return Gg(),XR(i,e),i===null&&zv(e.stateNode.containerInfo),Bs(e),null;case 10:return Mw(e.type._context),Bs(e),null;case 17:return Co(e.type)&&wS(),Bs(e),null;case 19:if(Vi(Qi),a=e.memoizedState,a===null)return Bs(e),null;if(r=(e.flags&128)!==0,l=a.rendering,l===null)if(r)kT(a,!1);else{if(Kr!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(l=PS(i),l!==null){for(e.flags|=128,kT(a,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,i=r,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,i=l.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n=n.sibling;return ki(Qi,Qi.current&1|2),e.child}i=i.sibling}a.tail!==null&&vr()>Vg&&(e.flags|=128,r=!0,kT(a,!1),e.lanes=4194304)}else{if(!r)if(i=PS(l),i!==null){if(e.flags|=128,r=!0,n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),kT(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!Yi)return Bs(e),null}else 2*vr()-a.renderingStartTime>Vg&&n!==1073741824&&(e.flags|=128,r=!0,kT(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(n=a.last,n!==null?n.sibling=l:e.child=l,a.last=l)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=vr(),e.sibling=null,n=Qi.current,ki(Qi,r?n&1|2:n&1),e):(Bs(e),null);case 22:case 23:return Xw(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?qo&1073741824&&(Bs(e),e.subtreeFlags&6&&(e.flags|=8192)):Bs(e),null;case 24:return null;case 25:return null}throw Error(Mt(156,e.tag))}function q3(i,e){switch(Cw(e),e.tag){case 1:return Co(e.type)&&wS(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Gg(),Vi(Ao),Vi(Vs),kw(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return Nw(e),null;case 13:if(Vi(Qi),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(Mt(340));Fg()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Vi(Qi),null;case 4:return Gg(),null;case 10:return Mw(e.type._context),null;case 22:case 23:return Xw(),null;case 24:return null;default:return null}}var Xy=!1,Gs=!1,Q3=typeof WeakSet=="function"?WeakSet:Set,Xt=null;function Eg(i,e){var n=i.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dr(i,e,r)}else n.current=null}function jR(i,e,n){try{n()}catch(r){dr(i,e,r)}}var hL=!1;function eV(i,e){if(MR=AS,i=sD(),bw(i)){if("selectionStart"in i)var n={start:i.selectionStart,end:i.selectionEnd};else e:{n=(n=i.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var l=0,u=-1,d=-1,h=0,f=0,p=i,m=null;t:for(;;){for(var v;p!==n||s!==0&&p.nodeType!==3||(u=l+s),p!==a||r!==0&&p.nodeType!==3||(d=l+r),p.nodeType===3&&(l+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===i)break t;if(m===n&&++h===s&&(u=l),m===a&&++f===r&&(d=l),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(IR={focusedElem:i,selectionRange:n},AS=!1,Xt=e;Xt!==null;)if(e=Xt,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Xt=i;else for(;Xt!==null;){e=Xt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var $=y.memoizedProps,E=y.memoizedState,S=e.stateNode,A=S.getSnapshotBeforeUpdate(e.elementType===e.type?$:xl(e.type,$),E);S.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Mt(163))}}catch(x){dr(e,e.return,x)}if(i=e.sibling,i!==null){i.return=e.return,Xt=i;break}Xt=e.return}return y=hL,hL=!1,y}function Av(i,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&i)===i){var a=s.destroy;s.destroy=void 0,a!==void 0&&jR(e,n,a)}s=s.next}while(s!==r)}}function d$(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&i)===i){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function YR(i){var e=i.ref;if(e!==null){var n=i.stateNode;switch(i.tag){case 5:i=n;break;default:i=n}typeof e=="function"?e(i):e.current=i}}function tB(i){var e=i.alternate;e!==null&&(i.alternate=null,tB(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Ec],delete e[Xv],delete e[NR],delete e[P3],delete e[D3])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function nB(i){return i.tag===5||i.tag===3||i.tag===4}function dL(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||nB(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function KR(i,e,n){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(i,e):n.insertBefore(i,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(i,n)):(e=n,e.appendChild(i)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=xS));else if(r!==4&&(i=i.child,i!==null))for(KR(i,e,n),i=i.sibling;i!==null;)KR(i,e,n),i=i.sibling}function JR(i,e,n){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?n.insertBefore(i,e):n.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(JR(i,e,n),i=i.sibling;i!==null;)JR(i,e,n),i=i.sibling}var ys=null,Ml=!1;function Mh(i,e,n){for(n=n.child;n!==null;)iB(i,e,n),n=n.sibling}function iB(i,e,n){if(bc&&typeof bc.onCommitFiberUnmount=="function")try{bc.onCommitFiberUnmount(r$,n)}catch{}switch(n.tag){case 5:Gs||Eg(n,e);case 6:var r=ys,s=Ml;ys=null,Mh(i,e,n),ys=r,Ml=s,ys!==null&&(Ml?(i=ys,n=n.stateNode,i.nodeType===8?i.parentNode.removeChild(n):i.removeChild(n)):ys.removeChild(n.stateNode));break;case 18:ys!==null&&(Ml?(i=ys,n=n.stateNode,i.nodeType===8?WA(i.parentNode,n):i.nodeType===1&&WA(i,n),Gv(i)):WA(ys,n.stateNode));break;case 4:r=ys,s=Ml,ys=n.stateNode.containerInfo,Ml=!0,Mh(i,e,n),ys=r,Ml=s;break;case 0:case 11:case 14:case 15:if(!Gs&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&jR(n,e,l),s=s.next}while(s!==r)}Mh(i,e,n);break;case 1:if(!Gs&&(Eg(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){dr(n,e,u)}Mh(i,e,n);break;case 21:Mh(i,e,n);break;case 22:n.mode&1?(Gs=(r=Gs)||n.memoizedState!==null,Mh(i,e,n),Gs=r):Mh(i,e,n);break;default:Mh(i,e,n)}}function fL(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var n=i.stateNode;n===null&&(n=i.stateNode=new Q3),e.forEach(function(r){var s=cV.bind(null,i,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Sl(i,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=i,l=e,u=l;e:for(;u!==null;){switch(u.tag){case 5:ys=u.stateNode,Ml=!1;break e;case 3:ys=u.stateNode.containerInfo,Ml=!0;break e;case 4:ys=u.stateNode.containerInfo,Ml=!0;break e}u=u.return}if(ys===null)throw Error(Mt(160));iB(a,l,s),ys=null,Ml=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){dr(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rB(e,i),e=e.sibling}function rB(i,e){var n=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Sl(e,i),gc(i),r&4){try{Av(3,i,i.return),d$(3,i)}catch($){dr(i,i.return,$)}try{Av(5,i,i.return)}catch($){dr(i,i.return,$)}}break;case 1:Sl(e,i),gc(i),r&512&&n!==null&&Eg(n,n.return);break;case 5:if(Sl(e,i),gc(i),r&512&&n!==null&&Eg(n,n.return),i.flags&32){var s=i.stateNode;try{Dv(s,"")}catch($){dr(i,i.return,$)}}if(r&4&&(s=i.stateNode,s!=null)){var a=i.memoizedProps,l=n!==null?n.memoizedProps:a,u=i.type,d=i.updateQueue;if(i.updateQueue=null,d!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&CP(s,a),ER(u,l);var h=ER(u,a);for(l=0;l<d.length;l+=2){var f=d[l],p=d[l+1];f==="style"?IP(s,p):f==="dangerouslySetInnerHTML"?wP(s,p):f==="children"?Dv(s,p):hw(s,f,p,h)}switch(u){case"input":mR(s,a);break;case"textarea":RP(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Rg(s,!!a.multiple,v,!1):m!==!!a.multiple&&(a.defaultValue!=null?Rg(s,!!a.multiple,a.defaultValue,!0):Rg(s,!!a.multiple,a.multiple?[]:"",!1))}s[Xv]=a}catch($){dr(i,i.return,$)}}break;case 6:if(Sl(e,i),gc(i),r&4){if(i.stateNode===null)throw Error(Mt(162));s=i.stateNode,a=i.memoizedProps;try{s.nodeValue=a}catch($){dr(i,i.return,$)}}break;case 3:if(Sl(e,i),gc(i),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gv(e.containerInfo)}catch($){dr(i,i.return,$)}break;case 4:Sl(e,i),gc(i);break;case 13:Sl(e,i),gc(i),s=i.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(zw=vr())),r&4&&fL(i);break;case 22:if(f=n!==null&&n.memoizedState!==null,i.mode&1?(Gs=(h=Gs)||f,Sl(e,i),Gs=h):Sl(e,i),gc(i),r&8192){if(h=i.memoizedState!==null,(i.stateNode.isHidden=h)&&!f&&i.mode&1)for(Xt=i,f=i.child;f!==null;){for(p=Xt=f;Xt!==null;){switch(m=Xt,v=m.child,m.tag){case 0:case 11:case 14:case 15:Av(4,m,m.return);break;case 1:Eg(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch($){dr(r,n,$)}}break;case 5:Eg(m,m.return);break;case 22:if(m.memoizedState!==null){mL(p);continue}}v!==null?(v.return=m,Xt=v):mL(p)}f=f.sibling}e:for(f=null,p=i;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,h?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=p.stateNode,d=p.memoizedProps.style,l=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=MP("display",l))}catch($){dr(i,i.return,$)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch($){dr(i,i.return,$)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===i)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break e;for(;p.sibling===null;){if(p.return===null||p.return===i)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Sl(e,i),gc(i),r&4&&fL(i);break;case 21:break;default:Sl(e,i),gc(i)}}function gc(i){var e=i.flags;if(e&2){try{e:{for(var n=i.return;n!==null;){if(nB(n)){var r=n;break e}n=n.return}throw Error(Mt(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Dv(s,""),r.flags&=-33);var a=dL(i);JR(i,a,s);break;case 3:case 4:var l=r.stateNode.containerInfo,u=dL(i);KR(i,u,l);break;default:throw Error(Mt(161))}}catch(d){dr(i,i.return,d)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function tV(i,e,n){Xt=i,sB(i)}function sB(i,e,n){for(var r=(i.mode&1)!==0;Xt!==null;){var s=Xt,a=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||Xy;if(!l){var u=s.alternate,d=u!==null&&u.memoizedState!==null||Gs;u=Xy;var h=Gs;if(Xy=l,(Gs=d)&&!h)for(Xt=s;Xt!==null;)l=Xt,d=l.child,l.tag===22&&l.memoizedState!==null?gL(s):d!==null?(d.return=l,Xt=d):gL(s);for(;a!==null;)Xt=a,sB(a),a=a.sibling;Xt=s,Xy=u,Gs=h}pL(i)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Xt=a):pL(i)}}function pL(i){for(;Xt!==null;){var e=Xt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gs||d$(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gs)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xl(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&qO(e,a,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qO(e,l,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Gv(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Mt(163))}Gs||e.flags&512&&YR(e)}catch(m){dr(e,e.return,m)}}if(e===i){Xt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Xt=n;break}Xt=e.return}}function mL(i){for(;Xt!==null;){var e=Xt;if(e===i){Xt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Xt=n;break}Xt=e.return}}function gL(i){for(;Xt!==null;){var e=Xt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{d$(4,e)}catch(d){dr(e,n,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(d){dr(e,s,d)}}var a=e.return;try{YR(e)}catch(d){dr(e,a,d)}break;case 5:var l=e.return;try{YR(e)}catch(d){dr(e,l,d)}}}catch(d){dr(e,e.return,d)}if(e===i){Xt=null;break}var u=e.sibling;if(u!==null){u.return=e.return,Xt=u;break}Xt=e.return}}var nV=Math.ceil,FS=Pu.ReactCurrentDispatcher,Hw=Pu.ReactCurrentOwner,Ga=Pu.ReactCurrentBatchConfig,si=0,as=null,Or=null,bs=0,qo=0,yg=gd(0),Kr=0,qv=null,vp=0,f$=0,Vw=0,Cv=null,So=null,zw=0,Vg=1/0,Tu=null,US=!1,ZR=null,td=null,jy=!1,Wh=null,GS=0,Rv=0,qR=null,aS=-1,lS=0;function ao(){return si&6?vr():aS!==-1?aS:aS=vr()}function nd(i){return i.mode&1?si&2&&bs!==0?bs&-bs:F3.transition!==null?(lS===0&&(lS=VP()),lS):(i=bi,i!==0||(i=window.event,i=i===void 0?16:JP(i.type)),i):1}function Nl(i,e,n,r){if(50<Rv)throw Rv=0,qR=null,Error(Mt(185));mE(i,n,r),(!(si&2)||i!==as)&&(i===as&&(!(si&2)&&(f$|=n),Kr===4&&Vh(i,bs)),Ro(i,r),n===1&&si===0&&!(e.mode&1)&&(Vg=vr()+500,c$&&_d()))}function Ro(i,e){var n=i.callbackNode;FH(i,e);var r=bS(i,i===as?bs:0);if(r===0)n!==null&&AO(n),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(n!=null&&AO(n),e===1)i.tag===0?B3(_L.bind(null,i)):mD(_L.bind(null,i)),N3(function(){!(si&6)&&_d()}),n=null;else{switch(zP(r)){case 1:n=gw;break;case 4:n=GP;break;case 16:n=$S;break;case 536870912:n=HP;break;default:n=$S}n=fB(n,oB.bind(null,i))}i.callbackPriority=e,i.callbackNode=n}}function oB(i,e){if(aS=-1,lS=0,si&6)throw Error(Mt(327));var n=i.callbackNode;if(Og()&&i.callbackNode!==n)return null;var r=bS(i,i===as?bs:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=HS(i,r);else{e=r;var s=si;si|=2;var a=lB();(as!==i||bs!==e)&&(Tu=null,Vg=vr()+500,np(i,e));do try{sV();break}catch(u){aB(i,u)}while(1);ww(),FS.current=a,si=s,Or!==null?e=0:(as=null,bs=0,e=Kr)}if(e!==0){if(e===2&&(s=AR(i),s!==0&&(r=s,e=QR(i,s))),e===1)throw n=qv,np(i,0),Vh(i,r),Ro(i,vr()),n;if(e===6)Vh(i,r);else{if(s=i.current.alternate,!(r&30)&&!iV(s)&&(e=HS(i,r),e===2&&(a=AR(i),a!==0&&(r=a,e=QR(i,a))),e===1))throw n=qv,np(i,0),Vh(i,r),Ro(i,vr()),n;switch(i.finishedWork=s,i.finishedLanes=r,e){case 0:case 1:throw Error(Mt(345));case 2:Ff(i,So,Tu);break;case 3:if(Vh(i,r),(r&130023424)===r&&(e=zw+500-vr(),10<e)){if(bS(i,0)!==0)break;if(s=i.suspendedLanes,(s&r)!==r){ao(),i.pingedLanes|=i.suspendedLanes&s;break}i.timeoutHandle=LR(Ff.bind(null,i,So,Tu),e);break}Ff(i,So,Tu);break;case 4:if(Vh(i,r),(r&4194240)===r)break;for(e=i.eventTimes,s=-1;0<r;){var l=31-Ll(r);a=1<<l,l=e[l],l>s&&(s=l),r&=~a}if(r=s,r=vr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nV(r/1960))-r,10<r){i.timeoutHandle=LR(Ff.bind(null,i,So,Tu),r);break}Ff(i,So,Tu);break;case 5:Ff(i,So,Tu);break;default:throw Error(Mt(329))}}}return Ro(i,vr()),i.callbackNode===n?oB.bind(null,i):null}function QR(i,e){var n=Cv;return i.current.memoizedState.isDehydrated&&(np(i,e).flags|=256),i=HS(i,e),i!==2&&(e=So,So=n,e!==null&&ex(e)),i}function ex(i){So===null?So=i:So.push.apply(So,i)}function iV(i){for(var e=i;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!Dl(a(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vh(i,e){for(e&=~Vw,e&=~f$,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var n=31-Ll(e),r=1<<n;i[n]=-1,e&=~r}}function _L(i){if(si&6)throw Error(Mt(327));Og();var e=bS(i,0);if(!(e&1))return Ro(i,vr()),null;var n=HS(i,e);if(i.tag!==0&&n===2){var r=AR(i);r!==0&&(e=r,n=QR(i,r))}if(n===1)throw n=qv,np(i,0),Vh(i,e),Ro(i,vr()),n;if(n===6)throw Error(Mt(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Ff(i,So,Tu),Ro(i,vr()),null}function Ww(i,e){var n=si;si|=1;try{return i(e)}finally{si=n,si===0&&(Vg=vr()+500,c$&&_d())}}function Ep(i){Wh!==null&&Wh.tag===0&&!(si&6)&&Og();var e=si;si|=1;var n=Ga.transition,r=bi;try{if(Ga.transition=null,bi=1,i)return i()}finally{bi=r,Ga.transition=n,si=e,!(si&6)&&_d()}}function Xw(){qo=yg.current,Vi(yg)}function np(i,e){i.finishedWork=null,i.finishedLanes=0;var n=i.timeoutHandle;if(n!==-1&&(i.timeoutHandle=-1,L3(n)),Or!==null)for(n=Or.return;n!==null;){var r=n;switch(Cw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wS();break;case 3:Gg(),Vi(Ao),Vi(Vs),kw();break;case 5:Nw(r);break;case 4:Gg();break;case 13:Vi(Qi);break;case 19:Vi(Qi);break;case 10:Mw(r.type._context);break;case 22:case 23:Xw()}n=n.return}if(as=i,Or=i=id(i.current,null),bs=qo=e,Kr=0,qv=null,Vw=f$=vp=0,So=Cv=null,jf!==null){for(e=0;e<jf.length;e++)if(n=jf[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var l=a.next;a.next=s,r.next=l}n.pending=r}jf=null}return i}function aB(i,e){do{var n=Or;try{if(ww(),rS.current=BS,DS){for(var r=nr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}DS=!1}if(Tp=0,os=jr=nr=null,bv=!1,Kv=0,Hw.current=null,n===null||n.return===null){Kr=1,qv=e,Or=null;break}e:{var a=i,l=n.return,u=n,d=e;if(e=bs,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,f=u,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=rL(l);if(v!==null){v.flags&=-257,sL(v,l,u,a,e),v.mode&1&&iL(a,h,e),e=v,d=h;var y=e.updateQueue;if(y===null){var $=new Set;$.add(d),e.updateQueue=$}else y.add(d);break e}else{if(!(e&1)){iL(a,h,e),jw();break e}d=Error(Mt(426))}}else if(Yi&&u.mode&1){var E=rL(l);if(E!==null){!(E.flags&65536)&&(E.flags|=256),sL(E,l,u,a,e),Rw(Hg(d,u));break e}}a=d=Hg(d,u),Kr!==4&&(Kr=2),Cv===null?Cv=[a]:Cv.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var S=zD(a,d,e);ZO(a,S);break e;case 1:u=d;var A=a.type,C=a.stateNode;if(!(a.flags&128)&&(typeof A.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(td===null||!td.has(C)))){a.flags|=65536,e&=-e,a.lanes|=e;var x=WD(a,u,e);ZO(a,x);break e}}a=a.return}while(a!==null)}uB(n)}catch(I){e=I,Or===n&&n!==null&&(Or=n=n.return);continue}break}while(1)}function lB(){var i=FS.current;return FS.current=BS,i===null?BS:i}function jw(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),as===null||!(vp&268435455)&&!(f$&268435455)||Vh(as,bs)}function HS(i,e){var n=si;si|=2;var r=lB();(as!==i||bs!==e)&&(Tu=null,np(i,e));do try{rV();break}catch(s){aB(i,s)}while(1);if(ww(),si=n,FS.current=r,Or!==null)throw Error(Mt(261));return as=null,bs=0,Kr}function rV(){for(;Or!==null;)cB(Or)}function sV(){for(;Or!==null&&!MH();)cB(Or)}function cB(i){var e=dB(i.alternate,i,qo);i.memoizedProps=i.pendingProps,e===null?uB(i):Or=e,Hw.current=null}function uB(i){var e=i;do{var n=e.alternate;if(i=e.return,e.flags&32768){if(n=q3(n,e),n!==null){n.flags&=32767,Or=n;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Kr=6,Or=null;return}}else if(n=Z3(n,e,qo),n!==null){Or=n;return}if(e=e.sibling,e!==null){Or=e;return}Or=e=i}while(e!==null);Kr===0&&(Kr=5)}function Ff(i,e,n){var r=bi,s=Ga.transition;try{Ga.transition=null,bi=1,oV(i,e,n,r)}finally{Ga.transition=s,bi=r}return null}function oV(i,e,n,r){do Og();while(Wh!==null);if(si&6)throw Error(Mt(327));n=i.finishedWork;var s=i.finishedLanes;if(n===null)return null;if(i.finishedWork=null,i.finishedLanes=0,n===i.current)throw Error(Mt(177));i.callbackNode=null,i.callbackPriority=0;var a=n.lanes|n.childLanes;if(UH(i,a),i===as&&(Or=as=null,bs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jy||(jy=!0,fB($S,function(){return Og(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ga.transition,Ga.transition=null;var l=bi;bi=1;var u=si;si|=4,Hw.current=null,eV(i,n),rB(n,i),C3(IR),AS=!!MR,IR=MR=null,i.current=n,tV(n),IH(),si=u,bi=l,Ga.transition=a}else i.current=n;if(jy&&(jy=!1,Wh=i,GS=s),a=i.pendingLanes,a===0&&(td=null),NH(n.stateNode),Ro(i,vr()),e!==null)for(r=i.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(US)throw US=!1,i=ZR,ZR=null,i;return GS&1&&i.tag!==0&&Og(),a=i.pendingLanes,a&1?i===qR?Rv++:(Rv=0,qR=i):Rv=0,_d(),null}function Og(){if(Wh!==null){var i=zP(GS),e=Ga.transition,n=bi;try{if(Ga.transition=null,bi=16>i?16:i,Wh===null)var r=!1;else{if(i=Wh,Wh=null,GS=0,si&6)throw Error(Mt(331));var s=si;for(si|=4,Xt=i.current;Xt!==null;){var a=Xt,l=a.child;if(Xt.flags&16){var u=a.deletions;if(u!==null){for(var d=0;d<u.length;d++){var h=u[d];for(Xt=h;Xt!==null;){var f=Xt;switch(f.tag){case 0:case 11:case 15:Av(8,f,a)}var p=f.child;if(p!==null)p.return=f,Xt=p;else for(;Xt!==null;){f=Xt;var m=f.sibling,v=f.return;if(tB(f),f===h){Xt=null;break}if(m!==null){m.return=v,Xt=m;break}Xt=v}}}var y=a.alternate;if(y!==null){var $=y.child;if($!==null){y.child=null;do{var E=$.sibling;$.sibling=null,$=E}while($!==null)}}Xt=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,Xt=l;else e:for(;Xt!==null;){if(a=Xt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Av(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,Xt=S;break e}Xt=a.return}}var A=i.current;for(Xt=A;Xt!==null;){l=Xt;var C=l.child;if(l.subtreeFlags&2064&&C!==null)C.return=l,Xt=C;else e:for(l=A;Xt!==null;){if(u=Xt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:d$(9,u)}}catch(I){dr(u,u.return,I)}if(u===l){Xt=null;break e}var x=u.sibling;if(x!==null){x.return=u.return,Xt=x;break e}Xt=u.return}}if(si=s,_d(),bc&&typeof bc.onPostCommitFiberRoot=="function")try{bc.onPostCommitFiberRoot(r$,i)}catch{}r=!0}return r}finally{bi=n,Ga.transition=e}}return!1}function TL(i,e,n){e=Hg(n,e),e=zD(i,e,1),i=ed(i,e,1),e=ao(),i!==null&&(mE(i,1,e),Ro(i,e))}function dr(i,e,n){if(i.tag===3)TL(i,i,n);else for(;e!==null;){if(e.tag===3){TL(e,i,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(td===null||!td.has(r))){i=Hg(n,i),i=WD(e,i,1),e=ed(e,i,1),i=ao(),e!==null&&(mE(e,1,i),Ro(e,i));break}}e=e.return}}function aV(i,e,n){var r=i.pingCache;r!==null&&r.delete(e),e=ao(),i.pingedLanes|=i.suspendedLanes&n,as===i&&(bs&n)===n&&(Kr===4||Kr===3&&(bs&130023424)===bs&&500>vr()-zw?np(i,0):Vw|=n),Ro(i,e)}function hB(i,e){e===0&&(i.mode&1?(e=Dy,Dy<<=1,!(Dy&130023424)&&(Dy=4194304)):e=1);var n=ao();i=Iu(i,e),i!==null&&(mE(i,e,n),Ro(i,n))}function lV(i){var e=i.memoizedState,n=0;e!==null&&(n=e.retryLane),hB(i,n)}function cV(i,e){var n=0;switch(i.tag){case 13:var r=i.stateNode,s=i.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(Mt(314))}r!==null&&r.delete(e),hB(i,n)}var dB;dB=function(i,e,n){if(i!==null)if(i.memoizedProps!==e.pendingProps||Ao.current)bo=!0;else{if(!(i.lanes&n)&&!(e.flags&128))return bo=!1,J3(i,e,n);bo=!!(i.flags&131072)}else bo=!1,Yi&&e.flags&1048576&&gD(e,OS,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oS(i,e),i=e.pendingProps;var s=Bg(e,Vs.current);Ig(e,n),s=Dw(null,e,r,i,s,n);var a=Bw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Co(r)?(a=!0,MS(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ow(e),s.updater=h$,e.stateNode=s,s._reactInternals=e,UR(e,r,i,n),e=VR(null,e,r,!0,a,n)):(e.tag=0,Yi&&a&&Aw(e),so(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(oS(i,e),i=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=hV(r),i=xl(r,i),s){case 0:e=HR(null,e,r,i,n);break e;case 1:e=lL(null,e,r,i,n);break e;case 11:e=oL(null,e,r,i,n);break e;case 14:e=aL(null,e,r,xl(r.type,i),n);break e}throw Error(Mt(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xl(r,s),HR(i,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xl(r,s),lL(i,e,r,s,n);case 3:e:{if(KD(e),i===null)throw Error(Mt(387));r=e.pendingProps,a=e.memoizedState,s=a.element,SD(i,e),kS(e,r,null,n);var l=e.memoizedState;if(r=l.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Hg(Error(Mt(423)),e),e=cL(i,e,r,n,s);break e}else if(r!==s){s=Hg(Error(Mt(424)),e),e=cL(i,e,r,n,s);break e}else for(Qo=Qh(e.stateNode.containerInfo.firstChild),na=e,Yi=!0,Il=null,n=ED(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fg(),r===s){e=Ou(i,e,n);break e}so(i,e,r,n)}e=e.child}return e;case 5:return $D(e),i===null&&DR(e),r=e.type,s=e.pendingProps,a=i!==null?i.memoizedProps:null,l=s.children,OR(r,s)?l=null:a!==null&&OR(r,a)&&(e.flags|=32),YD(i,e),so(i,e,l,n),e.child;case 6:return i===null&&DR(e),null;case 13:return JD(i,e,n);case 4:return Lw(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=Ug(e,null,r,n):so(i,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xl(r,s),oL(i,e,r,s,n);case 7:return so(i,e,e.pendingProps,n),e.child;case 8:return so(i,e,e.pendingProps.children,n),e.child;case 12:return so(i,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,a=e.memoizedProps,l=s.value,ki(LS,r._currentValue),r._currentValue=l,a!==null)if(Dl(a.value,l)){if(a.children===s.children&&!Ao.current){e=Ou(i,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var u=a.dependencies;if(u!==null){l=a.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(a.tag===1){d=Ru(-1,n&-n),d.tag=2;var h=a.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?d.next=d:(d.next=f.next,f.next=d),h.pending=d}}a.lanes|=n,d=a.alternate,d!==null&&(d.lanes|=n),BR(a.return,n,e),u.lanes|=n;break}d=d.next}}else if(a.tag===10)l=a.type===e.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(Mt(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),BR(l,n,e),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===e){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}so(i,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ig(e,n),s=Ha(s),r=r(s),e.flags|=1,so(i,e,r,n),e.child;case 14:return r=e.type,s=xl(r,e.pendingProps),s=xl(r.type,s),aL(i,e,r,s,n);case 15:return XD(i,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xl(r,s),oS(i,e),e.tag=1,Co(r)?(i=!0,MS(e)):i=!1,Ig(e,n),VD(e,r,s),UR(e,r,s,n),VR(null,e,r,!0,i,n);case 19:return ZD(i,e,n);case 22:return jD(i,e,n)}throw Error(Mt(156,e.tag))};function fB(i,e){return UP(i,e)}function uV(i,e,n,r){this.tag=i,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ua(i,e,n,r){return new uV(i,e,n,r)}function Yw(i){return i=i.prototype,!(!i||!i.isReactComponent)}function hV(i){if(typeof i=="function")return Yw(i)?1:0;if(i!=null){if(i=i.$$typeof,i===fw)return 11;if(i===pw)return 14}return 2}function id(i,e){var n=i.alternate;return n===null?(n=Ua(i.tag,e,i.key,i.mode),n.elementType=i.elementType,n.type=i.type,n.stateNode=i.stateNode,n.alternate=i,i.alternate=n):(n.pendingProps=e,n.type=i.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=i.flags&14680064,n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,e=i.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=i.sibling,n.index=i.index,n.ref=i.ref,n}function cS(i,e,n,r,s,a){var l=2;if(r=i,typeof i=="function")Yw(i)&&(l=1);else if(typeof i=="string")l=5;else e:switch(i){case hg:return ip(n.children,s,a,e);case dw:l=8,s|=8;break;case uR:return i=Ua(12,n,e,s|2),i.elementType=uR,i.lanes=a,i;case hR:return i=Ua(13,n,e,s),i.elementType=hR,i.lanes=a,i;case dR:return i=Ua(19,n,e,s),i.elementType=dR,i.lanes=a,i;case $P:return p$(n,s,a,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case yP:l=10;break e;case SP:l=9;break e;case fw:l=11;break e;case pw:l=14;break e;case Fh:l=16,r=null;break e}throw Error(Mt(130,i==null?i:typeof i,""))}return e=Ua(l,n,e,s),e.elementType=i,e.type=r,e.lanes=a,e}function ip(i,e,n,r){return i=Ua(7,i,r,e),i.lanes=n,i}function p$(i,e,n,r){return i=Ua(22,i,r,e),i.elementType=$P,i.lanes=n,i.stateNode={isHidden:!1},i}function QA(i,e,n){return i=Ua(6,i,null,e),i.lanes=n,i}function eC(i,e,n){return e=Ua(4,i.children!==null?i.children:[],i.key,e),e.lanes=n,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function dV(i,e,n,r,s){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=NA(0),this.expirationTimes=NA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=NA(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kw(i,e,n,r,s,a,l,u,d){return i=new dV(i,e,n,u,d),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ua(3,null,null,e),i.current=a,a.stateNode=i,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ow(a),i}function fV(i,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ug,key:r==null?null:""+r,children:i,containerInfo:e,implementation:n}}function pB(i){if(!i)return ld;i=i._reactInternals;e:{if(wp(i)!==i||i.tag!==1)throw Error(Mt(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Co(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Mt(171))}if(i.tag===1){var n=i.type;if(Co(n))return pD(i,n,e)}return e}function mB(i,e,n,r,s,a,l,u,d){return i=Kw(n,r,!0,i,s,a,l,u,d),i.context=pB(null),n=i.current,r=ao(),s=nd(n),a=Ru(r,s),a.callback=e??null,ed(n,a,s),i.current.lanes=s,mE(i,s,r),Ro(i,r),i}function m$(i,e,n,r){var s=e.current,a=ao(),l=nd(s);return n=pB(n),e.context===null?e.context=n:e.pendingContext=n,e=Ru(a,l),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=ed(s,e,l),i!==null&&(Nl(i,s,l,a),iS(i,s,l)),l}function VS(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function vL(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var n=i.retryLane;i.retryLane=n!==0&&n<e?n:e}}function Jw(i,e){vL(i,e),(i=i.alternate)&&vL(i,e)}function pV(){return null}var gB=typeof reportError=="function"?reportError:function(i){console.error(i)};function Zw(i){this._internalRoot=i}g$.prototype.render=Zw.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(Mt(409));m$(i,e,null,null)};g$.prototype.unmount=Zw.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Ep(function(){m$(null,i,null,null)}),e[Mu]=null}};function g$(i){this._internalRoot=i}g$.prototype.unstable_scheduleHydration=function(i){if(i){var e=jP();i={blockedOn:null,target:i,priority:e};for(var n=0;n<Hh.length&&e!==0&&e<Hh[n].priority;n++);Hh.splice(n,0,i),n===0&&KP(i)}};function qw(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function _$(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function EL(){}function mV(i,e,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var h=VS(l);a.call(h)}}var l=mB(e,r,i,0,null,!1,!1,"",EL);return i._reactRootContainer=l,i[Mu]=l.current,zv(i.nodeType===8?i.parentNode:i),Ep(),l}for(;s=i.lastChild;)i.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var h=VS(d);u.call(h)}}var d=Kw(i,0,!1,null,null,!1,!1,"",EL);return i._reactRootContainer=d,i[Mu]=d.current,zv(i.nodeType===8?i.parentNode:i),Ep(function(){m$(e,d,n,r)}),d}function T$(i,e,n,r,s){var a=n._reactRootContainer;if(a){var l=a;if(typeof s=="function"){var u=s;s=function(){var d=VS(l);u.call(d)}}m$(e,l,i,s)}else l=mV(n,e,i,s,r);return VS(l)}WP=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var n=mv(e.pendingLanes);n!==0&&(_w(e,n|1),Ro(e,vr()),!(si&6)&&(Vg=vr()+500,_d()))}break;case 13:Ep(function(){var r=Iu(i,1);if(r!==null){var s=ao();Nl(r,i,1,s)}}),Jw(i,1)}};Tw=function(i){if(i.tag===13){var e=Iu(i,134217728);if(e!==null){var n=ao();Nl(e,i,134217728,n)}Jw(i,134217728)}};XP=function(i){if(i.tag===13){var e=nd(i),n=Iu(i,e);if(n!==null){var r=ao();Nl(n,i,e,r)}Jw(i,e)}};jP=function(){return bi};YP=function(i,e){var n=bi;try{return bi=i,e()}finally{bi=n}};SR=function(i,e,n){switch(e){case"input":if(mR(i,n),e=n.name,n.type==="radio"&&e!=null){for(n=i;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==i&&r.form===i.form){var s=l$(r);if(!s)throw Error(Mt(90));AP(r),mR(r,s)}}}break;case"textarea":RP(i,n);break;case"select":e=n.value,e!=null&&Rg(i,!!n.multiple,e,!1)}};NP=Ww;kP=Ep;var gV={usingClientEntryPoint:!1,Events:[_E,mg,l$,OP,LP,Ww]},PT={findFiberByHostInstance:Xf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_V={bundleType:PT.bundleType,version:PT.version,rendererPackageName:PT.rendererPackageName,rendererConfig:PT.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pu.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=BP(i),i===null?null:i.stateNode},findFiberByHostInstance:PT.findFiberByHostInstance||pV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yy.isDisabled&&Yy.supportsFiber)try{r$=Yy.inject(_V),bc=Yy}catch{}}aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gV;aa.createPortal=function(i,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qw(e))throw Error(Mt(200));return fV(i,e,null,n)};aa.createRoot=function(i,e){if(!qw(i))throw Error(Mt(299));var n=!1,r="",s=gB;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Kw(i,1,!1,null,null,n,!1,r,s),i[Mu]=e.current,zv(i.nodeType===8?i.parentNode:i),new Zw(e)};aa.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(Mt(188)):(i=Object.keys(i).join(","),Error(Mt(268,i)));return i=BP(e),i=i===null?null:i.stateNode,i};aa.flushSync=function(i){return Ep(i)};aa.hydrate=function(i,e,n){if(!_$(e))throw Error(Mt(200));return T$(null,i,e,!0,n)};aa.hydrateRoot=function(i,e,n){if(!qw(i))throw Error(Mt(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",l=gB;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=mB(e,null,i,1,n??null,s,!1,a,l),i[Mu]=e.current,zv(i),r)for(i=0;i<r.length;i++)n=r[i],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new g$(e)};aa.render=function(i,e,n){if(!_$(e))throw Error(Mt(200));return T$(null,i,e,!1,n)};aa.unmountComponentAtNode=function(i){if(!_$(i))throw Error(Mt(40));return i._reactRootContainer?(Ep(function(){T$(null,null,i,!1,function(){i._reactRootContainer=null,i[Mu]=null})}),!0):!1};aa.unstable_batchedUpdates=Ww;aa.unstable_renderSubtreeIntoContainer=function(i,e,n,r){if(!_$(n))throw Error(Mt(200));if(i==null||i._reactInternals===void 0)throw Error(Mt(38));return T$(i,e,n,!1,r)};aa.version="18.3.1-next-f1338f8080-20240426";function _B(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_B)}catch(i){console.error(i)}}_B(),_P.exports=aa;var TV=_P.exports;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qv(){return Qv=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Qv.apply(this,arguments)}var Xh;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Xh||(Xh={}));const yL="popstate";function vV(i){i===void 0&&(i={});function e(s,a){let{pathname:l="/",search:u="",hash:d=""}=Mp(s.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),tx("",{pathname:l,search:u,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){let l=s.document.querySelector("base"),u="";if(l&&l.getAttribute("href")){let d=s.location.href,h=d.indexOf("#");u=h===-1?d:d.slice(0,h)}return u+"#"+(typeof a=="string"?a:TB(a))}function r(s,a){Qw(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return yV(e,n,r,i)}function Zr(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Qw(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function EV(){return Math.random().toString(36).substr(2,8)}function SL(i,e){return{usr:i.state,key:i.key,idx:e}}function tx(i,e,n,r){return n===void 0&&(n=null),Qv({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?Mp(e):e,{state:n,key:e&&e.key||r||EV()})}function TB(i){let{pathname:e="/",search:n="",hash:r=""}=i;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Mp(i){let e={};if(i){let n=i.indexOf("#");n>=0&&(e.hash=i.substr(n),i=i.substr(0,n));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function yV(i,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,u=Xh.Pop,d=null,h=f();h==null&&(h=0,l.replaceState(Qv({},l.state,{idx:h}),""));function f(){return(l.state||{idx:null}).idx}function p(){u=Xh.Pop;let E=f(),S=E==null?null:E-h;h=E,d&&d({action:u,location:$.location,delta:S})}function m(E,S){u=Xh.Push;let A=tx($.location,E,S);n&&n(A,E),h=f()+1;let C=SL(A,h),x=$.createHref(A);try{l.pushState(C,"",x)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(x)}a&&d&&d({action:u,location:$.location,delta:1})}function v(E,S){u=Xh.Replace;let A=tx($.location,E,S);n&&n(A,E),h=f();let C=SL(A,h),x=$.createHref(A);l.replaceState(C,"",x),a&&d&&d({action:u,location:$.location,delta:0})}function y(E){let S=s.location.origin!=="null"?s.location.origin:s.location.href,A=typeof E=="string"?E:TB(E);return A=A.replace(/ $/,"%20"),Zr(S,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,S)}let $={get action(){return u},get location(){return i(s,l)},listen(E){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(yL,p),d=E,()=>{s.removeEventListener(yL,p),d=null}},createHref(E){return e(s,E)},createURL:y,encodeLocation(E){let S=y(E);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:v,go(E){return l.go(E)}};return $}var $L;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})($L||($L={}));function SV(i,e,n){return n===void 0&&(n="/"),$V(i,e,n,!1)}function $V(i,e,n,r){let s=typeof e=="string"?Mp(e):e,a=yB(s.pathname||"/",n);if(a==null)return null;let l=vB(i);bV(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let h=kV(a);u=LV(l[d],h,r)}return u}function vB(i,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(a,l,u)=>{let d={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(Zr(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let h=rp([r,d.relativePath]),f=n.concat(d);a.children&&a.children.length>0&&(Zr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),vB(a.children,e,f,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:IV(h,a.index),routesMeta:f})};return i.forEach((a,l)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))s(a,l);else for(let d of EB(a.path))s(a,l,d)}),e}function EB(i){let e=i.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=EB(r.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&u.push(...l),u.map(d=>i.startsWith("/")&&d===""?"/":d)}function bV(i){i.sort((e,n)=>e.score!==n.score?n.score-e.score:OV(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const AV=/^:[\w-]+$/,CV=3,RV=2,xV=1,wV=10,MV=-2,bL=i=>i==="*";function IV(i,e){let n=i.split("/"),r=n.length;return n.some(bL)&&(r+=MV),e&&(r+=RV),n.filter(s=>!bL(s)).reduce((s,a)=>s+(AV.test(a)?CV:a===""?xV:wV),r)}function OV(i,e){return i.length===e.length&&i.slice(0,-1).every((r,s)=>r===e[s])?i[i.length-1]-e[e.length-1]:0}function LV(i,e,n){n===void 0&&(n=!1);let{routesMeta:r}=i,s={},a="/",l=[];for(let u=0;u<r.length;++u){let d=r[u],h=u===r.length-1,f=a==="/"?e:e.slice(a.length)||"/",p=AL({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},f),m=d.route;if(!p&&h&&n&&!r[r.length-1].route.index&&(p=AL({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},f)),!p)return null;Object.assign(s,p.params),l.push({params:s,pathname:rp([a,p.pathname]),pathnameBase:GV(rp([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=rp([a,p.pathnameBase]))}return l}function AL(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[n,r]=NV(i.path,i.caseSensitive,i.end),s=e.match(n);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:r.reduce((h,f,p)=>{let{paramName:m,isOptional:v}=f;if(m==="*"){let $=u[p]||"";l=a.slice(0,a.length-$.length).replace(/(.)\/+$/,"$1")}const y=u[p];return v&&!y?h[m]=void 0:h[m]=(y||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:l,pattern:i}}function NV(i,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qw(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(r.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function kV(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qw(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function yB(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=i.charAt(n);return r&&r!=="/"?null:i.slice(n)||"/"}function PV(i,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof i=="string"?Mp(i):i;return{pathname:n?n.startsWith("/")?n:DV(n,e):e,search:HV(r),hash:VV(s)}}function DV(i,e){let n=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function tC(i,e,n,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BV(i){return i.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function FV(i,e){let n=BV(i);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function UV(i,e,n,r){r===void 0&&(r=!1);let s;typeof i=="string"?s=Mp(i):(s=Qv({},i),Zr(!s.pathname||!s.pathname.includes("?"),tC("?","pathname","search",s)),Zr(!s.pathname||!s.pathname.includes("#"),tC("#","pathname","hash",s)),Zr(!s.search||!s.search.includes("#"),tC("#","search","hash",s)));let a=i===""||s.pathname==="",l=a?"/":s.pathname,u;if(l==null)u=n;else{let p=e.length-1;if(!r&&l.startsWith("..")){let m=l.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}u=p>=0?e[p]:"/"}let d=PV(s,u),h=l&&l!=="/"&&l.endsWith("/"),f=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(h||f)&&(d.pathname+="/"),d}const rp=i=>i.join("/").replace(/\/\/+/g,"/"),GV=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),HV=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,VV=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function zV(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const SB=["post","put","patch","delete"];new Set(SB);const WV=["get",...SB];new Set(WV);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eE(){return eE=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},eE.apply(this,arguments)}const eM=q.createContext(null),XV=q.createContext(null),v$=q.createContext(null),E$=q.createContext(null),Qg=q.createContext({outlet:null,matches:[],isDataRoute:!1}),$B=q.createContext(null);function y$(){return q.useContext(E$)!=null}function bB(){return y$()||Zr(!1),q.useContext(E$).location}function AB(i){q.useContext(v$).static||q.useLayoutEffect(i)}function jV(){let{isDataRoute:i}=q.useContext(Qg);return i?oz():YV()}function YV(){y$()||Zr(!1);let i=q.useContext(eM),{basename:e,future:n,navigator:r}=q.useContext(v$),{matches:s}=q.useContext(Qg),{pathname:a}=bB(),l=JSON.stringify(FV(s,n.v7_relativeSplatPath)),u=q.useRef(!1);return AB(()=>{u.current=!0}),q.useCallback(function(h,f){if(f===void 0&&(f={}),!u.current)return;if(typeof h=="number"){r.go(h);return}let p=UV(h,JSON.parse(l),a,f.relative==="path");i==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:rp([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,l,a,i])}function KV(i,e){return JV(i,e)}function JV(i,e,n,r){y$()||Zr(!1);let{navigator:s}=q.useContext(v$),{matches:a}=q.useContext(Qg),l=a[a.length-1],u=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let h=bB(),f;if(e){var p;let E=typeof e=="string"?Mp(e):e;d==="/"||(p=E.pathname)!=null&&p.startsWith(d)||Zr(!1),f=E}else f=h;let m=f.pathname||"/",v=m;if(d!=="/"){let E=d.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(E.length).join("/")}let y=SV(i,{pathname:v}),$=tz(y&&y.map(E=>Object.assign({},E,{params:Object.assign({},u,E.params),pathname:rp([d,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:rp([d,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),a,n,r);return e&&$?q.createElement(E$.Provider,{value:{location:eE({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Xh.Pop}},$):$}function ZV(){let i=sz(),e=zV(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),n=i instanceof Error?i.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},a=null;return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),n?q.createElement("pre",{style:s},n):null,a)}const qV=q.createElement(ZV,null);class QV extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?q.createElement(Qg.Provider,{value:this.props.routeContext},q.createElement($B.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ez(i){let{routeContext:e,match:n,children:r}=i,s=q.useContext(eM);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),q.createElement(Qg.Provider,{value:e},r)}function tz(i,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),i==null){var a;if(!n)return null;if(n.errors)i=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)i=n.matches;else return null}let l=i,u=(s=n)==null?void 0:s.errors;if(u!=null){let f=l.findIndex(p=>p.route.id&&(u==null?void 0:u[p.route.id])!==void 0);f>=0||Zr(!1),l=l.slice(0,Math.min(l.length,f+1))}let d=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<l.length;f++){let p=l[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:m,errors:v}=n,y=p.route.loader&&m[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||y){d=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((f,p,m)=>{let v,y=!1,$=null,E=null;n&&(v=u&&p.route.id?u[p.route.id]:void 0,$=p.route.errorElement||qV,d&&(h<0&&m===0?(az("route-fallback",!1),y=!0,E=null):h===m&&(y=!0,E=p.route.hydrateFallbackElement||null)));let S=e.concat(l.slice(0,m+1)),A=()=>{let C;return v?C=$:y?C=E:p.route.Component?C=q.createElement(p.route.Component,null):p.route.element?C=p.route.element:C=f,q.createElement(ez,{match:p,routeContext:{outlet:f,matches:S,isDataRoute:n!=null},children:C})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?q.createElement(QV,{location:n.location,revalidation:n.revalidation,component:$,error:v,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):A()},null)}var CB=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(CB||{}),zS=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(zS||{});function nz(i){let e=q.useContext(eM);return e||Zr(!1),e}function iz(i){let e=q.useContext(XV);return e||Zr(!1),e}function rz(i){let e=q.useContext(Qg);return e||Zr(!1),e}function RB(i){let e=rz(),n=e.matches[e.matches.length-1];return n.route.id||Zr(!1),n.route.id}function sz(){var i;let e=q.useContext($B),n=iz(zS.UseRouteError),r=RB(zS.UseRouteError);return e!==void 0?e:(i=n.errors)==null?void 0:i[r]}function oz(){let{router:i}=nz(CB.UseNavigateStable),e=RB(zS.UseNavigateStable),n=q.useRef(!1);return AB(()=>{n.current=!0}),q.useCallback(function(s,a){a===void 0&&(a={}),n.current&&(typeof s=="number"?i.navigate(s):i.navigate(s,eE({fromRouteId:e},a)))},[i,e])}const CL={};function az(i,e,n){!e&&!CL[i]&&(CL[i]=!0)}function Eo(i){Zr(!1)}function lz(i){let{basename:e="/",children:n=null,location:r,navigationType:s=Xh.Pop,navigator:a,static:l=!1,future:u}=i;y$()&&Zr(!1);let d=e.replace(/^\/*/,"/"),h=q.useMemo(()=>({basename:d,navigator:a,static:l,future:eE({v7_relativeSplatPath:!1},u)}),[d,u,a,l]);typeof r=="string"&&(r=Mp(r));let{pathname:f="/",search:p="",hash:m="",state:v=null,key:y="default"}=r,$=q.useMemo(()=>{let E=yB(f,d);return E==null?null:{location:{pathname:E,search:p,hash:m,state:v,key:y},navigationType:s}},[d,f,p,m,v,y,s]);return $==null?null:q.createElement(v$.Provider,{value:h},q.createElement(E$.Provider,{children:n,value:$}))}function cz(i){let{children:e,location:n}=i;return KV(nx(e),n)}new Promise(()=>{});function nx(i,e){e===void 0&&(e=[]);let n=[];return q.Children.forEach(i,(r,s)=>{if(!q.isValidElement(r))return;let a=[...e,s];if(r.type===q.Fragment){n.push.apply(n,nx(r.props.children,a));return}r.type!==Eo&&Zr(!1),!r.props.index||!r.props.children||Zr(!1);let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=nx(r.props.children,a)),n.push(l)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const uz="6";try{window.__reactRouterVersion=uz}catch{}const hz="startTransition",RL=aH[hz];function dz(i){let{basename:e,children:n,future:r,window:s}=i,a=q.useRef();a.current==null&&(a.current=vV({window:s,v5Compat:!0}));let l=a.current,[u,d]=q.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},f=q.useCallback(p=>{h&&RL?RL(()=>d(p)):d(p)},[d,h]);return q.useLayoutEffect(()=>l.listen(f),[l,f]),q.createElement(lz,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:l,future:r})}var xL;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(xL||(xL={}));var wL;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(wL||(wL={}));var ix={},xB,ML=TV;xB=ix.createRoot=ML.createRoot,ix.hydrateRoot=ML.hydrateRoot;var wB={exports:{}},fz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",pz=fz,mz=pz;function MB(){}function IB(){}IB.resetWarningCache=MB;var gz=function(){function i(r,s,a,l,u,d){if(d!==mz){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}i.isRequired=i;function e(){return i}var n={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:IB,resetWarningCache:MB};return n.PropTypes=n,n};wB.exports=gz();var _z=wB.exports;const zt=pd(_z),Tz=()=>window.location.hostname.includes("localhost")?"assets/fixtures/nws_banner.png":"/drone-simulation-cte-alpha/assets/fixtures/nws_banner.png";const Sg=({onClick:i,title:e,green:n,small:r,medium:s,right:a,disableButton:l})=>{const u={backgroundColor:n?"#28a745":"#007bff",width:r?"100px":s?"200px":"100%",cursor:"pointer",marginLeft:a?"auto":"0",disable:l};return V.jsxs("button",{className:"action-button",onClick:i,style:u,children:[" ",e]})};Sg.propTypes={onClick:zt.func,title:zt.string,green:zt.bool,small:zt.bool,right:zt.bool,medium:zt.bool,disableButton:zt.bool};const ca=({children:i})=>{const e=jV(),[n,r]=q.useState(!1),s=()=>{window.open("https://nextwavestem.github.io/drone-simulation/")};return q.useEffect(()=>{(l=>{const u=document.cookie.match(new RegExp("(^| )"+l+"=([^;]+)"));return u?decodeURIComponent(u[2]):null})("session_active")},[e]),V.jsxs("div",{className:"application-container",children:[V.jsxs("div",{className:"header-container",children:[V.jsx("div",{className:"nws-logo",onClick:s,children:V.jsx("img",{src:Tz(),alt:"Logo"})}),V.jsx("div",{className:"nws-home",onClick:s,children:V.jsx(Sg,{right:!0,small:!0,green:!0,title:"Home"})})]}),n&&V.jsxs("div",{className:"note-box",children:[V.jsxs("p",{children:[" ",V.jsx("strong",{children:"Note:"})," Enabling mouse control disables the default camera perspective of the drone."]}),V.jsx("button",{className:"close-btn",onClick:()=>r(!1),children:""})]}),V.jsx("div",{className:"application-content",children:i})]})};ca.propTypes={children:zt.node};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Ip="153",Uf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},OB=0,rx=1,LB=2,vz=3,NB=0,S$=1,xv=2,wl=3,za=0,Hs=1,$s=2,Ez=2,Cc=0,sp=1,sx=2,ox=3,ax=4,kB=5,Vf=100,PB=101,DB=102,lx=103,cx=104,BB=200,FB=201,UB=202,GB=203,tM=204,nM=205,HB=206,VB=207,zB=208,WB=209,XB=210,jB=0,YB=1,KB=2,WS=3,JB=4,ZB=5,qB=6,QB=7,vE=0,eF=1,tF=2,kl=0,nF=1,iF=2,rF=3,iM=4,sF=5,cd=300,Lu=301,ud=302,zg=303,tE=304,e_=306,Bl=1e3,Pi=1001,yp=1002,er=1003,Wg=1004,yz=1004,op=1005,Sz=1005,Dn=1006,EE=1007,$z=1007,Wa=1008,ux=1008,ia=1009,rM=1010,sM=1011,$$=1012,b$=1013,Sc=1014,Lr=1015,Jr=1016,oM=1017,aM=1018,rd=1020,oF=1021,Yr=1023,aF=1024,lF=1025,sd=1026,Sp=1027,lM=1028,cM=1029,cF=1030,uM=1031,hM=1033,uS=33776,hS=33777,dS=33778,fS=33779,hx=35840,dx=35841,fx=35842,px=35843,uF=36196,mx=37492,gx=37496,_x=37808,Tx=37809,vx=37810,Ex=37811,yx=37812,Sx=37813,$x=37814,bx=37815,Ax=37816,Cx=37817,Rx=37818,xx=37819,wx=37820,Mx=37821,pS=36492,hF=36283,Ix=36284,Ox=36285,Lx=36286,dF=2200,fF=2201,pF=2202,$p=2300,Nu=2301,mS=2302,Kf=2400,Jf=2401,nE=2402,A$=2500,dM=2501,fM=0,yE=1,bp=2,C$=3e3,Rc=3001,mF=3200,pM=3201,Td=0,gF=1,od="",vn="srgb",xo="srgb-linear",mM="display-p3",bz=0,gS=7680,Az=7681,Cz=7682,Rz=7683,xz=34055,wz=34056,Mz=5386,Iz=512,Oz=513,Lz=514,Nz=515,kz=516,Pz=517,Dz=518,_F=519,TF=512,vF=513,EF=514,yF=515,SF=516,$F=517,bF=518,AF=519,iE=35044,Bz=35048,Fz=35040,Uz=35045,Gz=35049,Hz=35041,Vz=35046,zz=35050,Wz=35042,Xz="100",Nx="300 es",XS=1035,$c=2e3,rE=2001;class Mc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const a=s.indexOf(n);a!==-1&&s.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const s=r.slice(0);for(let a=0,l=s.length;a<l;a++)s[a].call(this,e);e.target=null}}}const Fs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let IL=1234567;const ap=Math.PI/180,Xg=180/Math.PI;function ra(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Fs[i&255]+Fs[i>>8&255]+Fs[i>>16&255]+Fs[i>>24&255]+"-"+Fs[e&255]+Fs[e>>8&255]+"-"+Fs[e>>16&15|64]+Fs[e>>24&255]+"-"+Fs[n&63|128]+Fs[n>>8&255]+"-"+Fs[n>>16&255]+Fs[n>>24&255]+Fs[r&255]+Fs[r>>8&255]+Fs[r>>16&255]+Fs[r>>24&255]).toLowerCase()}function fr(i,e,n){return Math.max(e,Math.min(n,i))}function gM(i,e){return(i%e+e)%e}function jz(i,e,n,r,s){return r+(i-e)*(s-r)/(n-e)}function Yz(i,e,n){return i!==e?(n-i)/(e-i):0}function wv(i,e,n){return(1-n)*i+n*e}function Kz(i,e,n,r){return wv(i,e,1-Math.exp(-n*r))}function Jz(i,e=1){return e-Math.abs(gM(i,e*2)-e)}function Zz(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*(3-2*i))}function qz(i,e,n){return i<=e?0:i>=n?1:(i=(i-e)/(n-e),i*i*i*(i*(i*6-15)+10))}function Qz(i,e){return i+Math.floor(Math.random()*(e-i+1))}function e4(i,e){return i+Math.random()*(e-i)}function t4(i){return i*(.5-Math.random())}function n4(i){i!==void 0&&(IL=i);let e=IL+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function i4(i){return i*ap}function r4(i){return i*Xg}function kx(i){return(i&i-1)===0&&i!==0}function CF(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function jS(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function s4(i,e,n,r,s){const a=Math.cos,l=Math.sin,u=a(n/2),d=l(n/2),h=a((e+r)/2),f=l((e+r)/2),p=a((e-r)/2),m=l((e-r)/2),v=a((r-e)/2),y=l((r-e)/2);switch(s){case"XYX":i.set(u*f,d*p,d*m,u*h);break;case"YZY":i.set(d*m,u*f,d*p,u*h);break;case"ZXZ":i.set(d*p,d*m,u*f,u*h);break;case"XZX":i.set(u*f,d*y,d*v,u*h);break;case"YXY":i.set(d*v,u*f,d*y,u*h);break;case"ZYZ":i.set(d*y,d*v,u*f,u*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function ea(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function kn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const lp={DEG2RAD:ap,RAD2DEG:Xg,generateUUID:ra,clamp:fr,euclideanModulo:gM,mapLinear:jz,inverseLerp:Yz,lerp:wv,damp:Kz,pingpong:Jz,smoothstep:Zz,smootherstep:qz,randInt:Qz,randFloat:e4,randFloatSpread:t4,seededRandom:n4,degToRad:i4,radToDeg:r4,isPowerOfTwo:kx,ceilPowerOfTwo:CF,floorPowerOfTwo:jS,setQuaternionFromProperEuler:s4,normalize:kn,denormalize:ea};class mt{constructor(e=0,n=0){mt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6],this.y=s[1]*n+s[4]*r+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(fr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),s=Math.sin(n),a=this.x-e.x,l=this.y-e.y;return this.x=a*r-l*s+e.x,this.y=a*s+l*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Nn{constructor(e,n,r,s,a,l,u,d,h){Nn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,s,a,l,u,d,h)}set(e,n,r,s,a,l,u,d,h){const f=this.elements;return f[0]=e,f[1]=s,f[2]=u,f[3]=n,f[4]=a,f[5]=d,f[6]=r,f[7]=l,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,a=this.elements,l=r[0],u=r[3],d=r[6],h=r[1],f=r[4],p=r[7],m=r[2],v=r[5],y=r[8],$=s[0],E=s[3],S=s[6],A=s[1],C=s[4],x=s[7],I=s[2],O=s[5],F=s[8];return a[0]=l*$+u*A+d*I,a[3]=l*E+u*C+d*O,a[6]=l*S+u*x+d*F,a[1]=h*$+f*A+p*I,a[4]=h*E+f*C+p*O,a[7]=h*S+f*x+p*F,a[2]=m*$+v*A+y*I,a[5]=m*E+v*C+y*O,a[8]=m*S+v*x+y*F,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],u=e[5],d=e[6],h=e[7],f=e[8];return n*l*f-n*u*h-r*a*f+r*u*d+s*a*h-s*l*d}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],u=e[5],d=e[6],h=e[7],f=e[8],p=f*l-u*h,m=u*d-f*a,v=h*a-l*d,y=n*p+r*m+s*v;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const $=1/y;return e[0]=p*$,e[1]=(s*h-f*r)*$,e[2]=(u*r-s*l)*$,e[3]=m*$,e[4]=(f*n-s*d)*$,e[5]=(s*a-u*n)*$,e[6]=v*$,e[7]=(r*d-h*n)*$,e[8]=(l*n-r*a)*$,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,s,a,l,u){const d=Math.cos(a),h=Math.sin(a);return this.set(r*d,r*h,-r*(d*l+h*u)+l+e,-s*h,s*d,-s*(-h*l+d*u)+u+n,0,0,1),this}scale(e,n){return this.premultiply(nC.makeScale(e,n)),this}rotate(e){return this.premultiply(nC.makeRotation(-e)),this}translate(e,n){return this.premultiply(nC.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<9;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const nC=new Nn;function RF(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const o4={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function $g(i,e){return new o4[i](e)}function sE(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const OL={};function Mv(i){i in OL||(OL[i]=!0,console.warn(i))}function Lg(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function iC(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const a4=new Nn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),l4=new Nn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function c4(i){return i.convertSRGBToLinear().applyMatrix3(l4)}function u4(i){return i.applyMatrix3(a4).convertLinearToSRGB()}const h4={[xo]:i=>i,[vn]:i=>i.convertSRGBToLinear(),[mM]:c4},d4={[xo]:i=>i,[vn]:i=>i.convertLinearToSRGB(),[mM]:u4},La={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return xo},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,n){if(this.enabled===!1||e===n||!e||!n)return i;const r=h4[e],s=d4[n];if(r===void 0||s===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return s(r(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}};let Pm;class _M{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Pm===void 0&&(Pm=sE("canvas")),Pm.width=e.width,Pm.height=e.height;const r=Pm.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Pm}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=sE("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const s=r.getImageData(0,0,e.width,e.height),a=s.data;for(let l=0;l<a.length;l++)a[l]=Lg(a[l]/255)*255;return r.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Lg(n[r]/255)*255):n[r]=Lg(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let f4=0;class Zf{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:f4++}),this.uuid=ra(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},s=this.data;if(s!==null){let a;if(Array.isArray(s)){a=[];for(let l=0,u=s.length;l<u;l++)s[l].isDataTexture?a.push(rC(s[l].image)):a.push(rC(s[l]))}else a=rC(s);r.url=a}return n||(e.images[this.uuid]=r),r}}function rC(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?_M.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let p4=0;class ni extends Mc{constructor(e=ni.DEFAULT_IMAGE,n=ni.DEFAULT_MAPPING,r=Pi,s=Pi,a=Dn,l=Wa,u=Yr,d=ia,h=ni.DEFAULT_ANISOTROPY,f=od){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:p4++}),this.uuid=ra(),this.name="",this.source=new Zf(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=a,this.minFilter=l,this.anisotropy=h,this.format=u,this.internalFormat=null,this.type=d,this.offset=new mt(0,0),this.repeat=new mt(1,1),this.center=new mt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Nn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Mv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===Rc?vn:od),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==cd)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bl:e.x=e.x-Math.floor(e.x);break;case Pi:e.x=e.x<0?0:1;break;case yp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bl:e.y=e.y-Math.floor(e.y);break;case Pi:e.y=e.y<0?0:1;break;case yp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Mv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===vn?Rc:C$}set encoding(e){Mv("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Rc?vn:od}}ni.DEFAULT_IMAGE=null;ni.DEFAULT_MAPPING=cd;ni.DEFAULT_ANISOTROPY=1;class Hn{constructor(e=0,n=0,r=0,s=1){Hn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,s){return this.x=e,this.y=n,this.z=r,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,a=this.w,l=e.elements;return this.x=l[0]*n+l[4]*r+l[8]*s+l[12]*a,this.y=l[1]*n+l[5]*r+l[9]*s+l[13]*a,this.z=l[2]*n+l[6]*r+l[10]*s+l[14]*a,this.w=l[3]*n+l[7]*r+l[11]*s+l[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,s,a;const d=e.elements,h=d[0],f=d[4],p=d[8],m=d[1],v=d[5],y=d[9],$=d[2],E=d[6],S=d[10];if(Math.abs(f-m)<.01&&Math.abs(p-$)<.01&&Math.abs(y-E)<.01){if(Math.abs(f+m)<.1&&Math.abs(p+$)<.1&&Math.abs(y+E)<.1&&Math.abs(h+v+S-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const C=(h+1)/2,x=(v+1)/2,I=(S+1)/2,O=(f+m)/4,F=(p+$)/4,k=(y+E)/4;return C>x&&C>I?C<.01?(r=0,s=.707106781,a=.707106781):(r=Math.sqrt(C),s=O/r,a=F/r):x>I?x<.01?(r=.707106781,s=0,a=.707106781):(s=Math.sqrt(x),r=O/s,a=k/s):I<.01?(r=.707106781,s=.707106781,a=0):(a=Math.sqrt(I),r=F/a,s=k/a),this.set(r,s,a,n),this}let A=Math.sqrt((E-y)*(E-y)+(p-$)*(p-$)+(m-f)*(m-f));return Math.abs(A)<.001&&(A=1),this.x=(E-y)/A,this.y=(p-$)/A,this.z=(m-f)/A,this.w=Math.acos((h+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class lo extends Mc{constructor(e=1,n=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Hn(0,0,e,n),this.scissorTest=!1,this.viewport=new Hn(0,0,e,n);const s={width:e,height:n,depth:1};r.encoding!==void 0&&(Mv("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Rc?vn:od),this.texture=new ni(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Dn,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,n,r=1){(this.width!==e||this.height!==n||this.depth!==r)&&(this.width=e,this.height=n,this.depth=r,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Zf(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class R$ extends ni{constructor(e=null,n=1,r=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:s},this.magFilter=er,this.minFilter=er,this.wrapR=Pi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class m4 extends lo{constructor(e=1,n=1,r=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new R$(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class TM extends ni{constructor(e=null,n=1,r=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:s},this.magFilter=er,this.minFilter=er,this.wrapR=Pi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class g4 extends lo{constructor(e=1,n=1,r=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new TM(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class _4 extends lo{constructor(e=1,n=1,r=1,s={}){super(e,n,s),this.isWebGLMultipleRenderTargets=!0;const a=this.texture;this.texture=[];for(let l=0;l<r;l++)this.texture[l]=a.clone(),this.texture[l].isRenderTargetTexture=!0}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let s=0,a=this.texture.length;s<a;s++)this.texture[s].image.width=e,this.texture[s].image.height=n,this.texture[s].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,r=e.texture.length;n<r;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class Er{constructor(e=0,n=0,r=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=s}static slerpFlat(e,n,r,s,a,l,u){let d=r[s+0],h=r[s+1],f=r[s+2],p=r[s+3];const m=a[l+0],v=a[l+1],y=a[l+2],$=a[l+3];if(u===0){e[n+0]=d,e[n+1]=h,e[n+2]=f,e[n+3]=p;return}if(u===1){e[n+0]=m,e[n+1]=v,e[n+2]=y,e[n+3]=$;return}if(p!==$||d!==m||h!==v||f!==y){let E=1-u;const S=d*m+h*v+f*y+p*$,A=S>=0?1:-1,C=1-S*S;if(C>Number.EPSILON){const I=Math.sqrt(C),O=Math.atan2(I,S*A);E=Math.sin(E*O)/I,u=Math.sin(u*O)/I}const x=u*A;if(d=d*E+m*x,h=h*E+v*x,f=f*E+y*x,p=p*E+$*x,E===1-u){const I=1/Math.sqrt(d*d+h*h+f*f+p*p);d*=I,h*=I,f*=I,p*=I}}e[n]=d,e[n+1]=h,e[n+2]=f,e[n+3]=p}static multiplyQuaternionsFlat(e,n,r,s,a,l){const u=r[s],d=r[s+1],h=r[s+2],f=r[s+3],p=a[l],m=a[l+1],v=a[l+2],y=a[l+3];return e[n]=u*y+f*p+d*v-h*m,e[n+1]=d*y+f*m+h*p-u*v,e[n+2]=h*y+f*v+u*m-d*p,e[n+3]=f*y-u*p-d*m-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,s){return this._x=e,this._y=n,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const r=e._x,s=e._y,a=e._z,l=e._order,u=Math.cos,d=Math.sin,h=u(r/2),f=u(s/2),p=u(a/2),m=d(r/2),v=d(s/2),y=d(a/2);switch(l){case"XYZ":this._x=m*f*p+h*v*y,this._y=h*v*p-m*f*y,this._z=h*f*y+m*v*p,this._w=h*f*p-m*v*y;break;case"YXZ":this._x=m*f*p+h*v*y,this._y=h*v*p-m*f*y,this._z=h*f*y-m*v*p,this._w=h*f*p+m*v*y;break;case"ZXY":this._x=m*f*p-h*v*y,this._y=h*v*p+m*f*y,this._z=h*f*y+m*v*p,this._w=h*f*p-m*v*y;break;case"ZYX":this._x=m*f*p-h*v*y,this._y=h*v*p+m*f*y,this._z=h*f*y-m*v*p,this._w=h*f*p+m*v*y;break;case"YZX":this._x=m*f*p+h*v*y,this._y=h*v*p+m*f*y,this._z=h*f*y-m*v*p,this._w=h*f*p-m*v*y;break;case"XZY":this._x=m*f*p-h*v*y,this._y=h*v*p-m*f*y,this._z=h*f*y+m*v*p,this._w=h*f*p+m*v*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,s=Math.sin(r);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],s=n[4],a=n[8],l=n[1],u=n[5],d=n[9],h=n[2],f=n[6],p=n[10],m=r+u+p;if(m>0){const v=.5/Math.sqrt(m+1);this._w=.25/v,this._x=(f-d)*v,this._y=(a-h)*v,this._z=(l-s)*v}else if(r>u&&r>p){const v=2*Math.sqrt(1+r-u-p);this._w=(f-d)/v,this._x=.25*v,this._y=(s+l)/v,this._z=(a+h)/v}else if(u>p){const v=2*Math.sqrt(1+u-r-p);this._w=(a-h)/v,this._x=(s+l)/v,this._y=.25*v,this._z=(d+f)/v}else{const v=2*Math.sqrt(1+p-r-u);this._w=(l-s)/v,this._x=(a+h)/v,this._y=(d+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(fr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const s=Math.min(1,n/r);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,s=e._y,a=e._z,l=e._w,u=n._x,d=n._y,h=n._z,f=n._w;return this._x=r*f+l*u+s*h-a*d,this._y=s*f+l*d+a*u-r*h,this._z=a*f+l*h+r*d-s*u,this._w=l*f-r*u-s*d-a*h,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,s=this._y,a=this._z,l=this._w;let u=l*e._w+r*e._x+s*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=l,this._x=r,this._y=s,this._z=a,this;const d=1-u*u;if(d<=Number.EPSILON){const v=1-n;return this._w=v*l+n*this._w,this._x=v*r+n*this._x,this._y=v*s+n*this._y,this._z=v*a+n*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(d),f=Math.atan2(h,u),p=Math.sin((1-n)*f)/h,m=Math.sin(n*f)/h;return this._w=l*p+this._w*m,this._x=r*p+this._x*m,this._y=s*p+this._y*m,this._z=a*p+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=Math.random(),n=Math.sqrt(1-e),r=Math.sqrt(e),s=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(s),r*Math.sin(a),r*Math.cos(a),n*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,n=0,r=0){ie.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(LL.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(LL.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*n+a[3]*r+a[6]*s,this.y=a[1]*n+a[4]*r+a[7]*s,this.z=a[2]*n+a[5]*r+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,s=this.z,a=e.elements,l=1/(a[3]*n+a[7]*r+a[11]*s+a[15]);return this.x=(a[0]*n+a[4]*r+a[8]*s+a[12])*l,this.y=(a[1]*n+a[5]*r+a[9]*s+a[13])*l,this.z=(a[2]*n+a[6]*r+a[10]*s+a[14])*l,this}applyQuaternion(e){const n=this.x,r=this.y,s=this.z,a=e.x,l=e.y,u=e.z,d=e.w,h=d*n+l*s-u*r,f=d*r+u*n-a*s,p=d*s+a*r-l*n,m=-a*n-l*r-u*s;return this.x=h*d+m*-a+f*-u-p*-l,this.y=f*d+m*-l+p*-a-h*-u,this.z=p*d+m*-u+h*-l-f*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,s=this.z,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*s,this.y=a[1]*n+a[5]*r+a[9]*s,this.z=a[2]*n+a[6]*r+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,s=e.y,a=e.z,l=n.x,u=n.y,d=n.z;return this.x=s*d-a*u,this.y=a*l-r*d,this.z=r*u-s*l,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return sC.copy(this).projectOnVector(e),this.sub(sC)}reflect(e){return this.sub(sC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(fr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return n*n+r*r+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const s=Math.sin(n)*e;return this.x=s*Math.sin(r),this.y=Math.cos(n)*e,this.z=s*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(n),this.y=r*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const sC=new ie,LL=new Er;class zs{constructor(e=new ie(1/0,1/0,1/0),n=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(hu.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(hu.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=hu.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),Dm.copy(e.boundingBox),Dm.applyMatrix4(e.matrixWorld),this.union(Dm);else{const s=e.geometry;if(s!==void 0)if(n&&s.attributes!==void 0&&s.attributes.position!==void 0){const a=s.attributes.position;for(let l=0,u=a.count;l<u;l++)hu.fromBufferAttribute(a,l).applyMatrix4(e.matrixWorld),this.expandByPoint(hu)}else s.boundingBox===null&&s.computeBoundingBox(),Dm.copy(s.boundingBox),Dm.applyMatrix4(e.matrixWorld),this.union(Dm)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,hu),hu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(DT),Ky.subVectors(this.max,DT),Bm.subVectors(e.a,DT),Fm.subVectors(e.b,DT),Um.subVectors(e.c,DT),Ih.subVectors(Fm,Bm),Oh.subVectors(Um,Fm),Cf.subVectors(Bm,Um);let n=[0,-Ih.z,Ih.y,0,-Oh.z,Oh.y,0,-Cf.z,Cf.y,Ih.z,0,-Ih.x,Oh.z,0,-Oh.x,Cf.z,0,-Cf.x,-Ih.y,Ih.x,0,-Oh.y,Oh.x,0,-Cf.y,Cf.x,0];return!oC(n,Bm,Fm,Um,Ky)||(n=[1,0,0,0,1,0,0,0,1],!oC(n,Bm,Fm,Um,Ky))?!1:(Jy.crossVectors(Ih,Oh),n=[Jy.x,Jy.y,Jy.z],oC(n,Bm,Fm,Um,Ky))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,hu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(hu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(uu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),uu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),uu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),uu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),uu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),uu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),uu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),uu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(uu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const uu=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],hu=new ie,Dm=new zs,Bm=new ie,Fm=new ie,Um=new ie,Ih=new ie,Oh=new ie,Cf=new ie,DT=new ie,Ky=new ie,Jy=new ie,Rf=new ie;function oC(i,e,n,r,s){for(let a=0,l=i.length-3;a<=l;a+=3){Rf.fromArray(i,a);const u=s.x*Math.abs(Rf.x)+s.y*Math.abs(Rf.y)+s.z*Math.abs(Rf.z),d=e.dot(Rf),h=n.dot(Rf),f=r.dot(Rf);if(Math.max(-Math.max(d,h,f),Math.min(d,h,f))>u)return!1}return!0}const T4=new zs,BT=new ie,aC=new ie;class Ws{constructor(e=new ie,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):T4.setFromPoints(e).getCenter(r);let s=0;for(let a=0,l=e.length;a<l;a++)s=Math.max(s,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;BT.subVectors(e,this.center);const n=BT.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),s=(r-this.radius)*.5;this.center.addScaledVector(BT,s/r),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(aC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(BT.copy(e.center).add(aC)),this.expandByPoint(BT.copy(e.center).sub(aC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const du=new ie,lC=new ie,Zy=new ie,Lh=new ie,cC=new ie,qy=new ie,uC=new ie;class Op{constructor(e=new ie,n=new ie(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,du)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=du.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(du.copy(this.origin).addScaledVector(this.direction,n),du.distanceToSquared(e))}distanceSqToSegment(e,n,r,s){lC.copy(e).add(n).multiplyScalar(.5),Zy.copy(n).sub(e).normalize(),Lh.copy(this.origin).sub(lC);const a=e.distanceTo(n)*.5,l=-this.direction.dot(Zy),u=Lh.dot(this.direction),d=-Lh.dot(Zy),h=Lh.lengthSq(),f=Math.abs(1-l*l);let p,m,v,y;if(f>0)if(p=l*d-u,m=l*u-d,y=a*f,p>=0)if(m>=-y)if(m<=y){const $=1/f;p*=$,m*=$,v=p*(p+l*m+2*u)+m*(l*p+m+2*d)+h}else m=a,p=Math.max(0,-(l*m+u)),v=-p*p+m*(m+2*d)+h;else m=-a,p=Math.max(0,-(l*m+u)),v=-p*p+m*(m+2*d)+h;else m<=-y?(p=Math.max(0,-(-l*a+u)),m=p>0?-a:Math.min(Math.max(-a,-d),a),v=-p*p+m*(m+2*d)+h):m<=y?(p=0,m=Math.min(Math.max(-a,-d),a),v=m*(m+2*d)+h):(p=Math.max(0,-(l*a+u)),m=p>0?a:Math.min(Math.max(-a,-d),a),v=-p*p+m*(m+2*d)+h);else m=l>0?-a:a,p=Math.max(0,-(l*m+u)),v=-p*p+m*(m+2*d)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,p),s&&s.copy(lC).addScaledVector(Zy,m),v}intersectSphere(e,n){du.subVectors(e.center,this.origin);const r=du.dot(this.direction),s=du.dot(du)-r*r,a=e.radius*e.radius;if(s>a)return null;const l=Math.sqrt(a-s),u=r-l,d=r+l;return d<0?null:u<0?this.at(d,n):this.at(u,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,s,a,l,u,d;const h=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,m=this.origin;return h>=0?(r=(e.min.x-m.x)*h,s=(e.max.x-m.x)*h):(r=(e.max.x-m.x)*h,s=(e.min.x-m.x)*h),f>=0?(a=(e.min.y-m.y)*f,l=(e.max.y-m.y)*f):(a=(e.max.y-m.y)*f,l=(e.min.y-m.y)*f),r>l||a>s||((a>r||isNaN(r))&&(r=a),(l<s||isNaN(s))&&(s=l),p>=0?(u=(e.min.z-m.z)*p,d=(e.max.z-m.z)*p):(u=(e.max.z-m.z)*p,d=(e.min.z-m.z)*p),r>d||u>s)||((u>r||r!==r)&&(r=u),(d<s||s!==s)&&(s=d),s<0)?null:this.at(r>=0?r:s,n)}intersectsBox(e){return this.intersectBox(e,du)!==null}intersectTriangle(e,n,r,s,a){cC.subVectors(n,e),qy.subVectors(r,e),uC.crossVectors(cC,qy);let l=this.direction.dot(uC),u;if(l>0){if(s)return null;u=1}else if(l<0)u=-1,l=-l;else return null;Lh.subVectors(this.origin,e);const d=u*this.direction.dot(qy.crossVectors(Lh,qy));if(d<0)return null;const h=u*this.direction.dot(cC.cross(Lh));if(h<0||d+h>l)return null;const f=-u*Lh.dot(uC);return f<0?null:this.at(f/l,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class pn{constructor(e,n,r,s,a,l,u,d,h,f,p,m,v,y,$,E){pn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,s,a,l,u,d,h,f,p,m,v,y,$,E)}set(e,n,r,s,a,l,u,d,h,f,p,m,v,y,$,E){const S=this.elements;return S[0]=e,S[4]=n,S[8]=r,S[12]=s,S[1]=a,S[5]=l,S[9]=u,S[13]=d,S[2]=h,S[6]=f,S[10]=p,S[14]=m,S[3]=v,S[7]=y,S[11]=$,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new pn().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,s=1/Gm.setFromMatrixColumn(e,0).length(),a=1/Gm.setFromMatrixColumn(e,1).length(),l=1/Gm.setFromMatrixColumn(e,2).length();return n[0]=r[0]*s,n[1]=r[1]*s,n[2]=r[2]*s,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*l,n[9]=r[9]*l,n[10]=r[10]*l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,s=e.y,a=e.z,l=Math.cos(r),u=Math.sin(r),d=Math.cos(s),h=Math.sin(s),f=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){const m=l*f,v=l*p,y=u*f,$=u*p;n[0]=d*f,n[4]=-d*p,n[8]=h,n[1]=v+y*h,n[5]=m-$*h,n[9]=-u*d,n[2]=$-m*h,n[6]=y+v*h,n[10]=l*d}else if(e.order==="YXZ"){const m=d*f,v=d*p,y=h*f,$=h*p;n[0]=m+$*u,n[4]=y*u-v,n[8]=l*h,n[1]=l*p,n[5]=l*f,n[9]=-u,n[2]=v*u-y,n[6]=$+m*u,n[10]=l*d}else if(e.order==="ZXY"){const m=d*f,v=d*p,y=h*f,$=h*p;n[0]=m-$*u,n[4]=-l*p,n[8]=y+v*u,n[1]=v+y*u,n[5]=l*f,n[9]=$-m*u,n[2]=-l*h,n[6]=u,n[10]=l*d}else if(e.order==="ZYX"){const m=l*f,v=l*p,y=u*f,$=u*p;n[0]=d*f,n[4]=y*h-v,n[8]=m*h+$,n[1]=d*p,n[5]=$*h+m,n[9]=v*h-y,n[2]=-h,n[6]=u*d,n[10]=l*d}else if(e.order==="YZX"){const m=l*d,v=l*h,y=u*d,$=u*h;n[0]=d*f,n[4]=$-m*p,n[8]=y*p+v,n[1]=p,n[5]=l*f,n[9]=-u*f,n[2]=-h*f,n[6]=v*p+y,n[10]=m-$*p}else if(e.order==="XZY"){const m=l*d,v=l*h,y=u*d,$=u*h;n[0]=d*f,n[4]=-p,n[8]=h*f,n[1]=m*p+$,n[5]=l*f,n[9]=v*p-y,n[2]=y*p-v,n[6]=u*f,n[10]=$*p+m}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(v4,e,E4)}lookAt(e,n,r){const s=this.elements;return Jo.subVectors(e,n),Jo.lengthSq()===0&&(Jo.z=1),Jo.normalize(),Nh.crossVectors(r,Jo),Nh.lengthSq()===0&&(Math.abs(r.z)===1?Jo.x+=1e-4:Jo.z+=1e-4,Jo.normalize(),Nh.crossVectors(r,Jo)),Nh.normalize(),Qy.crossVectors(Jo,Nh),s[0]=Nh.x,s[4]=Qy.x,s[8]=Jo.x,s[1]=Nh.y,s[5]=Qy.y,s[9]=Jo.y,s[2]=Nh.z,s[6]=Qy.z,s[10]=Jo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,s=n.elements,a=this.elements,l=r[0],u=r[4],d=r[8],h=r[12],f=r[1],p=r[5],m=r[9],v=r[13],y=r[2],$=r[6],E=r[10],S=r[14],A=r[3],C=r[7],x=r[11],I=r[15],O=s[0],F=s[4],k=s[8],D=s[12],U=s[1],ce=s[5],re=s[9],ae=s[13],ne=s[2],de=s[6],ue=s[10],Re=s[14],G=s[3],Z=s[7],K=s[11],se=s[15];return a[0]=l*O+u*U+d*ne+h*G,a[4]=l*F+u*ce+d*de+h*Z,a[8]=l*k+u*re+d*ue+h*K,a[12]=l*D+u*ae+d*Re+h*se,a[1]=f*O+p*U+m*ne+v*G,a[5]=f*F+p*ce+m*de+v*Z,a[9]=f*k+p*re+m*ue+v*K,a[13]=f*D+p*ae+m*Re+v*se,a[2]=y*O+$*U+E*ne+S*G,a[6]=y*F+$*ce+E*de+S*Z,a[10]=y*k+$*re+E*ue+S*K,a[14]=y*D+$*ae+E*Re+S*se,a[3]=A*O+C*U+x*ne+I*G,a[7]=A*F+C*ce+x*de+I*Z,a[11]=A*k+C*re+x*ue+I*K,a[15]=A*D+C*ae+x*Re+I*se,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],s=e[8],a=e[12],l=e[1],u=e[5],d=e[9],h=e[13],f=e[2],p=e[6],m=e[10],v=e[14],y=e[3],$=e[7],E=e[11],S=e[15];return y*(+a*d*p-s*h*p-a*u*m+r*h*m+s*u*v-r*d*v)+$*(+n*d*v-n*h*m+a*l*m-s*l*v+s*h*f-a*d*f)+E*(+n*h*p-n*u*v-a*l*p+r*l*v+a*u*f-r*h*f)+S*(-s*u*f-n*d*p+n*u*m+s*l*p-r*l*m+r*d*f)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],u=e[5],d=e[6],h=e[7],f=e[8],p=e[9],m=e[10],v=e[11],y=e[12],$=e[13],E=e[14],S=e[15],A=p*E*h-$*m*h+$*d*v-u*E*v-p*d*S+u*m*S,C=y*m*h-f*E*h-y*d*v+l*E*v+f*d*S-l*m*S,x=f*$*h-y*p*h+y*u*v-l*$*v-f*u*S+l*p*S,I=y*p*d-f*$*d-y*u*m+l*$*m+f*u*E-l*p*E,O=n*A+r*C+s*x+a*I;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/O;return e[0]=A*F,e[1]=($*m*a-p*E*a-$*s*v+r*E*v+p*s*S-r*m*S)*F,e[2]=(u*E*a-$*d*a+$*s*h-r*E*h-u*s*S+r*d*S)*F,e[3]=(p*d*a-u*m*a-p*s*h+r*m*h+u*s*v-r*d*v)*F,e[4]=C*F,e[5]=(f*E*a-y*m*a+y*s*v-n*E*v-f*s*S+n*m*S)*F,e[6]=(y*d*a-l*E*a-y*s*h+n*E*h+l*s*S-n*d*S)*F,e[7]=(l*m*a-f*d*a+f*s*h-n*m*h-l*s*v+n*d*v)*F,e[8]=x*F,e[9]=(y*p*a-f*$*a-y*r*v+n*$*v+f*r*S-n*p*S)*F,e[10]=(l*$*a-y*u*a+y*r*h-n*$*h-l*r*S+n*u*S)*F,e[11]=(f*u*a-l*p*a-f*r*h+n*p*h+l*r*v-n*u*v)*F,e[12]=I*F,e[13]=(f*$*s-y*p*s+y*r*m-n*$*m-f*r*E+n*p*E)*F,e[14]=(y*u*s-l*$*s-y*r*d+n*$*d+l*r*E-n*u*E)*F,e[15]=(l*p*s-f*u*s+f*r*d-n*p*d-l*r*m+n*u*m)*F,this}scale(e){const n=this.elements,r=e.x,s=e.y,a=e.z;return n[0]*=r,n[4]*=s,n[8]*=a,n[1]*=r,n[5]*=s,n[9]*=a,n[2]*=r,n[6]*=s,n[10]*=a,n[3]*=r,n[7]*=s,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,s))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),s=Math.sin(n),a=1-r,l=e.x,u=e.y,d=e.z,h=a*l,f=a*u;return this.set(h*l+r,h*u-s*d,h*d+s*u,0,h*u+s*d,f*u+r,f*d-s*l,0,h*d-s*u,f*d+s*l,a*d*d+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,s,a,l){return this.set(1,r,a,0,e,1,l,0,n,s,1,0,0,0,0,1),this}compose(e,n,r){const s=this.elements,a=n._x,l=n._y,u=n._z,d=n._w,h=a+a,f=l+l,p=u+u,m=a*h,v=a*f,y=a*p,$=l*f,E=l*p,S=u*p,A=d*h,C=d*f,x=d*p,I=r.x,O=r.y,F=r.z;return s[0]=(1-($+S))*I,s[1]=(v+x)*I,s[2]=(y-C)*I,s[3]=0,s[4]=(v-x)*O,s[5]=(1-(m+S))*O,s[6]=(E+A)*O,s[7]=0,s[8]=(y+C)*F,s[9]=(E-A)*F,s[10]=(1-(m+$))*F,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,r){const s=this.elements;let a=Gm.set(s[0],s[1],s[2]).length();const l=Gm.set(s[4],s[5],s[6]).length(),u=Gm.set(s[8],s[9],s[10]).length();this.determinant()<0&&(a=-a),e.x=s[12],e.y=s[13],e.z=s[14],$l.copy(this);const h=1/a,f=1/l,p=1/u;return $l.elements[0]*=h,$l.elements[1]*=h,$l.elements[2]*=h,$l.elements[4]*=f,$l.elements[5]*=f,$l.elements[6]*=f,$l.elements[8]*=p,$l.elements[9]*=p,$l.elements[10]*=p,n.setFromRotationMatrix($l),r.x=a,r.y=l,r.z=u,this}makePerspective(e,n,r,s,a,l,u=$c){const d=this.elements,h=2*a/(n-e),f=2*a/(r-s),p=(n+e)/(n-e),m=(r+s)/(r-s);let v,y;if(u===$c)v=-(l+a)/(l-a),y=-2*l*a/(l-a);else if(u===rE)v=-l/(l-a),y=-l*a/(l-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return d[0]=h,d[4]=0,d[8]=p,d[12]=0,d[1]=0,d[5]=f,d[9]=m,d[13]=0,d[2]=0,d[6]=0,d[10]=v,d[14]=y,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,n,r,s,a,l,u=$c){const d=this.elements,h=1/(n-e),f=1/(r-s),p=1/(l-a),m=(n+e)*h,v=(r+s)*f;let y,$;if(u===$c)y=(l+a)*p,$=-2*p;else if(u===rE)y=a*p,$=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return d[0]=2*h,d[4]=0,d[8]=0,d[12]=-m,d[1]=0,d[5]=2*f,d[9]=0,d[13]=-v,d[2]=0,d[6]=0,d[10]=$,d[14]=-y,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let s=0;s<16;s++)if(n[s]!==r[s])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const Gm=new ie,$l=new pn,v4=new ie(0,0,0),E4=new ie(1,1,1),Nh=new ie,Qy=new ie,Jo=new ie,NL=new pn,kL=new Er;class SE{constructor(e=0,n=0,r=0,s=SE.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,s=this._order){return this._x=e,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const s=e.elements,a=s[0],l=s[4],u=s[8],d=s[1],h=s[5],f=s[9],p=s[2],m=s[6],v=s[10];switch(n){case"XYZ":this._y=Math.asin(fr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-fr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,v),this._z=Math.atan2(d,h)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(fr(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-l,h)):(this._y=0,this._z=Math.atan2(d,a));break;case"ZYX":this._y=Math.asin(-fr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,v),this._z=Math.atan2(d,a)):(this._x=0,this._z=Math.atan2(-l,h));break;case"YZX":this._z=Math.asin(fr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(u,v));break;case"XZY":this._z=Math.asin(-fr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return NL.makeRotationFromQuaternion(e),this.setFromRotationMatrix(NL,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return kL.setFromEuler(this),this.setFromQuaternion(kL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}SE.DEFAULT_ORDER="XYZ";class cp{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let y4=0;const PL=new ie,Hm=new Er,fu=new pn,e0=new ie,FT=new ie,S4=new ie,$4=new Er,DL=new ie(1,0,0),BL=new ie(0,1,0),FL=new ie(0,0,1),b4={type:"added"},UL={type:"removed"};class Xn extends Mc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:y4++}),this.uuid=ra(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xn.DEFAULT_UP.clone();const e=new ie,n=new SE,r=new Er,s=new ie(1,1,1);function a(){r.setFromEuler(n,!1)}function l(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new pn},normalMatrix:{value:new Nn}}),this.matrix=new pn,this.matrixWorld=new pn,this.matrixAutoUpdate=Xn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new cp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Hm.setFromAxisAngle(e,n),this.quaternion.multiply(Hm),this}rotateOnWorldAxis(e,n){return Hm.setFromAxisAngle(e,n),this.quaternion.premultiply(Hm),this}rotateX(e){return this.rotateOnAxis(DL,e)}rotateY(e){return this.rotateOnAxis(BL,e)}rotateZ(e){return this.rotateOnAxis(FL,e)}translateOnAxis(e,n){return PL.copy(e).applyQuaternion(this.quaternion),this.position.add(PL.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(DL,e)}translateY(e){return this.translateOnAxis(BL,e)}translateZ(e){return this.translateOnAxis(FL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fu.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?e0.copy(e):e0.set(e,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),FT.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fu.lookAt(FT,e0,this.up):fu.lookAt(e0,FT,this.up),this.quaternion.setFromRotationMatrix(fu),s&&(fu.extractRotation(s.matrixWorld),Hm.setFromRotationMatrix(fu),this.quaternion.premultiply(Hm.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(b4)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(UL)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(UL)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),fu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fu.multiply(e.parent.matrixWorld)),e.applyMatrix4(fu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const l=this.children[r].getObjectByProperty(e,n);if(l!==void 0)return l}}getObjectsByProperty(e,n){let r=[];this[e]===n&&r.push(this);for(let s=0,a=this.children.length;s<a;s++){const l=this.children[s].getObjectsByProperty(e,n);l.length>0&&(r=r.concat(l))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FT,e,S4),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(FT,$4,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const a=n[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const s=this.children;for(let a=0,l=s.length;a<l;a++){const u=s[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function a(u,d){return u[d.uuid]===void 0&&(u[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=a(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const d=u.shapes;if(Array.isArray(d))for(let h=0,f=d.length;h<f;h++){const p=d[h];a(e.shapes,p)}else a(e.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let d=0,h=this.material.length;d<h;d++)u.push(a(e.materials,this.material[d]));s.material=u}else s.material=a(e.materials,this.material);if(this.children.length>0){s.children=[];for(let u=0;u<this.children.length;u++)s.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let u=0;u<this.animations.length;u++){const d=this.animations[u];s.animations.push(a(e.animations,d))}}if(n){const u=l(e.geometries),d=l(e.materials),h=l(e.textures),f=l(e.images),p=l(e.shapes),m=l(e.skeletons),v=l(e.animations),y=l(e.nodes);u.length>0&&(r.geometries=u),d.length>0&&(r.materials=d),h.length>0&&(r.textures=h),f.length>0&&(r.images=f),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),v.length>0&&(r.animations=v),y.length>0&&(r.nodes=y)}return r.object=s,r;function l(u){const d=[];for(const h in u){const f=u[h];delete f.metadata,d.push(f)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const s=e.children[r];this.add(s.clone())}return this}}Xn.DEFAULT_UP=new ie(0,1,0);Xn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const bl=new ie,pu=new ie,hC=new ie,mu=new ie,Vm=new ie,zm=new ie,GL=new ie,dC=new ie,fC=new ie,pC=new ie;let t0=!1;class $o{constructor(e=new ie,n=new ie,r=new ie){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,s){s.subVectors(r,n),bl.subVectors(e,n),s.cross(bl);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,n,r,s,a){bl.subVectors(s,n),pu.subVectors(r,n),hC.subVectors(e,n);const l=bl.dot(bl),u=bl.dot(pu),d=bl.dot(hC),h=pu.dot(pu),f=pu.dot(hC),p=l*h-u*u;if(p===0)return a.set(-2,-1,-1);const m=1/p,v=(h*d-u*f)*m,y=(l*f-u*d)*m;return a.set(1-v-y,y,v)}static containsPoint(e,n,r,s){return this.getBarycoord(e,n,r,s,mu),mu.x>=0&&mu.y>=0&&mu.x+mu.y<=1}static getUV(e,n,r,s,a,l,u,d){return t0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),t0=!0),this.getInterpolation(e,n,r,s,a,l,u,d)}static getInterpolation(e,n,r,s,a,l,u,d){return this.getBarycoord(e,n,r,s,mu),d.setScalar(0),d.addScaledVector(a,mu.x),d.addScaledVector(l,mu.y),d.addScaledVector(u,mu.z),d}static isFrontFacing(e,n,r,s){return bl.subVectors(r,n),pu.subVectors(e,n),bl.cross(pu).dot(s)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,s){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,r,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return bl.subVectors(this.c,this.b),pu.subVectors(this.a,this.b),bl.cross(pu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $o.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return $o.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,r,s,a){return t0===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),t0=!0),$o.getInterpolation(e,this.a,this.b,this.c,n,r,s,a)}getInterpolation(e,n,r,s,a){return $o.getInterpolation(e,this.a,this.b,this.c,n,r,s,a)}containsPoint(e){return $o.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $o.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,s=this.b,a=this.c;let l,u;Vm.subVectors(s,r),zm.subVectors(a,r),dC.subVectors(e,r);const d=Vm.dot(dC),h=zm.dot(dC);if(d<=0&&h<=0)return n.copy(r);fC.subVectors(e,s);const f=Vm.dot(fC),p=zm.dot(fC);if(f>=0&&p<=f)return n.copy(s);const m=d*p-f*h;if(m<=0&&d>=0&&f<=0)return l=d/(d-f),n.copy(r).addScaledVector(Vm,l);pC.subVectors(e,a);const v=Vm.dot(pC),y=zm.dot(pC);if(y>=0&&v<=y)return n.copy(a);const $=v*h-d*y;if($<=0&&h>=0&&y<=0)return u=h/(h-y),n.copy(r).addScaledVector(zm,u);const E=f*y-v*p;if(E<=0&&p-f>=0&&v-y>=0)return GL.subVectors(a,s),u=(p-f)/(p-f+(v-y)),n.copy(s).addScaledVector(GL,u);const S=1/(E+$+m);return l=$*S,u=m*S,n.copy(r).addScaledVector(Vm,l).addScaledVector(zm,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let A4=0;class ir extends Mc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:A4++}),this.uuid=ra(),this.name="",this.type="Material",this.blending=sp,this.side=za,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=tM,this.blendDst=nM,this.blendEquation=Vf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=WS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_F,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gS,this.stencilZFail=gS,this.stencilZPass=gS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==sp&&(r.blending=this.blending),this.side!==za&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function s(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}if(n){const a=s(e.textures),l=s(e.images);a.length>0&&(r.textures=a),l.length>0&&(r.images=l)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const s=n.length;r=new Array(s);for(let a=0;a!==s;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const xF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Al={h:0,s:0,l:0},n0={h:0,s:0,l:0};function mC(i,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?i+(e-i)*6*n:n<1/2?e:n<2/3?i+(e-i)*6*(2/3-n):i}class xt{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=vn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,La.toWorkingColorSpace(this,n),this}setRGB(e,n,r,s=La.workingColorSpace){return this.r=e,this.g=n,this.b=r,La.toWorkingColorSpace(this,s),this}setHSL(e,n,r,s=La.workingColorSpace){if(e=gM(e,1),n=fr(n,0,1),r=fr(r,0,1),n===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,l=2*r-a;this.r=mC(l,a,e+1/3),this.g=mC(l,a,e),this.b=mC(l,a,e-1/3)}return La.toWorkingColorSpace(this,s),this}setStyle(e,n=vn){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const l=s[1],u=s[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(l===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=vn){const r=xF[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Lg(e.r),this.g=Lg(e.g),this.b=Lg(e.b),this}copyLinearToSRGB(e){return this.r=iC(e.r),this.g=iC(e.g),this.b=iC(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vn){return La.fromWorkingColorSpace(Us.copy(this),e),Math.round(fr(Us.r*255,0,255))*65536+Math.round(fr(Us.g*255,0,255))*256+Math.round(fr(Us.b*255,0,255))}getHexString(e=vn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=La.workingColorSpace){La.fromWorkingColorSpace(Us.copy(this),n);const r=Us.r,s=Us.g,a=Us.b,l=Math.max(r,s,a),u=Math.min(r,s,a);let d,h;const f=(u+l)/2;if(u===l)d=0,h=0;else{const p=l-u;switch(h=f<=.5?p/(l+u):p/(2-l-u),l){case r:d=(s-a)/p+(s<a?6:0);break;case s:d=(a-r)/p+2;break;case a:d=(r-s)/p+4;break}d/=6}return e.h=d,e.s=h,e.l=f,e}getRGB(e,n=La.workingColorSpace){return La.fromWorkingColorSpace(Us.copy(this),n),e.r=Us.r,e.g=Us.g,e.b=Us.b,e}getStyle(e=vn){La.fromWorkingColorSpace(Us.copy(this),e);const n=Us.r,r=Us.g,s=Us.b;return e!==vn?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(s*255)})`}offsetHSL(e,n,r){return this.getHSL(Al),Al.h+=e,Al.s+=n,Al.l+=r,this.setHSL(Al.h,Al.s,Al.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Al),e.getHSL(n0);const r=wv(Al.h,n0.h,n),s=wv(Al.s,n0.s,n),a=wv(Al.l,n0.l,n);return this.setHSL(r,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,s=this.b,a=e.elements;return this.r=a[0]*n+a[3]*r+a[6]*s,this.g=a[1]*n+a[4]*r+a[7]*s,this.b=a[2]*n+a[5]*r+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Us=new xt;xt.NAMES=xF;class oi extends ir{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Su=C4();function C4(){const i=new ArrayBuffer(4),e=new Float32Array(i),n=new Uint32Array(i),r=new Uint32Array(512),s=new Uint32Array(512);for(let d=0;d<256;++d){const h=d-127;h<-27?(r[d]=0,r[d|256]=32768,s[d]=24,s[d|256]=24):h<-14?(r[d]=1024>>-h-14,r[d|256]=1024>>-h-14|32768,s[d]=-h-1,s[d|256]=-h-1):h<=15?(r[d]=h+15<<10,r[d|256]=h+15<<10|32768,s[d]=13,s[d|256]=13):h<128?(r[d]=31744,r[d|256]=64512,s[d]=24,s[d|256]=24):(r[d]=31744,r[d|256]=64512,s[d]=13,s[d|256]=13)}const a=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64);for(let d=1;d<1024;++d){let h=d<<13,f=0;for(;!(h&8388608);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,a[d]=h|f}for(let d=1024;d<2048;++d)a[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)l[d]=d<<23;l[31]=1199570944,l[32]=2147483648;for(let d=33;d<63;++d)l[d]=2147483648+(d-32<<23);l[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(u[d]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:s,mantissaTable:a,exponentTable:l,offsetTable:u}}function yo(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=fr(i,-65504,65504),Su.floatView[0]=i;const e=Su.uint32View[0],n=e>>23&511;return Su.baseTable[n]+((e&8388607)>>Su.shiftTable[n])}function _v(i){const e=i>>10;return Su.uint32View[0]=Su.mantissaTable[Su.offsetTable[e]+(i&1023)]+Su.exponentTable[e],Su.floatView[0]}const qf={toHalfFloat:yo,fromHalfFloat:_v},Ir=new ie,i0=new mt;class Qn{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=iE,this.updateRange={offset:0,count:-1},this.gpuType=Lr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=n.array[r+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)i0.fromBufferAttribute(this,n),i0.applyMatrix3(e),this.setXY(n,i0.x,i0.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Ir.fromBufferAttribute(this,n),Ir.applyMatrix3(e),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Ir.fromBufferAttribute(this,n),Ir.applyMatrix4(e),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Ir.fromBufferAttribute(this,n),Ir.applyNormalMatrix(e),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Ir.fromBufferAttribute(this,n),Ir.transformDirection(e),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ea(n,this.array)),n}setX(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ea(n,this.array)),n}setY(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ea(n,this.array)),n}setZ(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ea(n,this.array)),n}setW(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,s){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this}setXYZW(e,n,r,s,a){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array),a=kn(a,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==iE&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class R4 extends Qn{constructor(e,n,r){super(new Int8Array(e),n,r)}}class x4 extends Qn{constructor(e,n,r){super(new Uint8Array(e),n,r)}}class w4 extends Qn{constructor(e,n,r){super(new Uint8ClampedArray(e),n,r)}}class M4 extends Qn{constructor(e,n,r){super(new Int16Array(e),n,r)}}class vM extends Qn{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class I4 extends Qn{constructor(e,n,r){super(new Int32Array(e),n,r)}}class EM extends Qn{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class O4 extends Qn{constructor(e,n,r){super(new Uint16Array(e),n,r),this.isFloat16BufferAttribute=!0}getX(e){let n=_v(this.array[e*this.itemSize]);return this.normalized&&(n=ea(n,this.array)),n}setX(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize]=yo(n),this}getY(e){let n=_v(this.array[e*this.itemSize+1]);return this.normalized&&(n=ea(n,this.array)),n}setY(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+1]=yo(n),this}getZ(e){let n=_v(this.array[e*this.itemSize+2]);return this.normalized&&(n=ea(n,this.array)),n}setZ(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+2]=yo(n),this}getW(e){let n=_v(this.array[e*this.itemSize+3]);return this.normalized&&(n=ea(n,this.array)),n}setW(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+3]=yo(n),this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array)),this.array[e+0]=yo(n),this.array[e+1]=yo(r),this}setXYZ(e,n,r,s){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array)),this.array[e+0]=yo(n),this.array[e+1]=yo(r),this.array[e+2]=yo(s),this}setXYZW(e,n,r,s,a){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array),a=kn(a,this.array)),this.array[e+0]=yo(n),this.array[e+1]=yo(r),this.array[e+2]=yo(s),this.array[e+3]=yo(a),this}}class Yt extends Qn{constructor(e,n,r){super(new Float32Array(e),n,r)}}class L4 extends Qn{constructor(e,n,r){super(new Float64Array(e),n,r)}}let N4=0;const Oa=new pn,gC=new Xn,Wm=new ie,Zo=new zs,UT=new zs,ss=new ie;class on extends Mc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:N4++}),this.uuid=ra(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(RF(e)?EM:vM)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new Nn().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Oa.makeRotationFromQuaternion(e),this.applyMatrix4(Oa),this}rotateX(e){return Oa.makeRotationX(e),this.applyMatrix4(Oa),this}rotateY(e){return Oa.makeRotationY(e),this.applyMatrix4(Oa),this}rotateZ(e){return Oa.makeRotationZ(e),this.applyMatrix4(Oa),this}translate(e,n,r){return Oa.makeTranslation(e,n,r),this.applyMatrix4(Oa),this}scale(e,n,r){return Oa.makeScale(e,n,r),this.applyMatrix4(Oa),this}lookAt(e){return gC.lookAt(e),gC.updateMatrix(),this.applyMatrix4(gC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wm).negate(),this.translate(Wm.x,Wm.y,Wm.z),this}setFromPoints(e){const n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Yt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new zs);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,s=n.length;r<s;r++){const a=n[r];Zo.setFromBufferAttribute(a),this.morphTargetsRelative?(ss.addVectors(this.boundingBox.min,Zo.min),this.boundingBox.expandByPoint(ss),ss.addVectors(this.boundingBox.max,Zo.max),this.boundingBox.expandByPoint(ss)):(this.boundingBox.expandByPoint(Zo.min),this.boundingBox.expandByPoint(Zo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ws);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ie,1/0);return}if(e){const r=this.boundingSphere.center;if(Zo.setFromBufferAttribute(e),n)for(let a=0,l=n.length;a<l;a++){const u=n[a];UT.setFromBufferAttribute(u),this.morphTargetsRelative?(ss.addVectors(Zo.min,UT.min),Zo.expandByPoint(ss),ss.addVectors(Zo.max,UT.max),Zo.expandByPoint(ss)):(Zo.expandByPoint(UT.min),Zo.expandByPoint(UT.max))}Zo.getCenter(r);let s=0;for(let a=0,l=e.count;a<l;a++)ss.fromBufferAttribute(e,a),s=Math.max(s,r.distanceToSquared(ss));if(n)for(let a=0,l=n.length;a<l;a++){const u=n[a],d=this.morphTargetsRelative;for(let h=0,f=u.count;h<f;h++)ss.fromBufferAttribute(u,h),d&&(Wm.fromBufferAttribute(e,h),ss.add(Wm)),s=Math.max(s,r.distanceToSquared(ss))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,s=n.position.array,a=n.normal.array,l=n.uv.array,u=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Qn(new Float32Array(4*u),4));const d=this.getAttribute("tangent").array,h=[],f=[];for(let U=0;U<u;U++)h[U]=new ie,f[U]=new ie;const p=new ie,m=new ie,v=new ie,y=new mt,$=new mt,E=new mt,S=new ie,A=new ie;function C(U,ce,re){p.fromArray(s,U*3),m.fromArray(s,ce*3),v.fromArray(s,re*3),y.fromArray(l,U*2),$.fromArray(l,ce*2),E.fromArray(l,re*2),m.sub(p),v.sub(p),$.sub(y),E.sub(y);const ae=1/($.x*E.y-E.x*$.y);isFinite(ae)&&(S.copy(m).multiplyScalar(E.y).addScaledVector(v,-$.y).multiplyScalar(ae),A.copy(v).multiplyScalar($.x).addScaledVector(m,-E.x).multiplyScalar(ae),h[U].add(S),h[ce].add(S),h[re].add(S),f[U].add(A),f[ce].add(A),f[re].add(A))}let x=this.groups;x.length===0&&(x=[{start:0,count:r.length}]);for(let U=0,ce=x.length;U<ce;++U){const re=x[U],ae=re.start,ne=re.count;for(let de=ae,ue=ae+ne;de<ue;de+=3)C(r[de+0],r[de+1],r[de+2])}const I=new ie,O=new ie,F=new ie,k=new ie;function D(U){F.fromArray(a,U*3),k.copy(F);const ce=h[U];I.copy(ce),I.sub(F.multiplyScalar(F.dot(ce))).normalize(),O.crossVectors(k,ce);const ae=O.dot(f[U])<0?-1:1;d[U*4]=I.x,d[U*4+1]=I.y,d[U*4+2]=I.z,d[U*4+3]=ae}for(let U=0,ce=x.length;U<ce;++U){const re=x[U],ae=re.start,ne=re.count;for(let de=ae,ue=ae+ne;de<ue;de+=3)D(r[de+0]),D(r[de+1]),D(r[de+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Qn(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let m=0,v=r.count;m<v;m++)r.setXYZ(m,0,0,0);const s=new ie,a=new ie,l=new ie,u=new ie,d=new ie,h=new ie,f=new ie,p=new ie;if(e)for(let m=0,v=e.count;m<v;m+=3){const y=e.getX(m+0),$=e.getX(m+1),E=e.getX(m+2);s.fromBufferAttribute(n,y),a.fromBufferAttribute(n,$),l.fromBufferAttribute(n,E),f.subVectors(l,a),p.subVectors(s,a),f.cross(p),u.fromBufferAttribute(r,y),d.fromBufferAttribute(r,$),h.fromBufferAttribute(r,E),u.add(f),d.add(f),h.add(f),r.setXYZ(y,u.x,u.y,u.z),r.setXYZ($,d.x,d.y,d.z),r.setXYZ(E,h.x,h.y,h.z)}else for(let m=0,v=n.count;m<v;m+=3)s.fromBufferAttribute(n,m+0),a.fromBufferAttribute(n,m+1),l.fromBufferAttribute(n,m+2),f.subVectors(l,a),p.subVectors(s,a),f.cross(p),r.setXYZ(m+0,f.x,f.y,f.z),r.setXYZ(m+1,f.x,f.y,f.z),r.setXYZ(m+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)ss.fromBufferAttribute(e,n),ss.normalize(),e.setXYZ(n,ss.x,ss.y,ss.z)}toNonIndexed(){function e(u,d){const h=u.array,f=u.itemSize,p=u.normalized,m=new h.constructor(d.length*f);let v=0,y=0;for(let $=0,E=d.length;$<E;$++){u.isInterleavedBufferAttribute?v=d[$]*u.data.stride+u.offset:v=d[$]*f;for(let S=0;S<f;S++)m[y++]=h[v++]}return new Qn(m,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new on,r=this.index.array,s=this.attributes;for(const u in s){const d=s[u],h=e(d,r);n.setAttribute(u,h)}const a=this.morphAttributes;for(const u in a){const d=[],h=a[u];for(let f=0,p=h.length;f<p;f++){const m=h[f],v=e(m,r);d.push(v)}n.morphAttributes[u]=d}n.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,d=l.length;u<d;u++){const h=l[u];n.addGroup(h.start,h.count,h.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const h in d)d[h]!==void 0&&(e[h]=d[h]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const d in r){const h=r[d];e.data.attributes[d]=h.toJSON(e.data)}const s={};let a=!1;for(const d in this.morphAttributes){const h=this.morphAttributes[d],f=[];for(let p=0,m=h.length;p<m;p++){const v=h[p];f.push(v.toJSON(e.data))}f.length>0&&(s[d]=f,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const s=e.attributes;for(const h in s){const f=s[h];this.setAttribute(h,f.clone(n))}const a=e.morphAttributes;for(const h in a){const f=[],p=a[h];for(let m=0,v=p.length;m<v;m++)f.push(p[m].clone(n));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let h=0,f=l.length;h<f;h++){const p=l[h];this.addGroup(p.start,p.count,p.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const HL=new pn,xf=new Op,r0=new Ws,VL=new ie,Xm=new ie,jm=new ie,Ym=new ie,_C=new ie,s0=new ie,o0=new mt,a0=new mt,l0=new mt,zL=new ie,WL=new ie,XL=new ie,c0=new ie,u0=new ie;class Bn extends Xn{constructor(e=new on,n=new oi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=s.length;a<l;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,n){const r=this.geometry,s=r.attributes.position,a=r.morphAttributes.position,l=r.morphTargetsRelative;n.fromBufferAttribute(s,e);const u=this.morphTargetInfluences;if(a&&u){s0.set(0,0,0);for(let d=0,h=a.length;d<h;d++){const f=u[d],p=a[d];f!==0&&(_C.fromBufferAttribute(p,e),l?s0.addScaledVector(_C,f):s0.addScaledVector(_C.sub(n),f))}n.add(s0)}return n}raycast(e,n){const r=this.geometry,s=this.material,a=this.matrixWorld;s!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),r0.copy(r.boundingSphere),r0.applyMatrix4(a),xf.copy(e.ray).recast(e.near),!(r0.containsPoint(xf.origin)===!1&&(xf.intersectSphere(r0,VL)===null||xf.origin.distanceToSquared(VL)>(e.far-e.near)**2))&&(HL.copy(a).invert(),xf.copy(e.ray).applyMatrix4(HL),!(r.boundingBox!==null&&xf.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,xf)))}_computeIntersections(e,n,r){let s;const a=this.geometry,l=this.material,u=a.index,d=a.attributes.position,h=a.attributes.uv,f=a.attributes.uv1,p=a.attributes.normal,m=a.groups,v=a.drawRange;if(u!==null)if(Array.isArray(l))for(let y=0,$=m.length;y<$;y++){const E=m[y],S=l[E.materialIndex],A=Math.max(E.start,v.start),C=Math.min(u.count,Math.min(E.start+E.count,v.start+v.count));for(let x=A,I=C;x<I;x+=3){const O=u.getX(x),F=u.getX(x+1),k=u.getX(x+2);s=h0(this,S,e,r,h,f,p,O,F,k),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=E.materialIndex,n.push(s))}}else{const y=Math.max(0,v.start),$=Math.min(u.count,v.start+v.count);for(let E=y,S=$;E<S;E+=3){const A=u.getX(E),C=u.getX(E+1),x=u.getX(E+2);s=h0(this,l,e,r,h,f,p,A,C,x),s&&(s.faceIndex=Math.floor(E/3),n.push(s))}}else if(d!==void 0)if(Array.isArray(l))for(let y=0,$=m.length;y<$;y++){const E=m[y],S=l[E.materialIndex],A=Math.max(E.start,v.start),C=Math.min(d.count,Math.min(E.start+E.count,v.start+v.count));for(let x=A,I=C;x<I;x+=3){const O=x,F=x+1,k=x+2;s=h0(this,S,e,r,h,f,p,O,F,k),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=E.materialIndex,n.push(s))}}else{const y=Math.max(0,v.start),$=Math.min(d.count,v.start+v.count);for(let E=y,S=$;E<S;E+=3){const A=E,C=E+1,x=E+2;s=h0(this,l,e,r,h,f,p,A,C,x),s&&(s.faceIndex=Math.floor(E/3),n.push(s))}}}}function k4(i,e,n,r,s,a,l,u){let d;if(e.side===Hs?d=r.intersectTriangle(l,a,s,!0,u):d=r.intersectTriangle(s,a,l,e.side===za,u),d===null)return null;u0.copy(u),u0.applyMatrix4(i.matrixWorld);const h=n.ray.origin.distanceTo(u0);return h<n.near||h>n.far?null:{distance:h,point:u0.clone(),object:i}}function h0(i,e,n,r,s,a,l,u,d,h){i.getVertexPosition(u,Xm),i.getVertexPosition(d,jm),i.getVertexPosition(h,Ym);const f=k4(i,e,n,r,Xm,jm,Ym,c0);if(f){s&&(o0.fromBufferAttribute(s,u),a0.fromBufferAttribute(s,d),l0.fromBufferAttribute(s,h),f.uv=$o.getInterpolation(c0,Xm,jm,Ym,o0,a0,l0,new mt)),a&&(o0.fromBufferAttribute(a,u),a0.fromBufferAttribute(a,d),l0.fromBufferAttribute(a,h),f.uv1=$o.getInterpolation(c0,Xm,jm,Ym,o0,a0,l0,new mt),f.uv2=f.uv1),l&&(zL.fromBufferAttribute(l,u),WL.fromBufferAttribute(l,d),XL.fromBufferAttribute(l,h),f.normal=$o.getInterpolation(c0,Xm,jm,Ym,zL,WL,XL,new ie),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));const p={a:u,b:d,c:h,normal:new ie,materialIndex:0};$o.getNormal(Xm,jm,Ym,p.normal),f.face=p}return f}class vd extends on{constructor(e=1,n=1,r=1,s=1,a=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:s,heightSegments:a,depthSegments:l};const u=this;s=Math.floor(s),a=Math.floor(a),l=Math.floor(l);const d=[],h=[],f=[],p=[];let m=0,v=0;y("z","y","x",-1,-1,r,n,e,l,a,0),y("z","y","x",1,-1,r,n,-e,l,a,1),y("x","z","y",1,1,e,r,n,s,l,2),y("x","z","y",1,-1,e,r,-n,s,l,3),y("x","y","z",1,-1,e,n,r,s,a,4),y("x","y","z",-1,-1,e,n,-r,s,a,5),this.setIndex(d),this.setAttribute("position",new Yt(h,3)),this.setAttribute("normal",new Yt(f,3)),this.setAttribute("uv",new Yt(p,2));function y($,E,S,A,C,x,I,O,F,k,D){const U=x/F,ce=I/k,re=x/2,ae=I/2,ne=O/2,de=F+1,ue=k+1;let Re=0,G=0;const Z=new ie;for(let K=0;K<ue;K++){const se=K*ce-ae;for(let Y=0;Y<de;Y++){const me=Y*U-re;Z[$]=me*A,Z[E]=se*C,Z[S]=ne,h.push(Z.x,Z.y,Z.z),Z[$]=0,Z[E]=0,Z[S]=O>0?1:-1,f.push(Z.x,Z.y,Z.z),p.push(Y/F),p.push(1-K/k),Re+=1}}for(let K=0;K<k;K++)for(let se=0;se<F;se++){const Y=m+se+de*K,me=m+se+de*(K+1),fe=m+(se+1)+de*(K+1),Ae=m+(se+1)+de*K;d.push(Y,me,Ae),d.push(me,fe,Ae),G+=6}u.addGroup(v,G,D),v+=G,m+=Re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function jg(i){const e={};for(const n in i){e[n]={};for(const r in i[n]){const s=i[n][r];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=s.clone():Array.isArray(s)?e[n][r]=s.slice():e[n][r]=s}}return e}function ro(i){const e={};for(let n=0;n<i.length;n++){const r=jg(i[n]);for(const s in r)e[s]=r[s]}return e}function P4(i){const e=[];for(let n=0;n<i.length;n++)e.push(i[n].clone());return e}function wF(i){return i.getRenderTarget()===null?i.outputColorSpace:xo}const oE={clone:jg,merge:ro};var D4=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,B4=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class wo extends ir{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=D4,this.fragmentShader=B4,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=jg(e.uniforms),this.uniformsGroups=P4(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const s in this.uniforms){const l=this.uniforms[s].value;l&&l.isTexture?n.uniforms[s]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?n.uniforms[s]={type:"c",value:l.getHex()}:l&&l.isVector2?n.uniforms[s]={type:"v2",value:l.toArray()}:l&&l.isVector3?n.uniforms[s]={type:"v3",value:l.toArray()}:l&&l.isVector4?n.uniforms[s]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?n.uniforms[s]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?n.uniforms[s]={type:"m4",value:l.toArray()}:n.uniforms[s]={value:l}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const s in this.extensions)this.extensions[s]===!0&&(r[s]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class $E extends Xn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new pn,this.projectionMatrix=new pn,this.projectionMatrixInverse=new pn,this.coordinateSystem=$c}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let Gi=class extends $E{constructor(e=50,n=1,r=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Xg*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ap*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Xg*2*Math.atan(Math.tan(ap*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,r,s,a,l){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(ap*.5*this.fov)/this.zoom,r=2*n,s=this.aspect*r,a=-.5*s;const l=this.view;if(this.view!==null&&this.view.enabled){const d=l.fullWidth,h=l.fullHeight;a+=l.offsetX*s/d,n-=l.offsetY*r/h,s*=l.width/d,r*=l.height/h}const u=this.filmOffset;u!==0&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const Km=-90,Jm=1;class MF extends Xn{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null;const s=new Gi(Km,Jm,e,n);s.layers=this.layers,this.add(s);const a=new Gi(Km,Jm,e,n);a.layers=this.layers,this.add(a);const l=new Gi(Km,Jm,e,n);l.layers=this.layers,this.add(l);const u=new Gi(Km,Jm,e,n);u.layers=this.layers,this.add(u);const d=new Gi(Km,Jm,e,n);d.layers=this.layers,this.add(d);const h=new Gi(Km,Jm,e,n);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,s,a,l,u,d]=n;for(const h of n)this.remove(h);if(e===$c)r.up.set(0,1,0),r.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===rE)r.up.set(0,-1,0),r.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of n)this.add(h),h.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,l,u,d,h]=this.children,f=e.getRenderTarget(),p=e.toneMapping,m=e.xr.enabled;e.toneMapping=kl,e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(n,s),e.setRenderTarget(r,1),e.render(n,a),e.setRenderTarget(r,2),e.render(n,l),e.setRenderTarget(r,3),e.render(n,u),e.setRenderTarget(r,4),e.render(n,d),r.texture.generateMipmaps=v,e.setRenderTarget(r,5),e.render(n,h),e.setRenderTarget(f),e.toneMapping=p,e.xr.enabled=m,r.texture.needsPMREMUpdate=!0}}class bE extends ni{constructor(e,n,r,s,a,l,u,d,h,f){e=e!==void 0?e:[],n=n!==void 0?n:Lu,super(e,n,r,s,a,l,u,d,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class yM extends lo{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},s=[r,r,r,r,r,r];n.encoding!==void 0&&(Mv("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Rc?vn:od),this.texture=new bE(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Dn}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new vd(5,5,5),a=new wo({name:"CubemapFromEquirect",uniforms:jg(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Hs,blending:Cc});a.uniforms.tEquirect.value=n;const l=new Bn(s,a),u=n.minFilter;return n.minFilter===Wa&&(n.minFilter=Dn),new MF(1,10,this).update(e,l),n.minFilter=u,l.geometry.dispose(),l.material.dispose(),this}clear(e,n,r,s){const a=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(n,r,s);e.setRenderTarget(a)}}const TC=new ie,F4=new ie,U4=new Nn;let yu=class{constructor(e=new ie(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,s){return this.normal.set(e,n,r),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const s=TC.subVectors(r,n).cross(F4.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(TC),s=this.normal.dot(r);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:n.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||U4.getNormalMatrix(e),s=this.coplanarPoint(TC).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const wf=new Ws,d0=new ie;class x${constructor(e=new yu,n=new yu,r=new yu,s=new yu,a=new yu,l=new yu){this.planes=[e,n,r,s,a,l]}set(e,n,r,s,a,l){const u=this.planes;return u[0].copy(e),u[1].copy(n),u[2].copy(r),u[3].copy(s),u[4].copy(a),u[5].copy(l),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=$c){const r=this.planes,s=e.elements,a=s[0],l=s[1],u=s[2],d=s[3],h=s[4],f=s[5],p=s[6],m=s[7],v=s[8],y=s[9],$=s[10],E=s[11],S=s[12],A=s[13],C=s[14],x=s[15];if(r[0].setComponents(d-a,m-h,E-v,x-S).normalize(),r[1].setComponents(d+a,m+h,E+v,x+S).normalize(),r[2].setComponents(d+l,m+f,E+y,x+A).normalize(),r[3].setComponents(d-l,m-f,E-y,x-A).normalize(),r[4].setComponents(d-u,m-p,E-$,x-C).normalize(),n===$c)r[5].setComponents(d+u,m+p,E+$,x+C).normalize();else if(n===rE)r[5].setComponents(u,p,$,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),wf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),wf.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(wf)}intersectsSprite(e){return wf.center.set(0,0,0),wf.radius=.7071067811865476,wf.applyMatrix4(e.matrixWorld),this.intersectsSphere(wf)}intersectsSphere(e){const n=this.planes,r=e.center,s=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(r)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const s=n[r];if(d0.x=s.normal.x>0?e.max.x:e.min.x,d0.y=s.normal.y>0?e.max.y:e.min.y,d0.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(d0)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function IF(){let i=null,e=!1,n=null,r=null;function s(a,l){n(a,l),r=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&n!==null&&(r=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){n=a},setContext:function(a){i=a}}}function G4(i,e){const n=e.isWebGL2,r=new WeakMap;function s(h,f){const p=h.array,m=h.usage,v=i.createBuffer();i.bindBuffer(f,v),i.bufferData(f,p,m),h.onUploadCallback();let y;if(p instanceof Float32Array)y=i.FLOAT;else if(p instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(n)y=i.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)y=i.SHORT;else if(p instanceof Uint32Array)y=i.UNSIGNED_INT;else if(p instanceof Int32Array)y=i.INT;else if(p instanceof Int8Array)y=i.BYTE;else if(p instanceof Uint8Array)y=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)y=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:y,bytesPerElement:p.BYTES_PER_ELEMENT,version:h.version}}function a(h,f,p){const m=f.array,v=f.updateRange;i.bindBuffer(p,h),v.count===-1?i.bufferSubData(p,0,m):(n?i.bufferSubData(p,v.offset*m.BYTES_PER_ELEMENT,m,v.offset,v.count):i.bufferSubData(p,v.offset*m.BYTES_PER_ELEMENT,m.subarray(v.offset,v.offset+v.count)),v.count=-1),f.onUploadCallback()}function l(h){return h.isInterleavedBufferAttribute&&(h=h.data),r.get(h)}function u(h){h.isInterleavedBufferAttribute&&(h=h.data);const f=r.get(h);f&&(i.deleteBuffer(f.buffer),r.delete(h))}function d(h,f){if(h.isGLBufferAttribute){const m=r.get(h);(!m||m.version<h.version)&&r.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const p=r.get(h);p===void 0?r.set(h,s(h,f)):p.version<h.version&&(a(p.buffer,h,f),p.version=h.version)}return{get:l,remove:u,update:d}}class ja extends on{constructor(e=1,n=1,r=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:s};const a=e/2,l=n/2,u=Math.floor(r),d=Math.floor(s),h=u+1,f=d+1,p=e/u,m=n/d,v=[],y=[],$=[],E=[];for(let S=0;S<f;S++){const A=S*m-l;for(let C=0;C<h;C++){const x=C*p-a;y.push(x,-A,0),$.push(0,0,1),E.push(C/u),E.push(1-S/d)}}for(let S=0;S<d;S++)for(let A=0;A<u;A++){const C=A+h*S,x=A+h*(S+1),I=A+1+h*(S+1),O=A+1+h*S;v.push(C,x,O),v.push(x,I,O)}this.setIndex(v),this.setAttribute("position",new Yt(y,3)),this.setAttribute("normal",new Yt($,3)),this.setAttribute("uv",new Yt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ja(e.width,e.height,e.widthSegments,e.heightSegments)}}var H4=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,V4=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,z4=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,W4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,X4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,j4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Y4="vec3 transformed = vec3( position );",K4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,J4=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Z4=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,q4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Q4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,eW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,tW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,nW=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,iW=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,rW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,sW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,oW=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,aW=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,lW=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,cW=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,uW=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,hW=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,dW=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,fW=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,pW="gl_FragColor = linearToOutputTexel( gl_FragColor );",mW=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,gW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,_W=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,TW=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,vW=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,EW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,yW=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,SW=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,$W=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,bW=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,AW=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,CW=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,RW=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,xW=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,wW=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,MW=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,IW=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,OW=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,LW=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,NW=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,kW=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,PW=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,DW=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,BW=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,FW=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,UW=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,GW=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,HW=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,VW=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,zW=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,WW=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,XW=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,jW=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,YW=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,KW=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,JW=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ZW=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,qW=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,QW=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,e5=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,t5=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,n5=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,i5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,r5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,s5=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,o5=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,a5=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,l5=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,c5=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,u5=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,h5=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,d5=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,f5=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,p5=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,m5=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,g5=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,_5=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,T5=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,v5=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,E5=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,y5=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,S5=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,$5=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,b5=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,A5=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,C5=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,R5=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,x5=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,w5=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,M5=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,I5=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,O5=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,L5=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,N5=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,k5=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,P5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const D5=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,B5=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,F5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,U5=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,G5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,H5=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,V5=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,z5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,W5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,X5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,j5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Y5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,K5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,J5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Z5=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,q5=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q5=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,e8=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,t8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,n8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,i8=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,r8=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,s8=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,o8=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,a8=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,l8=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c8=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,u8=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h8=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,d8=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,f8=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,p8=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,m8=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,g8=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Ln={alphamap_fragment:H4,alphamap_pars_fragment:V4,alphatest_fragment:z4,alphatest_pars_fragment:W4,aomap_fragment:X4,aomap_pars_fragment:j4,begin_vertex:Y4,beginnormal_vertex:K4,bsdfs:J4,iridescence_fragment:Z4,bumpmap_pars_fragment:q4,clipping_planes_fragment:Q4,clipping_planes_pars_fragment:eW,clipping_planes_pars_vertex:tW,clipping_planes_vertex:nW,color_fragment:iW,color_pars_fragment:rW,color_pars_vertex:sW,color_vertex:oW,common:aW,cube_uv_reflection_fragment:lW,defaultnormal_vertex:cW,displacementmap_pars_vertex:uW,displacementmap_vertex:hW,emissivemap_fragment:dW,emissivemap_pars_fragment:fW,encodings_fragment:pW,encodings_pars_fragment:mW,envmap_fragment:gW,envmap_common_pars_fragment:_W,envmap_pars_fragment:TW,envmap_pars_vertex:vW,envmap_physical_pars_fragment:IW,envmap_vertex:EW,fog_vertex:yW,fog_pars_vertex:SW,fog_fragment:$W,fog_pars_fragment:bW,gradientmap_pars_fragment:AW,lightmap_fragment:CW,lightmap_pars_fragment:RW,lights_lambert_fragment:xW,lights_lambert_pars_fragment:wW,lights_pars_begin:MW,lights_toon_fragment:OW,lights_toon_pars_fragment:LW,lights_phong_fragment:NW,lights_phong_pars_fragment:kW,lights_physical_fragment:PW,lights_physical_pars_fragment:DW,lights_fragment_begin:BW,lights_fragment_maps:FW,lights_fragment_end:UW,logdepthbuf_fragment:GW,logdepthbuf_pars_fragment:HW,logdepthbuf_pars_vertex:VW,logdepthbuf_vertex:zW,map_fragment:WW,map_pars_fragment:XW,map_particle_fragment:jW,map_particle_pars_fragment:YW,metalnessmap_fragment:KW,metalnessmap_pars_fragment:JW,morphcolor_vertex:ZW,morphnormal_vertex:qW,morphtarget_pars_vertex:QW,morphtarget_vertex:e5,normal_fragment_begin:t5,normal_fragment_maps:n5,normal_pars_fragment:i5,normal_pars_vertex:r5,normal_vertex:s5,normalmap_pars_fragment:o5,clearcoat_normal_fragment_begin:a5,clearcoat_normal_fragment_maps:l5,clearcoat_pars_fragment:c5,iridescence_pars_fragment:u5,output_fragment:h5,packing:d5,premultiplied_alpha_fragment:f5,project_vertex:p5,dithering_fragment:m5,dithering_pars_fragment:g5,roughnessmap_fragment:_5,roughnessmap_pars_fragment:T5,shadowmap_pars_fragment:v5,shadowmap_pars_vertex:E5,shadowmap_vertex:y5,shadowmask_pars_fragment:S5,skinbase_vertex:$5,skinning_pars_vertex:b5,skinning_vertex:A5,skinnormal_vertex:C5,specularmap_fragment:R5,specularmap_pars_fragment:x5,tonemapping_fragment:w5,tonemapping_pars_fragment:M5,transmission_fragment:I5,transmission_pars_fragment:O5,uv_pars_fragment:L5,uv_pars_vertex:N5,uv_vertex:k5,worldpos_vertex:P5,background_vert:D5,background_frag:B5,backgroundCube_vert:F5,backgroundCube_frag:U5,cube_vert:G5,cube_frag:H5,depth_vert:V5,depth_frag:z5,distanceRGBA_vert:W5,distanceRGBA_frag:X5,equirect_vert:j5,equirect_frag:Y5,linedashed_vert:K5,linedashed_frag:J5,meshbasic_vert:Z5,meshbasic_frag:q5,meshlambert_vert:Q5,meshlambert_frag:e8,meshmatcap_vert:t8,meshmatcap_frag:n8,meshnormal_vert:i8,meshnormal_frag:r8,meshphong_vert:s8,meshphong_frag:o8,meshphysical_vert:a8,meshphysical_frag:l8,meshtoon_vert:c8,meshtoon_frag:u8,points_vert:h8,points_frag:d8,shadow_vert:f8,shadow_frag:p8,sprite_vert:m8,sprite_frag:g8},Lt={common:{diffuse:{value:new xt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Nn},alphaMap:{value:null},alphaMapTransform:{value:new Nn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Nn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Nn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Nn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Nn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Nn},normalScale:{value:new mt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Nn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Nn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Nn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Nn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Nn},alphaTest:{value:0},uvTransform:{value:new Nn}},sprite:{diffuse:{value:new xt(16777215)},opacity:{value:1},center:{value:new mt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Nn},alphaMap:{value:null},alphaMapTransform:{value:new Nn},alphaTest:{value:0}}},Ol={basic:{uniforms:ro([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.fog]),vertexShader:Ln.meshbasic_vert,fragmentShader:Ln.meshbasic_frag},lambert:{uniforms:ro([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,Lt.lights,{emissive:{value:new xt(0)}}]),vertexShader:Ln.meshlambert_vert,fragmentShader:Ln.meshlambert_frag},phong:{uniforms:ro([Lt.common,Lt.specularmap,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,Lt.lights,{emissive:{value:new xt(0)},specular:{value:new xt(1118481)},shininess:{value:30}}]),vertexShader:Ln.meshphong_vert,fragmentShader:Ln.meshphong_frag},standard:{uniforms:ro([Lt.common,Lt.envmap,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.roughnessmap,Lt.metalnessmap,Lt.fog,Lt.lights,{emissive:{value:new xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ln.meshphysical_vert,fragmentShader:Ln.meshphysical_frag},toon:{uniforms:ro([Lt.common,Lt.aomap,Lt.lightmap,Lt.emissivemap,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.gradientmap,Lt.fog,Lt.lights,{emissive:{value:new xt(0)}}]),vertexShader:Ln.meshtoon_vert,fragmentShader:Ln.meshtoon_frag},matcap:{uniforms:ro([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,Lt.fog,{matcap:{value:null}}]),vertexShader:Ln.meshmatcap_vert,fragmentShader:Ln.meshmatcap_frag},points:{uniforms:ro([Lt.points,Lt.fog]),vertexShader:Ln.points_vert,fragmentShader:Ln.points_frag},dashed:{uniforms:ro([Lt.common,Lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ln.linedashed_vert,fragmentShader:Ln.linedashed_frag},depth:{uniforms:ro([Lt.common,Lt.displacementmap]),vertexShader:Ln.depth_vert,fragmentShader:Ln.depth_frag},normal:{uniforms:ro([Lt.common,Lt.bumpmap,Lt.normalmap,Lt.displacementmap,{opacity:{value:1}}]),vertexShader:Ln.meshnormal_vert,fragmentShader:Ln.meshnormal_frag},sprite:{uniforms:ro([Lt.sprite,Lt.fog]),vertexShader:Ln.sprite_vert,fragmentShader:Ln.sprite_frag},background:{uniforms:{uvTransform:{value:new Nn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ln.background_vert,fragmentShader:Ln.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ln.backgroundCube_vert,fragmentShader:Ln.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ln.cube_vert,fragmentShader:Ln.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ln.equirect_vert,fragmentShader:Ln.equirect_frag},distanceRGBA:{uniforms:ro([Lt.common,Lt.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ln.distanceRGBA_vert,fragmentShader:Ln.distanceRGBA_frag},shadow:{uniforms:ro([Lt.lights,Lt.fog,{color:{value:new xt(0)},opacity:{value:1}}]),vertexShader:Ln.shadow_vert,fragmentShader:Ln.shadow_frag}};Ol.physical={uniforms:ro([Ol.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Nn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Nn},clearcoatNormalScale:{value:new mt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Nn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Nn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Nn},sheen:{value:0},sheenColor:{value:new xt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Nn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Nn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Nn},transmissionSamplerSize:{value:new mt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Nn},attenuationDistance:{value:0},attenuationColor:{value:new xt(0)},specularColor:{value:new xt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Nn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Nn},anisotropyVector:{value:new mt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Nn}}]),vertexShader:Ln.meshphysical_vert,fragmentShader:Ln.meshphysical_frag};const f0={r:0,b:0,g:0};function _8(i,e,n,r,s,a,l){const u=new xt(0);let d=a===!0?0:1,h,f,p=null,m=0,v=null;function y(E,S){let A=!1,C=S.isScene===!0?S.background:null;switch(C&&C.isTexture&&(C=(S.backgroundBlurriness>0?n:e).get(C)),C===null?$(u,d):C&&C.isColor&&($(C,1),A=!0),i.xr.getEnvironmentBlendMode()){case"opaque":A=!0;break;case"additive":r.buffers.color.setClear(0,0,0,1,l),A=!0;break;case"alpha-blend":r.buffers.color.setClear(0,0,0,0,l),A=!0;break}(i.autoClear||A)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),C&&(C.isCubeTexture||C.mapping===e_)?(f===void 0&&(f=new Bn(new vd(1,1,1),new wo({name:"BackgroundCubeMaterial",uniforms:jg(Ol.backgroundCube.uniforms),vertexShader:Ol.backgroundCube.vertexShader,fragmentShader:Ol.backgroundCube.fragmentShader,side:Hs,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(O,F,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(f)),f.material.uniforms.envMap.value=C,f.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,f.material.toneMapped=C.colorSpace!==vn,(p!==C||m!==C.version||v!==i.toneMapping)&&(f.material.needsUpdate=!0,p=C,m=C.version,v=i.toneMapping),f.layers.enableAll(),E.unshift(f,f.geometry,f.material,0,0,null)):C&&C.isTexture&&(h===void 0&&(h=new Bn(new ja(2,2),new wo({name:"BackgroundMaterial",uniforms:jg(Ol.background.uniforms),vertexShader:Ol.background.vertexShader,fragmentShader:Ol.background.fragmentShader,side:za,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(h)),h.material.uniforms.t2D.value=C,h.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,h.material.toneMapped=C.colorSpace!==vn,C.matrixAutoUpdate===!0&&C.updateMatrix(),h.material.uniforms.uvTransform.value.copy(C.matrix),(p!==C||m!==C.version||v!==i.toneMapping)&&(h.material.needsUpdate=!0,p=C,m=C.version,v=i.toneMapping),h.layers.enableAll(),E.unshift(h,h.geometry,h.material,0,0,null))}function $(E,S){E.getRGB(f0,wF(i)),r.buffers.color.setClear(f0.r,f0.g,f0.b,S,l)}return{getClearColor:function(){return u},setClearColor:function(E,S=1){u.set(E),d=S,$(u,d)},getClearAlpha:function(){return d},setClearAlpha:function(E){d=E,$(u,d)},render:y}}function T8(i,e,n,r){const s=i.getParameter(i.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),l=r.isWebGL2||a!==null,u={},d=E(null);let h=d,f=!1;function p(ne,de,ue,Re,G){let Z=!1;if(l){const K=$(Re,ue,de);h!==K&&(h=K,v(h.object)),Z=S(ne,Re,ue,G),Z&&A(ne,Re,ue,G)}else{const K=de.wireframe===!0;(h.geometry!==Re.id||h.program!==ue.id||h.wireframe!==K)&&(h.geometry=Re.id,h.program=ue.id,h.wireframe=K,Z=!0)}G!==null&&n.update(G,i.ELEMENT_ARRAY_BUFFER),(Z||f)&&(f=!1,k(ne,de,ue,Re),G!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.get(G).buffer))}function m(){return r.isWebGL2?i.createVertexArray():a.createVertexArrayOES()}function v(ne){return r.isWebGL2?i.bindVertexArray(ne):a.bindVertexArrayOES(ne)}function y(ne){return r.isWebGL2?i.deleteVertexArray(ne):a.deleteVertexArrayOES(ne)}function $(ne,de,ue){const Re=ue.wireframe===!0;let G=u[ne.id];G===void 0&&(G={},u[ne.id]=G);let Z=G[de.id];Z===void 0&&(Z={},G[de.id]=Z);let K=Z[Re];return K===void 0&&(K=E(m()),Z[Re]=K),K}function E(ne){const de=[],ue=[],Re=[];for(let G=0;G<s;G++)de[G]=0,ue[G]=0,Re[G]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:de,enabledAttributes:ue,attributeDivisors:Re,object:ne,attributes:{},index:null}}function S(ne,de,ue,Re){const G=h.attributes,Z=de.attributes;let K=0;const se=ue.getAttributes();for(const Y in se)if(se[Y].location>=0){const fe=G[Y];let Ae=Z[Y];if(Ae===void 0&&(Y==="instanceMatrix"&&ne.instanceMatrix&&(Ae=ne.instanceMatrix),Y==="instanceColor"&&ne.instanceColor&&(Ae=ne.instanceColor)),fe===void 0||fe.attribute!==Ae||Ae&&fe.data!==Ae.data)return!0;K++}return h.attributesNum!==K||h.index!==Re}function A(ne,de,ue,Re){const G={},Z=de.attributes;let K=0;const se=ue.getAttributes();for(const Y in se)if(se[Y].location>=0){let fe=Z[Y];fe===void 0&&(Y==="instanceMatrix"&&ne.instanceMatrix&&(fe=ne.instanceMatrix),Y==="instanceColor"&&ne.instanceColor&&(fe=ne.instanceColor));const Ae={};Ae.attribute=fe,fe&&fe.data&&(Ae.data=fe.data),G[Y]=Ae,K++}h.attributes=G,h.attributesNum=K,h.index=Re}function C(){const ne=h.newAttributes;for(let de=0,ue=ne.length;de<ue;de++)ne[de]=0}function x(ne){I(ne,0)}function I(ne,de){const ue=h.newAttributes,Re=h.enabledAttributes,G=h.attributeDivisors;ue[ne]=1,Re[ne]===0&&(i.enableVertexAttribArray(ne),Re[ne]=1),G[ne]!==de&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ne,de),G[ne]=de)}function O(){const ne=h.newAttributes,de=h.enabledAttributes;for(let ue=0,Re=de.length;ue<Re;ue++)de[ue]!==ne[ue]&&(i.disableVertexAttribArray(ue),de[ue]=0)}function F(ne,de,ue,Re,G,Z,K){K===!0?i.vertexAttribIPointer(ne,de,ue,G,Z):i.vertexAttribPointer(ne,de,ue,Re,G,Z)}function k(ne,de,ue,Re){if(r.isWebGL2===!1&&(ne.isInstancedMesh||Re.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;C();const G=Re.attributes,Z=ue.getAttributes(),K=de.defaultAttributeValues;for(const se in Z){const Y=Z[se];if(Y.location>=0){let me=G[se];if(me===void 0&&(se==="instanceMatrix"&&ne.instanceMatrix&&(me=ne.instanceMatrix),se==="instanceColor"&&ne.instanceColor&&(me=ne.instanceColor)),me!==void 0){const fe=me.normalized,Ae=me.itemSize,Ce=n.get(me);if(Ce===void 0)continue;const Ie=Ce.buffer,We=Ce.type,ut=Ce.bytesPerElement,Ye=r.isWebGL2===!0&&(We===i.INT||We===i.UNSIGNED_INT||me.gpuType===b$);if(me.isInterleavedBufferAttribute){const we=me.data,Q=we.stride,Ge=me.offset;if(we.isInstancedInterleavedBuffer){for(let Oe=0;Oe<Y.locationSize;Oe++)I(Y.location+Oe,we.meshPerAttribute);ne.isInstancedMesh!==!0&&Re._maxInstanceCount===void 0&&(Re._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let Oe=0;Oe<Y.locationSize;Oe++)x(Y.location+Oe);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let Oe=0;Oe<Y.locationSize;Oe++)F(Y.location+Oe,Ae/Y.locationSize,We,fe,Q*ut,(Ge+Ae/Y.locationSize*Oe)*ut,Ye)}else{if(me.isInstancedBufferAttribute){for(let we=0;we<Y.locationSize;we++)I(Y.location+we,me.meshPerAttribute);ne.isInstancedMesh!==!0&&Re._maxInstanceCount===void 0&&(Re._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let we=0;we<Y.locationSize;we++)x(Y.location+we);i.bindBuffer(i.ARRAY_BUFFER,Ie);for(let we=0;we<Y.locationSize;we++)F(Y.location+we,Ae/Y.locationSize,We,fe,Ae*ut,Ae/Y.locationSize*we*ut,Ye)}}else if(K!==void 0){const fe=K[se];if(fe!==void 0)switch(fe.length){case 2:i.vertexAttrib2fv(Y.location,fe);break;case 3:i.vertexAttrib3fv(Y.location,fe);break;case 4:i.vertexAttrib4fv(Y.location,fe);break;default:i.vertexAttrib1fv(Y.location,fe)}}}}O()}function D(){re();for(const ne in u){const de=u[ne];for(const ue in de){const Re=de[ue];for(const G in Re)y(Re[G].object),delete Re[G];delete de[ue]}delete u[ne]}}function U(ne){if(u[ne.id]===void 0)return;const de=u[ne.id];for(const ue in de){const Re=de[ue];for(const G in Re)y(Re[G].object),delete Re[G];delete de[ue]}delete u[ne.id]}function ce(ne){for(const de in u){const ue=u[de];if(ue[ne.id]===void 0)continue;const Re=ue[ne.id];for(const G in Re)y(Re[G].object),delete Re[G];delete ue[ne.id]}}function re(){ae(),f=!0,h!==d&&(h=d,v(h.object))}function ae(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:p,reset:re,resetDefaultState:ae,dispose:D,releaseStatesOfGeometry:U,releaseStatesOfProgram:ce,initAttributes:C,enableAttribute:x,disableUnusedAttributes:O}}function v8(i,e,n,r){const s=r.isWebGL2;let a;function l(h){a=h}function u(h,f){i.drawArrays(a,h,f),n.update(f,a,1)}function d(h,f,p){if(p===0)return;let m,v;if(s)m=i,v="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](a,h,f,p),n.update(f,a,p)}this.setMode=l,this.render=u,this.renderInstances=d}function E8(i,e,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const F=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(F){if(F==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";F="mediump"}return F==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const l=typeof WebGL2RenderingContext<"u"&&i.constructor.name==="WebGL2RenderingContext";let u=n.precision!==void 0?n.precision:"highp";const d=a(u);d!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",d,"instead."),u=d);const h=l||e.has("WEBGL_draw_buffers"),f=n.logarithmicDepthBuffer===!0,p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),m=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=i.getParameter(i.MAX_TEXTURE_SIZE),y=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),$=i.getParameter(i.MAX_VERTEX_ATTRIBS),E=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),S=i.getParameter(i.MAX_VARYING_VECTORS),A=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),C=m>0,x=l||e.has("OES_texture_float"),I=C&&x,O=l?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:l,drawBuffers:h,getMaxAnisotropy:s,getMaxPrecision:a,precision:u,logarithmicDepthBuffer:f,maxTextures:p,maxVertexTextures:m,maxTextureSize:v,maxCubemapSize:y,maxAttributes:$,maxVertexUniforms:E,maxVaryings:S,maxFragmentUniforms:A,vertexTextures:C,floatFragmentTextures:x,floatVertexTextures:I,maxSamples:O}}function y8(i){const e=this;let n=null,r=0,s=!1,a=!1;const l=new yu,u=new Nn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(p,m){const v=p.length!==0||m||r!==0||s;return s=m,r=p.length,v},this.beginShadows=function(){a=!0,f(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(p,m){n=f(p,m,0)},this.setState=function(p,m,v){const y=p.clippingPlanes,$=p.clipIntersection,E=p.clipShadows,S=i.get(p);if(!s||y===null||y.length===0||a&&!E)a?f(null):h();else{const A=a?0:r,C=A*4;let x=S.clippingState||null;d.value=x,x=f(y,m,C,v);for(let I=0;I!==C;++I)x[I]=n[I];S.clippingState=x,this.numIntersection=$?this.numPlanes:0,this.numPlanes+=A}};function h(){d.value!==n&&(d.value=n,d.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(p,m,v,y){const $=p!==null?p.length:0;let E=null;if($!==0){if(E=d.value,y!==!0||E===null){const S=v+$*4,A=m.matrixWorldInverse;u.getNormalMatrix(A),(E===null||E.length<S)&&(E=new Float32Array(S));for(let C=0,x=v;C!==$;++C,x+=4)l.copy(p[C]).applyMatrix4(A,u),l.normal.toArray(E,x),E[x+3]=l.constant}d.value=E,d.needsUpdate=!0}return e.numPlanes=$,e.numIntersection=0,E}}function S8(i){let e=new WeakMap;function n(l,u){return u===zg?l.mapping=Lu:u===tE&&(l.mapping=ud),l}function r(l){if(l&&l.isTexture&&l.isRenderTargetTexture===!1){const u=l.mapping;if(u===zg||u===tE)if(e.has(l)){const d=e.get(l).texture;return n(d,l.mapping)}else{const d=l.image;if(d&&d.height>0){const h=new yM(d.height/2);return h.fromEquirectangularTexture(i,l),e.set(l,h),l.addEventListener("dispose",s),n(h.texture,l.mapping)}else return null}}return l}function s(l){const u=l.target;u.removeEventListener("dispose",s);const d=e.get(u);d!==void 0&&(e.delete(u),d.dispose())}function a(){e=new WeakMap}return{get:r,dispose:a}}class sa extends $E{constructor(e=-1,n=1,r=1,s=-1,a=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=s,this.near=a,this.far=l,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,s,a,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=s,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=r-e,l=r+e,u=s+n,d=s-n;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=h*this.view.offsetX,l=a+h*this.view.width,u-=f*this.view.offsetY,d=u-f*this.view.height}this.projectionMatrix.makeOrthographic(a,l,u,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const bg=4,jL=[.125,.215,.35,.446,.526,.582],zf=20,vC=new sa,YL=new xt;let EC=null;const Hf=(1+Math.sqrt(5))/2,Zm=1/Hf,KL=[new ie(1,1,1),new ie(-1,1,1),new ie(1,1,-1),new ie(-1,1,-1),new ie(0,Hf,Zm),new ie(0,Hf,-Zm),new ie(Zm,0,Hf),new ie(-Zm,0,Hf),new ie(Hf,Zm,0),new ie(-Hf,Zm,0)];class Px{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,s=100){EC=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,s,a),n>0&&this._blur(a,0,0,n),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=qL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ZL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(EC),e.scissorTest=!1,p0(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Lu||e.mapping===ud?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),EC=this._renderer.getRenderTarget();const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Dn,minFilter:Dn,generateMipmaps:!1,type:Jr,format:Yr,colorSpace:xo,depthBuffer:!1},s=JL(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=JL(e,n,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=$8(a)),this._blurMaterial=b8(a,e,n)}return s}_compileMaterial(e){const n=new Bn(this._lodPlanes[0],e);this._renderer.compile(n,vC)}_sceneToCubeUV(e,n,r,s){const u=new Gi(90,1,n,r),d=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,m=f.toneMapping;f.getClearColor(YL),f.toneMapping=kl,f.autoClear=!1;const v=new oi({name:"PMREM.Background",side:Hs,depthWrite:!1,depthTest:!1}),y=new Bn(new vd,v);let $=!1;const E=e.background;E?E.isColor&&(v.color.copy(E),e.background=null,$=!0):(v.color.copy(YL),$=!0);for(let S=0;S<6;S++){const A=S%3;A===0?(u.up.set(0,d[S],0),u.lookAt(h[S],0,0)):A===1?(u.up.set(0,0,d[S]),u.lookAt(0,h[S],0)):(u.up.set(0,d[S],0),u.lookAt(0,0,h[S]));const C=this._cubeSize;p0(s,A*C,S>2?C:0,C,C),f.setRenderTarget(s),$&&f.render(y,u),f.render(e,u)}y.geometry.dispose(),y.material.dispose(),f.toneMapping=m,f.autoClear=p,e.background=E}_textureToCubeUV(e,n){const r=this._renderer,s=e.mapping===Lu||e.mapping===ud;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=qL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ZL());const a=s?this._cubemapMaterial:this._equirectMaterial,l=new Bn(this._lodPlanes[0],a),u=a.uniforms;u.envMap.value=e;const d=this._cubeSize;p0(n,0,0,3*d,2*d),r.setRenderTarget(n),r.render(l,vC)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),l=KL[(s-1)%KL.length];this._blur(e,s-1,s,a,l)}n.autoClear=r}_blur(e,n,r,s,a){const l=this._pingPongRenderTarget;this._halfBlur(e,l,n,r,s,"latitudinal",a),this._halfBlur(l,e,r,r,s,"longitudinal",a)}_halfBlur(e,n,r,s,a,l,u){const d=this._renderer,h=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,p=new Bn(this._lodPlanes[s],h),m=h.uniforms,v=this._sizeLods[r]-1,y=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*zf-1),$=a/y,E=isFinite(a)?1+Math.floor(f*$):zf;E>zf&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${zf}`);const S=[];let A=0;for(let F=0;F<zf;++F){const k=F/$,D=Math.exp(-k*k/2);S.push(D),F===0?A+=D:F<E&&(A+=2*D)}for(let F=0;F<S.length;F++)S[F]=S[F]/A;m.envMap.value=e.texture,m.samples.value=E,m.weights.value=S,m.latitudinal.value=l==="latitudinal",u&&(m.poleAxis.value=u);const{_lodMax:C}=this;m.dTheta.value=y,m.mipInt.value=C-r;const x=this._sizeLods[s],I=3*x*(s>C-bg?s-C+bg:0),O=4*(this._cubeSize-x);p0(n,I,O,3*x,2*x),d.setRenderTarget(n),d.render(p,vC)}}function $8(i){const e=[],n=[],r=[];let s=i;const a=i-bg+1+jL.length;for(let l=0;l<a;l++){const u=Math.pow(2,s);n.push(u);let d=1/u;l>i-bg?d=jL[l-i+bg-1]:l===0&&(d=0),r.push(d);const h=1/(u-2),f=-h,p=1+h,m=[f,f,p,f,p,p,f,f,p,p,f,p],v=6,y=6,$=3,E=2,S=1,A=new Float32Array($*y*v),C=new Float32Array(E*y*v),x=new Float32Array(S*y*v);for(let O=0;O<v;O++){const F=O%3*2/3-1,k=O>2?0:-1,D=[F,k,0,F+2/3,k,0,F+2/3,k+1,0,F,k,0,F+2/3,k+1,0,F,k+1,0];A.set(D,$*y*O),C.set(m,E*y*O);const U=[O,O,O,O,O,O];x.set(U,S*y*O)}const I=new on;I.setAttribute("position",new Qn(A,$)),I.setAttribute("uv",new Qn(C,E)),I.setAttribute("faceIndex",new Qn(x,S)),e.push(I),s>bg&&s--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function JL(i,e,n){const r=new lo(i,e,n);return r.texture.mapping=e_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function p0(i,e,n,r,s){i.viewport.set(e,n,r,s),i.scissor.set(e,n,r,s)}function b8(i,e,n){const r=new Float32Array(zf),s=new ie(0,1,0);return new wo({name:"SphericalGaussianBlur",defines:{n:zf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:SM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Cc,depthTest:!1,depthWrite:!1})}function ZL(){return new wo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:SM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Cc,depthTest:!1,depthWrite:!1})}function qL(){return new wo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:SM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Cc,depthTest:!1,depthWrite:!1})}function SM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function A8(i){let e=new WeakMap,n=null;function r(u){if(u&&u.isTexture){const d=u.mapping,h=d===zg||d===tE,f=d===Lu||d===ud;if(h||f)if(u.isRenderTargetTexture&&u.needsPMREMUpdate===!0){u.needsPMREMUpdate=!1;let p=e.get(u);return n===null&&(n=new Px(i)),p=h?n.fromEquirectangular(u,p):n.fromCubemap(u,p),e.set(u,p),p.texture}else{if(e.has(u))return e.get(u).texture;{const p=u.image;if(h&&p&&p.height>0||f&&p&&s(p)){n===null&&(n=new Px(i));const m=h?n.fromEquirectangular(u):n.fromCubemap(u);return e.set(u,m),u.addEventListener("dispose",a),m.texture}else return null}}}return u}function s(u){let d=0;const h=6;for(let f=0;f<h;f++)u[f]!==void 0&&d++;return d===h}function a(u){const d=u.target;d.removeEventListener("dispose",a);const h=e.get(d);h!==void 0&&(e.delete(d),h.dispose())}function l(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:l}}function C8(i){const e={};function n(r){if(e[r]!==void 0)return e[r];let s;switch(r){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(r)}return e[r]=s,s}return{has:function(r){return n(r)!==null},init:function(r){r.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(r){const s=n(r);return s===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),s}}}function R8(i,e,n,r){const s={},a=new WeakMap;function l(p){const m=p.target;m.index!==null&&e.remove(m.index);for(const y in m.attributes)e.remove(m.attributes[y]);for(const y in m.morphAttributes){const $=m.morphAttributes[y];for(let E=0,S=$.length;E<S;E++)e.remove($[E])}m.removeEventListener("dispose",l),delete s[m.id];const v=a.get(m);v&&(e.remove(v),a.delete(m)),r.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,n.memory.geometries--}function u(p,m){return s[m.id]===!0||(m.addEventListener("dispose",l),s[m.id]=!0,n.memory.geometries++),m}function d(p){const m=p.attributes;for(const y in m)e.update(m[y],i.ARRAY_BUFFER);const v=p.morphAttributes;for(const y in v){const $=v[y];for(let E=0,S=$.length;E<S;E++)e.update($[E],i.ARRAY_BUFFER)}}function h(p){const m=[],v=p.index,y=p.attributes.position;let $=0;if(v!==null){const A=v.array;$=v.version;for(let C=0,x=A.length;C<x;C+=3){const I=A[C+0],O=A[C+1],F=A[C+2];m.push(I,O,O,F,F,I)}}else{const A=y.array;$=y.version;for(let C=0,x=A.length/3-1;C<x;C+=3){const I=C+0,O=C+1,F=C+2;m.push(I,O,O,F,F,I)}}const E=new(RF(m)?EM:vM)(m,1);E.version=$;const S=a.get(p);S&&e.remove(S),a.set(p,E)}function f(p){const m=a.get(p);if(m){const v=p.index;v!==null&&m.version<v.version&&h(p)}else h(p);return a.get(p)}return{get:u,update:d,getWireframeAttribute:f}}function x8(i,e,n,r){const s=r.isWebGL2;let a;function l(m){a=m}let u,d;function h(m){u=m.type,d=m.bytesPerElement}function f(m,v){i.drawElements(a,v,u,m*d),n.update(v,a,1)}function p(m,v,y){if(y===0)return;let $,E;if(s)$=i,E="drawElementsInstanced";else if($=e.get("ANGLE_instanced_arrays"),E="drawElementsInstancedANGLE",$===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}$[E](a,v,u,m*d,y),n.update(v,a,y)}this.setMode=l,this.setIndex=h,this.render=f,this.renderInstances=p}function w8(i){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,l,u){switch(n.calls++,l){case i.TRIANGLES:n.triangles+=u*(a/3);break;case i.LINES:n.lines+=u*(a/2);break;case i.LINE_STRIP:n.lines+=u*(a-1);break;case i.LINE_LOOP:n.lines+=u*a;break;case i.POINTS:n.points+=u*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function s(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:s,update:r}}function M8(i,e){return i[0]-e[0]}function I8(i,e){return Math.abs(e[1])-Math.abs(i[1])}function O8(i,e,n){const r={},s=new Float32Array(8),a=new WeakMap,l=new Hn,u=[];for(let h=0;h<8;h++)u[h]=[h,0];function d(h,f,p){const m=h.morphTargetInfluences;if(e.isWebGL2===!0){const y=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,$=y!==void 0?y.length:0;let E=a.get(f);if(E===void 0||E.count!==$){let de=function(){ae.dispose(),a.delete(f),f.removeEventListener("dispose",de)};var v=de;E!==void 0&&E.texture.dispose();const C=f.morphAttributes.position!==void 0,x=f.morphAttributes.normal!==void 0,I=f.morphAttributes.color!==void 0,O=f.morphAttributes.position||[],F=f.morphAttributes.normal||[],k=f.morphAttributes.color||[];let D=0;C===!0&&(D=1),x===!0&&(D=2),I===!0&&(D=3);let U=f.attributes.position.count*D,ce=1;U>e.maxTextureSize&&(ce=Math.ceil(U/e.maxTextureSize),U=e.maxTextureSize);const re=new Float32Array(U*ce*4*$),ae=new R$(re,U,ce,$);ae.type=Lr,ae.needsUpdate=!0;const ne=D*4;for(let ue=0;ue<$;ue++){const Re=O[ue],G=F[ue],Z=k[ue],K=U*ce*4*ue;for(let se=0;se<Re.count;se++){const Y=se*ne;C===!0&&(l.fromBufferAttribute(Re,se),re[K+Y+0]=l.x,re[K+Y+1]=l.y,re[K+Y+2]=l.z,re[K+Y+3]=0),x===!0&&(l.fromBufferAttribute(G,se),re[K+Y+4]=l.x,re[K+Y+5]=l.y,re[K+Y+6]=l.z,re[K+Y+7]=0),I===!0&&(l.fromBufferAttribute(Z,se),re[K+Y+8]=l.x,re[K+Y+9]=l.y,re[K+Y+10]=l.z,re[K+Y+11]=Z.itemSize===4?l.w:1)}}E={count:$,texture:ae,size:new mt(U,ce)},a.set(f,E),f.addEventListener("dispose",de)}let S=0;for(let C=0;C<m.length;C++)S+=m[C];const A=f.morphTargetsRelative?1:1-S;p.getUniforms().setValue(i,"morphTargetBaseInfluence",A),p.getUniforms().setValue(i,"morphTargetInfluences",m),p.getUniforms().setValue(i,"morphTargetsTexture",E.texture,n),p.getUniforms().setValue(i,"morphTargetsTextureSize",E.size)}else{const y=m===void 0?0:m.length;let $=r[f.id];if($===void 0||$.length!==y){$=[];for(let x=0;x<y;x++)$[x]=[x,0];r[f.id]=$}for(let x=0;x<y;x++){const I=$[x];I[0]=x,I[1]=m[x]}$.sort(I8);for(let x=0;x<8;x++)x<y&&$[x][1]?(u[x][0]=$[x][0],u[x][1]=$[x][1]):(u[x][0]=Number.MAX_SAFE_INTEGER,u[x][1]=0);u.sort(M8);const E=f.morphAttributes.position,S=f.morphAttributes.normal;let A=0;for(let x=0;x<8;x++){const I=u[x],O=I[0],F=I[1];O!==Number.MAX_SAFE_INTEGER&&F?(E&&f.getAttribute("morphTarget"+x)!==E[O]&&f.setAttribute("morphTarget"+x,E[O]),S&&f.getAttribute("morphNormal"+x)!==S[O]&&f.setAttribute("morphNormal"+x,S[O]),s[x]=F,A+=F):(E&&f.hasAttribute("morphTarget"+x)===!0&&f.deleteAttribute("morphTarget"+x),S&&f.hasAttribute("morphNormal"+x)===!0&&f.deleteAttribute("morphNormal"+x),s[x]=0)}const C=f.morphTargetsRelative?1:1-A;p.getUniforms().setValue(i,"morphTargetBaseInfluence",C),p.getUniforms().setValue(i,"morphTargetInfluences",s)}}return{update:d}}function L8(i,e,n,r){let s=new WeakMap;function a(d){const h=r.render.frame,f=d.geometry,p=e.get(d,f);return s.get(p)!==h&&(e.update(p),s.set(p,h)),d.isInstancedMesh&&(d.hasEventListener("dispose",u)===!1&&d.addEventListener("dispose",u),n.update(d.instanceMatrix,i.ARRAY_BUFFER),d.instanceColor!==null&&n.update(d.instanceColor,i.ARRAY_BUFFER)),p}function l(){s=new WeakMap}function u(d){const h=d.target;h.removeEventListener("dispose",u),n.remove(h.instanceMatrix),h.instanceColor!==null&&n.remove(h.instanceColor)}return{update:a,dispose:l}}const OF=new ni,LF=new R$,NF=new TM,kF=new bE,QL=[],eN=[],tN=new Float32Array(16),nN=new Float32Array(9),iN=new Float32Array(4);function t_(i,e,n){const r=i[0];if(r<=0||r>0)return i;const s=e*n;let a=QL[s];if(a===void 0&&(a=new Float32Array(s),QL[s]=a),e!==0){r.toArray(a,0);for(let l=1,u=0;l!==e;++l)u+=n,i[l].toArray(a,u)}return a}function qr(i,e){if(i.length!==e.length)return!1;for(let n=0,r=i.length;n<r;n++)if(i[n]!==e[n])return!1;return!0}function Qr(i,e){for(let n=0,r=e.length;n<r;n++)i[n]=e[n]}function w$(i,e){let n=eN[e];n===void 0&&(n=new Int32Array(e),eN[e]=n);for(let r=0;r!==e;++r)n[r]=i.allocateTextureUnit();return n}function N8(i,e){const n=this.cache;n[0]!==e&&(i.uniform1f(this.addr,e),n[0]=e)}function k8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(qr(n,e))return;i.uniform2fv(this.addr,e),Qr(n,e)}}function P8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(qr(n,e))return;i.uniform3fv(this.addr,e),Qr(n,e)}}function D8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(qr(n,e))return;i.uniform4fv(this.addr,e),Qr(n,e)}}function B8(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(qr(n,e))return;i.uniformMatrix2fv(this.addr,!1,e),Qr(n,e)}else{if(qr(n,r))return;iN.set(r),i.uniformMatrix2fv(this.addr,!1,iN),Qr(n,r)}}function F8(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(qr(n,e))return;i.uniformMatrix3fv(this.addr,!1,e),Qr(n,e)}else{if(qr(n,r))return;nN.set(r),i.uniformMatrix3fv(this.addr,!1,nN),Qr(n,r)}}function U8(i,e){const n=this.cache,r=e.elements;if(r===void 0){if(qr(n,e))return;i.uniformMatrix4fv(this.addr,!1,e),Qr(n,e)}else{if(qr(n,r))return;tN.set(r),i.uniformMatrix4fv(this.addr,!1,tN),Qr(n,r)}}function G8(i,e){const n=this.cache;n[0]!==e&&(i.uniform1i(this.addr,e),n[0]=e)}function H8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(qr(n,e))return;i.uniform2iv(this.addr,e),Qr(n,e)}}function V8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(qr(n,e))return;i.uniform3iv(this.addr,e),Qr(n,e)}}function z8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(qr(n,e))return;i.uniform4iv(this.addr,e),Qr(n,e)}}function W8(i,e){const n=this.cache;n[0]!==e&&(i.uniform1ui(this.addr,e),n[0]=e)}function X8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(qr(n,e))return;i.uniform2uiv(this.addr,e),Qr(n,e)}}function j8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(qr(n,e))return;i.uniform3uiv(this.addr,e),Qr(n,e)}}function Y8(i,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(qr(n,e))return;i.uniform4uiv(this.addr,e),Qr(n,e)}}function K8(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTexture2D(e||OF,s)}function J8(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTexture3D(e||NF,s)}function Z8(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTextureCube(e||kF,s)}function q8(i,e,n){const r=this.cache,s=n.allocateTextureUnit();r[0]!==s&&(i.uniform1i(this.addr,s),r[0]=s),n.setTexture2DArray(e||LF,s)}function Q8(i){switch(i){case 5126:return N8;case 35664:return k8;case 35665:return P8;case 35666:return D8;case 35674:return B8;case 35675:return F8;case 35676:return U8;case 5124:case 35670:return G8;case 35667:case 35671:return H8;case 35668:case 35672:return V8;case 35669:case 35673:return z8;case 5125:return W8;case 36294:return X8;case 36295:return j8;case 36296:return Y8;case 35678:case 36198:case 36298:case 36306:case 35682:return K8;case 35679:case 36299:case 36307:return J8;case 35680:case 36300:case 36308:case 36293:return Z8;case 36289:case 36303:case 36311:case 36292:return q8}}function e6(i,e){i.uniform1fv(this.addr,e)}function t6(i,e){const n=t_(e,this.size,2);i.uniform2fv(this.addr,n)}function n6(i,e){const n=t_(e,this.size,3);i.uniform3fv(this.addr,n)}function i6(i,e){const n=t_(e,this.size,4);i.uniform4fv(this.addr,n)}function r6(i,e){const n=t_(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,n)}function s6(i,e){const n=t_(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,n)}function o6(i,e){const n=t_(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,n)}function a6(i,e){i.uniform1iv(this.addr,e)}function l6(i,e){i.uniform2iv(this.addr,e)}function c6(i,e){i.uniform3iv(this.addr,e)}function u6(i,e){i.uniform4iv(this.addr,e)}function h6(i,e){i.uniform1uiv(this.addr,e)}function d6(i,e){i.uniform2uiv(this.addr,e)}function f6(i,e){i.uniform3uiv(this.addr,e)}function p6(i,e){i.uniform4uiv(this.addr,e)}function m6(i,e,n){const r=this.cache,s=e.length,a=w$(n,s);qr(r,a)||(i.uniform1iv(this.addr,a),Qr(r,a));for(let l=0;l!==s;++l)n.setTexture2D(e[l]||OF,a[l])}function g6(i,e,n){const r=this.cache,s=e.length,a=w$(n,s);qr(r,a)||(i.uniform1iv(this.addr,a),Qr(r,a));for(let l=0;l!==s;++l)n.setTexture3D(e[l]||NF,a[l])}function _6(i,e,n){const r=this.cache,s=e.length,a=w$(n,s);qr(r,a)||(i.uniform1iv(this.addr,a),Qr(r,a));for(let l=0;l!==s;++l)n.setTextureCube(e[l]||kF,a[l])}function T6(i,e,n){const r=this.cache,s=e.length,a=w$(n,s);qr(r,a)||(i.uniform1iv(this.addr,a),Qr(r,a));for(let l=0;l!==s;++l)n.setTexture2DArray(e[l]||LF,a[l])}function v6(i){switch(i){case 5126:return e6;case 35664:return t6;case 35665:return n6;case 35666:return i6;case 35674:return r6;case 35675:return s6;case 35676:return o6;case 5124:case 35670:return a6;case 35667:case 35671:return l6;case 35668:case 35672:return c6;case 35669:case 35673:return u6;case 5125:return h6;case 36294:return d6;case 36295:return f6;case 36296:return p6;case 35678:case 36198:case 36298:case 36306:case 35682:return m6;case 35679:case 36299:case 36307:return g6;case 35680:case 36300:case 36308:case 36293:return _6;case 36289:case 36303:case 36311:case 36292:return T6}}class E6{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Q8(n.type)}}class y6{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.size=n.size,this.setValue=v6(n.type)}}class S6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const s=this.seq;for(let a=0,l=s.length;a!==l;++a){const u=s[a];u.setValue(e,n[u.id],r)}}}const yC=/(\w+)(\])?(\[|\.)?/g;function rN(i,e){i.seq.push(e),i.map[e.id]=e}function $6(i,e,n){const r=i.name,s=r.length;for(yC.lastIndex=0;;){const a=yC.exec(r),l=yC.lastIndex;let u=a[1];const d=a[2]==="]",h=a[3];if(d&&(u=u|0),h===void 0||h==="["&&l+2===s){rN(n,h===void 0?new E6(u,i,e):new y6(u,i,e));break}else{let p=n.map[u];p===void 0&&(p=new S6(u),rN(n,p)),n=p}}}class _S{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){const a=e.getActiveUniform(n,s),l=e.getUniformLocation(n,a.name);$6(a,l,this)}}setValue(e,n,r,s){const a=this.map[n];a!==void 0&&a.setValue(e,r,s)}setOptional(e,n,r){const s=n[r];s!==void 0&&this.setValue(e,r,s)}static upload(e,n,r,s){for(let a=0,l=n.length;a!==l;++a){const u=n[a],d=r[u.id];d.needsUpdate!==!1&&u.setValue(e,d.value,s)}}static seqWithValue(e,n){const r=[];for(let s=0,a=e.length;s!==a;++s){const l=e[s];l.id in n&&r.push(l)}return r}}function sN(i,e,n){const r=i.createShader(e);return i.shaderSource(r,n),i.compileShader(r),r}let b6=0;function A6(i,e){const n=i.split(`
`),r=[],s=Math.max(e-6,0),a=Math.min(e+6,n.length);for(let l=s;l<a;l++){const u=l+1;r.push(`${u===e?">":" "} ${u}: ${n[l]}`)}return r.join(`
`)}function C6(i){switch(i){case xo:return["Linear","( value )"];case vn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),["Linear","( value )"]}}function oN(i,e,n){const r=i.getShaderParameter(e,i.COMPILE_STATUS),s=i.getShaderInfoLog(e).trim();if(r&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const l=parseInt(a[1]);return n.toUpperCase()+`

`+s+`

`+A6(i.getShaderSource(e),l)}else return s}function R6(i,e){const n=C6(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function x6(i,e){let n;switch(e){case nF:n="Linear";break;case iF:n="Reinhard";break;case rF:n="OptimizedCineon";break;case iM:n="ACESFilmic";break;case sF:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+i+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function w6(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tv).join(`
`)}function M6(i){const e=[];for(const n in i){const r=i[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function I6(i,e){const n={},r=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const a=i.getActiveAttrib(e,s),l=a.name;let u=1;a.type===i.FLOAT_MAT2&&(u=2),a.type===i.FLOAT_MAT3&&(u=3),a.type===i.FLOAT_MAT4&&(u=4),n[l]={type:a.type,location:i.getAttribLocation(e,l),locationSize:u}}return n}function Tv(i){return i!==""}function aN(i,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function lN(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const O6=/^[ \t]*#include +<([\w\d./]+)>/gm;function Dx(i){return i.replace(O6,L6)}function L6(i,e){const n=Ln[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return Dx(n)}const N6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function cN(i){return i.replace(N6,k6)}function k6(i,e,n,r){let s="";for(let a=parseInt(e);a<parseInt(n);a++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function uN(i){let e="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function P6(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===S$?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===xv?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===wl&&(e="SHADOWMAP_TYPE_VSM"),e}function D6(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Lu:case ud:e="ENVMAP_TYPE_CUBE";break;case e_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function B6(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case ud:e="ENVMAP_MODE_REFRACTION";break}return e}function F6(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case vE:e="ENVMAP_BLENDING_MULTIPLY";break;case eF:e="ENVMAP_BLENDING_MIX";break;case tF:e="ENVMAP_BLENDING_ADD";break}return e}function U6(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function G6(i,e,n,r){const s=i.getContext(),a=n.defines;let l=n.vertexShader,u=n.fragmentShader;const d=P6(n),h=D6(n),f=B6(n),p=F6(n),m=U6(n),v=n.isWebGL2?"":w6(n),y=M6(a),$=s.createProgram();let E,S,A=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(E=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter(Tv).join(`
`),E.length>0&&(E+=`
`),S=[v,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter(Tv).join(`
`),S.length>0&&(S+=`
`)):(E=[uN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Tv).join(`
`),S=[v,uN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+d:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==kl?"#define TONE_MAPPING":"",n.toneMapping!==kl?Ln.tonemapping_pars_fragment:"",n.toneMapping!==kl?x6("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Ln.encodings_pars_fragment,R6("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Tv).join(`
`)),l=Dx(l),l=aN(l,n),l=lN(l,n),u=Dx(u),u=aN(u,n),u=lN(u,n),l=cN(l),u=cN(u),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(A=`#version 300 es
`,E=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,S=["#define varying in",n.glslVersion===Nx?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Nx?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const C=A+E+l,x=A+S+u,I=sN(s,s.VERTEX_SHADER,C),O=sN(s,s.FRAGMENT_SHADER,x);if(s.attachShader($,I),s.attachShader($,O),n.index0AttributeName!==void 0?s.bindAttribLocation($,0,n.index0AttributeName):n.morphTargets===!0&&s.bindAttribLocation($,0,"position"),s.linkProgram($),i.debug.checkShaderErrors){const D=s.getProgramInfoLog($).trim(),U=s.getShaderInfoLog(I).trim(),ce=s.getShaderInfoLog(O).trim();let re=!0,ae=!0;if(s.getProgramParameter($,s.LINK_STATUS)===!1)if(re=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,$,I,O);else{const ne=oN(s,I,"vertex"),de=oN(s,O,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter($,s.VALIDATE_STATUS)+`

Program Info Log: `+D+`
`+ne+`
`+de)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(U===""||ce==="")&&(ae=!1);ae&&(this.diagnostics={runnable:re,programLog:D,vertexShader:{log:U,prefix:E},fragmentShader:{log:ce,prefix:S}})}s.deleteShader(I),s.deleteShader(O);let F;this.getUniforms=function(){return F===void 0&&(F=new _S(s,$)),F};let k;return this.getAttributes=function(){return k===void 0&&(k=I6(s,$)),k},this.destroy=function(){r.releaseStatesOfProgram(this),s.deleteProgram($),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=b6++,this.cacheKey=e,this.usedTimes=1,this.program=$,this.vertexShader=I,this.fragmentShader=O,this}let H6=0;class V6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,s=this._getShaderStage(n),a=this._getShaderStage(r),l=this._getShaderCacheForMaterial(e);return l.has(s)===!1&&(l.add(s),s.usedTimes++),l.has(a)===!1&&(l.add(a),a.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new z6(e),n.set(e,r)),r}}class z6{constructor(e){this.id=H6++,this.code=e,this.usedTimes=0}}function W6(i,e,n,r,s,a,l){const u=new cp,d=new V6,h=[],f=s.isWebGL2,p=s.logarithmicDepthBuffer,m=s.vertexTextures;let v=s.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function $(D){return D===0?"uv":`uv${D}`}function E(D,U,ce,re,ae){const ne=re.fog,de=ae.geometry,ue=D.isMeshStandardMaterial?re.environment:null,Re=(D.isMeshStandardMaterial?n:e).get(D.envMap||ue),G=Re&&Re.mapping===e_?Re.image.height:null,Z=y[D.type];D.precision!==null&&(v=s.getMaxPrecision(D.precision),v!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",v,"instead."));const K=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,se=K!==void 0?K.length:0;let Y=0;de.morphAttributes.position!==void 0&&(Y=1),de.morphAttributes.normal!==void 0&&(Y=2),de.morphAttributes.color!==void 0&&(Y=3);let me,fe,Ae,Ce;if(Z){const Ke=Ol[Z];me=Ke.vertexShader,fe=Ke.fragmentShader}else me=D.vertexShader,fe=D.fragmentShader,d.update(D),Ae=d.getVertexShaderID(D),Ce=d.getFragmentShaderID(D);const Ie=i.getRenderTarget(),We=ae.isInstancedMesh===!0,ut=!!D.map,Ye=!!D.matcap,we=!!Re,Q=!!D.aoMap,Ge=!!D.lightMap,Oe=!!D.bumpMap,Ve=!!D.normalMap,Fe=!!D.displacementMap,tt=!!D.emissiveMap,Ue=!!D.metalnessMap,Je=!!D.roughnessMap,ve=D.anisotropy>0,Me=D.clearcoat>0,vt=D.iridescence>0,oe=D.sheen>0,ee=D.transmission>0,W=ve&&!!D.anisotropyMap,ot=Me&&!!D.clearcoatMap,je=Me&&!!D.clearcoatNormalMap,Qe=Me&&!!D.clearcoatRoughnessMap,ht=vt&&!!D.iridescenceMap,ft=vt&&!!D.iridescenceThicknessMap,He=oe&&!!D.sheenColorMap,St=oe&&!!D.sheenRoughnessMap,L=!!D.specularMap,X=!!D.specularColorMap,he=!!D.specularIntensityMap,z=ee&&!!D.transmissionMap,be=ee&&!!D.thicknessMap,nt=!!D.gradientMap,Ee=!!D.alphaMap,Le=D.alphaTest>0,Be=!!D.extensions,N=!!de.attributes.uv1,j=!!de.attributes.uv2,ge=!!de.attributes.uv3;return{isWebGL2:f,shaderID:Z,shaderType:D.type,shaderName:D.name,vertexShader:me,fragmentShader:fe,defines:D.defines,customVertexShaderID:Ae,customFragmentShaderID:Ce,isRawShaderMaterial:D.isRawShaderMaterial===!0,glslVersion:D.glslVersion,precision:v,instancing:We,instancingColor:We&&ae.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:Ie===null?i.outputColorSpace:Ie.isXRRenderTarget===!0?Ie.texture.colorSpace:xo,map:ut,matcap:Ye,envMap:we,envMapMode:we&&Re.mapping,envMapCubeUVHeight:G,aoMap:Q,lightMap:Ge,bumpMap:Oe,normalMap:Ve,displacementMap:m&&Fe,emissiveMap:tt,normalMapObjectSpace:Ve&&D.normalMapType===gF,normalMapTangentSpace:Ve&&D.normalMapType===Td,metalnessMap:Ue,roughnessMap:Je,anisotropy:ve,anisotropyMap:W,clearcoat:Me,clearcoatMap:ot,clearcoatNormalMap:je,clearcoatRoughnessMap:Qe,iridescence:vt,iridescenceMap:ht,iridescenceThicknessMap:ft,sheen:oe,sheenColorMap:He,sheenRoughnessMap:St,specularMap:L,specularColorMap:X,specularIntensityMap:he,transmission:ee,transmissionMap:z,thicknessMap:be,gradientMap:nt,opaque:D.transparent===!1&&D.blending===sp,alphaMap:Ee,alphaTest:Le,combine:D.combine,mapUv:ut&&$(D.map.channel),aoMapUv:Q&&$(D.aoMap.channel),lightMapUv:Ge&&$(D.lightMap.channel),bumpMapUv:Oe&&$(D.bumpMap.channel),normalMapUv:Ve&&$(D.normalMap.channel),displacementMapUv:Fe&&$(D.displacementMap.channel),emissiveMapUv:tt&&$(D.emissiveMap.channel),metalnessMapUv:Ue&&$(D.metalnessMap.channel),roughnessMapUv:Je&&$(D.roughnessMap.channel),anisotropyMapUv:W&&$(D.anisotropyMap.channel),clearcoatMapUv:ot&&$(D.clearcoatMap.channel),clearcoatNormalMapUv:je&&$(D.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Qe&&$(D.clearcoatRoughnessMap.channel),iridescenceMapUv:ht&&$(D.iridescenceMap.channel),iridescenceThicknessMapUv:ft&&$(D.iridescenceThicknessMap.channel),sheenColorMapUv:He&&$(D.sheenColorMap.channel),sheenRoughnessMapUv:St&&$(D.sheenRoughnessMap.channel),specularMapUv:L&&$(D.specularMap.channel),specularColorMapUv:X&&$(D.specularColorMap.channel),specularIntensityMapUv:he&&$(D.specularIntensityMap.channel),transmissionMapUv:z&&$(D.transmissionMap.channel),thicknessMapUv:be&&$(D.thicknessMap.channel),alphaMapUv:Ee&&$(D.alphaMap.channel),vertexTangents:!!de.attributes.tangent&&(Ve||ve),vertexColors:D.vertexColors,vertexAlphas:D.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,vertexUv1s:N,vertexUv2s:j,vertexUv3s:ge,pointsUvs:ae.isPoints===!0&&!!de.attributes.uv&&(ut||Ee),fog:!!ne,useFog:D.fog===!0,fogExp2:ne&&ne.isFogExp2,flatShading:D.flatShading===!0,sizeAttenuation:D.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:ae.isSkinnedMesh===!0,morphTargets:de.morphAttributes.position!==void 0,morphNormals:de.morphAttributes.normal!==void 0,morphColors:de.morphAttributes.color!==void 0,morphTargetsCount:se,morphTextureStride:Y,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:D.dithering,shadowMapEnabled:i.shadowMap.enabled&&ce.length>0,shadowMapType:i.shadowMap.type,toneMapping:D.toneMapped?i.toneMapping:kl,useLegacyLights:i.useLegacyLights,premultipliedAlpha:D.premultipliedAlpha,doubleSided:D.side===$s,flipSided:D.side===Hs,useDepthPacking:D.depthPacking>=0,depthPacking:D.depthPacking||0,index0AttributeName:D.index0AttributeName,extensionDerivatives:Be&&D.extensions.derivatives===!0,extensionFragDepth:Be&&D.extensions.fragDepth===!0,extensionDrawBuffers:Be&&D.extensions.drawBuffers===!0,extensionShaderTextureLOD:Be&&D.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:f||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||r.has("EXT_shader_texture_lod"),customProgramCacheKey:D.customProgramCacheKey()}}function S(D){const U=[];if(D.shaderID?U.push(D.shaderID):(U.push(D.customVertexShaderID),U.push(D.customFragmentShaderID)),D.defines!==void 0)for(const ce in D.defines)U.push(ce),U.push(D.defines[ce]);return D.isRawShaderMaterial===!1&&(A(U,D),C(U,D),U.push(i.outputColorSpace)),U.push(D.customProgramCacheKey),U.join()}function A(D,U){D.push(U.precision),D.push(U.outputColorSpace),D.push(U.envMapMode),D.push(U.envMapCubeUVHeight),D.push(U.mapUv),D.push(U.alphaMapUv),D.push(U.lightMapUv),D.push(U.aoMapUv),D.push(U.bumpMapUv),D.push(U.normalMapUv),D.push(U.displacementMapUv),D.push(U.emissiveMapUv),D.push(U.metalnessMapUv),D.push(U.roughnessMapUv),D.push(U.anisotropyMapUv),D.push(U.clearcoatMapUv),D.push(U.clearcoatNormalMapUv),D.push(U.clearcoatRoughnessMapUv),D.push(U.iridescenceMapUv),D.push(U.iridescenceThicknessMapUv),D.push(U.sheenColorMapUv),D.push(U.sheenRoughnessMapUv),D.push(U.specularMapUv),D.push(U.specularColorMapUv),D.push(U.specularIntensityMapUv),D.push(U.transmissionMapUv),D.push(U.thicknessMapUv),D.push(U.combine),D.push(U.fogExp2),D.push(U.sizeAttenuation),D.push(U.morphTargetsCount),D.push(U.morphAttributeCount),D.push(U.numDirLights),D.push(U.numPointLights),D.push(U.numSpotLights),D.push(U.numSpotLightMaps),D.push(U.numHemiLights),D.push(U.numRectAreaLights),D.push(U.numDirLightShadows),D.push(U.numPointLightShadows),D.push(U.numSpotLightShadows),D.push(U.numSpotLightShadowsWithMaps),D.push(U.shadowMapType),D.push(U.toneMapping),D.push(U.numClippingPlanes),D.push(U.numClipIntersection),D.push(U.depthPacking)}function C(D,U){u.disableAll(),U.isWebGL2&&u.enable(0),U.supportsVertexTextures&&u.enable(1),U.instancing&&u.enable(2),U.instancingColor&&u.enable(3),U.matcap&&u.enable(4),U.envMap&&u.enable(5),U.normalMapObjectSpace&&u.enable(6),U.normalMapTangentSpace&&u.enable(7),U.clearcoat&&u.enable(8),U.iridescence&&u.enable(9),U.alphaTest&&u.enable(10),U.vertexColors&&u.enable(11),U.vertexAlphas&&u.enable(12),U.vertexUv1s&&u.enable(13),U.vertexUv2s&&u.enable(14),U.vertexUv3s&&u.enable(15),U.vertexTangents&&u.enable(16),U.anisotropy&&u.enable(17),D.push(u.mask),u.disableAll(),U.fog&&u.enable(0),U.useFog&&u.enable(1),U.flatShading&&u.enable(2),U.logarithmicDepthBuffer&&u.enable(3),U.skinning&&u.enable(4),U.morphTargets&&u.enable(5),U.morphNormals&&u.enable(6),U.morphColors&&u.enable(7),U.premultipliedAlpha&&u.enable(8),U.shadowMapEnabled&&u.enable(9),U.useLegacyLights&&u.enable(10),U.doubleSided&&u.enable(11),U.flipSided&&u.enable(12),U.useDepthPacking&&u.enable(13),U.dithering&&u.enable(14),U.transmission&&u.enable(15),U.sheen&&u.enable(16),U.opaque&&u.enable(17),U.pointsUvs&&u.enable(18),D.push(u.mask)}function x(D){const U=y[D.type];let ce;if(U){const re=Ol[U];ce=oE.clone(re.uniforms)}else ce=D.uniforms;return ce}function I(D,U){let ce;for(let re=0,ae=h.length;re<ae;re++){const ne=h[re];if(ne.cacheKey===U){ce=ne,++ce.usedTimes;break}}return ce===void 0&&(ce=new G6(i,U,D,a),h.push(ce)),ce}function O(D){if(--D.usedTimes===0){const U=h.indexOf(D);h[U]=h[h.length-1],h.pop(),D.destroy()}}function F(D){d.remove(D)}function k(){d.dispose()}return{getParameters:E,getProgramCacheKey:S,getUniforms:x,acquireProgram:I,releaseProgram:O,releaseShaderCache:F,programs:h,dispose:k}}function X6(){let i=new WeakMap;function e(a){let l=i.get(a);return l===void 0&&(l={},i.set(a,l)),l}function n(a){i.delete(a)}function r(a,l,u){i.get(a)[l]=u}function s(){i=new WeakMap}return{get:e,remove:n,update:r,dispose:s}}function j6(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function hN(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function dN(){const i=[];let e=0;const n=[],r=[],s=[];function a(){e=0,n.length=0,r.length=0,s.length=0}function l(p,m,v,y,$,E){let S=i[e];return S===void 0?(S={id:p.id,object:p,geometry:m,material:v,groupOrder:y,renderOrder:p.renderOrder,z:$,group:E},i[e]=S):(S.id=p.id,S.object=p,S.geometry=m,S.material=v,S.groupOrder=y,S.renderOrder=p.renderOrder,S.z=$,S.group=E),e++,S}function u(p,m,v,y,$,E){const S=l(p,m,v,y,$,E);v.transmission>0?r.push(S):v.transparent===!0?s.push(S):n.push(S)}function d(p,m,v,y,$,E){const S=l(p,m,v,y,$,E);v.transmission>0?r.unshift(S):v.transparent===!0?s.unshift(S):n.unshift(S)}function h(p,m){n.length>1&&n.sort(p||j6),r.length>1&&r.sort(m||hN),s.length>1&&s.sort(m||hN)}function f(){for(let p=e,m=i.length;p<m;p++){const v=i[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:n,transmissive:r,transparent:s,init:a,push:u,unshift:d,finish:f,sort:h}}function Y6(){let i=new WeakMap;function e(r,s){const a=i.get(r);let l;return a===void 0?(l=new dN,i.set(r,[l])):s>=a.length?(l=new dN,a.push(l)):l=a[s],l}function n(){i=new WeakMap}return{get:e,dispose:n}}function K6(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ie,color:new xt};break;case"SpotLight":n={position:new ie,direction:new ie,color:new xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ie,color:new xt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ie,skyColor:new xt,groundColor:new xt};break;case"RectAreaLight":n={color:new xt,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return i[e.id]=n,n}}}function J6(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mt};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=n,n}}}let Z6=0;function q6(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Q6(i,e){const n=new K6,r=J6(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let f=0;f<9;f++)s.probe.push(new ie);const a=new ie,l=new pn,u=new pn;function d(f,p){let m=0,v=0,y=0;for(let ce=0;ce<9;ce++)s.probe[ce].set(0,0,0);let $=0,E=0,S=0,A=0,C=0,x=0,I=0,O=0,F=0,k=0;f.sort(q6);const D=p===!0?Math.PI:1;for(let ce=0,re=f.length;ce<re;ce++){const ae=f[ce],ne=ae.color,de=ae.intensity,ue=ae.distance,Re=ae.shadow&&ae.shadow.map?ae.shadow.map.texture:null;if(ae.isAmbientLight)m+=ne.r*de*D,v+=ne.g*de*D,y+=ne.b*de*D;else if(ae.isLightProbe)for(let G=0;G<9;G++)s.probe[G].addScaledVector(ae.sh.coefficients[G],de);else if(ae.isDirectionalLight){const G=n.get(ae);if(G.color.copy(ae.color).multiplyScalar(ae.intensity*D),ae.castShadow){const Z=ae.shadow,K=r.get(ae);K.shadowBias=Z.bias,K.shadowNormalBias=Z.normalBias,K.shadowRadius=Z.radius,K.shadowMapSize=Z.mapSize,s.directionalShadow[$]=K,s.directionalShadowMap[$]=Re,s.directionalShadowMatrix[$]=ae.shadow.matrix,x++}s.directional[$]=G,$++}else if(ae.isSpotLight){const G=n.get(ae);G.position.setFromMatrixPosition(ae.matrixWorld),G.color.copy(ne).multiplyScalar(de*D),G.distance=ue,G.coneCos=Math.cos(ae.angle),G.penumbraCos=Math.cos(ae.angle*(1-ae.penumbra)),G.decay=ae.decay,s.spot[S]=G;const Z=ae.shadow;if(ae.map&&(s.spotLightMap[F]=ae.map,F++,Z.updateMatrices(ae),ae.castShadow&&k++),s.spotLightMatrix[S]=Z.matrix,ae.castShadow){const K=r.get(ae);K.shadowBias=Z.bias,K.shadowNormalBias=Z.normalBias,K.shadowRadius=Z.radius,K.shadowMapSize=Z.mapSize,s.spotShadow[S]=K,s.spotShadowMap[S]=Re,O++}S++}else if(ae.isRectAreaLight){const G=n.get(ae);G.color.copy(ne).multiplyScalar(de),G.halfWidth.set(ae.width*.5,0,0),G.halfHeight.set(0,ae.height*.5,0),s.rectArea[A]=G,A++}else if(ae.isPointLight){const G=n.get(ae);if(G.color.copy(ae.color).multiplyScalar(ae.intensity*D),G.distance=ae.distance,G.decay=ae.decay,ae.castShadow){const Z=ae.shadow,K=r.get(ae);K.shadowBias=Z.bias,K.shadowNormalBias=Z.normalBias,K.shadowRadius=Z.radius,K.shadowMapSize=Z.mapSize,K.shadowCameraNear=Z.camera.near,K.shadowCameraFar=Z.camera.far,s.pointShadow[E]=K,s.pointShadowMap[E]=Re,s.pointShadowMatrix[E]=ae.shadow.matrix,I++}s.point[E]=G,E++}else if(ae.isHemisphereLight){const G=n.get(ae);G.skyColor.copy(ae.color).multiplyScalar(de*D),G.groundColor.copy(ae.groundColor).multiplyScalar(de*D),s.hemi[C]=G,C++}}A>0&&(e.isWebGL2||i.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Lt.LTC_FLOAT_1,s.rectAreaLTC2=Lt.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=Lt.LTC_HALF_1,s.rectAreaLTC2=Lt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=m,s.ambient[1]=v,s.ambient[2]=y;const U=s.hash;(U.directionalLength!==$||U.pointLength!==E||U.spotLength!==S||U.rectAreaLength!==A||U.hemiLength!==C||U.numDirectionalShadows!==x||U.numPointShadows!==I||U.numSpotShadows!==O||U.numSpotMaps!==F)&&(s.directional.length=$,s.spot.length=S,s.rectArea.length=A,s.point.length=E,s.hemi.length=C,s.directionalShadow.length=x,s.directionalShadowMap.length=x,s.pointShadow.length=I,s.pointShadowMap.length=I,s.spotShadow.length=O,s.spotShadowMap.length=O,s.directionalShadowMatrix.length=x,s.pointShadowMatrix.length=I,s.spotLightMatrix.length=O+F-k,s.spotLightMap.length=F,s.numSpotLightShadowsWithMaps=k,U.directionalLength=$,U.pointLength=E,U.spotLength=S,U.rectAreaLength=A,U.hemiLength=C,U.numDirectionalShadows=x,U.numPointShadows=I,U.numSpotShadows=O,U.numSpotMaps=F,s.version=Z6++)}function h(f,p){let m=0,v=0,y=0,$=0,E=0;const S=p.matrixWorldInverse;for(let A=0,C=f.length;A<C;A++){const x=f[A];if(x.isDirectionalLight){const I=s.directional[m];I.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),I.direction.sub(a),I.direction.transformDirection(S),m++}else if(x.isSpotLight){const I=s.spot[y];I.position.setFromMatrixPosition(x.matrixWorld),I.position.applyMatrix4(S),I.direction.setFromMatrixPosition(x.matrixWorld),a.setFromMatrixPosition(x.target.matrixWorld),I.direction.sub(a),I.direction.transformDirection(S),y++}else if(x.isRectAreaLight){const I=s.rectArea[$];I.position.setFromMatrixPosition(x.matrixWorld),I.position.applyMatrix4(S),u.identity(),l.copy(x.matrixWorld),l.premultiply(S),u.extractRotation(l),I.halfWidth.set(x.width*.5,0,0),I.halfHeight.set(0,x.height*.5,0),I.halfWidth.applyMatrix4(u),I.halfHeight.applyMatrix4(u),$++}else if(x.isPointLight){const I=s.point[v];I.position.setFromMatrixPosition(x.matrixWorld),I.position.applyMatrix4(S),v++}else if(x.isHemisphereLight){const I=s.hemi[E];I.direction.setFromMatrixPosition(x.matrixWorld),I.direction.transformDirection(S),E++}}}return{setup:d,setupView:h,state:s}}function fN(i,e){const n=new Q6(i,e),r=[],s=[];function a(){r.length=0,s.length=0}function l(p){r.push(p)}function u(p){s.push(p)}function d(p){n.setup(r,p)}function h(p){n.setupView(r,p)}return{init:a,state:{lightsArray:r,shadowsArray:s,lights:n},setupLights:d,setupLightsView:h,pushLight:l,pushShadow:u}}function eX(i,e){let n=new WeakMap;function r(a,l=0){const u=n.get(a);let d;return u===void 0?(d=new fN(i,e),n.set(a,[d])):l>=u.length?(d=new fN(i,e),u.push(d)):d=u[l],d}function s(){n=new WeakMap}return{get:r,dispose:s}}class M$ extends ir{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=mF,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class I$ extends ir{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const tX=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,nX=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function iX(i,e,n){let r=new x$;const s=new mt,a=new mt,l=new Hn,u=new M$({depthPacking:pM}),d=new I$,h={},f=n.maxTextureSize,p={[za]:Hs,[Hs]:za,[$s]:$s},m=new wo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new mt},radius:{value:4}},vertexShader:tX,fragmentShader:nX}),v=m.clone();v.defines.HORIZONTAL_PASS=1;const y=new on;y.setAttribute("position",new Qn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const $=new Bn(y,m),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=S$;let S=this.type;this.render=function(I,O,F){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||I.length===0)return;const k=i.getRenderTarget(),D=i.getActiveCubeFace(),U=i.getActiveMipmapLevel(),ce=i.state;ce.setBlending(Cc),ce.buffers.color.setClear(1,1,1,1),ce.buffers.depth.setTest(!0),ce.setScissorTest(!1);const re=S!==wl&&this.type===wl,ae=S===wl&&this.type!==wl;for(let ne=0,de=I.length;ne<de;ne++){const ue=I[ne],Re=ue.shadow;if(Re===void 0){console.warn("THREE.WebGLShadowMap:",ue,"has no shadow.");continue}if(Re.autoUpdate===!1&&Re.needsUpdate===!1)continue;s.copy(Re.mapSize);const G=Re.getFrameExtents();if(s.multiply(G),a.copy(Re.mapSize),(s.x>f||s.y>f)&&(s.x>f&&(a.x=Math.floor(f/G.x),s.x=a.x*G.x,Re.mapSize.x=a.x),s.y>f&&(a.y=Math.floor(f/G.y),s.y=a.y*G.y,Re.mapSize.y=a.y)),Re.map===null||re===!0||ae===!0){const K=this.type!==wl?{minFilter:er,magFilter:er}:{};Re.map!==null&&Re.map.dispose(),Re.map=new lo(s.x,s.y,K),Re.map.texture.name=ue.name+".shadowMap",Re.camera.updateProjectionMatrix()}i.setRenderTarget(Re.map),i.clear();const Z=Re.getViewportCount();for(let K=0;K<Z;K++){const se=Re.getViewport(K);l.set(a.x*se.x,a.y*se.y,a.x*se.z,a.y*se.w),ce.viewport(l),Re.updateMatrices(ue,K),r=Re.getFrustum(),x(O,F,Re.camera,ue,this.type)}Re.isPointLightShadow!==!0&&this.type===wl&&A(Re,F),Re.needsUpdate=!1}S=this.type,E.needsUpdate=!1,i.setRenderTarget(k,D,U)};function A(I,O){const F=e.update($);m.defines.VSM_SAMPLES!==I.blurSamples&&(m.defines.VSM_SAMPLES=I.blurSamples,v.defines.VSM_SAMPLES=I.blurSamples,m.needsUpdate=!0,v.needsUpdate=!0),I.mapPass===null&&(I.mapPass=new lo(s.x,s.y)),m.uniforms.shadow_pass.value=I.map.texture,m.uniforms.resolution.value=I.mapSize,m.uniforms.radius.value=I.radius,i.setRenderTarget(I.mapPass),i.clear(),i.renderBufferDirect(O,null,F,m,$,null),v.uniforms.shadow_pass.value=I.mapPass.texture,v.uniforms.resolution.value=I.mapSize,v.uniforms.radius.value=I.radius,i.setRenderTarget(I.map),i.clear(),i.renderBufferDirect(O,null,F,v,$,null)}function C(I,O,F,k){let D=null;const U=F.isPointLight===!0?I.customDistanceMaterial:I.customDepthMaterial;if(U!==void 0)D=U;else if(D=F.isPointLight===!0?d:u,i.localClippingEnabled&&O.clipShadows===!0&&Array.isArray(O.clippingPlanes)&&O.clippingPlanes.length!==0||O.displacementMap&&O.displacementScale!==0||O.alphaMap&&O.alphaTest>0||O.map&&O.alphaTest>0){const ce=D.uuid,re=O.uuid;let ae=h[ce];ae===void 0&&(ae={},h[ce]=ae);let ne=ae[re];ne===void 0&&(ne=D.clone(),ae[re]=ne),D=ne}if(D.visible=O.visible,D.wireframe=O.wireframe,k===wl?D.side=O.shadowSide!==null?O.shadowSide:O.side:D.side=O.shadowSide!==null?O.shadowSide:p[O.side],D.alphaMap=O.alphaMap,D.alphaTest=O.alphaTest,D.map=O.map,D.clipShadows=O.clipShadows,D.clippingPlanes=O.clippingPlanes,D.clipIntersection=O.clipIntersection,D.displacementMap=O.displacementMap,D.displacementScale=O.displacementScale,D.displacementBias=O.displacementBias,D.wireframeLinewidth=O.wireframeLinewidth,D.linewidth=O.linewidth,F.isPointLight===!0&&D.isMeshDistanceMaterial===!0){const ce=i.properties.get(D);ce.light=F}return D}function x(I,O,F,k,D){if(I.visible===!1)return;if(I.layers.test(O.layers)&&(I.isMesh||I.isLine||I.isPoints)&&(I.castShadow||I.receiveShadow&&D===wl)&&(!I.frustumCulled||r.intersectsObject(I))){I.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,I.matrixWorld);const re=e.update(I),ae=I.material;if(Array.isArray(ae)){const ne=re.groups;for(let de=0,ue=ne.length;de<ue;de++){const Re=ne[de],G=ae[Re.materialIndex];if(G&&G.visible){const Z=C(I,G,k,D);i.renderBufferDirect(F,null,re,Z,I,Re)}}}else if(ae.visible){const ne=C(I,ae,k,D);i.renderBufferDirect(F,null,re,ne,I,null)}}const ce=I.children;for(let re=0,ae=ce.length;re<ae;re++)x(ce[re],O,F,k,D)}}function rX(i,e,n){const r=n.isWebGL2;function s(){let Ee=!1;const Le=new Hn;let Be=null;const N=new Hn(0,0,0,0);return{setMask:function(j){Be!==j&&!Ee&&(i.colorMask(j,j,j,j),Be=j)},setLocked:function(j){Ee=j},setClear:function(j,ge,xe,Ke,gt){gt===!0&&(j*=Ke,ge*=Ke,xe*=Ke),Le.set(j,ge,xe,Ke),N.equals(Le)===!1&&(i.clearColor(j,ge,xe,Ke),N.copy(Le))},reset:function(){Ee=!1,Be=null,N.set(-1,0,0,0)}}}function a(){let Ee=!1,Le=null,Be=null,N=null;return{setTest:function(j){j?Ie(i.DEPTH_TEST):We(i.DEPTH_TEST)},setMask:function(j){Le!==j&&!Ee&&(i.depthMask(j),Le=j)},setFunc:function(j){if(Be!==j){switch(j){case jB:i.depthFunc(i.NEVER);break;case YB:i.depthFunc(i.ALWAYS);break;case KB:i.depthFunc(i.LESS);break;case WS:i.depthFunc(i.LEQUAL);break;case JB:i.depthFunc(i.EQUAL);break;case ZB:i.depthFunc(i.GEQUAL);break;case qB:i.depthFunc(i.GREATER);break;case QB:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Be=j}},setLocked:function(j){Ee=j},setClear:function(j){N!==j&&(i.clearDepth(j),N=j)},reset:function(){Ee=!1,Le=null,Be=null,N=null}}}function l(){let Ee=!1,Le=null,Be=null,N=null,j=null,ge=null,xe=null,Ke=null,gt=null;return{setTest:function($t){Ee||($t?Ie(i.STENCIL_TEST):We(i.STENCIL_TEST))},setMask:function($t){Le!==$t&&!Ee&&(i.stencilMask($t),Le=$t)},setFunc:function($t,un,an){(Be!==$t||N!==un||j!==an)&&(i.stencilFunc($t,un,an),Be=$t,N=un,j=an)},setOp:function($t,un,an){(ge!==$t||xe!==un||Ke!==an)&&(i.stencilOp($t,un,an),ge=$t,xe=un,Ke=an)},setLocked:function($t){Ee=$t},setClear:function($t){gt!==$t&&(i.clearStencil($t),gt=$t)},reset:function(){Ee=!1,Le=null,Be=null,N=null,j=null,ge=null,xe=null,Ke=null,gt=null}}}const u=new s,d=new a,h=new l,f=new WeakMap,p=new WeakMap;let m={},v={},y=new WeakMap,$=[],E=null,S=!1,A=null,C=null,x=null,I=null,O=null,F=null,k=null,D=!1,U=null,ce=null,re=null,ae=null,ne=null;const de=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ue=!1,Re=0;const G=i.getParameter(i.VERSION);G.indexOf("WebGL")!==-1?(Re=parseFloat(/^WebGL (\d)/.exec(G)[1]),ue=Re>=1):G.indexOf("OpenGL ES")!==-1&&(Re=parseFloat(/^OpenGL ES (\d)/.exec(G)[1]),ue=Re>=2);let Z=null,K={};const se=i.getParameter(i.SCISSOR_BOX),Y=i.getParameter(i.VIEWPORT),me=new Hn().fromArray(se),fe=new Hn().fromArray(Y);function Ae(Ee,Le,Be,N){const j=new Uint8Array(4),ge=i.createTexture();i.bindTexture(Ee,ge),i.texParameteri(Ee,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(Ee,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let xe=0;xe<Be;xe++)r&&(Ee===i.TEXTURE_3D||Ee===i.TEXTURE_2D_ARRAY)?i.texImage3D(Le,0,i.RGBA,1,1,N,0,i.RGBA,i.UNSIGNED_BYTE,j):i.texImage2D(Le+xe,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,j);return ge}const Ce={};Ce[i.TEXTURE_2D]=Ae(i.TEXTURE_2D,i.TEXTURE_2D,1),Ce[i.TEXTURE_CUBE_MAP]=Ae(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Ce[i.TEXTURE_2D_ARRAY]=Ae(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ce[i.TEXTURE_3D]=Ae(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),u.setClear(0,0,0,1),d.setClear(1),h.setClear(0),Ie(i.DEPTH_TEST),d.setFunc(WS),Fe(!1),tt(rx),Ie(i.CULL_FACE),Oe(Cc);function Ie(Ee){m[Ee]!==!0&&(i.enable(Ee),m[Ee]=!0)}function We(Ee){m[Ee]!==!1&&(i.disable(Ee),m[Ee]=!1)}function ut(Ee,Le){return v[Ee]!==Le?(i.bindFramebuffer(Ee,Le),v[Ee]=Le,r&&(Ee===i.DRAW_FRAMEBUFFER&&(v[i.FRAMEBUFFER]=Le),Ee===i.FRAMEBUFFER&&(v[i.DRAW_FRAMEBUFFER]=Le)),!0):!1}function Ye(Ee,Le){let Be=$,N=!1;if(Ee)if(Be=y.get(Le),Be===void 0&&(Be=[],y.set(Le,Be)),Ee.isWebGLMultipleRenderTargets){const j=Ee.texture;if(Be.length!==j.length||Be[0]!==i.COLOR_ATTACHMENT0){for(let ge=0,xe=j.length;ge<xe;ge++)Be[ge]=i.COLOR_ATTACHMENT0+ge;Be.length=j.length,N=!0}}else Be[0]!==i.COLOR_ATTACHMENT0&&(Be[0]=i.COLOR_ATTACHMENT0,N=!0);else Be[0]!==i.BACK&&(Be[0]=i.BACK,N=!0);N&&(n.isWebGL2?i.drawBuffers(Be):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Be))}function we(Ee){return E!==Ee?(i.useProgram(Ee),E=Ee,!0):!1}const Q={[Vf]:i.FUNC_ADD,[PB]:i.FUNC_SUBTRACT,[DB]:i.FUNC_REVERSE_SUBTRACT};if(r)Q[lx]=i.MIN,Q[cx]=i.MAX;else{const Ee=e.get("EXT_blend_minmax");Ee!==null&&(Q[lx]=Ee.MIN_EXT,Q[cx]=Ee.MAX_EXT)}const Ge={[BB]:i.ZERO,[FB]:i.ONE,[UB]:i.SRC_COLOR,[tM]:i.SRC_ALPHA,[XB]:i.SRC_ALPHA_SATURATE,[zB]:i.DST_COLOR,[HB]:i.DST_ALPHA,[GB]:i.ONE_MINUS_SRC_COLOR,[nM]:i.ONE_MINUS_SRC_ALPHA,[WB]:i.ONE_MINUS_DST_COLOR,[VB]:i.ONE_MINUS_DST_ALPHA};function Oe(Ee,Le,Be,N,j,ge,xe,Ke){if(Ee===Cc){S===!0&&(We(i.BLEND),S=!1);return}if(S===!1&&(Ie(i.BLEND),S=!0),Ee!==kB){if(Ee!==A||Ke!==D){if((C!==Vf||O!==Vf)&&(i.blendEquation(i.FUNC_ADD),C=Vf,O=Vf),Ke)switch(Ee){case sp:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case sx:i.blendFunc(i.ONE,i.ONE);break;case ox:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case ax:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ee);break}else switch(Ee){case sp:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case sx:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case ox:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case ax:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ee);break}x=null,I=null,F=null,k=null,A=Ee,D=Ke}return}j=j||Le,ge=ge||Be,xe=xe||N,(Le!==C||j!==O)&&(i.blendEquationSeparate(Q[Le],Q[j]),C=Le,O=j),(Be!==x||N!==I||ge!==F||xe!==k)&&(i.blendFuncSeparate(Ge[Be],Ge[N],Ge[ge],Ge[xe]),x=Be,I=N,F=ge,k=xe),A=Ee,D=!1}function Ve(Ee,Le){Ee.side===$s?We(i.CULL_FACE):Ie(i.CULL_FACE);let Be=Ee.side===Hs;Le&&(Be=!Be),Fe(Be),Ee.blending===sp&&Ee.transparent===!1?Oe(Cc):Oe(Ee.blending,Ee.blendEquation,Ee.blendSrc,Ee.blendDst,Ee.blendEquationAlpha,Ee.blendSrcAlpha,Ee.blendDstAlpha,Ee.premultipliedAlpha),d.setFunc(Ee.depthFunc),d.setTest(Ee.depthTest),d.setMask(Ee.depthWrite),u.setMask(Ee.colorWrite);const N=Ee.stencilWrite;h.setTest(N),N&&(h.setMask(Ee.stencilWriteMask),h.setFunc(Ee.stencilFunc,Ee.stencilRef,Ee.stencilFuncMask),h.setOp(Ee.stencilFail,Ee.stencilZFail,Ee.stencilZPass)),Je(Ee.polygonOffset,Ee.polygonOffsetFactor,Ee.polygonOffsetUnits),Ee.alphaToCoverage===!0?Ie(i.SAMPLE_ALPHA_TO_COVERAGE):We(i.SAMPLE_ALPHA_TO_COVERAGE)}function Fe(Ee){U!==Ee&&(Ee?i.frontFace(i.CW):i.frontFace(i.CCW),U=Ee)}function tt(Ee){Ee!==OB?(Ie(i.CULL_FACE),Ee!==ce&&(Ee===rx?i.cullFace(i.BACK):Ee===LB?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):We(i.CULL_FACE),ce=Ee}function Ue(Ee){Ee!==re&&(ue&&i.lineWidth(Ee),re=Ee)}function Je(Ee,Le,Be){Ee?(Ie(i.POLYGON_OFFSET_FILL),(ae!==Le||ne!==Be)&&(i.polygonOffset(Le,Be),ae=Le,ne=Be)):We(i.POLYGON_OFFSET_FILL)}function ve(Ee){Ee?Ie(i.SCISSOR_TEST):We(i.SCISSOR_TEST)}function Me(Ee){Ee===void 0&&(Ee=i.TEXTURE0+de-1),Z!==Ee&&(i.activeTexture(Ee),Z=Ee)}function vt(Ee,Le,Be){Be===void 0&&(Z===null?Be=i.TEXTURE0+de-1:Be=Z);let N=K[Be];N===void 0&&(N={type:void 0,texture:void 0},K[Be]=N),(N.type!==Ee||N.texture!==Le)&&(Z!==Be&&(i.activeTexture(Be),Z=Be),i.bindTexture(Ee,Le||Ce[Ee]),N.type=Ee,N.texture=Le)}function oe(){const Ee=K[Z];Ee!==void 0&&Ee.type!==void 0&&(i.bindTexture(Ee.type,null),Ee.type=void 0,Ee.texture=void 0)}function ee(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function W(){try{i.compressedTexImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function ot(){try{i.texSubImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function je(){try{i.texSubImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function Qe(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function ht(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function ft(){try{i.texStorage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function He(){try{i.texStorage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function St(){try{i.texImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function L(){try{i.texImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function X(Ee){me.equals(Ee)===!1&&(i.scissor(Ee.x,Ee.y,Ee.z,Ee.w),me.copy(Ee))}function he(Ee){fe.equals(Ee)===!1&&(i.viewport(Ee.x,Ee.y,Ee.z,Ee.w),fe.copy(Ee))}function z(Ee,Le){let Be=p.get(Le);Be===void 0&&(Be=new WeakMap,p.set(Le,Be));let N=Be.get(Ee);N===void 0&&(N=i.getUniformBlockIndex(Le,Ee.name),Be.set(Ee,N))}function be(Ee,Le){const N=p.get(Le).get(Ee);f.get(Le)!==N&&(i.uniformBlockBinding(Le,N,Ee.__bindingPointIndex),f.set(Le,N))}function nt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),r===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},Z=null,K={},v={},y=new WeakMap,$=[],E=null,S=!1,A=null,C=null,x=null,I=null,O=null,F=null,k=null,D=!1,U=null,ce=null,re=null,ae=null,ne=null,me.set(0,0,i.canvas.width,i.canvas.height),fe.set(0,0,i.canvas.width,i.canvas.height),u.reset(),d.reset(),h.reset()}return{buffers:{color:u,depth:d,stencil:h},enable:Ie,disable:We,bindFramebuffer:ut,drawBuffers:Ye,useProgram:we,setBlending:Oe,setMaterial:Ve,setFlipSided:Fe,setCullFace:tt,setLineWidth:Ue,setPolygonOffset:Je,setScissorTest:ve,activeTexture:Me,bindTexture:vt,unbindTexture:oe,compressedTexImage2D:ee,compressedTexImage3D:W,texImage2D:St,texImage3D:L,updateUBOMapping:z,uniformBlockBinding:be,texStorage2D:ft,texStorage3D:He,texSubImage2D:ot,texSubImage3D:je,compressedTexSubImage2D:Qe,compressedTexSubImage3D:ht,scissor:X,viewport:he,reset:nt}}function sX(i,e,n,r,s,a,l){const u=s.isWebGL2,d=s.maxTextures,h=s.maxCubemapSize,f=s.maxTextureSize,p=s.maxSamples,m=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),y=new WeakMap;let $;const E=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(oe,ee){return S?new OffscreenCanvas(oe,ee):sE("canvas")}function C(oe,ee,W,ot){let je=1;if((oe.width>ot||oe.height>ot)&&(je=ot/Math.max(oe.width,oe.height)),je<1||ee===!0)if(typeof HTMLImageElement<"u"&&oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&oe instanceof ImageBitmap){const Qe=ee?jS:Math.floor,ht=Qe(je*oe.width),ft=Qe(je*oe.height);$===void 0&&($=A(ht,ft));const He=W?A(ht,ft):$;return He.width=ht,He.height=ft,He.getContext("2d").drawImage(oe,0,0,ht,ft),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+oe.width+"x"+oe.height+") to ("+ht+"x"+ft+")."),He}else return"data"in oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+oe.width+"x"+oe.height+")."),oe;return oe}function x(oe){return kx(oe.width)&&kx(oe.height)}function I(oe){return u?!1:oe.wrapS!==Pi||oe.wrapT!==Pi||oe.minFilter!==er&&oe.minFilter!==Dn}function O(oe,ee){return oe.generateMipmaps&&ee&&oe.minFilter!==er&&oe.minFilter!==Dn}function F(oe){i.generateMipmap(oe)}function k(oe,ee,W,ot,je=!1){if(u===!1)return ee;if(oe!==null){if(i[oe]!==void 0)return i[oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+oe+"'")}let Qe=ee;return ee===i.RED&&(W===i.FLOAT&&(Qe=i.R32F),W===i.HALF_FLOAT&&(Qe=i.R16F),W===i.UNSIGNED_BYTE&&(Qe=i.R8)),ee===i.RG&&(W===i.FLOAT&&(Qe=i.RG32F),W===i.HALF_FLOAT&&(Qe=i.RG16F),W===i.UNSIGNED_BYTE&&(Qe=i.RG8)),ee===i.RGBA&&(W===i.FLOAT&&(Qe=i.RGBA32F),W===i.HALF_FLOAT&&(Qe=i.RGBA16F),W===i.UNSIGNED_BYTE&&(Qe=ot===vn&&je===!1?i.SRGB8_ALPHA8:i.RGBA8),W===i.UNSIGNED_SHORT_4_4_4_4&&(Qe=i.RGBA4),W===i.UNSIGNED_SHORT_5_5_5_1&&(Qe=i.RGB5_A1)),(Qe===i.R16F||Qe===i.R32F||Qe===i.RG16F||Qe===i.RG32F||Qe===i.RGBA16F||Qe===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Qe}function D(oe,ee,W){return O(oe,W)===!0||oe.isFramebufferTexture&&oe.minFilter!==er&&oe.minFilter!==Dn?Math.log2(Math.max(ee.width,ee.height))+1:oe.mipmaps!==void 0&&oe.mipmaps.length>0?oe.mipmaps.length:oe.isCompressedTexture&&Array.isArray(oe.image)?ee.mipmaps.length:1}function U(oe){return oe===er||oe===Wg||oe===op?i.NEAREST:i.LINEAR}function ce(oe){const ee=oe.target;ee.removeEventListener("dispose",ce),ae(ee),ee.isVideoTexture&&y.delete(ee)}function re(oe){const ee=oe.target;ee.removeEventListener("dispose",re),de(ee)}function ae(oe){const ee=r.get(oe);if(ee.__webglInit===void 0)return;const W=oe.source,ot=E.get(W);if(ot){const je=ot[ee.__cacheKey];je.usedTimes--,je.usedTimes===0&&ne(oe),Object.keys(ot).length===0&&E.delete(W)}r.remove(oe)}function ne(oe){const ee=r.get(oe);i.deleteTexture(ee.__webglTexture);const W=oe.source,ot=E.get(W);delete ot[ee.__cacheKey],l.memory.textures--}function de(oe){const ee=oe.texture,W=r.get(oe),ot=r.get(ee);if(ot.__webglTexture!==void 0&&(i.deleteTexture(ot.__webglTexture),l.memory.textures--),oe.depthTexture&&oe.depthTexture.dispose(),oe.isWebGLCubeRenderTarget)for(let je=0;je<6;je++)i.deleteFramebuffer(W.__webglFramebuffer[je]),W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer[je]);else{if(i.deleteFramebuffer(W.__webglFramebuffer),W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&i.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let je=0;je<W.__webglColorRenderbuffer.length;je++)W.__webglColorRenderbuffer[je]&&i.deleteRenderbuffer(W.__webglColorRenderbuffer[je]);W.__webglDepthRenderbuffer&&i.deleteRenderbuffer(W.__webglDepthRenderbuffer)}if(oe.isWebGLMultipleRenderTargets)for(let je=0,Qe=ee.length;je<Qe;je++){const ht=r.get(ee[je]);ht.__webglTexture&&(i.deleteTexture(ht.__webglTexture),l.memory.textures--),r.remove(ee[je])}r.remove(ee),r.remove(oe)}let ue=0;function Re(){ue=0}function G(){const oe=ue;return oe>=d&&console.warn("THREE.WebGLTextures: Trying to use "+oe+" texture units while this GPU supports only "+d),ue+=1,oe}function Z(oe){const ee=[];return ee.push(oe.wrapS),ee.push(oe.wrapT),ee.push(oe.wrapR||0),ee.push(oe.magFilter),ee.push(oe.minFilter),ee.push(oe.anisotropy),ee.push(oe.internalFormat),ee.push(oe.format),ee.push(oe.type),ee.push(oe.generateMipmaps),ee.push(oe.premultiplyAlpha),ee.push(oe.flipY),ee.push(oe.unpackAlignment),ee.push(oe.colorSpace),ee.join()}function K(oe,ee){const W=r.get(oe);if(oe.isVideoTexture&&Me(oe),oe.isRenderTargetTexture===!1&&oe.version>0&&W.__version!==oe.version){const ot=oe.image;if(ot===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ot.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ut(W,oe,ee);return}}n.bindTexture(i.TEXTURE_2D,W.__webglTexture,i.TEXTURE0+ee)}function se(oe,ee){const W=r.get(oe);if(oe.version>0&&W.__version!==oe.version){ut(W,oe,ee);return}n.bindTexture(i.TEXTURE_2D_ARRAY,W.__webglTexture,i.TEXTURE0+ee)}function Y(oe,ee){const W=r.get(oe);if(oe.version>0&&W.__version!==oe.version){ut(W,oe,ee);return}n.bindTexture(i.TEXTURE_3D,W.__webglTexture,i.TEXTURE0+ee)}function me(oe,ee){const W=r.get(oe);if(oe.version>0&&W.__version!==oe.version){Ye(W,oe,ee);return}n.bindTexture(i.TEXTURE_CUBE_MAP,W.__webglTexture,i.TEXTURE0+ee)}const fe={[Bl]:i.REPEAT,[Pi]:i.CLAMP_TO_EDGE,[yp]:i.MIRRORED_REPEAT},Ae={[er]:i.NEAREST,[Wg]:i.NEAREST_MIPMAP_NEAREST,[op]:i.NEAREST_MIPMAP_LINEAR,[Dn]:i.LINEAR,[EE]:i.LINEAR_MIPMAP_NEAREST,[Wa]:i.LINEAR_MIPMAP_LINEAR},Ce={[TF]:i.NEVER,[AF]:i.ALWAYS,[vF]:i.LESS,[yF]:i.LEQUAL,[EF]:i.EQUAL,[bF]:i.GEQUAL,[SF]:i.GREATER,[$F]:i.NOTEQUAL};function Ie(oe,ee,W){if(W?(i.texParameteri(oe,i.TEXTURE_WRAP_S,fe[ee.wrapS]),i.texParameteri(oe,i.TEXTURE_WRAP_T,fe[ee.wrapT]),(oe===i.TEXTURE_3D||oe===i.TEXTURE_2D_ARRAY)&&i.texParameteri(oe,i.TEXTURE_WRAP_R,fe[ee.wrapR]),i.texParameteri(oe,i.TEXTURE_MAG_FILTER,Ae[ee.magFilter]),i.texParameteri(oe,i.TEXTURE_MIN_FILTER,Ae[ee.minFilter])):(i.texParameteri(oe,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(oe,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(oe===i.TEXTURE_3D||oe===i.TEXTURE_2D_ARRAY)&&i.texParameteri(oe,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(ee.wrapS!==Pi||ee.wrapT!==Pi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(oe,i.TEXTURE_MAG_FILTER,U(ee.magFilter)),i.texParameteri(oe,i.TEXTURE_MIN_FILTER,U(ee.minFilter)),ee.minFilter!==er&&ee.minFilter!==Dn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ee.compareFunction&&(i.texParameteri(oe,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(oe,i.TEXTURE_COMPARE_FUNC,Ce[ee.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ot=e.get("EXT_texture_filter_anisotropic");if(ee.magFilter===er||ee.minFilter!==op&&ee.minFilter!==Wa||ee.type===Lr&&e.has("OES_texture_float_linear")===!1||u===!1&&ee.type===Jr&&e.has("OES_texture_half_float_linear")===!1)return;(ee.anisotropy>1||r.get(ee).__currentAnisotropy)&&(i.texParameterf(oe,ot.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ee.anisotropy,s.getMaxAnisotropy())),r.get(ee).__currentAnisotropy=ee.anisotropy)}}function We(oe,ee){let W=!1;oe.__webglInit===void 0&&(oe.__webglInit=!0,ee.addEventListener("dispose",ce));const ot=ee.source;let je=E.get(ot);je===void 0&&(je={},E.set(ot,je));const Qe=Z(ee);if(Qe!==oe.__cacheKey){je[Qe]===void 0&&(je[Qe]={texture:i.createTexture(),usedTimes:0},l.memory.textures++,W=!0),je[Qe].usedTimes++;const ht=je[oe.__cacheKey];ht!==void 0&&(je[oe.__cacheKey].usedTimes--,ht.usedTimes===0&&ne(ee)),oe.__cacheKey=Qe,oe.__webglTexture=je[Qe].texture}return W}function ut(oe,ee,W){let ot=i.TEXTURE_2D;(ee.isDataArrayTexture||ee.isCompressedArrayTexture)&&(ot=i.TEXTURE_2D_ARRAY),ee.isData3DTexture&&(ot=i.TEXTURE_3D);const je=We(oe,ee),Qe=ee.source;n.bindTexture(ot,oe.__webglTexture,i.TEXTURE0+W);const ht=r.get(Qe);if(Qe.version!==ht.__version||je===!0){n.activeTexture(i.TEXTURE0+W),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ee.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ee.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const ft=I(ee)&&x(ee.image)===!1;let He=C(ee.image,ft,!1,f);He=vt(ee,He);const St=x(He)||u,L=a.convert(ee.format,ee.colorSpace);let X=a.convert(ee.type),he=k(ee.internalFormat,L,X,ee.colorSpace);Ie(ot,ee,St);let z;const be=ee.mipmaps,nt=u&&ee.isVideoTexture!==!0,Ee=ht.__version===void 0||je===!0,Le=D(ee,He,St);if(ee.isDepthTexture)he=i.DEPTH_COMPONENT,u?ee.type===Lr?he=i.DEPTH_COMPONENT32F:ee.type===Sc?he=i.DEPTH_COMPONENT24:ee.type===rd?he=i.DEPTH24_STENCIL8:he=i.DEPTH_COMPONENT16:ee.type===Lr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ee.format===sd&&he===i.DEPTH_COMPONENT&&ee.type!==$$&&ee.type!==Sc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ee.type=Sc,X=a.convert(ee.type)),ee.format===Sp&&he===i.DEPTH_COMPONENT&&(he=i.DEPTH_STENCIL,ee.type!==rd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ee.type=rd,X=a.convert(ee.type))),Ee&&(nt?n.texStorage2D(i.TEXTURE_2D,1,he,He.width,He.height):n.texImage2D(i.TEXTURE_2D,0,he,He.width,He.height,0,L,X,null));else if(ee.isDataTexture)if(be.length>0&&St){nt&&Ee&&n.texStorage2D(i.TEXTURE_2D,Le,he,be[0].width,be[0].height);for(let Be=0,N=be.length;Be<N;Be++)z=be[Be],nt?n.texSubImage2D(i.TEXTURE_2D,Be,0,0,z.width,z.height,L,X,z.data):n.texImage2D(i.TEXTURE_2D,Be,he,z.width,z.height,0,L,X,z.data);ee.generateMipmaps=!1}else nt?(Ee&&n.texStorage2D(i.TEXTURE_2D,Le,he,He.width,He.height),n.texSubImage2D(i.TEXTURE_2D,0,0,0,He.width,He.height,L,X,He.data)):n.texImage2D(i.TEXTURE_2D,0,he,He.width,He.height,0,L,X,He.data);else if(ee.isCompressedTexture)if(ee.isCompressedArrayTexture){nt&&Ee&&n.texStorage3D(i.TEXTURE_2D_ARRAY,Le,he,be[0].width,be[0].height,He.depth);for(let Be=0,N=be.length;Be<N;Be++)z=be[Be],ee.format!==Yr?L!==null?nt?n.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Be,0,0,0,z.width,z.height,He.depth,L,z.data,0,0):n.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Be,he,z.width,z.height,He.depth,0,z.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):nt?n.texSubImage3D(i.TEXTURE_2D_ARRAY,Be,0,0,0,z.width,z.height,He.depth,L,X,z.data):n.texImage3D(i.TEXTURE_2D_ARRAY,Be,he,z.width,z.height,He.depth,0,L,X,z.data)}else{nt&&Ee&&n.texStorage2D(i.TEXTURE_2D,Le,he,be[0].width,be[0].height);for(let Be=0,N=be.length;Be<N;Be++)z=be[Be],ee.format!==Yr?L!==null?nt?n.compressedTexSubImage2D(i.TEXTURE_2D,Be,0,0,z.width,z.height,L,z.data):n.compressedTexImage2D(i.TEXTURE_2D,Be,he,z.width,z.height,0,z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):nt?n.texSubImage2D(i.TEXTURE_2D,Be,0,0,z.width,z.height,L,X,z.data):n.texImage2D(i.TEXTURE_2D,Be,he,z.width,z.height,0,L,X,z.data)}else if(ee.isDataArrayTexture)nt?(Ee&&n.texStorage3D(i.TEXTURE_2D_ARRAY,Le,he,He.width,He.height,He.depth),n.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,L,X,He.data)):n.texImage3D(i.TEXTURE_2D_ARRAY,0,he,He.width,He.height,He.depth,0,L,X,He.data);else if(ee.isData3DTexture)nt?(Ee&&n.texStorage3D(i.TEXTURE_3D,Le,he,He.width,He.height,He.depth),n.texSubImage3D(i.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,L,X,He.data)):n.texImage3D(i.TEXTURE_3D,0,he,He.width,He.height,He.depth,0,L,X,He.data);else if(ee.isFramebufferTexture){if(Ee)if(nt)n.texStorage2D(i.TEXTURE_2D,Le,he,He.width,He.height);else{let Be=He.width,N=He.height;for(let j=0;j<Le;j++)n.texImage2D(i.TEXTURE_2D,j,he,Be,N,0,L,X,null),Be>>=1,N>>=1}}else if(be.length>0&&St){nt&&Ee&&n.texStorage2D(i.TEXTURE_2D,Le,he,be[0].width,be[0].height);for(let Be=0,N=be.length;Be<N;Be++)z=be[Be],nt?n.texSubImage2D(i.TEXTURE_2D,Be,0,0,L,X,z):n.texImage2D(i.TEXTURE_2D,Be,he,L,X,z);ee.generateMipmaps=!1}else nt?(Ee&&n.texStorage2D(i.TEXTURE_2D,Le,he,He.width,He.height),n.texSubImage2D(i.TEXTURE_2D,0,0,0,L,X,He)):n.texImage2D(i.TEXTURE_2D,0,he,L,X,He);O(ee,St)&&F(ot),ht.__version=Qe.version,ee.onUpdate&&ee.onUpdate(ee)}oe.__version=ee.version}function Ye(oe,ee,W){if(ee.image.length!==6)return;const ot=We(oe,ee),je=ee.source;n.bindTexture(i.TEXTURE_CUBE_MAP,oe.__webglTexture,i.TEXTURE0+W);const Qe=r.get(je);if(je.version!==Qe.__version||ot===!0){n.activeTexture(i.TEXTURE0+W),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,ee.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,ee.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);const ht=ee.isCompressedTexture||ee.image[0].isCompressedTexture,ft=ee.image[0]&&ee.image[0].isDataTexture,He=[];for(let Be=0;Be<6;Be++)!ht&&!ft?He[Be]=C(ee.image[Be],!1,!0,h):He[Be]=ft?ee.image[Be].image:ee.image[Be],He[Be]=vt(ee,He[Be]);const St=He[0],L=x(St)||u,X=a.convert(ee.format,ee.colorSpace),he=a.convert(ee.type),z=k(ee.internalFormat,X,he,ee.colorSpace),be=u&&ee.isVideoTexture!==!0,nt=Qe.__version===void 0||ot===!0;let Ee=D(ee,St,L);Ie(i.TEXTURE_CUBE_MAP,ee,L);let Le;if(ht){be&&nt&&n.texStorage2D(i.TEXTURE_CUBE_MAP,Ee,z,St.width,St.height);for(let Be=0;Be<6;Be++){Le=He[Be].mipmaps;for(let N=0;N<Le.length;N++){const j=Le[N];ee.format!==Yr?X!==null?be?n.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N,0,0,j.width,j.height,X,j.data):n.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N,z,j.width,j.height,0,j.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):be?n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N,0,0,j.width,j.height,X,he,j.data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N,z,j.width,j.height,0,X,he,j.data)}}}else{Le=ee.mipmaps,be&&nt&&(Le.length>0&&Ee++,n.texStorage2D(i.TEXTURE_CUBE_MAP,Ee,z,He[0].width,He[0].height));for(let Be=0;Be<6;Be++)if(ft){be?n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,0,0,0,He[Be].width,He[Be].height,X,he,He[Be].data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,0,z,He[Be].width,He[Be].height,0,X,he,He[Be].data);for(let N=0;N<Le.length;N++){const ge=Le[N].image[Be].image;be?n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N+1,0,0,ge.width,ge.height,X,he,ge.data):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N+1,z,ge.width,ge.height,0,X,he,ge.data)}}else{be?n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,0,0,0,X,he,He[Be]):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,0,z,X,he,He[Be]);for(let N=0;N<Le.length;N++){const j=Le[N];be?n.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N+1,0,0,X,he,j.image[Be]):n.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Be,N+1,z,X,he,j.image[Be])}}}O(ee,L)&&F(i.TEXTURE_CUBE_MAP),Qe.__version=je.version,ee.onUpdate&&ee.onUpdate(ee)}oe.__version=ee.version}function we(oe,ee,W,ot,je){const Qe=a.convert(W.format,W.colorSpace),ht=a.convert(W.type),ft=k(W.internalFormat,Qe,ht,W.colorSpace);r.get(ee).__hasExternalTextures||(je===i.TEXTURE_3D||je===i.TEXTURE_2D_ARRAY?n.texImage3D(je,0,ft,ee.width,ee.height,ee.depth,0,Qe,ht,null):n.texImage2D(je,0,ft,ee.width,ee.height,0,Qe,ht,null)),n.bindFramebuffer(i.FRAMEBUFFER,oe),ve(ee)?m.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ot,je,r.get(W).__webglTexture,0,Je(ee)):(je===i.TEXTURE_2D||je>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&je<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,ot,je,r.get(W).__webglTexture,0),n.bindFramebuffer(i.FRAMEBUFFER,null)}function Q(oe,ee,W){if(i.bindRenderbuffer(i.RENDERBUFFER,oe),ee.depthBuffer&&!ee.stencilBuffer){let ot=i.DEPTH_COMPONENT16;if(W||ve(ee)){const je=ee.depthTexture;je&&je.isDepthTexture&&(je.type===Lr?ot=i.DEPTH_COMPONENT32F:je.type===Sc&&(ot=i.DEPTH_COMPONENT24));const Qe=Je(ee);ve(ee)?m.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Qe,ot,ee.width,ee.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,Qe,ot,ee.width,ee.height)}else i.renderbufferStorage(i.RENDERBUFFER,ot,ee.width,ee.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,oe)}else if(ee.depthBuffer&&ee.stencilBuffer){const ot=Je(ee);W&&ve(ee)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,ot,i.DEPTH24_STENCIL8,ee.width,ee.height):ve(ee)?m.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ot,i.DEPTH24_STENCIL8,ee.width,ee.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,ee.width,ee.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,oe)}else{const ot=ee.isWebGLMultipleRenderTargets===!0?ee.texture:[ee.texture];for(let je=0;je<ot.length;je++){const Qe=ot[je],ht=a.convert(Qe.format,Qe.colorSpace),ft=a.convert(Qe.type),He=k(Qe.internalFormat,ht,ft,Qe.colorSpace),St=Je(ee);W&&ve(ee)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,St,He,ee.width,ee.height):ve(ee)?m.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,St,He,ee.width,ee.height):i.renderbufferStorage(i.RENDERBUFFER,He,ee.width,ee.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Ge(oe,ee){if(ee&&ee.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(i.FRAMEBUFFER,oe),!(ee.depthTexture&&ee.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(ee.depthTexture).__webglTexture||ee.depthTexture.image.width!==ee.width||ee.depthTexture.image.height!==ee.height)&&(ee.depthTexture.image.width=ee.width,ee.depthTexture.image.height=ee.height,ee.depthTexture.needsUpdate=!0),K(ee.depthTexture,0);const ot=r.get(ee.depthTexture).__webglTexture,je=Je(ee);if(ee.depthTexture.format===sd)ve(ee)?m.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0,je):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ot,0);else if(ee.depthTexture.format===Sp)ve(ee)?m.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0,je):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ot,0);else throw new Error("Unknown depthTexture format")}function Oe(oe){const ee=r.get(oe),W=oe.isWebGLCubeRenderTarget===!0;if(oe.depthTexture&&!ee.__autoAllocateDepthBuffer){if(W)throw new Error("target.depthTexture not supported in Cube render targets");Ge(ee.__webglFramebuffer,oe)}else if(W){ee.__webglDepthbuffer=[];for(let ot=0;ot<6;ot++)n.bindFramebuffer(i.FRAMEBUFFER,ee.__webglFramebuffer[ot]),ee.__webglDepthbuffer[ot]=i.createRenderbuffer(),Q(ee.__webglDepthbuffer[ot],oe,!1)}else n.bindFramebuffer(i.FRAMEBUFFER,ee.__webglFramebuffer),ee.__webglDepthbuffer=i.createRenderbuffer(),Q(ee.__webglDepthbuffer,oe,!1);n.bindFramebuffer(i.FRAMEBUFFER,null)}function Ve(oe,ee,W){const ot=r.get(oe);ee!==void 0&&we(ot.__webglFramebuffer,oe,oe.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D),W!==void 0&&Oe(oe)}function Fe(oe){const ee=oe.texture,W=r.get(oe),ot=r.get(ee);oe.addEventListener("dispose",re),oe.isWebGLMultipleRenderTargets!==!0&&(ot.__webglTexture===void 0&&(ot.__webglTexture=i.createTexture()),ot.__version=ee.version,l.memory.textures++);const je=oe.isWebGLCubeRenderTarget===!0,Qe=oe.isWebGLMultipleRenderTargets===!0,ht=x(oe)||u;if(je){W.__webglFramebuffer=[];for(let ft=0;ft<6;ft++)W.__webglFramebuffer[ft]=i.createFramebuffer()}else{if(W.__webglFramebuffer=i.createFramebuffer(),Qe)if(s.drawBuffers){const ft=oe.texture;for(let He=0,St=ft.length;He<St;He++){const L=r.get(ft[He]);L.__webglTexture===void 0&&(L.__webglTexture=i.createTexture(),l.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&oe.samples>0&&ve(oe)===!1){const ft=Qe?ee:[ee];W.__webglMultisampledFramebuffer=i.createFramebuffer(),W.__webglColorRenderbuffer=[],n.bindFramebuffer(i.FRAMEBUFFER,W.__webglMultisampledFramebuffer);for(let He=0;He<ft.length;He++){const St=ft[He];W.__webglColorRenderbuffer[He]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,W.__webglColorRenderbuffer[He]);const L=a.convert(St.format,St.colorSpace),X=a.convert(St.type),he=k(St.internalFormat,L,X,St.colorSpace,oe.isXRRenderTarget===!0),z=Je(oe);i.renderbufferStorageMultisample(i.RENDERBUFFER,z,he,oe.width,oe.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+He,i.RENDERBUFFER,W.__webglColorRenderbuffer[He])}i.bindRenderbuffer(i.RENDERBUFFER,null),oe.depthBuffer&&(W.__webglDepthRenderbuffer=i.createRenderbuffer(),Q(W.__webglDepthRenderbuffer,oe,!0)),n.bindFramebuffer(i.FRAMEBUFFER,null)}}if(je){n.bindTexture(i.TEXTURE_CUBE_MAP,ot.__webglTexture),Ie(i.TEXTURE_CUBE_MAP,ee,ht);for(let ft=0;ft<6;ft++)we(W.__webglFramebuffer[ft],oe,ee,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ft);O(ee,ht)&&F(i.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Qe){const ft=oe.texture;for(let He=0,St=ft.length;He<St;He++){const L=ft[He],X=r.get(L);n.bindTexture(i.TEXTURE_2D,X.__webglTexture),Ie(i.TEXTURE_2D,L,ht),we(W.__webglFramebuffer,oe,L,i.COLOR_ATTACHMENT0+He,i.TEXTURE_2D),O(L,ht)&&F(i.TEXTURE_2D)}n.unbindTexture()}else{let ft=i.TEXTURE_2D;(oe.isWebGL3DRenderTarget||oe.isWebGLArrayRenderTarget)&&(u?ft=oe.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(ft,ot.__webglTexture),Ie(ft,ee,ht),we(W.__webglFramebuffer,oe,ee,i.COLOR_ATTACHMENT0,ft),O(ee,ht)&&F(ft),n.unbindTexture()}oe.depthBuffer&&Oe(oe)}function tt(oe){const ee=x(oe)||u,W=oe.isWebGLMultipleRenderTargets===!0?oe.texture:[oe.texture];for(let ot=0,je=W.length;ot<je;ot++){const Qe=W[ot];if(O(Qe,ee)){const ht=oe.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,ft=r.get(Qe).__webglTexture;n.bindTexture(ht,ft),F(ht),n.unbindTexture()}}}function Ue(oe){if(u&&oe.samples>0&&ve(oe)===!1){const ee=oe.isWebGLMultipleRenderTargets?oe.texture:[oe.texture],W=oe.width,ot=oe.height;let je=i.COLOR_BUFFER_BIT;const Qe=[],ht=oe.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ft=r.get(oe),He=oe.isWebGLMultipleRenderTargets===!0;if(He)for(let St=0;St<ee.length;St++)n.bindFramebuffer(i.FRAMEBUFFER,ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+St,i.RENDERBUFFER,null),n.bindFramebuffer(i.FRAMEBUFFER,ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+St,i.TEXTURE_2D,null,0);n.bindFramebuffer(i.READ_FRAMEBUFFER,ft.__webglMultisampledFramebuffer),n.bindFramebuffer(i.DRAW_FRAMEBUFFER,ft.__webglFramebuffer);for(let St=0;St<ee.length;St++){Qe.push(i.COLOR_ATTACHMENT0+St),oe.depthBuffer&&Qe.push(ht);const L=ft.__ignoreDepthValues!==void 0?ft.__ignoreDepthValues:!1;if(L===!1&&(oe.depthBuffer&&(je|=i.DEPTH_BUFFER_BIT),oe.stencilBuffer&&(je|=i.STENCIL_BUFFER_BIT)),He&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ft.__webglColorRenderbuffer[St]),L===!0&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[ht]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[ht])),He){const X=r.get(ee[St]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,X,0)}i.blitFramebuffer(0,0,W,ot,0,0,W,ot,je,i.NEAREST),v&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Qe)}if(n.bindFramebuffer(i.READ_FRAMEBUFFER,null),n.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),He)for(let St=0;St<ee.length;St++){n.bindFramebuffer(i.FRAMEBUFFER,ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+St,i.RENDERBUFFER,ft.__webglColorRenderbuffer[St]);const L=r.get(ee[St]).__webglTexture;n.bindFramebuffer(i.FRAMEBUFFER,ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+St,i.TEXTURE_2D,L,0)}n.bindFramebuffer(i.DRAW_FRAMEBUFFER,ft.__webglMultisampledFramebuffer)}}function Je(oe){return Math.min(p,oe.samples)}function ve(oe){const ee=r.get(oe);return u&&oe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ee.__useRenderToTexture!==!1}function Me(oe){const ee=l.render.frame;y.get(oe)!==ee&&(y.set(oe,ee),oe.update())}function vt(oe,ee){const W=oe.colorSpace,ot=oe.format,je=oe.type;return oe.isCompressedTexture===!0||oe.format===XS||W!==xo&&W!==od&&(W===vn?u===!1?e.has("EXT_sRGB")===!0&&ot===Yr?(oe.format=XS,oe.minFilter=Dn,oe.generateMipmaps=!1):ee=_M.sRGBToLinear(ee):(ot!==Yr||je!==ia)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",W)),ee}this.allocateTextureUnit=G,this.resetTextureUnits=Re,this.setTexture2D=K,this.setTexture2DArray=se,this.setTexture3D=Y,this.setTextureCube=me,this.rebindTextures=Ve,this.setupRenderTarget=Fe,this.updateRenderTargetMipmap=tt,this.updateMultisampleRenderTarget=Ue,this.setupDepthRenderbuffer=Oe,this.setupFrameBufferTexture=we,this.useMultisampledRTT=ve}function PF(i,e,n){const r=n.isWebGL2;function s(a,l=od){let u;if(a===ia)return i.UNSIGNED_BYTE;if(a===oM)return i.UNSIGNED_SHORT_4_4_4_4;if(a===aM)return i.UNSIGNED_SHORT_5_5_5_1;if(a===rM)return i.BYTE;if(a===sM)return i.SHORT;if(a===$$)return i.UNSIGNED_SHORT;if(a===b$)return i.INT;if(a===Sc)return i.UNSIGNED_INT;if(a===Lr)return i.FLOAT;if(a===Jr)return r?i.HALF_FLOAT:(u=e.get("OES_texture_half_float"),u!==null?u.HALF_FLOAT_OES:null);if(a===oF)return i.ALPHA;if(a===Yr)return i.RGBA;if(a===aF)return i.LUMINANCE;if(a===lF)return i.LUMINANCE_ALPHA;if(a===sd)return i.DEPTH_COMPONENT;if(a===Sp)return i.DEPTH_STENCIL;if(a===XS)return u=e.get("EXT_sRGB"),u!==null?u.SRGB_ALPHA_EXT:null;if(a===lM)return i.RED;if(a===cM)return i.RED_INTEGER;if(a===cF)return i.RG;if(a===uM)return i.RG_INTEGER;if(a===hM)return i.RGBA_INTEGER;if(a===uS||a===hS||a===dS||a===fS)if(l===vn)if(u=e.get("WEBGL_compressed_texture_s3tc_srgb"),u!==null){if(a===uS)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===hS)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===dS)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===fS)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(u=e.get("WEBGL_compressed_texture_s3tc"),u!==null){if(a===uS)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===hS)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===dS)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===fS)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===hx||a===dx||a===fx||a===px)if(u=e.get("WEBGL_compressed_texture_pvrtc"),u!==null){if(a===hx)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===dx)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===fx)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===px)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===uF)return u=e.get("WEBGL_compressed_texture_etc1"),u!==null?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===mx||a===gx)if(u=e.get("WEBGL_compressed_texture_etc"),u!==null){if(a===mx)return l===vn?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(a===gx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===_x||a===Tx||a===vx||a===Ex||a===yx||a===Sx||a===$x||a===bx||a===Ax||a===Cx||a===Rx||a===xx||a===wx||a===Mx)if(u=e.get("WEBGL_compressed_texture_astc"),u!==null){if(a===_x)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===Tx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===vx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===Ex)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===yx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===Sx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===$x)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===bx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===Ax)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===Cx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===Rx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===xx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===wx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===Mx)return l===vn?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===pS)if(u=e.get("EXT_texture_compression_bptc"),u!==null){if(a===pS)return l===vn?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(a===hF||a===Ix||a===Ox||a===Lx)if(u=e.get("EXT_texture_compression_rgtc"),u!==null){if(a===pS)return u.COMPRESSED_RED_RGTC1_EXT;if(a===Ix)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===Ox)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===Lx)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===rd?r?i.UNSIGNED_INT_24_8:(u=e.get("WEBGL_depth_texture"),u!==null?u.UNSIGNED_INT_24_8_WEBGL:null):i[a]!==void 0?i[a]:null}return{convert:s}}class DF extends Gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ta extends Xn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const oX={type:"move"};class SC{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ta,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ta,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ta,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let s=null,a=null,l=null;const u=this._targetRay,d=this._grip,h=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(h&&e.hand){l=!0;for(const $ of e.hand.values()){const E=n.getJointPose($,r),S=this._getHandJoint(h,$);E!==null&&(S.matrix.fromArray(E.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=E.radius),S.visible=E!==null}const f=h.joints["index-finger-tip"],p=h.joints["thumb-tip"],m=f.position.distanceTo(p.position),v=.02,y=.005;h.inputState.pinching&&m>v+y?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=v-y&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(a=n.getPose(e.gripSpace,r),a!==null&&(d.matrix.fromArray(a.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,a.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(a.linearVelocity)):d.hasLinearVelocity=!1,a.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(a.angularVelocity)):d.hasAngularVelocity=!1));u!==null&&(s=n.getPose(e.targetRaySpace,r),s===null&&a!==null&&(s=a),s!==null&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(oX)))}return u!==null&&(u.visible=s!==null),d!==null&&(d.visible=a!==null),h!==null&&(h.visible=l!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new ta;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class $M extends ni{constructor(e,n,r,s,a,l,u,d,h,f){if(f=f!==void 0?f:sd,f!==sd&&f!==Sp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&f===sd&&(r=Sc),r===void 0&&f===Sp&&(r=rd),super(null,s,a,l,u,d,f,r,h),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=u!==void 0?u:er,this.minFilter=d!==void 0?d:er,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class aX extends Mc{constructor(e,n){super();const r=this;let s=null,a=1,l=null,u="local-floor",d=1,h=null,f=null,p=null,m=null,v=null,y=null;const $=n.getContextAttributes();let E=null,S=null;const A=[],C=[];let x=null;const I=new Gi;I.layers.enable(1),I.viewport=new Hn;const O=new Gi;O.layers.enable(2),O.viewport=new Hn;const F=[I,O],k=new DF;k.layers.enable(1),k.layers.enable(2);let D=null,U=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getCamera=function(){},this.setUserCamera=function(Y){x=Y},this.getController=function(Y){let me=A[Y];return me===void 0&&(me=new SC,A[Y]=me),me.getTargetRaySpace()},this.getControllerGrip=function(Y){let me=A[Y];return me===void 0&&(me=new SC,A[Y]=me),me.getGripSpace()},this.getHand=function(Y){let me=A[Y];return me===void 0&&(me=new SC,A[Y]=me),me.getHandSpace()};function ce(Y){const me=C.indexOf(Y.inputSource);if(me===-1)return;const fe=A[me];fe!==void 0&&(fe.update(Y.inputSource,Y.frame,h||l),fe.dispatchEvent({type:Y.type,data:Y.inputSource}))}function re(){s.removeEventListener("select",ce),s.removeEventListener("selectstart",ce),s.removeEventListener("selectend",ce),s.removeEventListener("squeeze",ce),s.removeEventListener("squeezestart",ce),s.removeEventListener("squeezeend",ce),s.removeEventListener("end",re),s.removeEventListener("inputsourceschange",ae);for(let Y=0;Y<A.length;Y++){const me=C[Y];me!==null&&(C[Y]=null,A[Y].disconnect(me))}D=null,U=null,e.setRenderTarget(E),v=null,m=null,p=null,s=null,S=null,se.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Y){a=Y,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Y){u=Y,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||l},this.setReferenceSpace=function(Y){h=Y},this.getBaseLayer=function(){return m!==null?m:v},this.getBinding=function(){return p},this.getFrame=function(){return y},this.getSession=function(){return s},this.setSession=async function(Y){if(s=Y,s!==null){if(E=e.getRenderTarget(),s.addEventListener("select",ce),s.addEventListener("selectstart",ce),s.addEventListener("selectend",ce),s.addEventListener("squeeze",ce),s.addEventListener("squeezestart",ce),s.addEventListener("squeezeend",ce),s.addEventListener("end",re),s.addEventListener("inputsourceschange",ae),$.xrCompatible!==!0&&await n.makeXRCompatible(),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const me={antialias:s.renderState.layers===void 0?$.antialias:!0,alpha:!0,depth:$.depth,stencil:$.stencil,framebufferScaleFactor:a};v=new XRWebGLLayer(s,n,me),s.updateRenderState({baseLayer:v}),S=new lo(v.framebufferWidth,v.framebufferHeight,{format:Yr,type:ia,colorSpace:e.outputColorSpace,stencilBuffer:$.stencil})}else{let me=null,fe=null,Ae=null;$.depth&&(Ae=$.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,me=$.stencil?Sp:sd,fe=$.stencil?rd:Sc);const Ce={colorFormat:n.RGBA8,depthFormat:Ae,scaleFactor:a};p=new XRWebGLBinding(s,n),m=p.createProjectionLayer(Ce),s.updateRenderState({layers:[m]}),S=new lo(m.textureWidth,m.textureHeight,{format:Yr,type:ia,depthTexture:new $M(m.textureWidth,m.textureHeight,fe,void 0,void 0,void 0,void 0,void 0,void 0,me),stencilBuffer:$.stencil,colorSpace:e.outputColorSpace,samples:$.antialias?4:0});const Ie=e.properties.get(S);Ie.__ignoreDepthValues=m.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(d),h=null,l=await s.requestReferenceSpace(u),se.setContext(s),se.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function ae(Y){for(let me=0;me<Y.removed.length;me++){const fe=Y.removed[me],Ae=C.indexOf(fe);Ae>=0&&(C[Ae]=null,A[Ae].disconnect(fe))}for(let me=0;me<Y.added.length;me++){const fe=Y.added[me];let Ae=C.indexOf(fe);if(Ae===-1){for(let Ie=0;Ie<A.length;Ie++)if(Ie>=C.length){C.push(fe),Ae=Ie;break}else if(C[Ie]===null){C[Ie]=fe,Ae=Ie;break}if(Ae===-1)break}const Ce=A[Ae];Ce&&Ce.connect(fe)}}const ne=new ie,de=new ie;function ue(Y,me,fe){ne.setFromMatrixPosition(me.matrixWorld),de.setFromMatrixPosition(fe.matrixWorld);const Ae=ne.distanceTo(de),Ce=me.projectionMatrix.elements,Ie=fe.projectionMatrix.elements,We=Ce[14]/(Ce[10]-1),ut=Ce[14]/(Ce[10]+1),Ye=(Ce[9]+1)/Ce[5],we=(Ce[9]-1)/Ce[5],Q=(Ce[8]-1)/Ce[0],Ge=(Ie[8]+1)/Ie[0],Oe=We*Q,Ve=We*Ge,Fe=Ae/(-Q+Ge),tt=Fe*-Q;me.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Y.translateX(tt),Y.translateZ(Fe),Y.matrixWorld.compose(Y.position,Y.quaternion,Y.scale),Y.matrixWorldInverse.copy(Y.matrixWorld).invert();const Ue=We+Fe,Je=ut+Fe,ve=Oe-tt,Me=Ve+(Ae-tt),vt=Ye*ut/Je*Ue,oe=we*ut/Je*Ue;Y.projectionMatrix.makePerspective(ve,Me,vt,oe,Ue,Je),Y.projectionMatrixInverse.copy(Y.projectionMatrix).invert()}function Re(Y,me){me===null?Y.matrixWorld.copy(Y.matrix):Y.matrixWorld.multiplyMatrices(me.matrixWorld,Y.matrix),Y.matrixWorldInverse.copy(Y.matrixWorld).invert()}this.updateCameraXR=function(Y){if(s===null)return Y;x&&(Y=x),k.near=O.near=I.near=Y.near,k.far=O.far=I.far=Y.far,(D!==k.near||U!==k.far)&&(s.updateRenderState({depthNear:k.near,depthFar:k.far}),D=k.near,U=k.far);const me=Y.parent,fe=k.cameras;Re(k,me);for(let Ae=0;Ae<fe.length;Ae++)Re(fe[Ae],me);return fe.length===2?ue(k,I,O):k.projectionMatrix.copy(I.projectionMatrix),x&&G(k,me),k};function G(Y,me){const fe=x;me===null?fe.matrix.copy(Y.matrixWorld):(fe.matrix.copy(me.matrixWorld),fe.matrix.invert(),fe.matrix.multiply(Y.matrixWorld)),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale),fe.updateMatrixWorld(!0);const Ae=fe.children;for(let Ce=0,Ie=Ae.length;Ce<Ie;Ce++)Ae[Ce].updateMatrixWorld(!0);fe.projectionMatrix.copy(Y.projectionMatrix),fe.projectionMatrixInverse.copy(Y.projectionMatrixInverse),fe.isPerspectiveCamera&&(fe.fov=Xg*2*Math.atan(1/fe.projectionMatrix.elements[5]),fe.zoom=1)}this.getFoveation=function(){if(!(m===null&&v===null))return d},this.setFoveation=function(Y){d=Y,m!==null&&(m.fixedFoveation=Y),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=Y)};let Z=null;function K(Y,me){if(f=me.getViewerPose(h||l),y=me,f!==null){const fe=f.views;v!==null&&(e.setRenderTargetFramebuffer(S,v.framebuffer),e.setRenderTarget(S));let Ae=!1;fe.length!==k.cameras.length&&(k.cameras.length=0,Ae=!0);for(let Ce=0;Ce<fe.length;Ce++){const Ie=fe[Ce];let We=null;if(v!==null)We=v.getViewport(Ie);else{const Ye=p.getViewSubImage(m,Ie);We=Ye.viewport,Ce===0&&(e.setRenderTargetTextures(S,Ye.colorTexture,m.ignoreDepthValues?void 0:Ye.depthStencilTexture),e.setRenderTarget(S))}let ut=F[Ce];ut===void 0&&(ut=new Gi,ut.layers.enable(Ce),ut.viewport=new Hn,F[Ce]=ut),ut.matrix.fromArray(Ie.transform.matrix),ut.matrix.decompose(ut.position,ut.quaternion,ut.scale),ut.projectionMatrix.fromArray(Ie.projectionMatrix),ut.projectionMatrixInverse.copy(ut.projectionMatrix).invert(),ut.viewport.set(We.x,We.y,We.width,We.height),Ce===0&&(k.matrix.copy(ut.matrix),k.matrix.decompose(k.position,k.quaternion,k.scale)),Ae===!0&&k.cameras.push(ut)}}for(let fe=0;fe<A.length;fe++){const Ae=C[fe],Ce=A[fe];Ae!==null&&Ce!==void 0&&Ce.update(Ae,me,h||l)}Z&&Z(Y,me),me.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:me}),y=null}const se=new IF;se.setAnimationLoop(K),this.setAnimationLoop=function(Y){Z=Y},this.dispose=function(){}}}function lX(i,e){function n(E,S){E.matrixAutoUpdate===!0&&E.updateMatrix(),S.value.copy(E.matrix)}function r(E,S){S.color.getRGB(E.fogColor.value,wF(i)),S.isFog?(E.fogNear.value=S.near,E.fogFar.value=S.far):S.isFogExp2&&(E.fogDensity.value=S.density)}function s(E,S,A,C,x){S.isMeshBasicMaterial||S.isMeshLambertMaterial?a(E,S):S.isMeshToonMaterial?(a(E,S),p(E,S)):S.isMeshPhongMaterial?(a(E,S),f(E,S)):S.isMeshStandardMaterial?(a(E,S),m(E,S),S.isMeshPhysicalMaterial&&v(E,S,x)):S.isMeshMatcapMaterial?(a(E,S),y(E,S)):S.isMeshDepthMaterial?a(E,S):S.isMeshDistanceMaterial?(a(E,S),$(E,S)):S.isMeshNormalMaterial?a(E,S):S.isLineBasicMaterial?(l(E,S),S.isLineDashedMaterial&&u(E,S)):S.isPointsMaterial?d(E,S,A,C):S.isSpriteMaterial?h(E,S):S.isShadowMaterial?(E.color.value.copy(S.color),E.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function a(E,S){E.opacity.value=S.opacity,S.color&&E.diffuse.value.copy(S.color),S.emissive&&E.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(E.map.value=S.map,n(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,n(S.alphaMap,E.alphaMapTransform)),S.bumpMap&&(E.bumpMap.value=S.bumpMap,n(S.bumpMap,E.bumpMapTransform),E.bumpScale.value=S.bumpScale,S.side===Hs&&(E.bumpScale.value*=-1)),S.normalMap&&(E.normalMap.value=S.normalMap,n(S.normalMap,E.normalMapTransform),E.normalScale.value.copy(S.normalScale),S.side===Hs&&E.normalScale.value.negate()),S.displacementMap&&(E.displacementMap.value=S.displacementMap,n(S.displacementMap,E.displacementMapTransform),E.displacementScale.value=S.displacementScale,E.displacementBias.value=S.displacementBias),S.emissiveMap&&(E.emissiveMap.value=S.emissiveMap,n(S.emissiveMap,E.emissiveMapTransform)),S.specularMap&&(E.specularMap.value=S.specularMap,n(S.specularMap,E.specularMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest);const A=e.get(S).envMap;if(A&&(E.envMap.value=A,E.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=S.reflectivity,E.ior.value=S.ior,E.refractionRatio.value=S.refractionRatio),S.lightMap){E.lightMap.value=S.lightMap;const C=i.useLegacyLights===!0?Math.PI:1;E.lightMapIntensity.value=S.lightMapIntensity*C,n(S.lightMap,E.lightMapTransform)}S.aoMap&&(E.aoMap.value=S.aoMap,E.aoMapIntensity.value=S.aoMapIntensity,n(S.aoMap,E.aoMapTransform))}function l(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,S.map&&(E.map.value=S.map,n(S.map,E.mapTransform))}function u(E,S){E.dashSize.value=S.dashSize,E.totalSize.value=S.dashSize+S.gapSize,E.scale.value=S.scale}function d(E,S,A,C){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.size.value=S.size*A,E.scale.value=C*.5,S.map&&(E.map.value=S.map,n(S.map,E.uvTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,n(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function h(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.rotation.value=S.rotation,S.map&&(E.map.value=S.map,n(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,n(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function f(E,S){E.specular.value.copy(S.specular),E.shininess.value=Math.max(S.shininess,1e-4)}function p(E,S){S.gradientMap&&(E.gradientMap.value=S.gradientMap)}function m(E,S){E.metalness.value=S.metalness,S.metalnessMap&&(E.metalnessMap.value=S.metalnessMap,n(S.metalnessMap,E.metalnessMapTransform)),E.roughness.value=S.roughness,S.roughnessMap&&(E.roughnessMap.value=S.roughnessMap,n(S.roughnessMap,E.roughnessMapTransform)),e.get(S).envMap&&(E.envMapIntensity.value=S.envMapIntensity)}function v(E,S,A){E.ior.value=S.ior,S.sheen>0&&(E.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),E.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(E.sheenColorMap.value=S.sheenColorMap,n(S.sheenColorMap,E.sheenColorMapTransform)),S.sheenRoughnessMap&&(E.sheenRoughnessMap.value=S.sheenRoughnessMap,n(S.sheenRoughnessMap,E.sheenRoughnessMapTransform))),S.clearcoat>0&&(E.clearcoat.value=S.clearcoat,E.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(E.clearcoatMap.value=S.clearcoatMap,n(S.clearcoatMap,E.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,n(S.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(E.clearcoatNormalMap.value=S.clearcoatNormalMap,n(S.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===Hs&&E.clearcoatNormalScale.value.negate())),S.iridescence>0&&(E.iridescence.value=S.iridescence,E.iridescenceIOR.value=S.iridescenceIOR,E.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(E.iridescenceMap.value=S.iridescenceMap,n(S.iridescenceMap,E.iridescenceMapTransform)),S.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=S.iridescenceThicknessMap,n(S.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),S.transmission>0&&(E.transmission.value=S.transmission,E.transmissionSamplerMap.value=A.texture,E.transmissionSamplerSize.value.set(A.width,A.height),S.transmissionMap&&(E.transmissionMap.value=S.transmissionMap,n(S.transmissionMap,E.transmissionMapTransform)),E.thickness.value=S.thickness,S.thicknessMap&&(E.thicknessMap.value=S.thicknessMap,n(S.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=S.attenuationDistance,E.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(E.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(E.anisotropyMap.value=S.anisotropyMap,n(S.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=S.specularIntensity,E.specularColor.value.copy(S.specularColor),S.specularColorMap&&(E.specularColorMap.value=S.specularColorMap,n(S.specularColorMap,E.specularColorMapTransform)),S.specularIntensityMap&&(E.specularIntensityMap.value=S.specularIntensityMap,n(S.specularIntensityMap,E.specularIntensityMapTransform))}function y(E,S){S.matcap&&(E.matcap.value=S.matcap)}function $(E,S){const A=e.get(S).light;E.referencePosition.value.setFromMatrixPosition(A.matrixWorld),E.nearDistance.value=A.shadow.camera.near,E.farDistance.value=A.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:s}}function cX(i,e,n,r){let s={},a={},l=[];const u=n.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function d(A,C){const x=C.program;r.uniformBlockBinding(A,x)}function h(A,C){let x=s[A.id];x===void 0&&(y(A),x=f(A),s[A.id]=x,A.addEventListener("dispose",E));const I=C.program;r.updateUBOMapping(A,I);const O=e.render.frame;a[A.id]!==O&&(m(A),a[A.id]=O)}function f(A){const C=p();A.__bindingPointIndex=C;const x=i.createBuffer(),I=A.__size,O=A.usage;return i.bindBuffer(i.UNIFORM_BUFFER,x),i.bufferData(i.UNIFORM_BUFFER,I,O),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,C,x),x}function p(){for(let A=0;A<u;A++)if(l.indexOf(A)===-1)return l.push(A),A;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(A){const C=s[A.id],x=A.uniforms,I=A.__cache;i.bindBuffer(i.UNIFORM_BUFFER,C);for(let O=0,F=x.length;O<F;O++){const k=x[O];if(v(k,O,I)===!0){const D=k.__offset,U=Array.isArray(k.value)?k.value:[k.value];let ce=0;for(let re=0;re<U.length;re++){const ae=U[re],ne=$(ae);typeof ae=="number"?(k.__data[0]=ae,i.bufferSubData(i.UNIFORM_BUFFER,D+ce,k.__data)):ae.isMatrix3?(k.__data[0]=ae.elements[0],k.__data[1]=ae.elements[1],k.__data[2]=ae.elements[2],k.__data[3]=ae.elements[0],k.__data[4]=ae.elements[3],k.__data[5]=ae.elements[4],k.__data[6]=ae.elements[5],k.__data[7]=ae.elements[0],k.__data[8]=ae.elements[6],k.__data[9]=ae.elements[7],k.__data[10]=ae.elements[8],k.__data[11]=ae.elements[0]):(ae.toArray(k.__data,ce),ce+=ne.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,D,k.__data)}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function v(A,C,x){const I=A.value;if(x[C]===void 0){if(typeof I=="number")x[C]=I;else{const O=Array.isArray(I)?I:[I],F=[];for(let k=0;k<O.length;k++)F.push(O[k].clone());x[C]=F}return!0}else if(typeof I=="number"){if(x[C]!==I)return x[C]=I,!0}else{const O=Array.isArray(x[C])?x[C]:[x[C]],F=Array.isArray(I)?I:[I];for(let k=0;k<O.length;k++){const D=O[k];if(D.equals(F[k])===!1)return D.copy(F[k]),!0}}return!1}function y(A){const C=A.uniforms;let x=0;const I=16;let O=0;for(let F=0,k=C.length;F<k;F++){const D=C[F],U={boundary:0,storage:0},ce=Array.isArray(D.value)?D.value:[D.value];for(let re=0,ae=ce.length;re<ae;re++){const ne=ce[re],de=$(ne);U.boundary+=de.boundary,U.storage+=de.storage}if(D.__data=new Float32Array(U.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=x,F>0){O=x%I;const re=I-O;O!==0&&re-U.boundary<0&&(x+=I-O,D.__offset=x)}x+=U.storage}return O=x%I,O>0&&(x+=I-O),A.__size=x,A.__cache={},this}function $(A){const C={boundary:0,storage:0};return typeof A=="number"?(C.boundary=4,C.storage=4):A.isVector2?(C.boundary=8,C.storage=8):A.isVector3||A.isColor?(C.boundary=16,C.storage=12):A.isVector4?(C.boundary=16,C.storage=16):A.isMatrix3?(C.boundary=48,C.storage=48):A.isMatrix4?(C.boundary=64,C.storage=64):A.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",A),C}function E(A){const C=A.target;C.removeEventListener("dispose",E);const x=l.indexOf(C.__bindingPointIndex);l.splice(x,1),i.deleteBuffer(s[C.id]),delete s[C.id],delete a[C.id]}function S(){for(const A in s)i.deleteBuffer(s[A]);l=[],s={},a={}}return{bind:d,update:h,dispose:S}}function uX(){const i=sE("canvas");return i.style.display="block",i}class O${constructor(e={}){const{canvas:n=uX(),context:r=null,depth:s=!0,stencil:a=!0,alpha:l=!1,antialias:u=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:h=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let m;r!==null?m=r.getContextAttributes().alpha:m=l;const v=new Uint32Array(4),y=new Int32Array(4);let $=null,E=null;const S=[],A=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=vn,this.useLegacyLights=!0,this.toneMapping=kl,this.toneMappingExposure=1;const C=this;let x=!1,I=0,O=0,F=null,k=-1,D=null;const U=new Hn,ce=new Hn;let re=null;const ae=new xt(0);let ne=0,de=n.width,ue=n.height,Re=1,G=null,Z=null;const K=new Hn(0,0,de,ue),se=new Hn(0,0,de,ue);let Y=!1;const me=new x$;let fe=!1,Ae=!1,Ce=null;const Ie=new pn,We=new mt,ut=new ie,Ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function we(){return F===null?Re:1}let Q=r;function Ge(B,le){for(let _e=0;_e<B.length;_e++){const pe=B[_e],ye=n.getContext(pe,le);if(ye!==null)return ye}return null}try{const B={alpha:!0,depth:s,stencil:a,antialias:u,premultipliedAlpha:d,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${Ip}`),n.addEventListener("webglcontextlost",Le,!1),n.addEventListener("webglcontextrestored",Be,!1),n.addEventListener("webglcontextcreationerror",N,!1),Q===null){const le=["webgl2","webgl","experimental-webgl"];if(C.isWebGL1Renderer===!0&&le.shift(),Q=Ge(le,B),Q===null)throw Ge(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Q instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let Oe,Ve,Fe,tt,Ue,Je,ve,Me,vt,oe,ee,W,ot,je,Qe,ht,ft,He,St,L,X,he,z,be;function nt(){Oe=new C8(Q),Ve=new E8(Q,Oe,e),Oe.init(Ve),he=new PF(Q,Oe,Ve),Fe=new rX(Q,Oe,Ve),tt=new w8(Q),Ue=new X6,Je=new sX(Q,Oe,Fe,Ue,Ve,he,tt),ve=new S8(C),Me=new A8(C),vt=new G4(Q,Ve),z=new T8(Q,Oe,vt,Ve),oe=new R8(Q,vt,tt,z),ee=new L8(Q,oe,vt,tt),St=new O8(Q,Ve,Je),ht=new y8(Ue),W=new W6(C,ve,Me,Oe,Ve,z,ht),ot=new lX(C,Ue),je=new Y6,Qe=new eX(Oe,Ve),He=new _8(C,ve,Me,Fe,ee,m,d),ft=new iX(C,ee,Ve),be=new cX(Q,tt,Ve,Fe),L=new v8(Q,Oe,tt,Ve),X=new x8(Q,Oe,tt,Ve),tt.programs=W.programs,C.capabilities=Ve,C.extensions=Oe,C.properties=Ue,C.renderLists=je,C.shadowMap=ft,C.state=Fe,C.info=tt}nt();const Ee=new aX(C,Q);this.xr=Ee,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const B=Oe.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=Oe.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return Re},this.setPixelRatio=function(B){B!==void 0&&(Re=B,this.setSize(de,ue,!1))},this.getSize=function(B){return B.set(de,ue)},this.setSize=function(B,le,_e=!0){if(Ee.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}de=B,ue=le,n.width=Math.floor(B*Re),n.height=Math.floor(le*Re),_e===!0&&(n.style.width=B+"px",n.style.height=le+"px"),this.setViewport(0,0,B,le)},this.getDrawingBufferSize=function(B){return B.set(de*Re,ue*Re).floor()},this.setDrawingBufferSize=function(B,le,_e){de=B,ue=le,Re=_e,n.width=Math.floor(B*_e),n.height=Math.floor(le*_e),this.setViewport(0,0,B,le)},this.getCurrentViewport=function(B){return B.copy(U)},this.getViewport=function(B){return B.copy(K)},this.setViewport=function(B,le,_e,pe){B.isVector4?K.set(B.x,B.y,B.z,B.w):K.set(B,le,_e,pe),Fe.viewport(U.copy(K).multiplyScalar(Re).floor())},this.getScissor=function(B){return B.copy(se)},this.setScissor=function(B,le,_e,pe){B.isVector4?se.set(B.x,B.y,B.z,B.w):se.set(B,le,_e,pe),Fe.scissor(ce.copy(se).multiplyScalar(Re).floor())},this.getScissorTest=function(){return Y},this.setScissorTest=function(B){Fe.setScissorTest(Y=B)},this.setOpaqueSort=function(B){G=B},this.setTransparentSort=function(B){Z=B},this.getClearColor=function(B){return B.copy(He.getClearColor())},this.setClearColor=function(){He.setClearColor.apply(He,arguments)},this.getClearAlpha=function(){return He.getClearAlpha()},this.setClearAlpha=function(){He.setClearAlpha.apply(He,arguments)},this.clear=function(B=!0,le=!0,_e=!0){let pe=0;if(B){let ye=!1;if(F!==null){const Ze=F.texture.format;ye=Ze===hM||Ze===uM||Ze===cM}if(ye){const Ze=F.texture.type,qe=Ze===ia||Ze===Sc||Ze===$$||Ze===rd||Ze===oM||Ze===aM,at=He.getClearColor(),rt=He.getClearAlpha(),pt=at.r,ke=at.g,It=at.b,Ct=Ue.get(F).__webglFramebuffer;qe?(v[0]=pt,v[1]=ke,v[2]=It,v[3]=rt,Q.clearBufferuiv(Q.COLOR,Ct,v)):(y[0]=pt,y[1]=ke,y[2]=It,y[3]=rt,Q.clearBufferiv(Q.COLOR,Ct,y))}else pe|=Q.COLOR_BUFFER_BIT}le&&(pe|=Q.DEPTH_BUFFER_BIT),_e&&(pe|=Q.STENCIL_BUFFER_BIT),Q.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Le,!1),n.removeEventListener("webglcontextrestored",Be,!1),n.removeEventListener("webglcontextcreationerror",N,!1),je.dispose(),Qe.dispose(),Ue.dispose(),ve.dispose(),Me.dispose(),ee.dispose(),z.dispose(),be.dispose(),W.dispose(),Ee.dispose(),Ee.removeEventListener("sessionstart",$t),Ee.removeEventListener("sessionend",un),Ce&&(Ce.dispose(),Ce=null),an.stop()};function Le(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Be(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const B=tt.autoReset,le=ft.enabled,_e=ft.autoUpdate,pe=ft.needsUpdate,ye=ft.type;nt(),tt.autoReset=B,ft.enabled=le,ft.autoUpdate=_e,ft.needsUpdate=pe,ft.type=ye}function N(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function j(B){const le=B.target;le.removeEventListener("dispose",j),ge(le)}function ge(B){xe(B),Ue.remove(B)}function xe(B){const le=Ue.get(B).programs;le!==void 0&&(le.forEach(function(_e){W.releaseProgram(_e)}),B.isShaderMaterial&&W.releaseShaderCache(B))}this.renderBufferDirect=function(B,le,_e,pe,ye,Ze){le===null&&(le=Ye);const qe=ye.isMesh&&ye.matrixWorld.determinant()<0,at=pi(B,le,_e,pe,ye);Fe.setMaterial(pe,qe);let rt=_e.index,pt=1;pe.wireframe===!0&&(rt=oe.getWireframeAttribute(_e),pt=2);const ke=_e.drawRange,It=_e.attributes.position;let Ct=ke.start*pt,wt=(ke.start+ke.count)*pt;Ze!==null&&(Ct=Math.max(Ct,Ze.start*pt),wt=Math.min(wt,(Ze.start+Ze.count)*pt)),rt!==null?(Ct=Math.max(Ct,0),wt=Math.min(wt,rt.count)):It!=null&&(Ct=Math.max(Ct,0),wt=Math.min(wt,It.count));const Ht=wt-Ct;if(Ht<0||Ht===1/0)return;z.setup(ye,pe,at,_e,rt);let Zt,jt=L;if(rt!==null&&(Zt=vt.get(rt),jt=X,jt.setIndex(Zt)),ye.isMesh)pe.wireframe===!0?(Fe.setLineWidth(pe.wireframeLinewidth*we()),jt.setMode(Q.LINES)):jt.setMode(Q.TRIANGLES);else if(ye.isLine){let Ot=pe.linewidth;Ot===void 0&&(Ot=1),Fe.setLineWidth(Ot*we()),ye.isLineSegments?jt.setMode(Q.LINES):ye.isLineLoop?jt.setMode(Q.LINE_LOOP):jt.setMode(Q.LINE_STRIP)}else ye.isPoints?jt.setMode(Q.POINTS):ye.isSprite&&jt.setMode(Q.TRIANGLES);if(ye.isInstancedMesh)jt.renderInstances(Ct,Ht,ye.count);else if(_e.isInstancedBufferGeometry){const Ot=_e._maxInstanceCount!==void 0?_e._maxInstanceCount:1/0,qt=Math.min(_e.instanceCount,Ot);jt.renderInstances(Ct,Ht,qt)}else jt.render(Ct,Ht)},this.compile=function(B,le){function _e(pe,ye,Ze){pe.transparent===!0&&pe.side===$s&&pe.forceSinglePass===!1?(pe.side=Hs,pe.needsUpdate=!0,Ti(pe,ye,Ze),pe.side=za,pe.needsUpdate=!0,Ti(pe,ye,Ze),pe.side=$s):Ti(pe,ye,Ze)}E=Qe.get(B),E.init(),A.push(E),B.traverseVisible(function(pe){pe.isLight&&pe.layers.test(le.layers)&&(E.pushLight(pe),pe.castShadow&&E.pushShadow(pe))}),E.setupLights(C.useLegacyLights),B.traverse(function(pe){const ye=pe.material;if(ye)if(Array.isArray(ye))for(let Ze=0;Ze<ye.length;Ze++){const qe=ye[Ze];_e(qe,B,pe)}else _e(ye,B,pe)}),A.pop(),E=null};let Ke=null;function gt(B){Ke&&Ke(B)}function $t(){an.stop()}function un(){an.start()}const an=new IF;an.setAnimationLoop(gt),typeof self<"u"&&an.setContext(self),this.setAnimationLoop=function(B){Ke=B,Ee.setAnimationLoop(B),B===null?an.stop():an.start()},Ee.addEventListener("sessionstart",$t),Ee.addEventListener("sessionend",un),this.render=function(B,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Ee.enabled===!0&&Ee.isPresenting===!0&&(le=Ee.updateCameraXR(le)),B.isScene===!0&&B.onBeforeRender(C,B,le,F),E=Qe.get(B,A.length),E.init(),A.push(E),Ie.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),me.setFromProjectionMatrix(Ie),Ae=this.localClippingEnabled,fe=ht.init(this.clippingPlanes,Ae),$=je.get(B,S.length),$.init(),S.push($),ei(B,le,0,C.sortObjects),$.finish(),C.sortObjects===!0&&$.sort(G,Z),fe===!0&&ht.beginShadows();const _e=E.state.shadowsArray;if(ft.render(_e,B,le),fe===!0&&ht.endShadows(),this.info.autoReset===!0&&this.info.reset(),this.info.render.frame++,He.render($,B),E.setupLights(C.useLegacyLights),le.isArrayCamera){const pe=le.cameras;for(let ye=0,Ze=pe.length;ye<Ze;ye++){const qe=pe[ye];fi($,B,qe,qe.viewport)}}else fi($,B,le);F!==null&&(Je.updateMultisampleRenderTarget(F),Je.updateRenderTargetMipmap(F)),B.isScene===!0&&B.onAfterRender(C,B,le),z.resetDefaultState(),k=-1,D=null,A.pop(),A.length>0?E=A[A.length-1]:E=null,S.pop(),S.length>0?$=S[S.length-1]:$=null};function ei(B,le,_e,pe){if(B.visible===!1)return;if(B.layers.test(le.layers)){if(B.isGroup)_e=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(le);else if(B.isLight)E.pushLight(B),B.castShadow&&E.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||me.intersectsSprite(B)){pe&&ut.setFromMatrixPosition(B.matrixWorld).applyMatrix4(Ie);const qe=ee.update(B),at=B.material;at.visible&&$.push(B,qe,at,_e,ut.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||me.intersectsObject(B))){B.isSkinnedMesh&&B.skeleton.frame!==tt.render.frame&&(B.skeleton.update(),B.skeleton.frame=tt.render.frame);const qe=ee.update(B),at=B.material;if(pe&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),ut.copy(B.boundingSphere.center)):(qe.boundingSphere===null&&qe.computeBoundingSphere(),ut.copy(qe.boundingSphere.center)),ut.applyMatrix4(B.matrixWorld).applyMatrix4(Ie)),Array.isArray(at)){const rt=qe.groups;for(let pt=0,ke=rt.length;pt<ke;pt++){const It=rt[pt],Ct=at[It.materialIndex];Ct&&Ct.visible&&$.push(B,qe,Ct,_e,ut.z,It)}}else at.visible&&$.push(B,qe,at,_e,ut.z,null)}}const Ze=B.children;for(let qe=0,at=Ze.length;qe<at;qe++)ei(Ze[qe],le,_e,pe)}function fi(B,le,_e,pe){const ye=B.opaque,Ze=B.transmissive,qe=B.transparent;E.setupLightsView(_e),fe===!0&&ht.setGlobalState(C.clippingPlanes,_e),Ze.length>0&&Ki(ye,Ze,le,_e),pe&&Fe.viewport(U.copy(pe)),ye.length>0&&Ci(ye,le,_e),Ze.length>0&&Ci(Ze,le,_e),qe.length>0&&Ci(qe,le,_e),Fe.buffers.depth.setTest(!0),Fe.buffers.depth.setMask(!0),Fe.buffers.color.setMask(!0),Fe.setPolygonOffset(!1)}function Ki(B,le,_e,pe){const ye=Ve.isWebGL2;Ce===null&&(Ce=new lo(1,1,{generateMipmaps:!0,type:Oe.has("EXT_color_buffer_half_float")?Jr:ia,minFilter:Wa,samples:ye&&u===!0?4:0})),C.getDrawingBufferSize(We),ye?Ce.setSize(We.x,We.y):Ce.setSize(jS(We.x),jS(We.y));const Ze=C.getRenderTarget();C.setRenderTarget(Ce),C.getClearColor(ae),ne=C.getClearAlpha(),ne<1&&C.setClearColor(16777215,.5),C.clear();const qe=C.toneMapping;C.toneMapping=kl,Ci(B,_e,pe),Je.updateMultisampleRenderTarget(Ce),Je.updateRenderTargetMipmap(Ce);let at=!1;for(let rt=0,pt=le.length;rt<pt;rt++){const ke=le[rt],It=ke.object,Ct=ke.geometry,wt=ke.material,Ht=ke.group;if(wt.side===$s&&It.layers.test(pe.layers)){const Zt=wt.side;wt.side=Hs,wt.needsUpdate=!0,_i(It,_e,pe,Ct,wt,Ht),wt.side=Zt,wt.needsUpdate=!0,at=!0}}at===!0&&(Je.updateMultisampleRenderTarget(Ce),Je.updateRenderTargetMipmap(Ce)),C.setRenderTarget(Ze),C.setClearColor(ae,ne),C.toneMapping=qe}function Ci(B,le,_e){const pe=le.isScene===!0?le.overrideMaterial:null;for(let ye=0,Ze=B.length;ye<Ze;ye++){const qe=B[ye],at=qe.object,rt=qe.geometry,pt=pe===null?qe.material:pe,ke=qe.group;at.layers.test(_e.layers)&&_i(at,le,_e,rt,pt,ke)}}function _i(B,le,_e,pe,ye,Ze){B.onBeforeRender(C,le,_e,pe,ye,Ze),B.modelViewMatrix.multiplyMatrices(_e.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),ye.onBeforeRender(C,le,_e,pe,B,Ze),ye.transparent===!0&&ye.side===$s&&ye.forceSinglePass===!1?(ye.side=Hs,ye.needsUpdate=!0,C.renderBufferDirect(_e,le,pe,ye,B,Ze),ye.side=za,ye.needsUpdate=!0,C.renderBufferDirect(_e,le,pe,ye,B,Ze),ye.side=$s):C.renderBufferDirect(_e,le,pe,ye,B,Ze),B.onAfterRender(C,le,_e,pe,ye,Ze)}function Ti(B,le,_e){le.isScene!==!0&&(le=Ye);const pe=Ue.get(B),ye=E.state.lights,Ze=E.state.shadowsArray,qe=ye.state.version,at=W.getParameters(B,ye.state,Ze,le,_e),rt=W.getProgramCacheKey(at);let pt=pe.programs;pe.environment=B.isMeshStandardMaterial?le.environment:null,pe.fog=le.fog,pe.envMap=(B.isMeshStandardMaterial?Me:ve).get(B.envMap||pe.environment),pt===void 0&&(B.addEventListener("dispose",j),pt=new Map,pe.programs=pt);let ke=pt.get(rt);if(ke!==void 0){if(pe.currentProgram===ke&&pe.lightsStateVersion===qe)return nn(B,at),ke}else at.uniforms=W.getUniforms(B),B.onBuild(_e,at,C),B.onBeforeCompile(at,C),ke=W.acquireProgram(at,rt),pt.set(rt,ke),pe.uniforms=at.uniforms;const It=pe.uniforms;(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(It.clippingPlanes=ht.uniform),nn(B,at),pe.needsLights=J(B),pe.lightsStateVersion=qe,pe.needsLights&&(It.ambientLightColor.value=ye.state.ambient,It.lightProbe.value=ye.state.probe,It.directionalLights.value=ye.state.directional,It.directionalLightShadows.value=ye.state.directionalShadow,It.spotLights.value=ye.state.spot,It.spotLightShadows.value=ye.state.spotShadow,It.rectAreaLights.value=ye.state.rectArea,It.ltc_1.value=ye.state.rectAreaLTC1,It.ltc_2.value=ye.state.rectAreaLTC2,It.pointLights.value=ye.state.point,It.pointLightShadows.value=ye.state.pointShadow,It.hemisphereLights.value=ye.state.hemi,It.directionalShadowMap.value=ye.state.directionalShadowMap,It.directionalShadowMatrix.value=ye.state.directionalShadowMatrix,It.spotShadowMap.value=ye.state.spotShadowMap,It.spotLightMatrix.value=ye.state.spotLightMatrix,It.spotLightMap.value=ye.state.spotLightMap,It.pointShadowMap.value=ye.state.pointShadowMap,It.pointShadowMatrix.value=ye.state.pointShadowMatrix);const Ct=ke.getUniforms(),wt=_S.seqWithValue(Ct.seq,It);return pe.currentProgram=ke,pe.uniformsList=wt,ke}function nn(B,le){const _e=Ue.get(B);_e.outputColorSpace=le.outputColorSpace,_e.instancing=le.instancing,_e.skinning=le.skinning,_e.morphTargets=le.morphTargets,_e.morphNormals=le.morphNormals,_e.morphColors=le.morphColors,_e.morphTargetsCount=le.morphTargetsCount,_e.numClippingPlanes=le.numClippingPlanes,_e.numIntersection=le.numClipIntersection,_e.vertexAlphas=le.vertexAlphas,_e.vertexTangents=le.vertexTangents,_e.toneMapping=le.toneMapping}function pi(B,le,_e,pe,ye){le.isScene!==!0&&(le=Ye),Je.resetTextureUnits();const Ze=le.fog,qe=pe.isMeshStandardMaterial?le.environment:null,at=F===null?C.outputColorSpace:F.isXRRenderTarget===!0?F.texture.colorSpace:xo,rt=(pe.isMeshStandardMaterial?Me:ve).get(pe.envMap||qe),pt=pe.vertexColors===!0&&!!_e.attributes.color&&_e.attributes.color.itemSize===4,ke=!!_e.attributes.tangent&&(!!pe.normalMap||pe.anisotropy>0),It=!!_e.morphAttributes.position,Ct=!!_e.morphAttributes.normal,wt=!!_e.morphAttributes.color,Ht=pe.toneMapped?C.toneMapping:kl,Zt=_e.morphAttributes.position||_e.morphAttributes.normal||_e.morphAttributes.color,jt=Zt!==void 0?Zt.length:0,Ot=Ue.get(pe),qt=E.state.lights;if(fe===!0&&(Ae===!0||B!==D)){const hn=B===D&&pe.id===k;ht.setState(pe,B,hn)}let Ft=!1;pe.version===Ot.__version?(Ot.needsLights&&Ot.lightsStateVersion!==qt.state.version||Ot.outputColorSpace!==at||ye.isInstancedMesh&&Ot.instancing===!1||!ye.isInstancedMesh&&Ot.instancing===!0||ye.isSkinnedMesh&&Ot.skinning===!1||!ye.isSkinnedMesh&&Ot.skinning===!0||Ot.envMap!==rt||pe.fog===!0&&Ot.fog!==Ze||Ot.numClippingPlanes!==void 0&&(Ot.numClippingPlanes!==ht.numPlanes||Ot.numIntersection!==ht.numIntersection)||Ot.vertexAlphas!==pt||Ot.vertexTangents!==ke||Ot.morphTargets!==It||Ot.morphNormals!==Ct||Ot.morphColors!==wt||Ot.toneMapping!==Ht||Ve.isWebGL2===!0&&Ot.morphTargetsCount!==jt)&&(Ft=!0):(Ft=!0,Ot.__version=pe.version);let ln=Ot.currentProgram;Ft===!0&&(ln=Ti(pe,le,ye));let Fn=!1,sn=!1,$n=!1;const tn=ln.getUniforms(),Un=Ot.uniforms;if(Fe.useProgram(ln.program)&&(Fn=!0,sn=!0,$n=!0),pe.id!==k&&(k=pe.id,sn=!0),Fn||D!==B){if(tn.setValue(Q,"projectionMatrix",B.projectionMatrix),Ve.logarithmicDepthBuffer&&tn.setValue(Q,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),D!==B&&(D=B,sn=!0,$n=!0),pe.isShaderMaterial||pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshStandardMaterial||pe.envMap){const hn=tn.map.cameraPosition;hn!==void 0&&hn.setValue(Q,ut.setFromMatrixPosition(B.matrixWorld))}(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&tn.setValue(Q,"isOrthographic",B.isOrthographicCamera===!0),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial||pe.isShadowMaterial||ye.isSkinnedMesh)&&tn.setValue(Q,"viewMatrix",B.matrixWorldInverse)}if(ye.isSkinnedMesh){tn.setOptional(Q,ye,"bindMatrix"),tn.setOptional(Q,ye,"bindMatrixInverse");const hn=ye.skeleton;hn&&(Ve.floatVertexTextures?(hn.boneTexture===null&&hn.computeBoneTexture(),tn.setValue(Q,"boneTexture",hn.boneTexture,Je),tn.setValue(Q,"boneTextureSize",hn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Rn=_e.morphAttributes;if((Rn.position!==void 0||Rn.normal!==void 0||Rn.color!==void 0&&Ve.isWebGL2===!0)&&St.update(ye,_e,ln),(sn||Ot.receiveShadow!==ye.receiveShadow)&&(Ot.receiveShadow=ye.receiveShadow,tn.setValue(Q,"receiveShadow",ye.receiveShadow)),pe.isMeshGouraudMaterial&&pe.envMap!==null&&(Un.envMap.value=rt,Un.flipEnvMap.value=rt.isCubeTexture&&rt.isRenderTargetTexture===!1?-1:1),sn&&(tn.setValue(Q,"toneMappingExposure",C.toneMappingExposure),Ot.needsLights&&yr(Un,$n),Ze&&pe.fog===!0&&ot.refreshFogUniforms(Un,Ze),ot.refreshMaterialUniforms(Un,pe,Re,ue,Ce),_S.upload(Q,Ot.uniformsList,Un,Je)),pe.isShaderMaterial&&pe.uniformsNeedUpdate===!0&&(_S.upload(Q,Ot.uniformsList,Un,Je),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&tn.setValue(Q,"center",ye.center),tn.setValue(Q,"modelViewMatrix",ye.modelViewMatrix),tn.setValue(Q,"normalMatrix",ye.normalMatrix),tn.setValue(Q,"modelMatrix",ye.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const hn=pe.uniformsGroups;for(let zn=0,In=hn.length;zn<In;zn++)if(Ve.isWebGL2){const Kt=hn[zn];be.update(Kt,ln),be.bind(Kt,ln)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ln}function yr(B,le){B.ambientLightColor.needsUpdate=le,B.lightProbe.needsUpdate=le,B.directionalLights.needsUpdate=le,B.directionalLightShadows.needsUpdate=le,B.pointLights.needsUpdate=le,B.pointLightShadows.needsUpdate=le,B.spotLights.needsUpdate=le,B.spotLightShadows.needsUpdate=le,B.rectAreaLights.needsUpdate=le,B.hemisphereLights.needsUpdate=le}function J(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(B,le,_e){Ue.get(B.texture).__webglTexture=le,Ue.get(B.depthTexture).__webglTexture=_e;const pe=Ue.get(B);pe.__hasExternalTextures=!0,pe.__hasExternalTextures&&(pe.__autoAllocateDepthBuffer=_e===void 0,pe.__autoAllocateDepthBuffer||Oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(B,le){const _e=Ue.get(B);_e.__webglFramebuffer=le,_e.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(B,le=0,_e=0){F=B,I=le,O=_e;let pe=!0,ye=null,Ze=!1,qe=!1;if(B){const rt=Ue.get(B);rt.__useDefaultFramebuffer!==void 0?(Fe.bindFramebuffer(Q.FRAMEBUFFER,null),pe=!1):rt.__webglFramebuffer===void 0?Je.setupRenderTarget(B):rt.__hasExternalTextures&&Je.rebindTextures(B,Ue.get(B.texture).__webglTexture,Ue.get(B.depthTexture).__webglTexture);const pt=B.texture;(pt.isData3DTexture||pt.isDataArrayTexture||pt.isCompressedArrayTexture)&&(qe=!0);const ke=Ue.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(ye=ke[le],Ze=!0):Ve.isWebGL2&&B.samples>0&&Je.useMultisampledRTT(B)===!1?ye=Ue.get(B).__webglMultisampledFramebuffer:ye=ke,U.copy(B.viewport),ce.copy(B.scissor),re=B.scissorTest}else U.copy(K).multiplyScalar(Re).floor(),ce.copy(se).multiplyScalar(Re).floor(),re=Y;if(Fe.bindFramebuffer(Q.FRAMEBUFFER,ye)&&Ve.drawBuffers&&pe&&Fe.drawBuffers(B,ye),Fe.viewport(U),Fe.scissor(ce),Fe.setScissorTest(re),Ze){const rt=Ue.get(B.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+le,rt.__webglTexture,_e)}else if(qe){const rt=Ue.get(B.texture),pt=le||0;Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,rt.__webglTexture,_e||0,pt)}k=-1},this.readRenderTargetPixels=function(B,le,_e,pe,ye,Ze,qe){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let at=Ue.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&qe!==void 0&&(at=at[qe]),at){Fe.bindFramebuffer(Q.FRAMEBUFFER,at);try{const rt=B.texture,pt=rt.format,ke=rt.type;if(pt!==Yr&&he.convert(pt)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const It=ke===Jr&&(Oe.has("EXT_color_buffer_half_float")||Ve.isWebGL2&&Oe.has("EXT_color_buffer_float"));if(ke!==ia&&he.convert(ke)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ke===Lr&&(Ve.isWebGL2||Oe.has("OES_texture_float")||Oe.has("WEBGL_color_buffer_float")))&&!It){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=B.width-pe&&_e>=0&&_e<=B.height-ye&&Q.readPixels(le,_e,pe,ye,he.convert(pt),he.convert(ke),Ze)}finally{const rt=F!==null?Ue.get(F).__webglFramebuffer:null;Fe.bindFramebuffer(Q.FRAMEBUFFER,rt)}}},this.copyFramebufferToTexture=function(B,le,_e=0){const pe=Math.pow(2,-_e),ye=Math.floor(le.image.width*pe),Ze=Math.floor(le.image.height*pe);Je.setTexture2D(le,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,_e,0,0,B.x,B.y,ye,Ze),Fe.unbindTexture()},this.copyTextureToTexture=function(B,le,_e,pe=0){const ye=le.image.width,Ze=le.image.height,qe=he.convert(_e.format),at=he.convert(_e.type);Je.setTexture2D(_e,0),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,_e.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,_e.unpackAlignment),le.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,pe,B.x,B.y,ye,Ze,qe,at,le.image.data):le.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,pe,B.x,B.y,le.mipmaps[0].width,le.mipmaps[0].height,qe,le.mipmaps[0].data):Q.texSubImage2D(Q.TEXTURE_2D,pe,B.x,B.y,qe,at,le.image),pe===0&&_e.generateMipmaps&&Q.generateMipmap(Q.TEXTURE_2D),Fe.unbindTexture()},this.copyTextureToTexture3D=function(B,le,_e,pe,ye=0){if(C.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ze=B.max.x-B.min.x+1,qe=B.max.y-B.min.y+1,at=B.max.z-B.min.z+1,rt=he.convert(pe.format),pt=he.convert(pe.type);let ke;if(pe.isData3DTexture)Je.setTexture3D(pe,0),ke=Q.TEXTURE_3D;else if(pe.isDataArrayTexture)Je.setTexture2DArray(pe,0),ke=Q.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,pe.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,pe.unpackAlignment);const It=Q.getParameter(Q.UNPACK_ROW_LENGTH),Ct=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),wt=Q.getParameter(Q.UNPACK_SKIP_PIXELS),Ht=Q.getParameter(Q.UNPACK_SKIP_ROWS),Zt=Q.getParameter(Q.UNPACK_SKIP_IMAGES),jt=_e.isCompressedTexture?_e.mipmaps[0]:_e.image;Q.pixelStorei(Q.UNPACK_ROW_LENGTH,jt.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,jt.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,B.min.x),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,B.min.y),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,B.min.z),_e.isDataTexture||_e.isData3DTexture?Q.texSubImage3D(ke,ye,le.x,le.y,le.z,Ze,qe,at,rt,pt,jt.data):_e.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Q.compressedTexSubImage3D(ke,ye,le.x,le.y,le.z,Ze,qe,at,rt,jt.data)):Q.texSubImage3D(ke,ye,le.x,le.y,le.z,Ze,qe,at,rt,pt,jt),Q.pixelStorei(Q.UNPACK_ROW_LENGTH,It),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,Ct),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,wt),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Ht),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,Zt),ye===0&&pe.generateMipmaps&&Q.generateMipmap(ke),Fe.unbindTexture()},this.initTexture=function(B){B.isCubeTexture?Je.setTextureCube(B,0):B.isData3DTexture?Je.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?Je.setTexture2DArray(B,0):Je.setTexture2D(B,0),Fe.unbindTexture()},this.resetState=function(){I=0,O=0,F=null,Fe.reset(),z.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return $c}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===vn?Rc:C$}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Rc?vn:xo}}class BF extends O${}BF.prototype.isWebGL1Renderer=!0;class L${constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new xt(e),this.density=n}clone(){return new L$(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class N${constructor(e,n=1,r=1e3){this.isFog=!0,this.name="",this.color=new xt(e),this.near=n,this.far=r}clone(){return new N$(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Yg extends Xn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class n_{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=iE,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ra()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,r){e*=this.stride,r*=n.stride;for(let s=0,a=this.stride;s<a;s++)this.array[e+s]=n.array[r+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ra()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(n,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ra()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const io=new ie;class oo{constructor(e,n,r,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=r,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,r=this.data.count;n<r;n++)io.fromBufferAttribute(this,n),io.applyMatrix4(e),this.setXYZ(n,io.x,io.y,io.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)io.fromBufferAttribute(this,n),io.applyNormalMatrix(e),this.setXYZ(n,io.x,io.y,io.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)io.fromBufferAttribute(this,n),io.transformDirection(e),this.setXYZ(n,io.x,io.y,io.z);return this}setX(e,n){return this.normalized&&(n=kn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=kn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=kn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=kn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=ea(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=ea(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=ea(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=ea(n,this.array)),n}setXY(e,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this}setXYZ(e,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=s,this}setXYZW(e,n,r,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(n=kn(n,this.array),r=kn(r,this.array),s=kn(s,this.array),a=kn(a,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=s,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)n.push(this.data.array[s+a])}return new Qn(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new oo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const s=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)n.push(this.data.array[s+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class bM extends ir{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let qm;const GT=new ie,Qm=new ie,eg=new ie,tg=new mt,HT=new mt,FF=new pn,m0=new ie,VT=new ie,g0=new ie,pN=new mt,$C=new mt,mN=new mt;class UF extends Xn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",qm===void 0){qm=new on;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new n_(n,5);qm.setIndex([0,1,2,0,2,3]),qm.setAttribute("position",new oo(r,3,0,!1)),qm.setAttribute("uv",new oo(r,2,3,!1))}this.geometry=qm,this.material=e!==void 0?e:new bM,this.center=new mt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qm.setFromMatrixScale(this.matrixWorld),FF.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),eg.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Qm.multiplyScalar(-eg.z);const r=this.material.rotation;let s,a;r!==0&&(a=Math.cos(r),s=Math.sin(r));const l=this.center;_0(m0.set(-.5,-.5,0),eg,l,Qm,s,a),_0(VT.set(.5,-.5,0),eg,l,Qm,s,a),_0(g0.set(.5,.5,0),eg,l,Qm,s,a),pN.set(0,0),$C.set(1,0),mN.set(1,1);let u=e.ray.intersectTriangle(m0,VT,g0,!1,GT);if(u===null&&(_0(VT.set(-.5,.5,0),eg,l,Qm,s,a),$C.set(0,1),u=e.ray.intersectTriangle(m0,g0,VT,!1,GT),u===null))return;const d=e.ray.origin.distanceTo(GT);d<e.near||d>e.far||n.push({distance:d,point:GT.clone(),uv:$o.getInterpolation(GT,m0,VT,g0,pN,$C,mN,new mt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function _0(i,e,n,r,s,a){tg.subVectors(i,n).addScalar(.5).multiply(r),s!==void 0?(HT.x=a*tg.x-s*tg.y,HT.y=s*tg.x+a*tg.y):HT.copy(tg),i.copy(e),i.x+=HT.x,i.y+=HT.y,i.applyMatrix4(FF)}const T0=new ie,gN=new ie;class GF extends Xn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let r=0,s=n.length;r<s;r++){const a=n[r];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,r=0){n=Math.abs(n);const s=this.levels;let a;for(a=0;a<s.length&&!(n<s[a].distance);a++);return s.splice(a,0,{distance:n,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let r,s;for(r=1,s=n.length;r<s;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),e<a)break}return n[r-1].object}return null}raycast(e,n){if(this.levels.length>0){T0.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(T0);this.getObjectForDistance(s).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){T0.setFromMatrixPosition(e.matrixWorld),gN.setFromMatrixPosition(this.matrixWorld);const r=T0.distanceTo(gN)/e.zoom;n[0].object.visible=!0;let s,a;for(s=1,a=n.length;s<a;s++){let l=n[s].distance;if(n[s].object.visible&&(l-=l*n[s].hysteresis),r>=l)n[s-1].object.visible=!1,n[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<a;s++)n[s].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const r=this.levels;for(let s=0,a=r.length;s<a;s++){const l=r[s];n.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return n}}const _N=new ie,TN=new Hn,vN=new Hn,hX=new ie,EN=new pn,ng=new ie,bC=new Ws,yN=new pn,AC=new Op;class k$ extends Bn{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new pn,this.bindMatrixInverse=new pn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new zs),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)ng.fromBufferAttribute(n,r),this.applyBoneTransform(r,ng),this.boundingBox.expandByPoint(ng)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ws),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)ng.fromBufferAttribute(n,r),this.applyBoneTransform(r,ng),this.boundingSphere.expandByPoint(ng)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const r=this.material,s=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bC.copy(this.boundingSphere),bC.applyMatrix4(s),e.ray.intersectsSphere(bC)!==!1&&(yN.copy(s).invert(),AC.copy(e.ray).applyMatrix4(yN),!(this.boundingBox!==null&&AC.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,AC)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hn,n=this.geometry.attributes.skinWeight;for(let r=0,s=n.count;r<s;r++){e.fromBufferAttribute(n,r);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),n.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const r=this.skeleton,s=this.geometry;TN.fromBufferAttribute(s.attributes.skinIndex,e),vN.fromBufferAttribute(s.attributes.skinWeight,e),_N.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let a=0;a<4;a++){const l=vN.getComponent(a);if(l!==0){const u=TN.getComponent(a);EN.multiplyMatrices(r.bones[u].matrixWorld,r.boneInverses[u]),n.addScaledVector(hX.copy(_N).applyMatrix4(EN),l)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class AE extends Xn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class up extends ni{constructor(e=null,n=1,r=1,s,a,l,u,d,h=er,f=er,p,m){super(null,l,u,d,h,f,s,a,p,m),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const SN=new pn,dX=new pn;class i_{constructor(e=[],n=[]){this.uuid=ra(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,s=this.bones.length;r<s;r++)this.boneInverses.push(new pn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const r=new pn;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,n=this.boneInverses,r=this.boneMatrices,s=this.boneTexture;for(let a=0,l=e.length;a<l;a++){const u=e[a]?e[a].matrixWorld:dX;SN.multiplyMatrices(u,n[a]),SN.toArray(r,a*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new i_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=CF(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const r=new up(n,e,e,Yr,Lr);return r.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,r=this.bones.length;n<r;n++){const s=this.bones[n];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let r=0,s=e.bones.length;r<s;r++){const a=e.bones[r];let l=n[a];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),l=new AE),this.bones.push(l),this.boneInverses.push(new pn().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,r=this.boneInverses;for(let s=0,a=n.length;s<a;s++){const l=n[s];e.bones.push(l.uuid);const u=r[s];e.boneInverses.push(u.toArray())}return e}}class hd extends Qn{constructor(e,n,r,s=1){super(e,n,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ig=new pn,$N=new pn,v0=[],bN=new zs,fX=new pn,zT=new Bn,WT=new Ws;class P$ extends Bn{constructor(e,n,r){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new hd(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<r;s++)this.setMatrixAt(s,fX)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new zs),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,ig),bN.copy(e.boundingBox).applyMatrix4(ig),this.boundingBox.union(bN)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ws),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,ig),WT.copy(e.boundingSphere).applyMatrix4(ig),this.boundingSphere.union(WT)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const r=this.matrixWorld,s=this.count;if(zT.geometry=this.geometry,zT.material=this.material,zT.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),WT.copy(this.boundingSphere),WT.applyMatrix4(r),e.ray.intersectsSphere(WT)!==!1))for(let a=0;a<s;a++){this.getMatrixAt(a,ig),$N.multiplyMatrices(r,ig),zT.matrixWorld=$N,zT.raycast(e,v0);for(let l=0,u=v0.length;l<u;l++){const d=v0[l];d.instanceId=a,d.object=this,n.push(d)}v0.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new hd(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Ai extends ir{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const AN=new ie,CN=new ie,RN=new pn,CC=new Op,E0=new Ws;let pr=class extends Xn{constructor(e=new on,n=new Ai){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let s=1,a=n.count;s<a;s++)AN.fromBufferAttribute(n,s-1),CN.fromBufferAttribute(n,s),r[s]=r[s-1],r[s]+=AN.distanceTo(CN);e.setAttribute("lineDistance",new Yt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,s=this.matrixWorld,a=e.params.Line.threshold,l=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),E0.copy(r.boundingSphere),E0.applyMatrix4(s),E0.radius+=a,e.ray.intersectsSphere(E0)===!1)return;RN.copy(s).invert(),CC.copy(e.ray).applyMatrix4(RN);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,h=new ie,f=new ie,p=new ie,m=new ie,v=this.isLineSegments?2:1,y=r.index,E=r.attributes.position;if(y!==null){const S=Math.max(0,l.start),A=Math.min(y.count,l.start+l.count);for(let C=S,x=A-1;C<x;C+=v){const I=y.getX(C),O=y.getX(C+1);if(h.fromBufferAttribute(E,I),f.fromBufferAttribute(E,O),CC.distanceSqToSegment(h,f,m,p)>d)continue;m.applyMatrix4(this.matrixWorld);const k=e.ray.origin.distanceTo(m);k<e.near||k>e.far||n.push({distance:k,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else{const S=Math.max(0,l.start),A=Math.min(E.count,l.start+l.count);for(let C=S,x=A-1;C<x;C+=v){if(h.fromBufferAttribute(E,C),f.fromBufferAttribute(E,C+1),CC.distanceSqToSegment(h,f,m,p)>d)continue;m.applyMatrix4(this.matrixWorld);const O=e.ray.origin.distanceTo(m);O<e.near||O>e.far||n.push({distance:O,point:p.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=s.length;a<l;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}};const xN=new ie,wN=new ie;class Ya extends pr{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let s=0,a=n.count;s<a;s+=2)xN.fromBufferAttribute(n,s),wN.fromBufferAttribute(n,s+1),r[s]=s===0?0:r[s-1],r[s+1]=r[s]+xN.distanceTo(wN);e.setAttribute("lineDistance",new Yt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class D$ extends pr{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class CE extends ir{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const MN=new pn,Bx=new Op,y0=new Ws,S0=new ie;class B$ extends Xn{constructor(e=new on,n=new CE){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const r=this.geometry,s=this.matrixWorld,a=e.params.Points.threshold,l=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),y0.copy(r.boundingSphere),y0.applyMatrix4(s),y0.radius+=a,e.ray.intersectsSphere(y0)===!1)return;MN.copy(s).invert(),Bx.copy(e.ray).applyMatrix4(MN);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=u*u,h=r.index,p=r.attributes.position;if(h!==null){const m=Math.max(0,l.start),v=Math.min(h.count,l.start+l.count);for(let y=m,$=v;y<$;y++){const E=h.getX(y);S0.fromBufferAttribute(p,E),IN(S0,E,d,s,e,n,this)}}else{const m=Math.max(0,l.start),v=Math.min(p.count,l.start+l.count);for(let y=m,$=v;y<$;y++)S0.fromBufferAttribute(p,y),IN(S0,y,d,s,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const s=n[r[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=s.length;a<l;a++){const u=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}function IN(i,e,n,r,s,a,l){const u=Bx.distanceSqToPoint(i);if(u<n){const d=new ie;Bx.closestPointToPoint(i,d),d.applyMatrix4(r);const h=s.ray.origin.distanceTo(d);if(h<s.near||h>s.far)return;a.push({distance:h,distanceToRay:Math.sqrt(u),point:d,index:e,face:null,object:l})}}class pX extends ni{constructor(e,n,r,s,a,l,u,d,h){super(e,n,r,s,a,l,u,d,h),this.isVideoTexture=!0,this.minFilter=l!==void 0?l:Dn,this.magFilter=a!==void 0?a:Dn,this.generateMipmaps=!1;const f=this;function p(){f.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class mX extends ni{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=er,this.minFilter=er,this.generateMipmaps=!1,this.needsUpdate=!0}}class AM extends ni{constructor(e,n,r,s,a,l,u,d,h,f,p,m){super(null,l,u,d,h,f,s,a,p,m),this.isCompressedTexture=!0,this.image={width:n,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class gX extends AM{constructor(e,n,r,s,a,l){super(e,n,r,a,l),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Pi}}class _X extends ni{constructor(e,n,r,s,a,l,u,d,h){super(e,n,r,s,a,l,u,d,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Fl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,s=this.getPoint(0),a=0;n.push(0);for(let l=1;l<=e;l++)r=this.getPoint(l/e),a+=r.distanceTo(s),n.push(a),s=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const r=this.getLengths();let s=0;const a=r.length;let l;n?l=n:l=e*r[a-1];let u=0,d=a-1,h;for(;u<=d;)if(s=Math.floor(u+(d-u)/2),h=r[s]-l,h<0)u=s+1;else if(h>0)d=s-1;else{d=s;break}if(s=d,r[s]===l)return s/(a-1);const f=r[s],m=r[s+1]-f,v=(l-f)/m;return(s+v)/(a-1)}getTangent(e,n){let s=e-1e-4,a=e+1e-4;s<0&&(s=0),a>1&&(a=1);const l=this.getPoint(s),u=this.getPoint(a),d=n||(l.isVector2?new mt:new ie);return d.copy(u).sub(l).normalize(),d}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n){const r=new ie,s=[],a=[],l=[],u=new ie,d=new pn;for(let v=0;v<=e;v++){const y=v/e;s[v]=this.getTangentAt(y,new ie)}a[0]=new ie,l[0]=new ie;let h=Number.MAX_VALUE;const f=Math.abs(s[0].x),p=Math.abs(s[0].y),m=Math.abs(s[0].z);f<=h&&(h=f,r.set(1,0,0)),p<=h&&(h=p,r.set(0,1,0)),m<=h&&r.set(0,0,1),u.crossVectors(s[0],r).normalize(),a[0].crossVectors(s[0],u),l[0].crossVectors(s[0],a[0]);for(let v=1;v<=e;v++){if(a[v]=a[v-1].clone(),l[v]=l[v-1].clone(),u.crossVectors(s[v-1],s[v]),u.length()>Number.EPSILON){u.normalize();const y=Math.acos(fr(s[v-1].dot(s[v]),-1,1));a[v].applyMatrix4(d.makeRotationAxis(u,y))}l[v].crossVectors(s[v],a[v])}if(n===!0){let v=Math.acos(fr(a[0].dot(a[e]),-1,1));v/=e,s[0].dot(u.crossVectors(a[0],a[e]))>0&&(v=-v);for(let y=1;y<=e;y++)a[y].applyMatrix4(d.makeRotationAxis(s[y],v*y)),l[y].crossVectors(s[y],a[y])}return{tangents:s,normals:a,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class F$ extends Fl{constructor(e=0,n=0,r=1,s=1,a=0,l=Math.PI*2,u=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=r,this.yRadius=s,this.aStartAngle=a,this.aEndAngle=l,this.aClockwise=u,this.aRotation=d}getPoint(e,n){const r=n||new mt,s=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const l=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=s;for(;a>s;)a-=s;a<Number.EPSILON&&(l?a=0:a=s),this.aClockwise===!0&&!l&&(a===s?a=-s:a=a-s);const u=this.aStartAngle+e*a;let d=this.aX+this.xRadius*Math.cos(u),h=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),m=d-this.aX,v=h-this.aY;d=m*f-v*p+this.aX,h=m*p+v*f+this.aY}return r.set(d,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class HF extends F${constructor(e,n,r,s,a,l){super(e,n,r,r,s,a,l),this.isArcCurve=!0,this.type="ArcCurve"}}function CM(){let i=0,e=0,n=0,r=0;function s(a,l,u,d){i=a,e=u,n=-3*a+3*l-2*u-d,r=2*a-2*l+u+d}return{initCatmullRom:function(a,l,u,d,h){s(l,u,h*(u-a),h*(d-l))},initNonuniformCatmullRom:function(a,l,u,d,h,f,p){let m=(l-a)/h-(u-a)/(h+f)+(u-l)/f,v=(u-l)/f-(d-l)/(f+p)+(d-u)/p;m*=f,v*=f,s(l,u,m,v)},calc:function(a){const l=a*a,u=l*a;return i+e*a+n*l+r*u}}}const $0=new ie,RC=new CM,xC=new CM,wC=new CM;class VF extends Fl{constructor(e=[],n=!1,r="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=r,this.tension=s}getPoint(e,n=new ie){const r=n,s=this.points,a=s.length,l=(a-(this.closed?0:1))*e;let u=Math.floor(l),d=l-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/a)+1)*a:d===0&&u===a-1&&(u=a-2,d=1);let h,f;this.closed||u>0?h=s[(u-1)%a]:($0.subVectors(s[0],s[1]).add(s[0]),h=$0);const p=s[u%a],m=s[(u+1)%a];if(this.closed||u+2<a?f=s[(u+2)%a]:($0.subVectors(s[a-1],s[a-2]).add(s[a-1]),f=$0),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let y=Math.pow(h.distanceToSquared(p),v),$=Math.pow(p.distanceToSquared(m),v),E=Math.pow(m.distanceToSquared(f),v);$<1e-4&&($=1),y<1e-4&&(y=$),E<1e-4&&(E=$),RC.initNonuniformCatmullRom(h.x,p.x,m.x,f.x,y,$,E),xC.initNonuniformCatmullRom(h.y,p.y,m.y,f.y,y,$,E),wC.initNonuniformCatmullRom(h.z,p.z,m.z,f.z,y,$,E)}else this.curveType==="catmullrom"&&(RC.initCatmullRom(h.x,p.x,m.x,f.x,this.tension),xC.initCatmullRom(h.y,p.y,m.y,f.y,this.tension),wC.initCatmullRom(h.z,p.z,m.z,f.z,this.tension));return r.set(RC.calc(d),xC.calc(d),wC.calc(d)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(new ie().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ON(i,e,n,r,s){const a=(r-e)*.5,l=(s-n)*.5,u=i*i,d=i*u;return(2*n-2*r+a+l)*d+(-3*n+3*r-2*a-l)*u+a*i+n}function TX(i,e){const n=1-i;return n*n*e}function vX(i,e){return 2*(1-i)*i*e}function EX(i,e){return i*i*e}function Iv(i,e,n,r){return TX(i,e)+vX(i,n)+EX(i,r)}function yX(i,e){const n=1-i;return n*n*n*e}function SX(i,e){const n=1-i;return 3*n*n*i*e}function $X(i,e){return 3*(1-i)*i*i*e}function bX(i,e){return i*i*i*e}function Ov(i,e,n,r,s){return yX(i,e)+SX(i,n)+$X(i,r)+bX(i,s)}class RM extends Fl{constructor(e=new mt,n=new mt,r=new mt,s=new mt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=r,this.v3=s}getPoint(e,n=new mt){const r=n,s=this.v0,a=this.v1,l=this.v2,u=this.v3;return r.set(Ov(e,s.x,a.x,l.x,u.x),Ov(e,s.y,a.y,l.y,u.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zF extends Fl{constructor(e=new ie,n=new ie,r=new ie,s=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=r,this.v3=s}getPoint(e,n=new ie){const r=n,s=this.v0,a=this.v1,l=this.v2,u=this.v3;return r.set(Ov(e,s.x,a.x,l.x,u.x),Ov(e,s.y,a.y,l.y,u.y),Ov(e,s.z,a.z,l.z,u.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class U$ extends Fl{constructor(e=new mt,n=new mt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new mt){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new mt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WF extends Fl{constructor(e=new ie,n=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ie){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ie){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xM extends Fl{constructor(e=new mt,n=new mt,r=new mt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new mt){const r=n,s=this.v0,a=this.v1,l=this.v2;return r.set(Iv(e,s.x,a.x,l.x),Iv(e,s.y,a.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class wM extends Fl{constructor(e=new ie,n=new ie,r=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new ie){const r=n,s=this.v0,a=this.v1,l=this.v2;return r.set(Iv(e,s.x,a.x,l.x),Iv(e,s.y,a.y,l.y),Iv(e,s.z,a.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class MM extends Fl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new mt){const r=n,s=this.points,a=(s.length-1)*e,l=Math.floor(a),u=a-l,d=s[l===0?l:l-1],h=s[l],f=s[l>s.length-2?s.length-1:l+1],p=s[l>s.length-3?s.length-1:l+2];return r.set(ON(u,d.x,h.x,f.x,p.x),ON(u,d.y,h.y,f.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const s=e.points[n];this.points.push(new mt().fromArray(s))}return this}}var IM=Object.freeze({__proto__:null,ArcCurve:HF,CatmullRomCurve3:VF,CubicBezierCurve:RM,CubicBezierCurve3:zF,EllipseCurve:F$,LineCurve:U$,LineCurve3:WF,QuadraticBezierCurve:xM,QuadraticBezierCurve3:wM,SplineCurve:MM});class XF extends Fl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new U$(n,e))}getPoint(e,n){const r=e*this.getLength(),s=this.getCurveLengths();let a=0;for(;a<s.length;){if(s[a]>=r){const l=s[a]-r,u=this.curves[a],d=u.getLength(),h=d===0?0:1-l/d;return u.getPointAt(h,n)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let r=0,s=this.curves.length;r<s;r++)n+=this.curves[r].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let r;for(let s=0,a=this.curves;s<a.length;s++){const l=a[s],u=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,d=l.getPoints(u);for(let h=0;h<d.length;h++){const f=d[h];r&&r.equals(f)||(n.push(f),r=f)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const s=e.curves[n];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,r=this.curves.length;n<r;n++){const s=this.curves[n];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const s=e.curves[n];this.curves.push(new IM[s.type]().fromJSON(s))}return this}}class aE extends XF{constructor(e){super(),this.type="Path",this.currentPoint=new mt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,r=e.length;n<r;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const r=new U$(this.currentPoint.clone(),new mt(e,n));return this.curves.push(r),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,r,s){const a=new xM(this.currentPoint.clone(),new mt(e,n),new mt(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}bezierCurveTo(e,n,r,s,a,l){const u=new RM(this.currentPoint.clone(),new mt(e,n),new mt(r,s),new mt(a,l));return this.curves.push(u),this.currentPoint.set(a,l),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),r=new MM(n);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,r,s,a,l){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+u,n+d,r,s,a,l),this}absarc(e,n,r,s,a,l){return this.absellipse(e,n,r,r,s,a,l),this}ellipse(e,n,r,s,a,l,u,d){const h=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+h,n+f,r,s,a,l,u,d),this}absellipse(e,n,r,s,a,l,u,d){const h=new F$(e,n,r,s,a,l,u,d);if(this.curves.length>0){const p=h.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(h);const f=h.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class r_ extends on{constructor(e=[new mt(0,-.5),new mt(.5,0),new mt(0,.5)],n=12,r=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:r,phiLength:s},n=Math.floor(n),s=fr(s,0,Math.PI*2);const a=[],l=[],u=[],d=[],h=[],f=1/n,p=new ie,m=new mt,v=new ie,y=new ie,$=new ie;let E=0,S=0;for(let A=0;A<=e.length-1;A++)switch(A){case 0:E=e[A+1].x-e[A].x,S=e[A+1].y-e[A].y,v.x=S*1,v.y=-E,v.z=S*0,$.copy(v),v.normalize(),d.push(v.x,v.y,v.z);break;case e.length-1:d.push($.x,$.y,$.z);break;default:E=e[A+1].x-e[A].x,S=e[A+1].y-e[A].y,v.x=S*1,v.y=-E,v.z=S*0,y.copy(v),v.x+=$.x,v.y+=$.y,v.z+=$.z,v.normalize(),d.push(v.x,v.y,v.z),$.copy(y)}for(let A=0;A<=n;A++){const C=r+A*f*s,x=Math.sin(C),I=Math.cos(C);for(let O=0;O<=e.length-1;O++){p.x=e[O].x*x,p.y=e[O].y,p.z=e[O].x*I,l.push(p.x,p.y,p.z),m.x=A/n,m.y=O/(e.length-1),u.push(m.x,m.y);const F=d[3*O+0]*x,k=d[3*O+1],D=d[3*O+0]*I;h.push(F,k,D)}}for(let A=0;A<n;A++)for(let C=0;C<e.length-1;C++){const x=C+A*e.length,I=x,O=x+e.length,F=x+e.length+1,k=x+1;a.push(I,O,k),a.push(F,k,O)}this.setIndex(a),this.setAttribute("position",new Yt(l,3)),this.setAttribute("uv",new Yt(u,2)),this.setAttribute("normal",new Yt(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r_(e.points,e.segments,e.phiStart,e.phiLength)}}class RE extends r_{constructor(e=1,n=1,r=4,s=8){const a=new aE;a.absarc(0,-n/2,e,Math.PI*1.5,0),a.absarc(0,n/2,e,0,Math.PI*.5),super(a.getPoints(r),s),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:r,radialSegments:s}}static fromJSON(e){return new RE(e.radius,e.length,e.capSegments,e.radialSegments)}}class xE extends on{constructor(e=1,n=32,r=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:r,thetaLength:s},n=Math.max(3,n);const a=[],l=[],u=[],d=[],h=new ie,f=new mt;l.push(0,0,0),u.push(0,0,1),d.push(.5,.5);for(let p=0,m=3;p<=n;p++,m+=3){const v=r+p/n*s;h.x=e*Math.cos(v),h.y=e*Math.sin(v),l.push(h.x,h.y,h.z),u.push(0,0,1),f.x=(l[m]/e+1)/2,f.y=(l[m+1]/e+1)/2,d.push(f.x,f.y)}for(let p=1;p<=n;p++)a.push(p,p+1,0);this.setIndex(a),this.setAttribute("position",new Yt(l,3)),this.setAttribute("normal",new Yt(u,3)),this.setAttribute("uv",new Yt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xE(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Lp extends on{constructor(e=1,n=1,r=1,s=32,a=1,l=!1,u=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:s,heightSegments:a,openEnded:l,thetaStart:u,thetaLength:d};const h=this;s=Math.floor(s),a=Math.floor(a);const f=[],p=[],m=[],v=[];let y=0;const $=[],E=r/2;let S=0;A(),l===!1&&(e>0&&C(!0),n>0&&C(!1)),this.setIndex(f),this.setAttribute("position",new Yt(p,3)),this.setAttribute("normal",new Yt(m,3)),this.setAttribute("uv",new Yt(v,2));function A(){const x=new ie,I=new ie;let O=0;const F=(n-e)/r;for(let k=0;k<=a;k++){const D=[],U=k/a,ce=U*(n-e)+e;for(let re=0;re<=s;re++){const ae=re/s,ne=ae*d+u,de=Math.sin(ne),ue=Math.cos(ne);I.x=ce*de,I.y=-U*r+E,I.z=ce*ue,p.push(I.x,I.y,I.z),x.set(de,F,ue).normalize(),m.push(x.x,x.y,x.z),v.push(ae,1-U),D.push(y++)}$.push(D)}for(let k=0;k<s;k++)for(let D=0;D<a;D++){const U=$[D][k],ce=$[D+1][k],re=$[D+1][k+1],ae=$[D][k+1];f.push(U,ce,ae),f.push(ce,re,ae),O+=6}h.addGroup(S,O,0),S+=O}function C(x){const I=y,O=new mt,F=new ie;let k=0;const D=x===!0?e:n,U=x===!0?1:-1;for(let re=1;re<=s;re++)p.push(0,E*U,0),m.push(0,U,0),v.push(.5,.5),y++;const ce=y;for(let re=0;re<=s;re++){const ne=re/s*d+u,de=Math.cos(ne),ue=Math.sin(ne);F.x=D*ue,F.y=E*U,F.z=D*de,p.push(F.x,F.y,F.z),m.push(0,U,0),O.x=de*.5+.5,O.y=ue*.5*U+.5,v.push(O.x,O.y),y++}for(let re=0;re<s;re++){const ae=I+re,ne=ce+re;x===!0?f.push(ne,ne+1,ae):f.push(ne+1,ne,ae),k+=3}h.addGroup(S,k,x===!0?1:2),S+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lp(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class wE extends Lp{constructor(e=1,n=1,r=32,s=1,a=!1,l=0,u=Math.PI*2){super(0,e,n,r,s,a,l,u),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:l,thetaLength:u}}static fromJSON(e){return new wE(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Du extends on{constructor(e=[],n=[],r=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:r,detail:s};const a=[],l=[];u(s),h(r),f(),this.setAttribute("position",new Yt(a,3)),this.setAttribute("normal",new Yt(a.slice(),3)),this.setAttribute("uv",new Yt(l,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function u(A){const C=new ie,x=new ie,I=new ie;for(let O=0;O<n.length;O+=3)v(n[O+0],C),v(n[O+1],x),v(n[O+2],I),d(C,x,I,A)}function d(A,C,x,I){const O=I+1,F=[];for(let k=0;k<=O;k++){F[k]=[];const D=A.clone().lerp(x,k/O),U=C.clone().lerp(x,k/O),ce=O-k;for(let re=0;re<=ce;re++)re===0&&k===O?F[k][re]=D:F[k][re]=D.clone().lerp(U,re/ce)}for(let k=0;k<O;k++)for(let D=0;D<2*(O-k)-1;D++){const U=Math.floor(D/2);D%2===0?(m(F[k][U+1]),m(F[k+1][U]),m(F[k][U])):(m(F[k][U+1]),m(F[k+1][U+1]),m(F[k+1][U]))}}function h(A){const C=new ie;for(let x=0;x<a.length;x+=3)C.x=a[x+0],C.y=a[x+1],C.z=a[x+2],C.normalize().multiplyScalar(A),a[x+0]=C.x,a[x+1]=C.y,a[x+2]=C.z}function f(){const A=new ie;for(let C=0;C<a.length;C+=3){A.x=a[C+0],A.y=a[C+1],A.z=a[C+2];const x=E(A)/2/Math.PI+.5,I=S(A)/Math.PI+.5;l.push(x,1-I)}y(),p()}function p(){for(let A=0;A<l.length;A+=6){const C=l[A+0],x=l[A+2],I=l[A+4],O=Math.max(C,x,I),F=Math.min(C,x,I);O>.9&&F<.1&&(C<.2&&(l[A+0]+=1),x<.2&&(l[A+2]+=1),I<.2&&(l[A+4]+=1))}}function m(A){a.push(A.x,A.y,A.z)}function v(A,C){const x=A*3;C.x=e[x+0],C.y=e[x+1],C.z=e[x+2]}function y(){const A=new ie,C=new ie,x=new ie,I=new ie,O=new mt,F=new mt,k=new mt;for(let D=0,U=0;D<a.length;D+=9,U+=6){A.set(a[D+0],a[D+1],a[D+2]),C.set(a[D+3],a[D+4],a[D+5]),x.set(a[D+6],a[D+7],a[D+8]),O.set(l[U+0],l[U+1]),F.set(l[U+2],l[U+3]),k.set(l[U+4],l[U+5]),I.copy(A).add(C).add(x).divideScalar(3);const ce=E(I);$(O,U+0,A,ce),$(F,U+2,C,ce),$(k,U+4,x,ce)}}function $(A,C,x,I){I<0&&A.x===1&&(l[C]=A.x-1),x.x===0&&x.z===0&&(l[C]=I/2/Math.PI+.5)}function E(A){return Math.atan2(A.z,-A.x)}function S(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Du(e.vertices,e.indices,e.radius,e.details)}}class ME extends Du{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,s=1/r,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-r,0,-s,r,0,s,-r,0,s,r,-s,-r,0,-s,r,0,s,-r,0,s,r,0,-r,0,-s,r,0,-s,-r,0,s,r,0,s],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(a,l,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ME(e.radius,e.detail)}}const b0=new ie,A0=new ie,MC=new ie,C0=new $o;class jF extends on{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const s=Math.pow(10,4),a=Math.cos(ap*n),l=e.getIndex(),u=e.getAttribute("position"),d=l?l.count:u.count,h=[0,0,0],f=["a","b","c"],p=new Array(3),m={},v=[];for(let y=0;y<d;y+=3){l?(h[0]=l.getX(y),h[1]=l.getX(y+1),h[2]=l.getX(y+2)):(h[0]=y,h[1]=y+1,h[2]=y+2);const{a:$,b:E,c:S}=C0;if($.fromBufferAttribute(u,h[0]),E.fromBufferAttribute(u,h[1]),S.fromBufferAttribute(u,h[2]),C0.getNormal(MC),p[0]=`${Math.round($.x*s)},${Math.round($.y*s)},${Math.round($.z*s)}`,p[1]=`${Math.round(E.x*s)},${Math.round(E.y*s)},${Math.round(E.z*s)}`,p[2]=`${Math.round(S.x*s)},${Math.round(S.y*s)},${Math.round(S.z*s)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let A=0;A<3;A++){const C=(A+1)%3,x=p[A],I=p[C],O=C0[f[A]],F=C0[f[C]],k=`${x}_${I}`,D=`${I}_${x}`;D in m&&m[D]?(MC.dot(m[D].normal)<=a&&(v.push(O.x,O.y,O.z),v.push(F.x,F.y,F.z)),m[D]=null):k in m||(m[k]={index0:h[A],index1:h[C],normal:MC.clone()})}}for(const y in m)if(m[y]){const{index0:$,index1:E}=m[y];b0.fromBufferAttribute(u,$),A0.fromBufferAttribute(u,E),v.push(b0.x,b0.y,b0.z),v.push(A0.x,A0.y,A0.z)}this.setAttribute("position",new Yt(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class hp extends aE{constructor(e){super(e),this.uuid=ra(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let r=0,s=this.holes.length;r<s;r++)n[r]=this.holes[r].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const s=e.holes[n];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,r=this.holes.length;n<r;n++){const s=this.holes[n];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const s=e.holes[n];this.holes.push(new aE().fromJSON(s))}return this}}const AX={triangulate:function(i,e,n=2){const r=e&&e.length,s=r?e[0]*n:i.length;let a=YF(i,0,s,n,!0);const l=[];if(!a||a.next===a.prev)return l;let u,d,h,f,p,m,v;if(r&&(a=MX(i,e,a,n)),i.length>80*n){u=h=i[0],d=f=i[1];for(let y=n;y<s;y+=n)p=i[y],m=i[y+1],p<u&&(u=p),m<d&&(d=m),p>h&&(h=p),m>f&&(f=m);v=Math.max(h-u,f-d),v=v!==0?32767/v:0}return lE(a,l,n,u,d,v,0),l}};function YF(i,e,n,r,s){let a,l;if(s===GX(i,e,n,r)>0)for(a=e;a<n;a+=r)l=LN(a,i[a],i[a+1],l);else for(a=n-r;a>=e;a-=r)l=LN(a,i[a],i[a+1],l);return l&&G$(l,l.next)&&(uE(l),l=l.next),l}function Ap(i,e){if(!i)return i;e||(e=i);let n=i,r;do if(r=!1,!n.steiner&&(G$(n,n.next)||tr(n.prev,n,n.next)===0)){if(uE(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function lE(i,e,n,r,s,a,l){if(!i)return;!l&&a&&kX(i,r,s,a);let u=i,d,h;for(;i.prev!==i.next;){if(d=i.prev,h=i.next,a?RX(i,r,s,a):CX(i)){e.push(d.i/n|0),e.push(i.i/n|0),e.push(h.i/n|0),uE(i),i=h.next,u=h.next;continue}if(i=h,i===u){l?l===1?(i=xX(Ap(i),e,n),lE(i,e,n,r,s,a,2)):l===2&&wX(i,e,n,r,s,a):lE(Ap(i),e,n,r,s,a,1);break}}}function CX(i){const e=i.prev,n=i,r=i.next;if(tr(e,n,r)>=0)return!1;const s=e.x,a=n.x,l=r.x,u=e.y,d=n.y,h=r.y,f=s<a?s<l?s:l:a<l?a:l,p=u<d?u<h?u:h:d<h?d:h,m=s>a?s>l?s:l:a>l?a:l,v=u>d?u>h?u:h:d>h?d:h;let y=r.next;for(;y!==e;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=v&&Ag(s,u,a,d,l,h,y.x,y.y)&&tr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function RX(i,e,n,r){const s=i.prev,a=i,l=i.next;if(tr(s,a,l)>=0)return!1;const u=s.x,d=a.x,h=l.x,f=s.y,p=a.y,m=l.y,v=u<d?u<h?u:h:d<h?d:h,y=f<p?f<m?f:m:p<m?p:m,$=u>d?u>h?u:h:d>h?d:h,E=f>p?f>m?f:m:p>m?p:m,S=Fx(v,y,e,n,r),A=Fx($,E,e,n,r);let C=i.prevZ,x=i.nextZ;for(;C&&C.z>=S&&x&&x.z<=A;){if(C.x>=v&&C.x<=$&&C.y>=y&&C.y<=E&&C!==s&&C!==l&&Ag(u,f,d,p,h,m,C.x,C.y)&&tr(C.prev,C,C.next)>=0||(C=C.prevZ,x.x>=v&&x.x<=$&&x.y>=y&&x.y<=E&&x!==s&&x!==l&&Ag(u,f,d,p,h,m,x.x,x.y)&&tr(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;C&&C.z>=S;){if(C.x>=v&&C.x<=$&&C.y>=y&&C.y<=E&&C!==s&&C!==l&&Ag(u,f,d,p,h,m,C.x,C.y)&&tr(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;x&&x.z<=A;){if(x.x>=v&&x.x<=$&&x.y>=y&&x.y<=E&&x!==s&&x!==l&&Ag(u,f,d,p,h,m,x.x,x.y)&&tr(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function xX(i,e,n){let r=i;do{const s=r.prev,a=r.next.next;!G$(s,a)&&KF(s,r,r.next,a)&&cE(s,a)&&cE(a,s)&&(e.push(s.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),uE(r),uE(r.next),r=i=a),r=r.next}while(r!==i);return Ap(r)}function wX(i,e,n,r,s,a){let l=i;do{let u=l.next.next;for(;u!==l.prev;){if(l.i!==u.i&&BX(l,u)){let d=JF(l,u);l=Ap(l,l.next),d=Ap(d,d.next),lE(l,e,n,r,s,a,0),lE(d,e,n,r,s,a,0);return}u=u.next}l=l.next}while(l!==i)}function MX(i,e,n,r){const s=[];let a,l,u,d,h;for(a=0,l=e.length;a<l;a++)u=e[a]*r,d=a<l-1?e[a+1]*r:i.length,h=YF(i,u,d,r,!1),h===h.next&&(h.steiner=!0),s.push(DX(h));for(s.sort(IX),a=0;a<s.length;a++)n=OX(s[a],n);return n}function IX(i,e){return i.x-e.x}function OX(i,e){const n=LX(i,e);if(!n)return e;const r=JF(n,i);return Ap(r,r.next),Ap(n,n.next)}function LX(i,e){let n=e,r=-1/0,s;const a=i.x,l=i.y;do{if(l<=n.y&&l>=n.next.y&&n.next.y!==n.y){const m=n.x+(l-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(m<=a&&m>r&&(r=m,s=n.x<n.next.x?n:n.next,m===a))return s}n=n.next}while(n!==e);if(!s)return null;const u=s,d=s.x,h=s.y;let f=1/0,p;n=s;do a>=n.x&&n.x>=d&&a!==n.x&&Ag(l<h?a:r,l,d,h,l<h?r:a,l,n.x,n.y)&&(p=Math.abs(l-n.y)/(a-n.x),cE(n,i)&&(p<f||p===f&&(n.x>s.x||n.x===s.x&&NX(s,n)))&&(s=n,f=p)),n=n.next;while(n!==u);return s}function NX(i,e){return tr(i.prev,i,e.prev)<0&&tr(e.next,i,i.next)<0}function kX(i,e,n,r){let s=i;do s.z===0&&(s.z=Fx(s.x,s.y,e,n,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,PX(s)}function PX(i){let e,n,r,s,a,l,u,d,h=1;do{for(n=i,i=null,a=null,l=0;n;){for(l++,r=n,u=0,e=0;e<h&&(u++,r=r.nextZ,!!r);e++);for(d=h;u>0||d>0&&r;)u!==0&&(d===0||!r||n.z<=r.z)?(s=n,n=n.nextZ,u--):(s=r,r=r.nextZ,d--),a?a.nextZ=s:i=s,s.prevZ=a,a=s;n=r}a.nextZ=null,h*=2}while(l>1);return i}function Fx(i,e,n,r,s){return i=(i-n)*s|0,e=(e-r)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function DX(i){let e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function Ag(i,e,n,r,s,a,l,u){return(s-l)*(e-u)>=(i-l)*(a-u)&&(i-l)*(r-u)>=(n-l)*(e-u)&&(n-l)*(a-u)>=(s-l)*(r-u)}function BX(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!FX(i,e)&&(cE(i,e)&&cE(e,i)&&UX(i,e)&&(tr(i.prev,i,e.prev)||tr(i,e.prev,e))||G$(i,e)&&tr(i.prev,i,i.next)>0&&tr(e.prev,e,e.next)>0)}function tr(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function G$(i,e){return i.x===e.x&&i.y===e.y}function KF(i,e,n,r){const s=x0(tr(i,e,n)),a=x0(tr(i,e,r)),l=x0(tr(n,r,i)),u=x0(tr(n,r,e));return!!(s!==a&&l!==u||s===0&&R0(i,n,e)||a===0&&R0(i,r,e)||l===0&&R0(n,i,r)||u===0&&R0(n,e,r))}function R0(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function x0(i){return i>0?1:i<0?-1:0}function FX(i,e){let n=i;do{if(n.i!==i.i&&n.next.i!==i.i&&n.i!==e.i&&n.next.i!==e.i&&KF(n,n.next,i,e))return!0;n=n.next}while(n!==i);return!1}function cE(i,e){return tr(i.prev,i,i.next)<0?tr(i,e,i.next)>=0&&tr(i,i.prev,e)>=0:tr(i,e,i.prev)<0||tr(i,i.next,e)<0}function UX(i,e){let n=i,r=!1;const s=(i.x+e.x)/2,a=(i.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&s<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==i);return r}function JF(i,e){const n=new Ux(i.i,i.x,i.y),r=new Ux(e.i,e.x,e.y),s=i.next,a=e.prev;return i.next=e,e.prev=i,n.next=s,s.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function LN(i,e,n,r){const s=new Ux(i,e,n);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function uE(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ux(i,e,n){this.i=i,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function GX(i,e,n,r){let s=0;for(let a=e,l=n-r;a<n;a+=r)s+=(i[l]-i[a])*(i[a+1]+i[l+1]),l=a;return s}class xc{static area(e){const n=e.length;let r=0;for(let s=n-1,a=0;a<n;s=a++)r+=e[s].x*e[a].y-e[a].x*e[s].y;return r*.5}static isClockWise(e){return xc.area(e)<0}static triangulateShape(e,n){const r=[],s=[],a=[];NN(e),kN(r,e);let l=e.length;n.forEach(NN);for(let d=0;d<n.length;d++)s.push(l),l+=n[d].length,kN(r,n[d]);const u=AX.triangulate(r,s);for(let d=0;d<u.length;d+=3)a.push(u.slice(d,d+3));return a}}function NN(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function kN(i,e){for(let n=0;n<e.length;n++)i.push(e[n].x),i.push(e[n].y)}class s_ extends on{constructor(e=new hp([new mt(.5,.5),new mt(-.5,.5),new mt(-.5,-.5),new mt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const r=this,s=[],a=[];for(let u=0,d=e.length;u<d;u++){const h=e[u];l(h)}this.setAttribute("position",new Yt(s,3)),this.setAttribute("uv",new Yt(a,2)),this.computeVertexNormals();function l(u){const d=[],h=n.curveSegments!==void 0?n.curveSegments:12,f=n.steps!==void 0?n.steps:1,p=n.depth!==void 0?n.depth:1;let m=n.bevelEnabled!==void 0?n.bevelEnabled:!0,v=n.bevelThickness!==void 0?n.bevelThickness:.2,y=n.bevelSize!==void 0?n.bevelSize:v-.1,$=n.bevelOffset!==void 0?n.bevelOffset:0,E=n.bevelSegments!==void 0?n.bevelSegments:3;const S=n.extrudePath,A=n.UVGenerator!==void 0?n.UVGenerator:HX;let C,x=!1,I,O,F,k;S&&(C=S.getSpacedPoints(f),x=!0,m=!1,I=S.computeFrenetFrames(f,!1),O=new ie,F=new ie,k=new ie),m||(E=0,v=0,y=0,$=0);const D=u.extractPoints(h);let U=D.shape;const ce=D.holes;if(!xc.isClockWise(U)){U=U.reverse();for(let Q=0,Ge=ce.length;Q<Ge;Q++){const Oe=ce[Q];xc.isClockWise(Oe)&&(ce[Q]=Oe.reverse())}}const ae=xc.triangulateShape(U,ce),ne=U;for(let Q=0,Ge=ce.length;Q<Ge;Q++){const Oe=ce[Q];U=U.concat(Oe)}function de(Q,Ge,Oe){return Ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),Q.clone().addScaledVector(Ge,Oe)}const ue=U.length,Re=ae.length;function G(Q,Ge,Oe){let Ve,Fe,tt;const Ue=Q.x-Ge.x,Je=Q.y-Ge.y,ve=Oe.x-Q.x,Me=Oe.y-Q.y,vt=Ue*Ue+Je*Je,oe=Ue*Me-Je*ve;if(Math.abs(oe)>Number.EPSILON){const ee=Math.sqrt(vt),W=Math.sqrt(ve*ve+Me*Me),ot=Ge.x-Je/ee,je=Ge.y+Ue/ee,Qe=Oe.x-Me/W,ht=Oe.y+ve/W,ft=((Qe-ot)*Me-(ht-je)*ve)/(Ue*Me-Je*ve);Ve=ot+Ue*ft-Q.x,Fe=je+Je*ft-Q.y;const He=Ve*Ve+Fe*Fe;if(He<=2)return new mt(Ve,Fe);tt=Math.sqrt(He/2)}else{let ee=!1;Ue>Number.EPSILON?ve>Number.EPSILON&&(ee=!0):Ue<-Number.EPSILON?ve<-Number.EPSILON&&(ee=!0):Math.sign(Je)===Math.sign(Me)&&(ee=!0),ee?(Ve=-Je,Fe=Ue,tt=Math.sqrt(vt)):(Ve=Ue,Fe=Je,tt=Math.sqrt(vt/2))}return new mt(Ve/tt,Fe/tt)}const Z=[];for(let Q=0,Ge=ne.length,Oe=Ge-1,Ve=Q+1;Q<Ge;Q++,Oe++,Ve++)Oe===Ge&&(Oe=0),Ve===Ge&&(Ve=0),Z[Q]=G(ne[Q],ne[Oe],ne[Ve]);const K=[];let se,Y=Z.concat();for(let Q=0,Ge=ce.length;Q<Ge;Q++){const Oe=ce[Q];se=[];for(let Ve=0,Fe=Oe.length,tt=Fe-1,Ue=Ve+1;Ve<Fe;Ve++,tt++,Ue++)tt===Fe&&(tt=0),Ue===Fe&&(Ue=0),se[Ve]=G(Oe[Ve],Oe[tt],Oe[Ue]);K.push(se),Y=Y.concat(se)}for(let Q=0;Q<E;Q++){const Ge=Q/E,Oe=v*Math.cos(Ge*Math.PI/2),Ve=y*Math.sin(Ge*Math.PI/2)+$;for(let Fe=0,tt=ne.length;Fe<tt;Fe++){const Ue=de(ne[Fe],Z[Fe],Ve);Ie(Ue.x,Ue.y,-Oe)}for(let Fe=0,tt=ce.length;Fe<tt;Fe++){const Ue=ce[Fe];se=K[Fe];for(let Je=0,ve=Ue.length;Je<ve;Je++){const Me=de(Ue[Je],se[Je],Ve);Ie(Me.x,Me.y,-Oe)}}}const me=y+$;for(let Q=0;Q<ue;Q++){const Ge=m?de(U[Q],Y[Q],me):U[Q];x?(F.copy(I.normals[0]).multiplyScalar(Ge.x),O.copy(I.binormals[0]).multiplyScalar(Ge.y),k.copy(C[0]).add(F).add(O),Ie(k.x,k.y,k.z)):Ie(Ge.x,Ge.y,0)}for(let Q=1;Q<=f;Q++)for(let Ge=0;Ge<ue;Ge++){const Oe=m?de(U[Ge],Y[Ge],me):U[Ge];x?(F.copy(I.normals[Q]).multiplyScalar(Oe.x),O.copy(I.binormals[Q]).multiplyScalar(Oe.y),k.copy(C[Q]).add(F).add(O),Ie(k.x,k.y,k.z)):Ie(Oe.x,Oe.y,p/f*Q)}for(let Q=E-1;Q>=0;Q--){const Ge=Q/E,Oe=v*Math.cos(Ge*Math.PI/2),Ve=y*Math.sin(Ge*Math.PI/2)+$;for(let Fe=0,tt=ne.length;Fe<tt;Fe++){const Ue=de(ne[Fe],Z[Fe],Ve);Ie(Ue.x,Ue.y,p+Oe)}for(let Fe=0,tt=ce.length;Fe<tt;Fe++){const Ue=ce[Fe];se=K[Fe];for(let Je=0,ve=Ue.length;Je<ve;Je++){const Me=de(Ue[Je],se[Je],Ve);x?Ie(Me.x,Me.y+C[f-1].y,C[f-1].x+Oe):Ie(Me.x,Me.y,p+Oe)}}}fe(),Ae();function fe(){const Q=s.length/3;if(m){let Ge=0,Oe=ue*Ge;for(let Ve=0;Ve<Re;Ve++){const Fe=ae[Ve];We(Fe[2]+Oe,Fe[1]+Oe,Fe[0]+Oe)}Ge=f+E*2,Oe=ue*Ge;for(let Ve=0;Ve<Re;Ve++){const Fe=ae[Ve];We(Fe[0]+Oe,Fe[1]+Oe,Fe[2]+Oe)}}else{for(let Ge=0;Ge<Re;Ge++){const Oe=ae[Ge];We(Oe[2],Oe[1],Oe[0])}for(let Ge=0;Ge<Re;Ge++){const Oe=ae[Ge];We(Oe[0]+ue*f,Oe[1]+ue*f,Oe[2]+ue*f)}}r.addGroup(Q,s.length/3-Q,0)}function Ae(){const Q=s.length/3;let Ge=0;Ce(ne,Ge),Ge+=ne.length;for(let Oe=0,Ve=ce.length;Oe<Ve;Oe++){const Fe=ce[Oe];Ce(Fe,Ge),Ge+=Fe.length}r.addGroup(Q,s.length/3-Q,1)}function Ce(Q,Ge){let Oe=Q.length;for(;--Oe>=0;){const Ve=Oe;let Fe=Oe-1;Fe<0&&(Fe=Q.length-1);for(let tt=0,Ue=f+E*2;tt<Ue;tt++){const Je=ue*tt,ve=ue*(tt+1),Me=Ge+Ve+Je,vt=Ge+Fe+Je,oe=Ge+Fe+ve,ee=Ge+Ve+ve;ut(Me,vt,oe,ee)}}}function Ie(Q,Ge,Oe){d.push(Q),d.push(Ge),d.push(Oe)}function We(Q,Ge,Oe){Ye(Q),Ye(Ge),Ye(Oe);const Ve=s.length/3,Fe=A.generateTopUV(r,s,Ve-3,Ve-2,Ve-1);we(Fe[0]),we(Fe[1]),we(Fe[2])}function ut(Q,Ge,Oe,Ve){Ye(Q),Ye(Ge),Ye(Ve),Ye(Ge),Ye(Oe),Ye(Ve);const Fe=s.length/3,tt=A.generateSideWallUV(r,s,Fe-6,Fe-3,Fe-2,Fe-1);we(tt[0]),we(tt[1]),we(tt[3]),we(tt[1]),we(tt[2]),we(tt[3])}function Ye(Q){s.push(d[Q*3+0]),s.push(d[Q*3+1]),s.push(d[Q*3+2])}function we(Q){a.push(Q.x),a.push(Q.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,r=this.parameters.options;return VX(n,r,e)}static fromJSON(e,n){const r=[];for(let a=0,l=e.shapes.length;a<l;a++){const u=n[e.shapes[a]];r.push(u)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new IM[s.type]().fromJSON(s)),new s_(r,e.options)}}const HX={generateTopUV:function(i,e,n,r,s){const a=e[n*3],l=e[n*3+1],u=e[r*3],d=e[r*3+1],h=e[s*3],f=e[s*3+1];return[new mt(a,l),new mt(u,d),new mt(h,f)]},generateSideWallUV:function(i,e,n,r,s,a){const l=e[n*3],u=e[n*3+1],d=e[n*3+2],h=e[r*3],f=e[r*3+1],p=e[r*3+2],m=e[s*3],v=e[s*3+1],y=e[s*3+2],$=e[a*3],E=e[a*3+1],S=e[a*3+2];return Math.abs(u-f)<Math.abs(l-h)?[new mt(l,1-d),new mt(h,1-p),new mt(m,1-y),new mt($,1-S)]:[new mt(u,1-d),new mt(f,1-p),new mt(v,1-y),new mt(E,1-S)]}};function VX(i,e,n){if(n.shapes=[],Array.isArray(i))for(let r=0,s=i.length;r<s;r++){const a=i[r];n.shapes.push(a.uuid)}else n.shapes.push(i.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class o_ extends Du{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,s=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,a,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new o_(e.radius,e.detail)}}class a_ extends Du{constructor(e=1,n=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,s,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new a_(e.radius,e.detail)}}class IE extends on{constructor(e=.5,n=1,r=32,s=1,a=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:r,phiSegments:s,thetaStart:a,thetaLength:l},r=Math.max(3,r),s=Math.max(1,s);const u=[],d=[],h=[],f=[];let p=e;const m=(n-e)/s,v=new ie,y=new mt;for(let $=0;$<=s;$++){for(let E=0;E<=r;E++){const S=a+E/r*l;v.x=p*Math.cos(S),v.y=p*Math.sin(S),d.push(v.x,v.y,v.z),h.push(0,0,1),y.x=(v.x/n+1)/2,y.y=(v.y/n+1)/2,f.push(y.x,y.y)}p+=m}for(let $=0;$<s;$++){const E=$*(r+1);for(let S=0;S<r;S++){const A=S+E,C=A,x=A+r+1,I=A+r+2,O=A+1;u.push(C,x,O),u.push(x,I,O)}}this.setIndex(u),this.setAttribute("position",new Yt(d,3)),this.setAttribute("normal",new Yt(h,3)),this.setAttribute("uv",new Yt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new IE(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class OE extends on{constructor(e=new hp([new mt(0,.5),new mt(-.5,-.5),new mt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const r=[],s=[],a=[],l=[];let u=0,d=0;if(Array.isArray(e)===!1)h(e);else for(let f=0;f<e.length;f++)h(e[f]),this.addGroup(u,d,f),u+=d,d=0;this.setIndex(r),this.setAttribute("position",new Yt(s,3)),this.setAttribute("normal",new Yt(a,3)),this.setAttribute("uv",new Yt(l,2));function h(f){const p=s.length/3,m=f.extractPoints(n);let v=m.shape;const y=m.holes;xc.isClockWise(v)===!1&&(v=v.reverse());for(let E=0,S=y.length;E<S;E++){const A=y[E];xc.isClockWise(A)===!0&&(y[E]=A.reverse())}const $=xc.triangulateShape(v,y);for(let E=0,S=y.length;E<S;E++){const A=y[E];v=v.concat(A)}for(let E=0,S=v.length;E<S;E++){const A=v[E];s.push(A.x,A.y,0),a.push(0,0,1),l.push(A.x,A.y)}for(let E=0,S=$.length;E<S;E++){const A=$[E],C=A[0]+p,x=A[1]+p,I=A[2]+p;r.push(C,x,I),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return zX(n,e)}static fromJSON(e,n){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const l=n[e.shapes[s]];r.push(l)}return new OE(r,e.curveSegments)}}function zX(i,e){if(e.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class l_ extends on{constructor(e=1,n=32,r=16,s=0,a=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:s,phiLength:a,thetaStart:l,thetaLength:u},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const d=Math.min(l+u,Math.PI);let h=0;const f=[],p=new ie,m=new ie,v=[],y=[],$=[],E=[];for(let S=0;S<=r;S++){const A=[],C=S/r;let x=0;S===0&&l===0?x=.5/n:S===r&&d===Math.PI&&(x=-.5/n);for(let I=0;I<=n;I++){const O=I/n;p.x=-e*Math.cos(s+O*a)*Math.sin(l+C*u),p.y=e*Math.cos(l+C*u),p.z=e*Math.sin(s+O*a)*Math.sin(l+C*u),y.push(p.x,p.y,p.z),m.copy(p).normalize(),$.push(m.x,m.y,m.z),E.push(O+x,1-C),A.push(h++)}f.push(A)}for(let S=0;S<r;S++)for(let A=0;A<n;A++){const C=f[S][A+1],x=f[S][A],I=f[S+1][A],O=f[S+1][A+1];(S!==0||l>0)&&v.push(C,x,O),(S!==r-1||d<Math.PI)&&v.push(x,I,O)}this.setIndex(v),this.setAttribute("position",new Yt(y,3)),this.setAttribute("normal",new Yt($,3)),this.setAttribute("uv",new Yt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l_(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class LE extends Du{constructor(e=1,n=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,s,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new LE(e.radius,e.detail)}}class NE extends on{constructor(e=1,n=.4,r=12,s=48,a=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:r,tubularSegments:s,arc:a},r=Math.floor(r),s=Math.floor(s);const l=[],u=[],d=[],h=[],f=new ie,p=new ie,m=new ie;for(let v=0;v<=r;v++)for(let y=0;y<=s;y++){const $=y/s*a,E=v/r*Math.PI*2;p.x=(e+n*Math.cos(E))*Math.cos($),p.y=(e+n*Math.cos(E))*Math.sin($),p.z=n*Math.sin(E),u.push(p.x,p.y,p.z),f.x=e*Math.cos($),f.y=e*Math.sin($),m.subVectors(p,f).normalize(),d.push(m.x,m.y,m.z),h.push(y/s),h.push(v/r)}for(let v=1;v<=r;v++)for(let y=1;y<=s;y++){const $=(s+1)*v+y-1,E=(s+1)*(v-1)+y-1,S=(s+1)*(v-1)+y,A=(s+1)*v+y;l.push($,E,A),l.push(E,S,A)}this.setIndex(l),this.setAttribute("position",new Yt(u,3)),this.setAttribute("normal",new Yt(d,3)),this.setAttribute("uv",new Yt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new NE(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class kE extends on{constructor(e=1,n=.4,r=64,s=8,a=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:r,radialSegments:s,p:a,q:l},r=Math.floor(r),s=Math.floor(s);const u=[],d=[],h=[],f=[],p=new ie,m=new ie,v=new ie,y=new ie,$=new ie,E=new ie,S=new ie;for(let C=0;C<=r;++C){const x=C/r*a*Math.PI*2;A(x,a,l,e,v),A(x+.01,a,l,e,y),E.subVectors(y,v),S.addVectors(y,v),$.crossVectors(E,S),S.crossVectors($,E),$.normalize(),S.normalize();for(let I=0;I<=s;++I){const O=I/s*Math.PI*2,F=-n*Math.cos(O),k=n*Math.sin(O);p.x=v.x+(F*S.x+k*$.x),p.y=v.y+(F*S.y+k*$.y),p.z=v.z+(F*S.z+k*$.z),d.push(p.x,p.y,p.z),m.subVectors(p,v).normalize(),h.push(m.x,m.y,m.z),f.push(C/r),f.push(I/s)}}for(let C=1;C<=r;C++)for(let x=1;x<=s;x++){const I=(s+1)*(C-1)+(x-1),O=(s+1)*C+(x-1),F=(s+1)*C+x,k=(s+1)*(C-1)+x;u.push(I,O,k),u.push(O,F,k)}this.setIndex(u),this.setAttribute("position",new Yt(d,3)),this.setAttribute("normal",new Yt(h,3)),this.setAttribute("uv",new Yt(f,2));function A(C,x,I,O,F){const k=Math.cos(C),D=Math.sin(C),U=I/x*C,ce=Math.cos(U);F.x=O*(2+ce)*.5*k,F.y=O*(2+ce)*D*.5,F.z=O*Math.sin(U)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kE(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class PE extends on{constructor(e=new wM(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),n=64,r=1,s=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:r,radialSegments:s,closed:a};const l=e.computeFrenetFrames(n,a);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const u=new ie,d=new ie,h=new mt;let f=new ie;const p=[],m=[],v=[],y=[];$(),this.setIndex(y),this.setAttribute("position",new Yt(p,3)),this.setAttribute("normal",new Yt(m,3)),this.setAttribute("uv",new Yt(v,2));function $(){for(let C=0;C<n;C++)E(C);E(a===!1?n:0),A(),S()}function E(C){f=e.getPointAt(C/n,f);const x=l.normals[C],I=l.binormals[C];for(let O=0;O<=s;O++){const F=O/s*Math.PI*2,k=Math.sin(F),D=-Math.cos(F);d.x=D*x.x+k*I.x,d.y=D*x.y+k*I.y,d.z=D*x.z+k*I.z,d.normalize(),m.push(d.x,d.y,d.z),u.x=f.x+r*d.x,u.y=f.y+r*d.y,u.z=f.z+r*d.z,p.push(u.x,u.y,u.z)}}function S(){for(let C=1;C<=n;C++)for(let x=1;x<=s;x++){const I=(s+1)*(C-1)+(x-1),O=(s+1)*C+(x-1),F=(s+1)*C+x,k=(s+1)*(C-1)+x;y.push(I,O,k),y.push(O,F,k)}}function A(){for(let C=0;C<=n;C++)for(let x=0;x<=s;x++)h.x=C/n,h.y=x/s,v.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new PE(new IM[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class OM extends on{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,s=new ie,a=new ie;if(e.index!==null){const l=e.attributes.position,u=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:u.count,materialIndex:0}]);for(let h=0,f=d.length;h<f;++h){const p=d[h],m=p.start,v=p.count;for(let y=m,$=m+v;y<$;y+=3)for(let E=0;E<3;E++){const S=u.getX(y+E),A=u.getX(y+(E+1)%3);s.fromBufferAttribute(l,S),a.fromBufferAttribute(l,A),PN(s,a,r)===!0&&(n.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z))}}}else{const l=e.attributes.position;for(let u=0,d=l.count/3;u<d;u++)for(let h=0;h<3;h++){const f=3*u+h,p=3*u+(h+1)%3;s.fromBufferAttribute(l,f),a.fromBufferAttribute(l,p),PN(s,a,r)===!0&&(n.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z))}}this.setAttribute("position",new Yt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function PN(i,e,n){const r=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return n.has(r)===!0||n.has(s)===!0?!1:(n.add(r),n.add(s),!0)}var DN=Object.freeze({__proto__:null,BoxGeometry:vd,CapsuleGeometry:RE,CircleGeometry:xE,ConeGeometry:wE,CylinderGeometry:Lp,DodecahedronGeometry:ME,EdgesGeometry:jF,ExtrudeGeometry:s_,IcosahedronGeometry:o_,LatheGeometry:r_,OctahedronGeometry:a_,PlaneGeometry:ja,PolyhedronGeometry:Du,RingGeometry:IE,ShapeGeometry:OE,SphereGeometry:l_,TetrahedronGeometry:LE,TorusGeometry:NE,TorusKnotGeometry:kE,TubeGeometry:PE,WireframeGeometry:OM});class ZF extends ir{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new xt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class qF extends wo{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Np extends ir{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kr extends Np{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new mt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return fr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class QF extends ir{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xt(16777215),this.specular=new xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eU extends ir{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class tU extends ir{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class nU extends ir{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iU extends ir{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new xt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Td,this.normalScale=new mt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class rU extends Ai{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Pa(i,e,n){return LM(i)?new i.constructor(i.subarray(e,n!==void 0?n:i.length)):i.slice(e,n)}function Qf(i,e,n){return!i||!n&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function LM(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function sU(i){function e(s,a){return i[s]-i[a]}const n=i.length,r=new Array(n);for(let s=0;s!==n;++s)r[s]=s;return r.sort(e),r}function Gx(i,e,n){const r=i.length,s=new i.constructor(r);for(let a=0,l=0;l!==r;++a){const u=n[a]*e;for(let d=0;d!==e;++d)s[l++]=i[u+d]}return s}function NM(i,e,n,r){let s=1,a=i[0];for(;a!==void 0&&a[r]===void 0;)a=i[s++];if(a===void 0)return;let l=a[r];if(l!==void 0)if(Array.isArray(l))do l=a[r],l!==void 0&&(e.push(a.time),n.push.apply(n,l)),a=i[s++];while(a!==void 0);else if(l.toArray!==void 0)do l=a[r],l!==void 0&&(e.push(a.time),l.toArray(n,n.length)),a=i[s++];while(a!==void 0);else do l=a[r],l!==void 0&&(e.push(a.time),n.push(l)),a=i[s++];while(a!==void 0)}function WX(i,e,n,r,s=30){const a=i.clone();a.name=e;const l=[];for(let d=0;d<a.tracks.length;++d){const h=a.tracks[d],f=h.getValueSize(),p=[],m=[];for(let v=0;v<h.times.length;++v){const y=h.times[v]*s;if(!(y<n||y>=r)){p.push(h.times[v]);for(let $=0;$<f;++$)m.push(h.values[v*f+$])}}p.length!==0&&(h.times=Qf(p,h.times.constructor),h.values=Qf(m,h.values.constructor),l.push(h))}a.tracks=l;let u=1/0;for(let d=0;d<a.tracks.length;++d)u>a.tracks[d].times[0]&&(u=a.tracks[d].times[0]);for(let d=0;d<a.tracks.length;++d)a.tracks[d].shift(-1*u);return a.resetDuration(),a}function XX(i,e=0,n=i,r=30){r<=0&&(r=30);const s=n.tracks.length,a=e/r;for(let l=0;l<s;++l){const u=n.tracks[l],d=u.ValueTypeName;if(d==="bool"||d==="string")continue;const h=i.tracks.find(function(S){return S.name===u.name&&S.ValueTypeName===d});if(h===void 0)continue;let f=0;const p=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let m=0;const v=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);const y=u.times.length-1;let $;if(a<=u.times[0]){const S=f,A=p-f;$=Pa(u.values,S,A)}else if(a>=u.times[y]){const S=y*p+f,A=S+p-f;$=Pa(u.values,S,A)}else{const S=u.createInterpolant(),A=f,C=p-f;S.evaluate(a),$=Pa(S.resultBuffer,A,C)}d==="quaternion"&&new Er().fromArray($).normalize().conjugate().toArray($);const E=h.times.length;for(let S=0;S<E;++S){const A=S*v+m;if(d==="quaternion")Er.multiplyQuaternionsFlat(h.values,A,$,0,h.values,A);else{const C=v-m*2;for(let x=0;x<C;++x)h.values[A+x]-=$[x]}}}return i.blendMode=dM,i}const jX={arraySlice:Pa,convertArray:Qf,isTypedArray:LM,getKeyframeOrder:sU,sortedArray:Gx,flattenJSON:NM,subclip:WX,makeClipAdditive:XX};class kp{constructor(e,n,r,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let r=this._cachedIndex,s=n[r],a=n[r-1];e:{t:{let l;n:{i:if(!(e<s)){for(let u=r+2;;){if(s===void 0){if(e<a)break i;return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===u)break;if(a=s,s=n[++r],e<s)break t}l=n.length;break n}if(!(e>=a)){const u=n[1];e<u&&(r=2,a=u);for(let d=r-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===d)break;if(s=a,a=n[--r-1],e>=a)break t}l=r,r=0;break n}break e}for(;r<l;){const u=r+l>>>1;e<n[u]?l=u:r=u+1}if(s=n[r],a=n[r-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,s)}return this.interpolate_(r,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s;for(let l=0;l!==s;++l)n[l]=r[a+l];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class oU extends kp{constructor(e,n,r,s){super(e,n,r,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Kf,endingEnd:Kf}}intervalChanged_(e,n,r){const s=this.parameterPositions;let a=e-2,l=e+1,u=s[a],d=s[l];if(u===void 0)switch(this.getSettings_().endingStart){case Jf:a=e,u=2*n-r;break;case nE:a=s.length-2,u=n+s[a]-s[a+1];break;default:a=e,u=r}if(d===void 0)switch(this.getSettings_().endingEnd){case Jf:l=e,d=2*r-n;break;case nE:l=1,d=r+s[1]-s[0];break;default:l=e-1,d=n}const h=(r-n)*.5,f=this.valueSize;this._weightPrev=h/(n-u),this._weightNext=h/(d-r),this._offsetPrev=a*f,this._offsetNext=l*f}interpolate_(e,n,r,s){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=e*u,h=d-u,f=this._offsetPrev,p=this._offsetNext,m=this._weightPrev,v=this._weightNext,y=(r-n)/(s-n),$=y*y,E=$*y,S=-m*E+2*m*$-m*y,A=(1+m)*E+(-1.5-2*m)*$+(-.5+m)*y+1,C=(-1-v)*E+(1.5+v)*$+.5*y,x=v*E-v*$;for(let I=0;I!==u;++I)a[I]=S*l[f+I]+A*l[h+I]+C*l[d+I]+x*l[p+I];return a}}class kM extends kp{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e,n,r,s){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=e*u,h=d-u,f=(r-n)/(s-n),p=1-f;for(let m=0;m!==u;++m)a[m]=l[h+m]*p+l[d+m]*f;return a}}class aU extends kp{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ul{constructor(e,n,r,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Qf(n,this.TimeBufferType),this.values=Qf(r,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let r;if(n.toJSON!==this.toJSON)r=n.toJSON(e);else{r={name:e.name,times:Qf(e.times,Array),values:Qf(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(r.interpolation=s)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new aU(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new oU(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case $p:n=this.InterpolantFactoryMethodDiscrete;break;case Nu:n=this.InterpolantFactoryMethodLinear;break;case mS:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $p;case this.InterpolantFactoryMethodLinear:return Nu;case this.InterpolantFactoryMethodSmooth:return mS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let r=0,s=n.length;r!==s;++r)n[r]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let r=0,s=n.length;r!==s;++r)n[r]*=e}return this}trim(e,n){const r=this.times,s=r.length;let a=0,l=s-1;for(;a!==s&&r[a]<e;)++a;for(;l!==-1&&r[l]>n;)--l;if(++l,a!==0||l!==s){a>=l&&(l=Math.max(l,1),a=l-1);const u=this.getValueSize();this.times=Pa(r,a,l),this.values=Pa(this.values,a*u,l*u)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,s=this.values,a=r.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let u=0;u!==a;u++){const d=r[u];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,d),e=!1;break}if(l!==null&&l>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,d,l),e=!1;break}l=d}if(s!==void 0&&LM(s))for(let u=0,d=s.length;u!==d;++u){const h=s[u];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,h),e=!1;break}}return e}optimize(){const e=Pa(this.times),n=Pa(this.values),r=this.getValueSize(),s=this.getInterpolation()===mS,a=e.length-1;let l=1;for(let u=1;u<a;++u){let d=!1;const h=e[u],f=e[u+1];if(h!==f&&(u!==1||h!==e[0]))if(s)d=!0;else{const p=u*r,m=p-r,v=p+r;for(let y=0;y!==r;++y){const $=n[p+y];if($!==n[m+y]||$!==n[v+y]){d=!0;break}}}if(d){if(u!==l){e[l]=e[u];const p=u*r,m=l*r;for(let v=0;v!==r;++v)n[m+v]=n[p+v]}++l}}if(a>0){e[l]=e[a];for(let u=a*r,d=l*r,h=0;h!==r;++h)n[d+h]=n[u+h];++l}return l!==e.length?(this.times=Pa(e,0,l),this.values=Pa(n,0,l*r)):(this.times=e,this.values=n),this}clone(){const e=Pa(this.times,0),n=Pa(this.values,0),r=this.constructor,s=new r(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}Ul.prototype.TimeBufferType=Float32Array;Ul.prototype.ValueBufferType=Float32Array;Ul.prototype.DefaultInterpolation=Nu;class Pp extends Ul{}Pp.prototype.ValueTypeName="bool";Pp.prototype.ValueBufferType=Array;Pp.prototype.DefaultInterpolation=$p;Pp.prototype.InterpolantFactoryMethodLinear=void 0;Pp.prototype.InterpolantFactoryMethodSmooth=void 0;class PM extends Ul{}PM.prototype.ValueTypeName="color";class dd extends Ul{}dd.prototype.ValueTypeName="number";class lU extends kp{constructor(e,n,r,s){super(e,n,r,s)}interpolate_(e,n,r,s){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=(r-n)/(s-n);let h=e*u;for(let f=h+u;h!==f;h+=4)Er.slerpFlat(a,0,l,h-u,l,h,d);return a}}class wc extends Ul{InterpolantFactoryMethodLinear(e){return new lU(this.times,this.values,this.getValueSize(),e)}}wc.prototype.ValueTypeName="quaternion";wc.prototype.DefaultInterpolation=Nu;wc.prototype.InterpolantFactoryMethodSmooth=void 0;class Dp extends Ul{}Dp.prototype.ValueTypeName="string";Dp.prototype.ValueBufferType=Array;Dp.prototype.DefaultInterpolation=$p;Dp.prototype.InterpolantFactoryMethodLinear=void 0;Dp.prototype.InterpolantFactoryMethodSmooth=void 0;class fd extends Ul{}fd.prototype.ValueTypeName="vector";class Cp{constructor(e,n=-1,r,s=A$){this.name=e,this.tracks=r,this.duration=n,this.blendMode=s,this.uuid=ra(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],r=e.tracks,s=1/(e.fps||1);for(let l=0,u=r.length;l!==u;++l)n.push(KX(r[l]).scale(s));const a=new this(e.name,e.duration,n,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const n=[],r=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,l=r.length;a!==l;++a)n.push(Ul.toJSON(r[a]));return s}static CreateFromMorphTargetSequence(e,n,r,s){const a=n.length,l=[];for(let u=0;u<a;u++){let d=[],h=[];d.push((u+a-1)%a,u,(u+1)%a),h.push(0,1,0);const f=sU(d);d=Gx(d,1,f),h=Gx(h,1,f),!s&&d[0]===0&&(d.push(a),h.push(h[0])),l.push(new dd(".morphTargetInfluences["+n[u].name+"]",d,h).scale(1/r))}return new this(e,-1,l)}static findByName(e,n){let r=e;if(!Array.isArray(e)){const s=e;r=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<r.length;s++)if(r[s].name===n)return r[s];return null}static CreateClipsFromMorphTargetSequences(e,n,r){const s={},a=/^([\w-]*?)([\d]+)$/;for(let u=0,d=e.length;u<d;u++){const h=e[u],f=h.name.match(a);if(f&&f.length>1){const p=f[1];let m=s[p];m||(s[p]=m=[]),m.push(h)}}const l=[];for(const u in s)l.push(this.CreateFromMorphTargetSequence(u,s[u],n,r));return l}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(p,m,v,y,$){if(v.length!==0){const E=[],S=[];NM(v,E,S,y),E.length!==0&&$.push(new p(m,E,S))}},s=[],a=e.name||"default",l=e.fps||30,u=e.blendMode;let d=e.length||-1;const h=e.hierarchy||[];for(let p=0;p<h.length;p++){const m=h[p].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const v={};let y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let $=0;$<m[y].morphTargets.length;$++)v[m[y].morphTargets[$]]=-1;for(const $ in v){const E=[],S=[];for(let A=0;A!==m[y].morphTargets.length;++A){const C=m[y];E.push(C.time),S.push(C.morphTarget===$?1:0)}s.push(new dd(".morphTargetInfluence["+$+"]",E,S))}d=v.length*l}else{const v=".bones["+n[p].name+"]";r(fd,v+".position",m,"pos",s),r(wc,v+".quaternion",m,"rot",s),r(fd,v+".scale",m,"scl",s)}}return s.length===0?null:new this(a,d,s,u)}resetDuration(){const e=this.tracks;let n=0;for(let r=0,s=e.length;r!==s;++r){const a=this.tracks[r];n=Math.max(n,a.times[a.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function YX(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return dd;case"vector":case"vector2":case"vector3":case"vector4":return fd;case"color":return PM;case"quaternion":return wc;case"bool":case"boolean":return Pp;case"string":return Dp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function KX(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=YX(i.type);if(i.times===void 0){const n=[],r=[];NM(i.keys,n,r,"value"),i.times=n,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Rp={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class H${constructor(e,n,r){const s=this;let a=!1,l=0,u=0,d;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(f){u++,a===!1&&s.onStart!==void 0&&s.onStart(f,l,u),a=!0},this.itemEnd=function(f){l++,s.onProgress!==void 0&&s.onProgress(f,l,u),l===u&&(a=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(f){s.onError!==void 0&&s.onError(f)},this.resolveURL=function(f){return d?d(f):f},this.setURLModifier=function(f){return d=f,this},this.addHandler=function(f,p){return h.push(f,p),this},this.removeHandler=function(f){const p=h.indexOf(f);return p!==-1&&h.splice(p,2),this},this.getHandler=function(f){for(let p=0,m=h.length;p<m;p+=2){const v=h[p],y=h[p+1];if(v.global&&(v.lastIndex=0),v.test(f))return y}return null}}}const cU=new H$;class ls{constructor(e){this.manager=e!==void 0?e:cU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(s,a){r.load(e,s,n,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const gu={};class JX extends Error{constructor(e,n){super(e),this.response=n}}class Nr extends ls{constructor(e){super(e)}load(e,n,r,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=Rp.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(a),this.manager.itemEnd(e)},0),a;if(gu[e]!==void 0){gu[e].push({onLoad:n,onProgress:r,onError:s});return}gu[e]=[],gu[e].push({onLoad:n,onProgress:r,onError:s});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,d=this.responseType;fetch(l).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=gu[e],p=h.body.getReader(),m=h.headers.get("Content-Length")||h.headers.get("X-File-Size"),v=m?parseInt(m):0,y=v!==0;let $=0;const E=new ReadableStream({start(S){A();function A(){p.read().then(({done:C,value:x})=>{if(C)S.close();else{$+=x.byteLength;const I=new ProgressEvent("progress",{lengthComputable:y,loaded:$,total:v});for(let O=0,F=f.length;O<F;O++){const k=f[O];k.onProgress&&k.onProgress(I)}S.enqueue(x),A()}})}}});return new Response(E)}else throw new JX(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(d){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,u));case"json":return h.json();default:if(u===void 0)return h.text();{const p=/charset="?([^;"\s]*)"?/i.exec(u),m=p&&p[1]?p[1].toLowerCase():void 0,v=new TextDecoder(m);return h.arrayBuffer().then(y=>v.decode(y))}}}).then(h=>{Rp.add(e,h);const f=gu[e];delete gu[e];for(let p=0,m=f.length;p<m;p++){const v=f[p];v.onLoad&&v.onLoad(h)}}).catch(h=>{const f=gu[e];if(f===void 0)throw this.manager.itemError(e),h;delete gu[e];for(let p=0,m=f.length;p<m;p++){const v=f[p];v.onError&&v.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ZX extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=new Nr(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{n(a.parse(JSON.parse(u)))}catch(d){s?s(d):console.error(d),a.manager.itemError(e)}},r,s)}parse(e){const n=[];for(let r=0;r<e.length;r++){const s=Cp.parse(e[r]);n.push(s)}return n}}class qX extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=[],u=new AM,d=new Nr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(a.withCredentials);let h=0;function f(p){d.load(e[p],function(m){const v=a.parse(m,!0);l[p]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},h+=1,h===6&&(v.mipmapCount===1&&(u.minFilter=Dn),u.image=l,u.format=v.format,u.needsUpdate=!0,n&&n(u))},r,s)}if(Array.isArray(e))for(let p=0,m=e.length;p<m;++p)f(p);else d.load(e,function(p){const m=a.parse(p,!0);if(m.isCubemap){const v=m.mipmaps.length/m.mipmapCount;for(let y=0;y<v;y++){l[y]={mipmaps:[]};for(let $=0;$<m.mipmapCount;$++)l[y].mipmaps.push(m.mipmaps[y*m.mipmapCount+$]),l[y].format=m.format,l[y].width=m.width,l[y].height=m.height}u.image=l}else u.image.width=m.width,u.image.height=m.height,u.mipmaps=m.mipmaps;m.mipmapCount===1&&(u.minFilter=Dn),u.format=m.format,u.needsUpdate=!0,n&&n(u)},r,s);return u}}class hE extends ls{constructor(e){super(e)}load(e,n,r,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,l=Rp.get(e);if(l!==void 0)return a.manager.itemStart(e),setTimeout(function(){n&&n(l),a.manager.itemEnd(e)},0),l;const u=sE("img");function d(){f(),Rp.add(e,this),n&&n(this),a.manager.itemEnd(e)}function h(p){f(),s&&s(p),a.manager.itemError(e),a.manager.itemEnd(e)}function f(){u.removeEventListener("load",d,!1),u.removeEventListener("error",h,!1)}return u.addEventListener("load",d,!1),u.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(e),u.src=e,u}}class uU extends ls{constructor(e){super(e)}load(e,n,r,s){const a=new bE;a.colorSpace=vn;const l=new hE(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let u=0;function d(h){l.load(e[h],function(f){a.images[h]=f,u++,u===6&&(a.needsUpdate=!0,n&&n(a))},void 0,s)}for(let h=0;h<e.length;++h)d(h);return a}}class DM extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=new up,u=new Nr(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(a.withCredentials),u.load(e,function(d){const h=a.parse(d);h&&(h.image!==void 0?l.image=h.image:h.data!==void 0&&(l.image.width=h.width,l.image.height=h.height,l.image.data=h.data),l.wrapS=h.wrapS!==void 0?h.wrapS:Pi,l.wrapT=h.wrapT!==void 0?h.wrapT:Pi,l.magFilter=h.magFilter!==void 0?h.magFilter:Dn,l.minFilter=h.minFilter!==void 0?h.minFilter:Dn,l.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0?l.colorSpace=h.colorSpace:h.encoding!==void 0&&(l.encoding=h.encoding),h.flipY!==void 0&&(l.flipY=h.flipY),h.format!==void 0&&(l.format=h.format),h.type!==void 0&&(l.type=h.type),h.mipmaps!==void 0&&(l.mipmaps=h.mipmaps,l.minFilter=Wa),h.mipmapCount===1&&(l.minFilter=Dn),h.generateMipmaps!==void 0&&(l.generateMipmaps=h.generateMipmaps),l.needsUpdate=!0,n&&n(l,h))},r,s),l}}class BM extends ls{constructor(e){super(e)}load(e,n,r,s){const a=new ni,l=new hE(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(u){a.image=u,a.needsUpdate=!0,n!==void 0&&n(a)},r,s),a}}class Ed extends Xn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new xt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class hU extends Ed{constructor(e,n,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new xt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const IC=new pn,BN=new ie,FN=new ie;class FM{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new mt(512,512),this.map=null,this.mapPass=null,this.matrix=new pn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new x$,this._frameExtents=new mt(1,1),this._viewportCount=1,this._viewports=[new Hn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;BN.setFromMatrixPosition(e.matrixWorld),n.position.copy(BN),FN.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(FN),n.updateMatrixWorld(),IC.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IC),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(IC)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class QX extends FM{constructor(){super(new Gi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=Xg*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,a=e.distance||n.far;(r!==n.fov||s!==n.aspect||a!==n.far)&&(n.fov=r,n.aspect=s,n.far=a,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class V$ extends Ed{constructor(e,n,r=0,s=Math.PI/3,a=0,l=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.target=new Xn,this.distance=r,this.angle=s,this.penumbra=a,this.decay=l,this.map=null,this.shadow=new QX}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const UN=new pn,XT=new ie,OC=new ie;class ej extends FM{constructor(){super(new Gi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new mt(4,2),this._viewportCount=6,this._viewports=[new Hn(2,1,1,1),new Hn(0,1,1,1),new Hn(3,1,1,1),new Hn(1,1,1,1),new Hn(3,0,1,1),new Hn(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,n=0){const r=this.camera,s=this.matrix,a=e.distance||r.far;a!==r.far&&(r.far=a,r.updateProjectionMatrix()),XT.setFromMatrixPosition(e.matrixWorld),r.position.copy(XT),OC.copy(r.position),OC.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(OC),r.updateMatrixWorld(),s.makeTranslation(-XT.x,-XT.y,-XT.z),UN.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(UN)}}class z$ extends Ed{constructor(e,n,r=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=s,this.shadow=new ej}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class tj extends FM{constructor(){super(new sa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class W$ extends Ed{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.target=new Xn,this.shadow=new tj}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class dU extends Ed{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class fU extends Ed{constructor(e,n,r=10,s=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class pU{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const r=e.x,s=e.y,a=e.z,l=this.coefficients;return n.copy(l[0]).multiplyScalar(.282095),n.addScaledVector(l[1],.488603*s),n.addScaledVector(l[2],.488603*a),n.addScaledVector(l[3],.488603*r),n.addScaledVector(l[4],1.092548*(r*s)),n.addScaledVector(l[5],1.092548*(s*a)),n.addScaledVector(l[6],.315392*(3*a*a-1)),n.addScaledVector(l[7],1.092548*(r*a)),n.addScaledVector(l[8],.546274*(r*r-s*s)),n}getIrradianceAt(e,n){const r=e.x,s=e.y,a=e.z,l=this.coefficients;return n.copy(l[0]).multiplyScalar(.886227),n.addScaledVector(l[1],2*.511664*s),n.addScaledVector(l[2],2*.511664*a),n.addScaledVector(l[3],2*.511664*r),n.addScaledVector(l[4],2*.429043*r*s),n.addScaledVector(l[5],2*.429043*s*a),n.addScaledVector(l[6],.743125*a*a-.247708),n.addScaledVector(l[7],2*.429043*r*a),n.addScaledVector(l[8],.429043*(r*r-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const r=this.coefficients;for(let s=0;s<9;s++)r[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const r=e.x,s=e.y,a=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*a,n[3]=.488603*r,n[4]=1.092548*r*s,n[5]=1.092548*s*a,n[6]=.315392*(3*a*a-1),n[7]=1.092548*r*a,n[8]=.546274*(r*r-s*s)}}class X$ extends Ed{constructor(e=new pU,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class j$ extends ls{constructor(e){super(e),this.textures={}}load(e,n,r,s){const a=this,l=new Nr(a.manager);l.setPath(a.path),l.setRequestHeader(a.requestHeader),l.setWithCredentials(a.withCredentials),l.load(e,function(u){try{n(a.parse(JSON.parse(u)))}catch(d){s?s(d):console.error(d),a.manager.itemError(e)}},r,s)}parse(e){const n=this.textures;function r(a){return n[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),n[a]}const s=j$.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new xt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==1&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const l=e.uniforms[a];switch(s.uniforms[a]={},l.type){case"t":s.uniforms[a].value=r(l.value);break;case"c":s.uniforms[a].value=new xt().setHex(l.value);break;case"v2":s.uniforms[a].value=new mt().fromArray(l.value);break;case"v3":s.uniforms[a].value=new ie().fromArray(l.value);break;case"v4":s.uniforms[a].value=new Hn().fromArray(l.value);break;case"m3":s.uniforms[a].value=new Nn().fromArray(l.value);break;case"m4":s.uniforms[a].value=new pn().fromArray(l.value);break;default:s.uniforms[a].value=l.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const a in e.extensions)s.extensions[a]=e.extensions[a];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=r(e.map)),e.matcap!==void 0&&(s.matcap=r(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),s.normalScale=new mt().fromArray(a)}return e.displacementMap!==void 0&&(s.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new mt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=r(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:ZF,SpriteMaterial:bM,RawShaderMaterial:qF,ShaderMaterial:wo,PointsMaterial:CE,MeshPhysicalMaterial:kr,MeshStandardMaterial:Np,MeshPhongMaterial:QF,MeshToonMaterial:eU,MeshNormalMaterial:tU,MeshLambertMaterial:nU,MeshDepthMaterial:M$,MeshDistanceMaterial:I$,MeshBasicMaterial:oi,MeshMatcapMaterial:iU,LineDashedMaterial:rU,LineBasicMaterial:Ai,Material:ir};return new n[e]}}class Pl{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class Y$ extends on{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class mU extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=new Nr(a.manager);l.setPath(a.path),l.setRequestHeader(a.requestHeader),l.setWithCredentials(a.withCredentials),l.load(e,function(u){try{n(a.parse(JSON.parse(u)))}catch(d){s?s(d):console.error(d),a.manager.itemError(e)}},r,s)}parse(e){const n={},r={};function s(v,y){if(n[y]!==void 0)return n[y];const E=v.interleavedBuffers[y],S=a(v,E.buffer),A=$g(E.type,S),C=new n_(A,E.stride);return C.uuid=E.uuid,n[y]=C,C}function a(v,y){if(r[y]!==void 0)return r[y];const E=v.arrayBuffers[y],S=new Uint32Array(E).buffer;return r[y]=S,S}const l=e.isInstancedBufferGeometry?new Y$:new on,u=e.data.index;if(u!==void 0){const v=$g(u.type,u.array);l.setIndex(new Qn(v,1))}const d=e.data.attributes;for(const v in d){const y=d[v];let $;if(y.isInterleavedBufferAttribute){const E=s(e.data,y.data);$=new oo(E,y.itemSize,y.offset,y.normalized)}else{const E=$g(y.type,y.array),S=y.isInstancedBufferAttribute?hd:Qn;$=new S(E,y.itemSize,y.normalized)}y.name!==void 0&&($.name=y.name),y.usage!==void 0&&$.setUsage(y.usage),y.updateRange!==void 0&&($.updateRange.offset=y.updateRange.offset,$.updateRange.count=y.updateRange.count),l.setAttribute(v,$)}const h=e.data.morphAttributes;if(h)for(const v in h){const y=h[v],$=[];for(let E=0,S=y.length;E<S;E++){const A=y[E];let C;if(A.isInterleavedBufferAttribute){const x=s(e.data,A.data);C=new oo(x,A.itemSize,A.offset,A.normalized)}else{const x=$g(A.type,A.array);C=new Qn(x,A.itemSize,A.normalized)}A.name!==void 0&&(C.name=A.name),$.push(C)}l.morphAttributes[v]=$}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let v=0,y=p.length;v!==y;++v){const $=p[v];l.addGroup($.start,$.count,$.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const v=new ie;m.center!==void 0&&v.fromArray(m.center),l.boundingSphere=new Ws(v,m.radius)}return e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class nj extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=this.path===""?Pl.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const u=new Nr(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){let h=null;try{h=JSON.parse(d)}catch(p){s!==void 0&&s(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}const f=h.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}a.parse(h,n)},r,s)}async loadAsync(e,n){const r=this,s=this.path===""?Pl.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new Nr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials);const l=await a.loadAsync(e,n),u=JSON.parse(l),d=u.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(u)}parse(e,n){const r=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,s),l=this.parseImages(e.images,function(){n!==void 0&&n(h)}),u=this.parseTextures(e.textures,l),d=this.parseMaterials(e.materials,u),h=this.parseObject(e.object,a,d,u,r),f=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,f),n!==void 0){let p=!1;for(const m in l)if(l[m].data instanceof HTMLImageElement){p=!0;break}p===!1&&n(h)}return h}async parseAsync(e){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,a),u=this.parseMaterials(e.materials,l),d=this.parseObject(e.object,s,u,l,n),h=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,h),d}parseShapes(e){const n={};if(e!==void 0)for(let r=0,s=e.length;r<s;r++){const a=new hp().fromJSON(e[r]);n[a.uuid]=a}return n}parseSkeletons(e,n){const r={},s={};if(n.traverse(function(a){a.isBone&&(s[a.uuid]=a)}),e!==void 0)for(let a=0,l=e.length;a<l;a++){const u=new i_().fromJSON(e[a],s);r[u.uuid]=u}return r}parseGeometries(e,n){const r={};if(e!==void 0){const s=new mU;for(let a=0,l=e.length;a<l;a++){let u;const d=e[a];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":u=s.parse(d);break;default:d.type in DN?u=DN[d.type].fromJSON(d,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}u.uuid=d.uuid,d.name!==void 0&&(u.name=d.name),d.userData!==void 0&&(u.userData=d.userData),r[d.uuid]=u}}return r}parseMaterials(e,n){const r={},s={};if(e!==void 0){const a=new j$;a.setTextures(n);for(let l=0,u=e.length;l<u;l++){const d=e[l];r[d.uuid]===void 0&&(r[d.uuid]=a.parse(d)),s[d.uuid]=r[d.uuid]}}return s}parseAnimations(e){const n={};if(e!==void 0)for(let r=0;r<e.length;r++){const s=e[r],a=Cp.parse(s);n[a.uuid]=a}return n}parseImages(e,n){const r=this,s={};let a;function l(d){return r.manager.itemStart(d),a.load(d,function(){r.manager.itemEnd(d)},void 0,function(){r.manager.itemError(d),r.manager.itemEnd(d)})}function u(d){if(typeof d=="string"){const h=d,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:r.resourcePath+h;return l(f)}else return d.data?{data:$g(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new H$(n);a=new hE(d),a.setCrossOrigin(this.crossOrigin);for(let h=0,f=e.length;h<f;h++){const p=e[h],m=p.url;if(Array.isArray(m)){const v=[];for(let y=0,$=m.length;y<$;y++){const E=m[y],S=u(E);S!==null&&(S instanceof HTMLImageElement?v.push(S):v.push(new up(S.data,S.width,S.height)))}s[p.uuid]=new Zf(v)}else{const v=u(p.url);s[p.uuid]=new Zf(v)}}}return s}async parseImagesAsync(e){const n=this,r={};let s;async function a(l){if(typeof l=="string"){const u=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u;return await s.loadAsync(d)}else return l.data?{data:$g(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){s=new hE(this.manager),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const d=e[l],h=d.url;if(Array.isArray(h)){const f=[];for(let p=0,m=h.length;p<m;p++){const v=h[p],y=await a(v);y!==null&&(y instanceof HTMLImageElement?f.push(y):f.push(new up(y.data,y.width,y.height)))}r[d.uuid]=new Zf(f)}else{const f=await a(d.url);r[d.uuid]=new Zf(f)}}}return r}parseTextures(e,n){function r(a,l){return typeof a=="number"?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),l[a])}const s={};if(e!==void 0)for(let a=0,l=e.length;a<l;a++){const u=e[a];u.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',u.uuid),n[u.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",u.image);const d=n[u.image],h=d.data;let f;Array.isArray(h)?(f=new bE,h.length===6&&(f.needsUpdate=!0)):(h&&h.data?f=new up:f=new ni,h&&(f.needsUpdate=!0)),f.source=d,f.uuid=u.uuid,u.name!==void 0&&(f.name=u.name),u.mapping!==void 0&&(f.mapping=r(u.mapping,ij)),u.channel!==void 0&&(f.channel=u.channel),u.offset!==void 0&&f.offset.fromArray(u.offset),u.repeat!==void 0&&f.repeat.fromArray(u.repeat),u.center!==void 0&&f.center.fromArray(u.center),u.rotation!==void 0&&(f.rotation=u.rotation),u.wrap!==void 0&&(f.wrapS=r(u.wrap[0],GN),f.wrapT=r(u.wrap[1],GN)),u.format!==void 0&&(f.format=u.format),u.internalFormat!==void 0&&(f.internalFormat=u.internalFormat),u.type!==void 0&&(f.type=u.type),u.colorSpace!==void 0&&(f.colorSpace=u.colorSpace),u.encoding!==void 0&&(f.encoding=u.encoding),u.minFilter!==void 0&&(f.minFilter=r(u.minFilter,HN)),u.magFilter!==void 0&&(f.magFilter=r(u.magFilter,HN)),u.anisotropy!==void 0&&(f.anisotropy=u.anisotropy),u.flipY!==void 0&&(f.flipY=u.flipY),u.generateMipmaps!==void 0&&(f.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(f.unpackAlignment=u.unpackAlignment),u.compareFunction!==void 0&&(f.compareFunction=u.compareFunction),u.userData!==void 0&&(f.userData=u.userData),s[u.uuid]=f}return s}parseObject(e,n,r,s,a){let l;function u(m){return n[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),n[m]}function d(m){if(m!==void 0){if(Array.isArray(m)){const v=[];for(let y=0,$=m.length;y<$;y++){const E=m[y];r[E]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",E),v.push(r[E])}return v}return r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),r[m]}}function h(m){return s[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),s[m]}let f,p;switch(e.type){case"Scene":l=new Yg,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new xt(e.background):l.background=h(e.background)),e.environment!==void 0&&(l.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new N$(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new L$(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":l=new Gi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new sa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new dU(e.color,e.intensity);break;case"DirectionalLight":l=new W$(e.color,e.intensity);break;case"PointLight":l=new z$(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new fU(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new V$(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":l=new hU(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new X$().fromJSON(e);break;case"SkinnedMesh":f=u(e.geometry),p=d(e.material),l=new k$(f,p),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":f=u(e.geometry),p=d(e.material),l=new Bn(f,p);break;case"InstancedMesh":f=u(e.geometry),p=d(e.material);const m=e.count,v=e.instanceMatrix,y=e.instanceColor;l=new P$(f,p,m),l.instanceMatrix=new hd(new Float32Array(v.array),16),y!==void 0&&(l.instanceColor=new hd(new Float32Array(y.array),y.itemSize));break;case"LOD":l=new GF;break;case"Line":l=new pr(u(e.geometry),d(e.material));break;case"LineLoop":l=new D$(u(e.geometry),d(e.material));break;case"LineSegments":l=new Ya(u(e.geometry),d(e.material));break;case"PointCloud":case"Points":l=new B$(u(e.geometry),d(e.material));break;case"Sprite":l=new UF(d(e.material));break;case"Group":l=new ta;break;case"Bone":l=new AE;break;default:l=new Xn}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.up!==void 0&&l.up.fromArray(e.up),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let v=0;v<m.length;v++)l.add(this.parseObject(m[v],n,r,s,a))}if(e.animations!==void 0){const m=e.animations;for(let v=0;v<m.length;v++){const y=m[v];l.animations.push(a[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const m=e.levels;for(let v=0;v<m.length;v++){const y=m[v],$=l.getObjectByProperty("uuid",y.object);$!==void 0&&l.addLevel($,y.distance,y.hysteresis)}}return l}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const s=n[r.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(s,r.bindMatrix)}})}}const ij={UVMapping:cd,CubeReflectionMapping:Lu,CubeRefractionMapping:ud,EquirectangularReflectionMapping:zg,EquirectangularRefractionMapping:tE,CubeUVReflectionMapping:e_},GN={RepeatWrapping:Bl,ClampToEdgeWrapping:Pi,MirroredRepeatWrapping:yp},HN={NearestFilter:er,NearestMipmapNearestFilter:Wg,NearestMipmapLinearFilter:op,LinearFilter:Dn,LinearMipmapNearestFilter:EE,LinearMipmapLinearFilter:Wa};class UM extends ls{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,r,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,l=Rp.get(e);if(l!==void 0)return a.manager.itemStart(e),setTimeout(function(){n&&n(l),a.manager.itemEnd(e)},0),l;const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,fetch(e,u).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(d){Rp.add(e,d),n&&n(d),a.manager.itemEnd(e)}).catch(function(d){s&&s(d),a.manager.itemError(e),a.manager.itemEnd(e)}),a.manager.itemStart(e)}}let w0;class GM{static getContext(){return w0===void 0&&(w0=new(window.AudioContext||window.webkitAudioContext)),w0}static setContext(e){w0=e}}class rj extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=new Nr(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(d){try{const h=d.slice(0);GM.getContext().decodeAudioData(h,function(p){n(p)},u)}catch(h){u(h)}},r,s);function u(d){s?s(d):console.error(d),a.manager.itemError(e)}}}class sj extends X${constructor(e,n,r=1){super(void 0,r),this.isHemisphereLightProbe=!0;const s=new xt().set(e),a=new xt().set(n),l=new ie(s.r,s.g,s.b),u=new ie(a.r,a.g,a.b),d=Math.sqrt(Math.PI),h=d*Math.sqrt(.75);this.sh.coefficients[0].copy(l).add(u).multiplyScalar(d),this.sh.coefficients[1].copy(l).sub(u).multiplyScalar(h)}}class oj extends X${constructor(e,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const r=new xt().set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const VN=new pn,zN=new pn,Mf=new pn;class aj{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Mf.copy(e.projectionMatrix);const s=n.eyeSep/2,a=s*n.near/n.focus,l=n.near*Math.tan(ap*n.fov*.5)/n.zoom;let u,d;zN.elements[12]=-s,VN.elements[12]=s,u=-l*n.aspect+a,d=l*n.aspect+a,Mf.elements[0]=2*n.near/(d-u),Mf.elements[8]=(d+u)/(d-u),this.cameraL.projectionMatrix.copy(Mf),u=-l*n.aspect-a,d=l*n.aspect-a,Mf.elements[0]=2*n.near/(d-u),Mf.elements[8]=(d+u)/(d-u),this.cameraR.projectionMatrix.copy(Mf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(zN),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(VN)}}class HM{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=WN(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=WN();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function WN(){return(typeof performance>"u"?Date:performance).now()}const If=new ie,XN=new Er,lj=new ie,Of=new ie;class cj extends Xn{constructor(){super(),this.type="AudioListener",this.context=GM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new HM}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(If,XN,lj),Of.set(0,0,-1).applyQuaternion(XN),n.positionX){const s=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(If.x,s),n.positionY.linearRampToValueAtTime(If.y,s),n.positionZ.linearRampToValueAtTime(If.z,s),n.forwardX.linearRampToValueAtTime(Of.x,s),n.forwardY.linearRampToValueAtTime(Of.y,s),n.forwardZ.linearRampToValueAtTime(Of.z,s),n.upX.linearRampToValueAtTime(r.x,s),n.upY.linearRampToValueAtTime(r.y,s),n.upZ.linearRampToValueAtTime(r.z,s)}else n.setPosition(If.x,If.y,If.z),n.setOrientation(Of.x,Of.y,Of.z,r.x,r.y,r.z)}}class gU extends Xn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Lf=new ie,jN=new Er,uj=new ie,Nf=new ie;class hj extends gU{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Lf,jN,uj),Nf.set(0,0,1).applyQuaternion(jN);const n=this.panner;if(n.positionX){const r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Lf.x,r),n.positionY.linearRampToValueAtTime(Lf.y,r),n.positionZ.linearRampToValueAtTime(Lf.z,r),n.orientationX.linearRampToValueAtTime(Nf.x,r),n.orientationY.linearRampToValueAtTime(Nf.y,r),n.orientationZ.linearRampToValueAtTime(Nf.z,r)}else n.setPosition(Lf.x,Lf.y,Lf.z),n.setOrientation(Nf.x,Nf.y,Nf.z)}}class dj{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let r=0;r<n.length;r++)e+=n[r];return e/n.length}}class _U{constructor(e,n,r){this.binding=e,this.valueSize=r;let s,a,l;switch(n){case"quaternion":s=this._slerp,a=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":s=this._select,a=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:s=this._lerp,a=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=a,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const r=this.buffer,s=this.valueSize,a=e*s+s;let l=this.cumulativeWeight;if(l===0){for(let u=0;u!==s;++u)r[a+u]=r[u];l=n}else{l+=n;const u=n/l;this._mixBufferRegion(r,a,0,u,s)}this.cumulativeWeight=l}accumulateAdditive(e){const n=this.buffer,r=this.valueSize,s=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,s,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,r=this.buffer,s=e*n+n,a=this.cumulativeWeight,l=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const d=n*this._origIndex;this._mixBufferRegion(r,s,d,1-a,n)}l>0&&this._mixBufferRegionAdditive(r,s,this._addIndex*n,1,n);for(let d=n,h=n+n;d!==h;++d)if(r[d]!==r[d+n]){u.setValue(r,s);break}}saveOriginalState(){const e=this.binding,n=this.buffer,r=this.valueSize,s=r*this._origIndex;e.getValue(n,s);for(let a=r,l=s;a!==l;++a)n[a]=n[s+a%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let r=e;r<n;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[n+r]=this.buffer[e+r]}_select(e,n,r,s,a){if(s>=.5)for(let l=0;l!==a;++l)e[n+l]=e[r+l]}_slerp(e,n,r,s){Er.slerpFlat(e,n,e,n,e,r,s)}_slerpAdditive(e,n,r,s,a){const l=this._workIndex*a;Er.multiplyQuaternionsFlat(e,l,e,n,e,r),Er.slerpFlat(e,n,e,n,e,l,s)}_lerp(e,n,r,s,a){const l=1-s;for(let u=0;u!==a;++u){const d=n+u;e[d]=e[d]*l+e[r+u]*s}}_lerpAdditive(e,n,r,s,a){for(let l=0;l!==a;++l){const u=n+l;e[u]=e[u]+e[r+l]*s}}}const VM="\\[\\]\\.:\\/",fj=new RegExp("["+VM+"]","g"),zM="[^"+VM+"]",pj="[^"+VM.replace("\\.","")+"]",mj=/((?:WC+[\/:])*)/.source.replace("WC",zM),gj=/(WCOD+)?/.source.replace("WCOD",pj),_j=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",zM),Tj=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",zM),vj=new RegExp("^"+mj+gj+_j+Tj+"$"),Ej=["material","materials","bones","map"];class yj{constructor(e,n,r){const s=r||Zn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const r=this._targetGroup.nCachedObjects_,s=this._bindings[r];s!==void 0&&s.getValue(e,n)}setValue(e,n){const r=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=r.length;s!==a;++s)r[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].unbind()}}class Zn{constructor(e,n,r){this.path=n,this.parsedPath=r||Zn.parseTrackName(n),this.node=Zn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new Zn.Composite(e,n,r):new Zn(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(fj,"")}static parseTrackName(e){const n=vj.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const a=r.nodeName.substring(s+1);Ej.indexOf(a)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=a)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(r!==void 0)return r}if(e.children){const r=function(a){for(let l=0;l<a.length;l++){const u=a[l];if(u.name===n||u.uuid===n)return u;const d=r(u.children);if(d)return d}return null},s=r(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)e[n++]=r[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let a=n.propertyIndex;if(e||(e=Zn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let h=n.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const l=e[s];if(l===void 0){const h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+s+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(a!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}d=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else l.fromArray!==void 0&&l.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(d=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=s;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Zn.Composite=yj;Zn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zn.prototype.GetterByBindingType=[Zn.prototype._getValue_direct,Zn.prototype._getValue_array,Zn.prototype._getValue_arrayElement,Zn.prototype._getValue_toArray];Zn.prototype.SetterByBindingTypeAndVersioning=[[Zn.prototype._setValue_direct,Zn.prototype._setValue_direct_setNeedsUpdate,Zn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_array,Zn.prototype._setValue_array_setNeedsUpdate,Zn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_arrayElement,Zn.prototype._setValue_arrayElement_setNeedsUpdate,Zn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_fromArray,Zn.prototype._setValue_fromArray_setNeedsUpdate,Zn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Sj{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ra(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,s=arguments.length;r!==s;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,r=this._paths,s=this._parsedPaths,a=this._bindings,l=a.length;let u,d=e.length,h=this.nCachedObjects_;for(let f=0,p=arguments.length;f!==p;++f){const m=arguments[f],v=m.uuid;let y=n[v];if(y===void 0){y=d++,n[v]=y,e.push(m);for(let $=0,E=l;$!==E;++$)a[$].push(new Zn(m,r[$],s[$]))}else if(y<h){u=e[y];const $=--h,E=e[$];n[E.uuid]=y,e[y]=E,n[v]=$,e[$]=m;for(let S=0,A=l;S!==A;++S){const C=a[S],x=C[$];let I=C[y];C[y]=x,I===void 0&&(I=new Zn(m,r[S],s[S])),C[$]=I}}else e[y]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,s=r.length;let a=this.nCachedObjects_;for(let l=0,u=arguments.length;l!==u;++l){const d=arguments[l],h=d.uuid,f=n[h];if(f!==void 0&&f>=a){const p=a++,m=e[p];n[m.uuid]=f,e[f]=m,n[h]=p,e[p]=d;for(let v=0,y=s;v!==y;++v){const $=r[v],E=$[p],S=$[f];$[f]=E,$[p]=S}}}this.nCachedObjects_=a}uncache(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,s=r.length;let a=this.nCachedObjects_,l=e.length;for(let u=0,d=arguments.length;u!==d;++u){const h=arguments[u],f=h.uuid,p=n[f];if(p!==void 0)if(delete n[f],p<a){const m=--a,v=e[m],y=--l,$=e[y];n[v.uuid]=p,e[p]=v,n[$.uuid]=m,e[m]=$,e.pop();for(let E=0,S=s;E!==S;++E){const A=r[E],C=A[m],x=A[y];A[p]=C,A[m]=x,A.pop()}}else{const m=--l,v=e[m];m>0&&(n[v.uuid]=p),e[p]=v,e.pop();for(let y=0,$=s;y!==$;++y){const E=r[y];E[p]=E[m],E.pop()}}}this.nCachedObjects_=a}subscribe_(e,n){const r=this._bindingsIndicesByPath;let s=r[e];const a=this._bindings;if(s!==void 0)return a[s];const l=this._paths,u=this._parsedPaths,d=this._objects,h=d.length,f=this.nCachedObjects_,p=new Array(h);s=a.length,r[e]=s,l.push(e),u.push(n),a.push(p);for(let m=f,v=d.length;m!==v;++m){const y=d[m];p[m]=new Zn(y,e,n)}return p}unsubscribe_(e){const n=this._bindingsIndicesByPath,r=n[e];if(r!==void 0){const s=this._paths,a=this._parsedPaths,l=this._bindings,u=l.length-1,d=l[u],h=e[u];n[h]=r,l[r]=d,l.pop(),a[r]=a[u],a.pop(),s[r]=s[u],s.pop()}}}class TU{constructor(e,n,r=null,s=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=r,this.blendMode=s;const a=n.tracks,l=a.length,u=new Array(l),d={endingStart:Kf,endingEnd:Kf};for(let h=0;h!==l;++h){const f=a[h].createInterpolant(null);u[h]=f,f.settings=d}this._interpolantSettings=d,this._interpolants=u,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fF,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,r){if(e.fadeOut(n),this.fadeIn(n),r){const s=this._clip.duration,a=e._clip.duration,l=a/s,u=s/a;e.warp(1,l,n),this.warp(u,1,n)}return this}crossFadeTo(e,n,r){return e.crossFadeFrom(this,n,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,r){const s=this._mixer,a=s.time,l=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=s._lendControlInterpolant(),this._timeScaleInterpolant=u);const d=u.parameterPositions,h=u.sampleValues;return d[0]=a,d[1]=a+r,h[0]=e/l,h[1]=n/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,r,s){if(!this.enabled){this._updateWeight(e);return}const a=this._startTime;if(a!==null){const d=(e-a)*r;d<0||r===0?n=0:(this._startTime=null,n=r*d)}n*=this._updateTimeScale(e);const l=this._updateTime(n),u=this._updateWeight(e);if(u>0){const d=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case dM:for(let f=0,p=d.length;f!==p;++f)d[f].evaluate(l),h[f].accumulateAdditive(u);break;case A$:default:for(let f=0,p=d.length;f!==p;++f)d[f].evaluate(l),h[f].accumulate(s,u)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const r=this._weightInterpolant;if(r!==null){const s=r.evaluate(e)[0];n*=s,e>r.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const s=r.evaluate(e)[0];n*=s,e>r.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,r=this.loop;let s=this.time+e,a=this._loopCount;const l=r===pF;if(e===0)return a===-1?s:l&&(a&1)===1?n-s:s;if(r===dF){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),s>=n||s<0){const u=Math.floor(s/n);s-=n*u,a+=Math.abs(u);const d=this.repetitions-a;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const h=e<0;this._setEndings(h,!h,l)}else this._setEndings(!1,!1,l);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=s;if(l&&(a&1)===1)return n-s}return s}_setEndings(e,n,r){const s=this._interpolantSettings;r?(s.endingStart=Jf,s.endingEnd=Jf):(e?s.endingStart=this.zeroSlopeAtStart?Jf:Kf:s.endingStart=nE,n?s.endingEnd=this.zeroSlopeAtEnd?Jf:Kf:s.endingEnd=nE)}_scheduleFading(e,n,r){const s=this._mixer,a=s.time;let l=this._weightInterpolant;l===null&&(l=s._lendControlInterpolant(),this._weightInterpolant=l);const u=l.parameterPositions,d=l.sampleValues;return u[0]=a,d[0]=n,u[1]=a+e,d[1]=r,this}}const $j=new Float32Array(1);class bj extends Mc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const r=e._localRoot||this._root,s=e._clip.tracks,a=s.length,l=e._propertyBindings,u=e._interpolants,d=r.uuid,h=this._bindingsByRootAndName;let f=h[d];f===void 0&&(f={},h[d]=f);for(let p=0;p!==a;++p){const m=s[p],v=m.name;let y=f[v];if(y!==void 0)++y.referenceCount,l[p]=y;else{if(y=l[p],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,d,v));continue}const $=n&&n._propertyBindings[p].binding.parsedPath;y=new _U(Zn.create(r,v,$),m.ValueTypeName,m.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,d,v),l[p]=y}u[p].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,s=e._clip.uuid,a=this._actionsByClip[s];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,s,r)}const n=e._propertyBindings;for(let r=0,s=n.length;r!==s;++r){const a=n[r];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let r=0,s=n.length;r!==s;++r){const a=n[r];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,r){const s=this._actions,a=this._actionsByClip;let l=a[n];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[n]=l;else{const u=l.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=s.length,s.push(e),l.actionByRoot[r]=e}_removeInactiveAction(e){const n=this._actions,r=n[n.length-1],s=e._cacheIndex;r._cacheIndex=s,n[s]=r,n.pop(),e._cacheIndex=null;const a=e._clip.uuid,l=this._actionsByClip,u=l[a],d=u.knownActions,h=d[d.length-1],f=e._byClipCacheIndex;h._byClipCacheIndex=f,d[f]=h,d.pop(),e._byClipCacheIndex=null;const p=u.actionByRoot,m=(e._localRoot||this._root).uuid;delete p[m],d.length===0&&delete l[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let r=0,s=n.length;r!==s;++r){const a=n[r];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(e){const n=this._actions,r=e._cacheIndex,s=this._nActiveActions++,a=n[s];e._cacheIndex=s,n[s]=e,a._cacheIndex=r,n[r]=a}_takeBackAction(e){const n=this._actions,r=e._cacheIndex,s=--this._nActiveActions,a=n[s];e._cacheIndex=s,n[s]=e,a._cacheIndex=r,n[r]=a}_addInactiveBinding(e,n,r){const s=this._bindingsByRootAndName,a=this._bindings;let l=s[n];l===void 0&&(l={},s[n]=l),l[r]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const n=this._bindings,r=e.binding,s=r.rootNode.uuid,a=r.path,l=this._bindingsByRootAndName,u=l[s],d=n[n.length-1],h=e._cacheIndex;d._cacheIndex=h,n[h]=d,n.pop(),delete u[a],Object.keys(u).length===0&&delete l[s]}_lendBinding(e){const n=this._bindings,r=e._cacheIndex,s=this._nActiveBindings++,a=n[s];e._cacheIndex=s,n[s]=e,a._cacheIndex=r,n[r]=a}_takeBackBinding(e){const n=this._bindings,r=e._cacheIndex,s=--this._nActiveBindings,a=n[s];e._cacheIndex=s,n[s]=e,a._cacheIndex=r,n[r]=a}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let r=e[n];return r===void 0&&(r=new kM(new Float32Array(2),new Float32Array(2),1,$j),r.__cacheIndex=n,e[n]=r),r}_takeBackControlInterpolant(e){const n=this._controlInterpolants,r=e.__cacheIndex,s=--this._nActiveControlInterpolants,a=n[s];e.__cacheIndex=s,n[s]=e,a.__cacheIndex=r,n[r]=a}clipAction(e,n,r){const s=n||this._root,a=s.uuid;let l=typeof e=="string"?Cp.findByName(s,e):e;const u=l!==null?l.uuid:e,d=this._actionsByClip[u];let h=null;if(r===void 0&&(l!==null?r=l.blendMode:r=A$),d!==void 0){const p=d.actionByRoot[a];if(p!==void 0&&p.blendMode===r)return p;h=d.knownActions[0],l===null&&(l=h._clip)}if(l===null)return null;const f=new TU(this,l,n,r);return this._bindAction(f,h),this._addInactiveAction(f,u,a),f}existingAction(e,n){const r=n||this._root,s=r.uuid,a=typeof e=="string"?Cp.findByName(r,e):e,l=a?a.uuid:e,u=this._actionsByClip[l];return u!==void 0&&u.actionByRoot[s]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let r=n-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const n=this._actions,r=this._nActiveActions,s=this.time+=e,a=Math.sign(e),l=this._accuIndex^=1;for(let h=0;h!==r;++h)n[h]._update(s,e,a,l);const u=this._bindings,d=this._nActiveBindings;for(let h=0;h!==d;++h)u[h].apply(l);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,r=e.uuid,s=this._actionsByClip,a=s[r];if(a!==void 0){const l=a.knownActions;for(let u=0,d=l.length;u!==d;++u){const h=l[u];this._deactivateAction(h);const f=h._cacheIndex,p=n[n.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,p._cacheIndex=f,n[f]=p,n.pop(),this._removeInactiveBindingsForAction(h)}delete s[r]}}uncacheRoot(e){const n=e.uuid,r=this._actionsByClip;for(const l in r){const u=r[l].actionByRoot,d=u[n];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const s=this._bindingsByRootAndName,a=s[n];if(a!==void 0)for(const l in a){const u=a[l];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,n){const r=this.existingAction(e,n);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class WM{constructor(e){this.value=e}clone(){return new WM(this.value.clone===void 0?this.value:this.value.clone())}}let Aj=0;class Cj extends Mc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Aj++}),this.name="",this.usage=iE,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let r=0,s=n.length;r<s;r++)this.uniforms.push(n[r].clone());return this}clone(){return new this.constructor().copy(this)}}class YS extends n_{constructor(e,n,r=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class Rj{constructor(e,n,r,s,a){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=r,this.elementSize=s,this.count=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class ho{constructor(e,n,r=0,s=1/0){this.ray=new Op(e,n),this.near=r,this.far=s,this.camera=null,this.layers=new cp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,r=[]){return Hx(e,this,r,n),r.sort(YN),r}intersectObjects(e,n=!0,r=[]){for(let s=0,a=e.length;s<a;s++)Hx(e[s],this,r,n);return r.sort(YN),r}}function YN(i,e){return i.distance-e.distance}function Hx(i,e,n,r){if(i.layers.test(e.layers)&&i.raycast(e,n),r===!0){const s=i.children;for(let a=0,l=s.length;a<l;a++)Hx(s[a],e,n,!0)}}class Vx{constructor(e=1,n=0,r=0){return this.radius=e,this.phi=n,this.theta=r,this}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+n*n+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(fr(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class xj{constructor(e=1,n=0,r=0){return this.radius=e,this.theta=n,this.y=r,this}set(e,n,r){return this.radius=e,this.theta=n,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=n,this}clone(){return new this.constructor().copy(this)}}const KN=new mt;class wj{constructor(e=new mt(1/0,1/0),n=new mt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=KN.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,KN).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const JN=new ie,M0=new ie;class vU{constructor(e=new ie,n=new ie){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){JN.subVectors(e,this.start),M0.subVectors(this.end,this.start);const r=M0.dot(M0);let a=M0.dot(JN)/r;return n&&(a=fr(a,0,1)),a}closestPointToPoint(e,n,r){const s=this.closestPointToPointParameter(e,n);return this.delta(r).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ZN=new ie;class Mj extends Xn{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const r=new on,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,u=1,d=32;l<d;l++,u++){const h=l/d*Math.PI*2,f=u/d*Math.PI*2;s.push(Math.cos(h),Math.sin(h),1,Math.cos(f),Math.sin(f),1)}r.setAttribute("position",new Yt(s,3));const a=new Ai({fog:!1,toneMapped:!1});this.cone=new Ya(r,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),ZN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ZN),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kh=new ie,I0=new pn,LC=new pn;class Ij extends Ya{constructor(e){const n=EU(e),r=new on,s=[],a=[],l=new xt(0,0,1),u=new xt(0,1,0);for(let h=0;h<n.length;h++){const f=n[h];f.parent&&f.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),a.push(l.r,l.g,l.b),a.push(u.r,u.g,u.b))}r.setAttribute("position",new Yt(s,3)),r.setAttribute("color",new Yt(a,3));const d=new Ai({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,d),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,r=this.geometry,s=r.getAttribute("position");LC.copy(this.root.matrixWorld).invert();for(let a=0,l=0;a<n.length;a++){const u=n[a];u.parent&&u.parent.isBone&&(I0.multiplyMatrices(LC,u.matrixWorld),kh.setFromMatrixPosition(I0),s.setXYZ(l,kh.x,kh.y,kh.z),I0.multiplyMatrices(LC,u.parent.matrixWorld),kh.setFromMatrixPosition(I0),s.setXYZ(l+1,kh.x,kh.y,kh.z),l+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function EU(i){const e=[];i.isBone===!0&&e.push(i);for(let n=0;n<i.children.length;n++)e.push.apply(e,EU(i.children[n]));return e}class Oj extends Bn{constructor(e,n,r){const s=new l_(n,4,2),a=new oi({wireframe:!0,fog:!1,toneMapped:!1});super(s,a),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Lj=new ie,qN=new xt,QN=new xt;class Nj extends Xn{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const s=new a_(n);s.rotateY(Math.PI*.5),this.material=new oi({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=s.getAttribute("position"),l=new Float32Array(a.count*3);s.setAttribute("color",new Qn(l,3)),this.add(new Bn(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");qN.copy(this.light.color),QN.copy(this.light.groundColor);for(let r=0,s=n.count;r<s;r++){const a=r<s/2?qN:QN;n.setXYZ(r,a.r,a.g,a.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Lj.setFromMatrixPosition(this.light.matrixWorld).negate())}}class kj extends Ya{constructor(e=10,n=10,r=4473924,s=8947848){r=new xt(r),s=new xt(s);const a=n/2,l=e/n,u=e/2,d=[],h=[];for(let m=0,v=0,y=-u;m<=n;m++,y+=l){d.push(-u,0,y,u,0,y),d.push(y,0,-u,y,0,u);const $=m===a?r:s;$.toArray(h,v),v+=3,$.toArray(h,v),v+=3,$.toArray(h,v),v+=3,$.toArray(h,v),v+=3}const f=new on;f.setAttribute("position",new Yt(d,3)),f.setAttribute("color",new Yt(h,3));const p=new Ai({vertexColors:!0,toneMapped:!1});super(f,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Pj extends Ya{constructor(e=10,n=16,r=8,s=64,a=4473924,l=8947848){a=new xt(a),l=new xt(l);const u=[],d=[];if(n>1)for(let p=0;p<n;p++){const m=p/n*(Math.PI*2),v=Math.sin(m)*e,y=Math.cos(m)*e;u.push(0,0,0),u.push(v,0,y);const $=p&1?a:l;d.push($.r,$.g,$.b),d.push($.r,$.g,$.b)}for(let p=0;p<r;p++){const m=p&1?a:l,v=e-e/r*p;for(let y=0;y<s;y++){let $=y/s*(Math.PI*2),E=Math.sin($)*v,S=Math.cos($)*v;u.push(E,0,S),d.push(m.r,m.g,m.b),$=(y+1)/s*(Math.PI*2),E=Math.sin($)*v,S=Math.cos($)*v,u.push(E,0,S),d.push(m.r,m.g,m.b)}}const h=new on;h.setAttribute("position",new Yt(u,3)),h.setAttribute("color",new Yt(d,3));const f=new Ai({vertexColors:!0,toneMapped:!1});super(h,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const ek=new ie,O0=new ie,tk=new ie;class Dj extends Xn{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",n===void 0&&(n=1);let s=new on;s.setAttribute("position",new Yt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const a=new Ai({fog:!1,toneMapped:!1});this.lightPlane=new pr(s,a),this.add(this.lightPlane),s=new on,s.setAttribute("position",new Yt([0,0,0,0,0,1],3)),this.targetLine=new pr(s,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),ek.setFromMatrixPosition(this.light.matrixWorld),O0.setFromMatrixPosition(this.light.target.matrixWorld),tk.subVectors(O0,ek),this.lightPlane.lookAt(O0),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(O0),this.targetLine.scale.z=tk.length()}}const L0=new ie,hr=new $E;class Bj extends Ya{constructor(e){const n=new on,r=new Ai({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],a=[],l={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(y,$){d(y),d($)}function d(y){s.push(0,0,0),a.push(0,0,0),l[y]===void 0&&(l[y]=[]),l[y].push(s.length/3-1)}n.setAttribute("position",new Yt(s,3)),n.setAttribute("color",new Yt(a,3)),super(n,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const h=new xt(16755200),f=new xt(16711680),p=new xt(43775),m=new xt(16777215),v=new xt(3355443);this.setColors(h,f,p,m,v)}setColors(e,n,r,s,a){const u=this.geometry.getAttribute("color");u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,n.r,n.g,n.b),u.setXYZ(25,n.r,n.g,n.b),u.setXYZ(26,n.r,n.g,n.b),u.setXYZ(27,n.r,n.g,n.b),u.setXYZ(28,n.r,n.g,n.b),u.setXYZ(29,n.r,n.g,n.b),u.setXYZ(30,n.r,n.g,n.b),u.setXYZ(31,n.r,n.g,n.b),u.setXYZ(32,r.r,r.g,r.b),u.setXYZ(33,r.r,r.g,r.b),u.setXYZ(34,r.r,r.g,r.b),u.setXYZ(35,r.r,r.g,r.b),u.setXYZ(36,r.r,r.g,r.b),u.setXYZ(37,r.r,r.g,r.b),u.setXYZ(38,s.r,s.g,s.b),u.setXYZ(39,s.r,s.g,s.b),u.setXYZ(40,a.r,a.g,a.b),u.setXYZ(41,a.r,a.g,a.b),u.setXYZ(42,a.r,a.g,a.b),u.setXYZ(43,a.r,a.g,a.b),u.setXYZ(44,a.r,a.g,a.b),u.setXYZ(45,a.r,a.g,a.b),u.setXYZ(46,a.r,a.g,a.b),u.setXYZ(47,a.r,a.g,a.b),u.setXYZ(48,a.r,a.g,a.b),u.setXYZ(49,a.r,a.g,a.b),u.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,r=1,s=1;hr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Tr("c",n,e,hr,0,0,-1),Tr("t",n,e,hr,0,0,1),Tr("n1",n,e,hr,-r,-s,-1),Tr("n2",n,e,hr,r,-s,-1),Tr("n3",n,e,hr,-r,s,-1),Tr("n4",n,e,hr,r,s,-1),Tr("f1",n,e,hr,-r,-s,1),Tr("f2",n,e,hr,r,-s,1),Tr("f3",n,e,hr,-r,s,1),Tr("f4",n,e,hr,r,s,1),Tr("u1",n,e,hr,r*.7,s*1.1,-1),Tr("u2",n,e,hr,-r*.7,s*1.1,-1),Tr("u3",n,e,hr,0,s*2,-1),Tr("cf1",n,e,hr,-r,0,1),Tr("cf2",n,e,hr,r,0,1),Tr("cf3",n,e,hr,0,-s,1),Tr("cf4",n,e,hr,0,s,1),Tr("cn1",n,e,hr,-r,0,-1),Tr("cn2",n,e,hr,r,0,-1),Tr("cn3",n,e,hr,0,-s,-1),Tr("cn4",n,e,hr,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Tr(i,e,n,r,s,a,l){L0.set(s,a,l).unproject(r);const u=e[i];if(u!==void 0){const d=n.getAttribute("position");for(let h=0,f=u.length;h<f;h++)d.setXYZ(u[h],L0.x,L0.y,L0.z)}}const N0=new zs;class Fj extends Ya{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),a=new on;a.setIndex(new Qn(r,1)),a.setAttribute("position",new Qn(s,3)),super(a,new Ai({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&N0.setFromObject(this.object),N0.isEmpty())return;const n=N0.min,r=N0.max,s=this.geometry.attributes.position,a=s.array;a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=n.x,a[4]=r.y,a[5]=r.z,a[6]=n.x,a[7]=n.y,a[8]=r.z,a[9]=r.x,a[10]=n.y,a[11]=r.z,a[12]=r.x,a[13]=r.y,a[14]=n.z,a[15]=n.x,a[16]=r.y,a[17]=n.z,a[18]=n.x,a[19]=n.y,a[20]=n.z,a[21]=r.x,a[22]=n.y,a[23]=n.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Uj extends Ya{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new on;a.setIndex(new Qn(r,1)),a.setAttribute("position",new Yt(s,3)),super(a,new Ai({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Gj extends pr{constructor(e,n=1,r=16776960){const s=r,a=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new on;l.setAttribute("position",new Yt(a,3)),l.computeBoundingSphere(),super(l,new Ai({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new on;d.setAttribute("position",new Yt(u,3)),d.computeBoundingSphere(),this.add(new Bn(d,new oi({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const nk=new ie;let k0,NC;class Hj extends Xn{constructor(e=new ie(0,0,1),n=new ie(0,0,0),r=1,s=16776960,a=r*.2,l=a*.2){super(),this.type="ArrowHelper",k0===void 0&&(k0=new on,k0.setAttribute("position",new Yt([0,0,0,0,1,0],3)),NC=new Lp(0,.5,1,5,1),NC.translate(0,-.5,0)),this.position.copy(n),this.line=new pr(k0,new Ai({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Bn(NC,new oi({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,a,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{nk.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(nk,n)}}setLength(e,n=e*.2,r=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(r,n,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Vj extends Ya{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new on;s.setAttribute("position",new Yt(n,3)),s.setAttribute("color",new Yt(r,3));const a=new Ai({vertexColors:!0,toneMapped:!1});super(s,a),this.type="AxesHelper"}setColors(e,n,r){const s=new xt,a=this.geometry.attributes.color.array;return s.set(e),s.toArray(a,0),s.toArray(a,3),s.set(n),s.toArray(a,6),s.toArray(a,9),s.set(r),s.toArray(a,12),s.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yU{constructor(){this.type="ShapePath",this.color=new xt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new aE,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,r,s){return this.currentPath.quadraticCurveTo(e,n,r,s),this}bezierCurveTo(e,n,r,s,a,l){return this.currentPath.bezierCurveTo(e,n,r,s,a,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(S){const A=[];for(let C=0,x=S.length;C<x;C++){const I=S[C],O=new hp;O.curves=I.curves,A.push(O)}return A}function r(S,A){const C=A.length;let x=!1;for(let I=C-1,O=0;O<C;I=O++){let F=A[I],k=A[O],D=k.x-F.x,U=k.y-F.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(F=A[O],D=-D,k=A[I],U=-U),S.y<F.y||S.y>k.y)continue;if(S.y===F.y){if(S.x===F.x)return!0}else{const ce=U*(S.x-F.x)-D*(S.y-F.y);if(ce===0)return!0;if(ce<0)continue;x=!x}}else{if(S.y!==F.y)continue;if(k.x<=S.x&&S.x<=F.x||F.x<=S.x&&S.x<=k.x)return!0}}return x}const s=xc.isClockWise,a=this.subPaths;if(a.length===0)return[];let l,u,d;const h=[];if(a.length===1)return u=a[0],d=new hp,d.curves=u.curves,h.push(d),h;let f=!s(a[0].getPoints());f=e?!f:f;const p=[],m=[];let v=[],y=0,$;m[y]=void 0,v[y]=[];for(let S=0,A=a.length;S<A;S++)u=a[S],$=u.getPoints(),l=s($),l=e?!l:l,l?(!f&&m[y]&&y++,m[y]={s:new hp,p:$},m[y].s.curves=u.curves,f&&y++,v[y]=[]):v[y].push({h:u,p:$[0]});if(!m[0])return n(a);if(m.length>1){let S=!1,A=0;for(let C=0,x=m.length;C<x;C++)p[C]=[];for(let C=0,x=m.length;C<x;C++){const I=v[C];for(let O=0;O<I.length;O++){const F=I[O];let k=!0;for(let D=0;D<m.length;D++)r(F.p,m[D].p)&&(C!==D&&A++,k?(k=!1,p[D].push(F)):S=!0);k&&p[C].push(F)}}A>0&&S===!1&&(v=p)}let E;for(let S=0,A=m.length;S<A;S++){d=m[S].s,h.push(d),E=v[S];for(let C=0,x=E.length;C<x;C++)d.holes.push(E[C].h)}return h}}class zj extends vd{constructor(e,n,r,s,a,l){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,n,r,s,a,l)}}class Wj extends RE{constructor(e,n,r,s){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,n,r,s)}}class Xj extends xE{constructor(e,n,r,s){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,n,r,s)}}class jj extends wE{constructor(e,n,r,s,a,l,u){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,n,r,s,a,l,u)}}class Yj extends Lp{constructor(e,n,r,s,a,l,u,d){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,n,r,s,a,l,u,d)}}class Kj extends ME{constructor(e,n){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,n)}}class Jj extends s_{constructor(e,n){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,n)}}class Zj extends o_{constructor(e,n){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,n)}}class qj extends r_{constructor(e,n,r,s){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,n,r,s)}}class Qj extends a_{constructor(e,n){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,n)}}class e9 extends ja{constructor(e,n,r,s){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,n,r,s)}}class t9 extends Du{constructor(e,n,r,s){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,n,r,s)}}class n9 extends IE{constructor(e,n,r,s,a,l){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,n,r,s,a,l)}}class i9 extends OE{constructor(e,n){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,n)}}class r9 extends l_{constructor(e,n,r,s,a,l,u){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,n,r,s,a,l,u)}}class s9 extends LE{constructor(e,n){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,n)}}class o9 extends NE{constructor(e,n,r,s,a){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,n,r,s,a)}}class a9 extends kE{constructor(e,n,r,s,a,l){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,n,r,s,a,l)}}class l9 extends PE{constructor(e,n,r,s,a){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,n,r,s,a)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ip}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ip);const c9=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:iM,AddEquation:Vf,AddOperation:tF,AdditiveAnimationBlendMode:dM,AdditiveBlending:sx,AlphaFormat:oF,AlwaysCompare:AF,AlwaysDepth:YB,AlwaysStencilFunc:_F,AmbientLight:dU,AmbientLightProbe:oj,AnimationAction:TU,AnimationClip:Cp,AnimationLoader:ZX,AnimationMixer:bj,AnimationObjectGroup:Sj,AnimationUtils:jX,ArcCurve:HF,ArrayCamera:DF,ArrowHelper:Hj,Audio:gU,AudioAnalyser:dj,AudioContext:GM,AudioListener:cj,AudioLoader:rj,AxesHelper:Vj,BackSide:Hs,BasicDepthPacking:mF,BasicShadowMap:NB,Bone:AE,BooleanKeyframeTrack:Pp,Box2:wj,Box3:zs,Box3Helper:Uj,BoxBufferGeometry:zj,BoxGeometry:vd,BoxHelper:Fj,BufferAttribute:Qn,BufferGeometry:on,BufferGeometryLoader:mU,ByteType:rM,Cache:Rp,Camera:$E,CameraHelper:Bj,CanvasTexture:_X,CapsuleBufferGeometry:Wj,CapsuleGeometry:RE,CatmullRomCurve3:VF,CineonToneMapping:rF,CircleBufferGeometry:Xj,CircleGeometry:xE,ClampToEdgeWrapping:Pi,Clock:HM,Color:xt,ColorKeyframeTrack:PM,ColorManagement:La,CompressedArrayTexture:gX,CompressedTexture:AM,CompressedTextureLoader:qX,ConeBufferGeometry:jj,ConeGeometry:wE,CubeCamera:MF,CubeReflectionMapping:Lu,CubeRefractionMapping:ud,CubeTexture:bE,CubeTextureLoader:uU,CubeUVReflectionMapping:e_,CubicBezierCurve:RM,CubicBezierCurve3:zF,CubicInterpolant:oU,CullFaceBack:rx,CullFaceFront:LB,CullFaceFrontBack:vz,CullFaceNone:OB,Curve:Fl,CurvePath:XF,CustomBlending:kB,CustomToneMapping:sF,CylinderBufferGeometry:Yj,CylinderGeometry:Lp,Cylindrical:xj,Data3DTexture:TM,DataArrayTexture:R$,DataTexture:up,DataTextureLoader:DM,DataUtils:qf,DecrementStencilOp:Rz,DecrementWrapStencilOp:wz,DefaultLoadingManager:cU,DepthFormat:sd,DepthStencilFormat:Sp,DepthTexture:$M,DirectionalLight:W$,DirectionalLightHelper:Dj,DiscreteInterpolant:aU,DisplayP3ColorSpace:mM,DodecahedronBufferGeometry:Kj,DodecahedronGeometry:ME,DoubleSide:$s,DstAlphaFactor:HB,DstColorFactor:zB,DynamicCopyUsage:zz,DynamicDrawUsage:Bz,DynamicReadUsage:Gz,EdgesGeometry:jF,EllipseCurve:F$,EqualCompare:EF,EqualDepth:JB,EqualStencilFunc:Lz,EquirectangularReflectionMapping:zg,EquirectangularRefractionMapping:tE,Euler:SE,EventDispatcher:Mc,ExtrudeBufferGeometry:Jj,ExtrudeGeometry:s_,FileLoader:Nr,Float16BufferAttribute:O4,Float32BufferAttribute:Yt,Float64BufferAttribute:L4,FloatType:Lr,Fog:N$,FogExp2:L$,FramebufferTexture:mX,FrontSide:za,Frustum:x$,GLBufferAttribute:Rj,GLSL1:Xz,GLSL3:Nx,GreaterCompare:SF,GreaterDepth:qB,GreaterEqualCompare:bF,GreaterEqualDepth:ZB,GreaterEqualStencilFunc:Dz,GreaterStencilFunc:kz,GridHelper:kj,Group:ta,HalfFloatType:Jr,HemisphereLight:hU,HemisphereLightHelper:Nj,HemisphereLightProbe:sj,IcosahedronBufferGeometry:Zj,IcosahedronGeometry:o_,ImageBitmapLoader:UM,ImageLoader:hE,ImageUtils:_M,IncrementStencilOp:Cz,IncrementWrapStencilOp:xz,InstancedBufferAttribute:hd,InstancedBufferGeometry:Y$,InstancedInterleavedBuffer:YS,InstancedMesh:P$,Int16BufferAttribute:M4,Int32BufferAttribute:I4,Int8BufferAttribute:R4,IntType:b$,InterleavedBuffer:n_,InterleavedBufferAttribute:oo,Interpolant:kp,InterpolateDiscrete:$p,InterpolateLinear:Nu,InterpolateSmooth:mS,InvertStencilOp:Mz,KeepStencilOp:gS,KeyframeTrack:Ul,LOD:GF,LatheBufferGeometry:qj,LatheGeometry:r_,Layers:cp,LessCompare:vF,LessDepth:KB,LessEqualCompare:yF,LessEqualDepth:WS,LessEqualStencilFunc:Nz,LessStencilFunc:Oz,Light:Ed,LightProbe:X$,Line:pr,Line3:vU,LineBasicMaterial:Ai,LineCurve:U$,LineCurve3:WF,LineDashedMaterial:rU,LineLoop:D$,LineSegments:Ya,LinearEncoding:C$,LinearFilter:Dn,LinearInterpolant:kM,LinearMipMapLinearFilter:ux,LinearMipMapNearestFilter:$z,LinearMipmapLinearFilter:Wa,LinearMipmapNearestFilter:EE,LinearSRGBColorSpace:xo,LinearToneMapping:nF,Loader:ls,LoaderUtils:Pl,LoadingManager:H$,LoopOnce:dF,LoopPingPong:pF,LoopRepeat:fF,LuminanceAlphaFormat:lF,LuminanceFormat:aF,MOUSE:Uf,Material:ir,MaterialLoader:j$,MathUtils:lp,Matrix3:Nn,Matrix4:pn,MaxEquation:cx,Mesh:Bn,MeshBasicMaterial:oi,MeshDepthMaterial:M$,MeshDistanceMaterial:I$,MeshLambertMaterial:nU,MeshMatcapMaterial:iU,MeshNormalMaterial:tU,MeshPhongMaterial:QF,MeshPhysicalMaterial:kr,MeshStandardMaterial:Np,MeshToonMaterial:eU,MinEquation:lx,MirroredRepeatWrapping:yp,MixOperation:eF,MultiplyBlending:ax,MultiplyOperation:vE,NearestFilter:er,NearestMipMapLinearFilter:Sz,NearestMipMapNearestFilter:yz,NearestMipmapLinearFilter:op,NearestMipmapNearestFilter:Wg,NeverCompare:TF,NeverDepth:jB,NeverStencilFunc:Iz,NoBlending:Cc,NoColorSpace:od,NoToneMapping:kl,NormalAnimationBlendMode:A$,NormalBlending:sp,NotEqualCompare:$F,NotEqualDepth:QB,NotEqualStencilFunc:Pz,NumberKeyframeTrack:dd,Object3D:Xn,ObjectLoader:nj,ObjectSpaceNormalMap:gF,OctahedronBufferGeometry:Qj,OctahedronGeometry:a_,OneFactor:FB,OneMinusDstAlphaFactor:VB,OneMinusDstColorFactor:WB,OneMinusSrcAlphaFactor:nM,OneMinusSrcColorFactor:GB,OrthographicCamera:sa,PCFShadowMap:S$,PCFSoftShadowMap:xv,PMREMGenerator:Px,Path:aE,PerspectiveCamera:Gi,Plane:yu,PlaneBufferGeometry:e9,PlaneGeometry:ja,PlaneHelper:Gj,PointLight:z$,PointLightHelper:Oj,Points:B$,PointsMaterial:CE,PolarGridHelper:Pj,PolyhedronBufferGeometry:t9,PolyhedronGeometry:Du,PositionalAudio:hj,PropertyBinding:Zn,PropertyMixer:_U,QuadraticBezierCurve:xM,QuadraticBezierCurve3:wM,Quaternion:Er,QuaternionKeyframeTrack:wc,QuaternionLinearInterpolant:lU,RED_GREEN_RGTC2_Format:Ox,RED_RGTC1_Format:hF,REVISION:Ip,RGBADepthPacking:pM,RGBAFormat:Yr,RGBAIntegerFormat:hM,RGBA_ASTC_10x10_Format:xx,RGBA_ASTC_10x5_Format:Ax,RGBA_ASTC_10x6_Format:Cx,RGBA_ASTC_10x8_Format:Rx,RGBA_ASTC_12x10_Format:wx,RGBA_ASTC_12x12_Format:Mx,RGBA_ASTC_4x4_Format:_x,RGBA_ASTC_5x4_Format:Tx,RGBA_ASTC_5x5_Format:vx,RGBA_ASTC_6x5_Format:Ex,RGBA_ASTC_6x6_Format:yx,RGBA_ASTC_8x5_Format:Sx,RGBA_ASTC_8x6_Format:$x,RGBA_ASTC_8x8_Format:bx,RGBA_BPTC_Format:pS,RGBA_ETC2_EAC_Format:gx,RGBA_PVRTC_2BPPV1_Format:px,RGBA_PVRTC_4BPPV1_Format:fx,RGBA_S3TC_DXT1_Format:hS,RGBA_S3TC_DXT3_Format:dS,RGBA_S3TC_DXT5_Format:fS,RGB_ETC1_Format:uF,RGB_ETC2_Format:mx,RGB_PVRTC_2BPPV1_Format:dx,RGB_PVRTC_4BPPV1_Format:hx,RGB_S3TC_DXT1_Format:uS,RGFormat:cF,RGIntegerFormat:uM,RawShaderMaterial:qF,Ray:Op,Raycaster:ho,RectAreaLight:fU,RedFormat:lM,RedIntegerFormat:cM,ReinhardToneMapping:iF,RepeatWrapping:Bl,ReplaceStencilOp:Az,ReverseSubtractEquation:DB,RingBufferGeometry:n9,RingGeometry:IE,SIGNED_RED_GREEN_RGTC2_Format:Lx,SIGNED_RED_RGTC1_Format:Ix,SRGBColorSpace:vn,Scene:Yg,ShaderChunk:Ln,ShaderLib:Ol,ShaderMaterial:wo,ShadowMaterial:ZF,Shape:hp,ShapeBufferGeometry:i9,ShapeGeometry:OE,ShapePath:yU,ShapeUtils:xc,ShortType:sM,Skeleton:i_,SkeletonHelper:Ij,SkinnedMesh:k$,Source:Zf,Sphere:Ws,SphereBufferGeometry:r9,SphereGeometry:l_,Spherical:Vx,SphericalHarmonics3:pU,SplineCurve:MM,SpotLight:V$,SpotLightHelper:Mj,Sprite:UF,SpriteMaterial:bM,SrcAlphaFactor:tM,SrcAlphaSaturateFactor:XB,SrcColorFactor:UB,StaticCopyUsage:Vz,StaticDrawUsage:iE,StaticReadUsage:Uz,StereoCamera:aj,StreamCopyUsage:Wz,StreamDrawUsage:Fz,StreamReadUsage:Hz,StringKeyframeTrack:Dp,SubtractEquation:PB,SubtractiveBlending:ox,TOUCH:Gf,TangentSpaceNormalMap:Td,TetrahedronBufferGeometry:s9,TetrahedronGeometry:LE,Texture:ni,TextureLoader:BM,TorusBufferGeometry:o9,TorusGeometry:NE,TorusKnotBufferGeometry:a9,TorusKnotGeometry:kE,Triangle:$o,TriangleFanDrawMode:bp,TriangleStripDrawMode:yE,TrianglesDrawMode:fM,TubeBufferGeometry:l9,TubeGeometry:PE,TwoPassDoubleSide:Ez,UVMapping:cd,Uint16BufferAttribute:vM,Uint32BufferAttribute:EM,Uint8BufferAttribute:x4,Uint8ClampedBufferAttribute:w4,Uniform:WM,UniformsGroup:Cj,UniformsLib:Lt,UniformsUtils:oE,UnsignedByteType:ia,UnsignedInt248Type:rd,UnsignedIntType:Sc,UnsignedShort4444Type:oM,UnsignedShort5551Type:aM,UnsignedShortType:$$,VSMShadowMap:wl,Vector2:mt,Vector3:ie,Vector4:Hn,VectorKeyframeTrack:fd,VideoTexture:pX,WebGL1Renderer:BF,WebGL3DRenderTarget:g4,WebGLArrayRenderTarget:m4,WebGLCoordinateSystem:$c,WebGLCubeRenderTarget:yM,WebGLMultipleRenderTargets:_4,WebGLRenderTarget:lo,WebGLRenderer:O$,WebGLUtils:PF,WebGPUCoordinateSystem:rE,WireframeGeometry:OM,WrapAroundEnding:nE,ZeroCurvatureEnding:Kf,ZeroFactor:BB,ZeroSlopeEnding:Jf,ZeroStencilOp:bz,_SRGBAFormat:XS,sRGBEncoding:Rc},Symbol.toStringTag,{value:"Module"}));var SU={exports:{}},Bp={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Bp.ConcurrentRoot=1;Bp.ContinuousEventPriority=4;Bp.DefaultEventPriority=16;Bp.DiscreteEventPriority=1;Bp.IdleEventPriority=536870912;Bp.LegacyRoot=0;SU.exports=Bp;var Cg=SU.exports;function u9(i){let e;const n=new Set,r=(h,f)=>{const p=typeof h=="function"?h(e):h;if(p!==e){const m=e;e=f?p:Object.assign({},e,p),n.forEach(v=>v(e,m))}},s=()=>e,a=(h,f=s,p=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=f(e);function v(){const y=f(e);if(!p(m,y)){const $=m;h(m=y,$)}}return n.add(v),()=>n.delete(v)},d={setState:r,getState:s,subscribe:(h,f,p)=>f||p?a(h,f,p):(n.add(h),()=>n.delete(h)),destroy:()=>n.clear()};return e=i(r,s,d),d}const h9=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ik=h9?q.useEffect:q.useLayoutEffect;function $U(i){const e=typeof i=="function"?u9(i):i,n=(r=e.getState,s=Object.is)=>{const[,a]=q.useReducer(E=>E+1,0),l=e.getState(),u=q.useRef(l),d=q.useRef(r),h=q.useRef(s),f=q.useRef(!1),p=q.useRef();p.current===void 0&&(p.current=r(l));let m,v=!1;(u.current!==l||d.current!==r||h.current!==s||f.current)&&(m=r(l),v=!s(p.current,m)),ik(()=>{v&&(p.current=m),u.current=l,d.current=r,h.current=s,f.current=!1});const y=q.useRef(l);ik(()=>{const E=()=>{try{const A=e.getState(),C=d.current(A);h.current(p.current,C)||(u.current=A,p.current=C,a())}catch{f.current=!0,a()}},S=e.subscribe(E);return e.getState()!==y.current&&E(),S},[]);const $=v?m:p.current;return q.useDebugValue($),$};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,e];return{next(){const s=r.length<=0;return{value:r.shift(),done:s}}}},n}var bU={exports:{}},kC={exports:{}},PC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rk;function d9(){return rk||(rk=1,function(i){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var se=K-1>>>1,Y=G[se];if(0<s(Y,Z))G[se]=Z,G[K]=Y,K=se;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var se=0,Y=G.length,me=Y>>>1;se<me;){var fe=2*(se+1)-1,Ae=G[fe],Ce=fe+1,Ie=G[Ce];if(0>s(Ae,K))Ce<Y&&0>s(Ie,Ae)?(G[se]=Ie,G[Ce]=K,se=Ce):(G[se]=Ae,G[fe]=K,se=fe);else if(Ce<Y&&0>s(Ie,K))G[se]=Ie,G[Ce]=K,se=Ce;else break e}}return Z}function s(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],h=[],f=1,p=null,m=3,v=!1,y=!1,$=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(G){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=G)r(h),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=n(h)}}function x(G){if($=!1,C(G),!y)if(n(d)!==null)y=!0,ue(I);else{var Z=n(h);Z!==null&&Re(x,Z.startTime-G)}}function I(G,Z){y=!1,$&&($=!1,S(k),k=-1),v=!0;var K=m;try{for(C(Z),p=n(d);p!==null&&(!(p.expirationTime>Z)||G&&!ce());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var Y=se(p.expirationTime<=Z);Z=i.unstable_now(),typeof Y=="function"?p.callback=Y:p===n(d)&&r(d),C(Z)}else r(d);p=n(d)}if(p!==null)var me=!0;else{var fe=n(h);fe!==null&&Re(x,fe.startTime-Z),me=!1}return me}finally{p=null,m=K,v=!1}}var O=!1,F=null,k=-1,D=5,U=-1;function ce(){return!(i.unstable_now()-U<D)}function re(){if(F!==null){var G=i.unstable_now();U=G;var Z=!0;try{Z=F(!0,G)}finally{Z?ae():(O=!1,F=null)}}else O=!1}var ae;if(typeof A=="function")ae=function(){A(re)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,de=ne.port2;ne.port1.onmessage=re,ae=function(){de.postMessage(null)}}else ae=function(){E(re,0)};function ue(G){F=G,O||(O=!0,ae())}function Re(G,Z){k=E(function(){G(i.unstable_now())},Z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_continueExecution=function(){y||v||(y=!0,ue(I))},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return n(d)},i.unstable_next=function(G){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var K=m;m=Z;try{return G()}finally{m=K}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=m;m=G;try{return Z()}finally{m=K}},i.unstable_scheduleCallback=function(G,Z,K){var se=i.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?se+K:se):K=se,G){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=K+Y,G={id:f++,callback:Z,priorityLevel:G,startTime:K,expirationTime:Y,sortIndex:-1},K>se?(G.sortIndex=K,e(h,G),n(d)===null&&G===n(h)&&($?(S(k),k=-1):$=!0,Re(x,K-se))):(G.sortIndex=Y,e(d,G),y||v||(y=!0,ue(I))),G},i.unstable_shouldYield=ce,i.unstable_wrapCallback=function(G){var Z=m;return function(){var K=m;m=Z;try{return G.apply(this,arguments)}finally{m=K}}}}(PC)),PC}var sk;function f9(){return sk||(sk=1,kC.exports=d9()),kC.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p9=function(e){var n={},r=q,s=f9(),a=Object.assign;function l(_){for(var T="https://reactjs.org/docs/error-decoder.html?invariant="+_,R=1;R<arguments.length;R++)T+="&args[]="+encodeURIComponent(arguments[R]);return"Minified React error #"+_+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),h=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),x=Symbol.for("react.offscreen"),I=Symbol.iterator;function O(_){return _===null||typeof _!="object"?null:(_=I&&_[I]||_["@@iterator"],typeof _=="function"?_:null)}function F(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case f:return"Fragment";case h:return"Portal";case m:return"Profiler";case p:return"StrictMode";case E:return"Suspense";case S:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case y:return(_.displayName||"Context")+".Consumer";case v:return(_._context.displayName||"Context")+".Provider";case $:var T=_.render;return _=_.displayName,_||(_=T.displayName||T.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case A:return T=_.displayName||null,T!==null?T:F(_.type)||"Memo";case C:T=_._payload,_=_._init;try{return F(_(T))}catch{}}return null}function k(_){var T=_.type;switch(_.tag){case 24:return"Cache";case 9:return(T.displayName||"Context")+".Consumer";case 10:return(T._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=T.render,_=_.displayName||_.name||"",T.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return T;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(T);case 8:return T===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T}return null}function D(_){var T=_,R=_;if(_.alternate)for(;T.return;)T=T.return;else{_=T;do T=_,T.flags&4098&&(R=T.return),_=T.return;while(_)}return T.tag===3?R:null}function U(_){if(D(_)!==_)throw Error(l(188))}function ce(_){var T=_.alternate;if(!T){if(T=D(_),T===null)throw Error(l(188));return T!==_?null:_}for(var R=_,w=T;;){var P=R.return;if(P===null)break;var H=P.alternate;if(H===null){if(w=P.return,w!==null){R=w;continue}break}if(P.child===H.child){for(H=P.child;H;){if(H===R)return U(P),_;if(H===w)return U(P),T;H=H.sibling}throw Error(l(188))}if(R.return!==w.return)R=P,w=H;else{for(var Se=!1,De=P.child;De;){if(De===R){Se=!0,R=P,w=H;break}if(De===w){Se=!0,w=P,R=H;break}De=De.sibling}if(!Se){for(De=H.child;De;){if(De===R){Se=!0,R=H,w=P;break}if(De===w){Se=!0,w=H,R=P;break}De=De.sibling}if(!Se)throw Error(l(189))}}if(R.alternate!==w)throw Error(l(190))}if(R.tag!==3)throw Error(l(188));return R.stateNode.current===R?_:T}function re(_){return _=ce(_),_!==null?ae(_):null}function ae(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var T=ae(_);if(T!==null)return T;_=_.sibling}return null}function ne(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){if(_.tag!==4){var T=ne(_);if(T!==null)return T}_=_.sibling}return null}var de=Array.isArray,ue=e.getPublicInstance,Re=e.getRootHostContext,G=e.getChildHostContext,Z=e.prepareForCommit,K=e.resetAfterCommit,se=e.createInstance,Y=e.appendInitialChild,me=e.finalizeInitialChildren,fe=e.prepareUpdate,Ae=e.shouldSetTextContent,Ce=e.createTextInstance,Ie=e.scheduleTimeout,We=e.cancelTimeout,ut=e.noTimeout,Ye=e.isPrimaryRenderer,we=e.supportsMutation,Q=e.supportsPersistence,Ge=e.supportsHydration,Oe=e.getInstanceFromNode,Ve=e.preparePortalMount,Fe=e.getCurrentEventPriority,tt=e.detachDeletedInstance,Ue=e.supportsMicrotasks,Je=e.scheduleMicrotask,ve=e.supportsTestSelectors,Me=e.findFiberRoot,vt=e.getBoundingRect,oe=e.getTextContent,ee=e.isHiddenSubtree,W=e.matchAccessibilityRole,ot=e.setFocusIfFocusable,je=e.setupIntersectionObserver,Qe=e.appendChild,ht=e.appendChildToContainer,ft=e.commitTextUpdate,He=e.commitMount,St=e.commitUpdate,L=e.insertBefore,X=e.insertInContainerBefore,he=e.removeChild,z=e.removeChildFromContainer,be=e.resetTextContent,nt=e.hideInstance,Ee=e.hideTextInstance,Le=e.unhideInstance,Be=e.unhideTextInstance,N=e.clearContainer,j=e.cloneInstance,ge=e.createContainerChildSet,xe=e.appendChildToContainerChildSet,Ke=e.finalizeContainerChildren,gt=e.replaceContainerChildren,$t=e.cloneHiddenInstance,un=e.cloneHiddenTextInstance,an=e.canHydrateInstance,ei=e.canHydrateTextInstance,fi=e.canHydrateSuspenseInstance,Ki=e.isSuspenseInstancePending,Ci=e.isSuspenseInstanceFallback,_i=e.registerSuspenseInstanceRetry,Ti=e.getNextHydratableSibling,nn=e.getFirstHydratableChild,pi=e.getFirstHydratableChildWithinContainer,yr=e.getFirstHydratableChildWithinSuspenseInstance,J=e.hydrateInstance,B=e.hydrateTextInstance,le=e.hydrateSuspenseInstance,_e=e.getNextHydratableInstanceAfterSuspenseInstance,pe=e.commitHydratedContainer,ye=e.commitHydratedSuspenseInstance,Ze=e.clearSuspenseBoundary,qe=e.clearSuspenseBoundaryFromContainer,at=e.shouldDeleteUnhydratedTailInstances,rt=e.didNotMatchHydratedContainerTextInstance,pt=e.didNotMatchHydratedTextInstance,ke;function It(_){if(ke===void 0)try{throw Error()}catch(R){var T=R.stack.trim().match(/\n( *(at )?)/);ke=T&&T[1]||""}return`
`+ke+_}var Ct=!1;function wt(_,T){if(!_||Ct)return"";Ct=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(T)if(T=function(){throw Error()},Object.defineProperty(T.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(T,[])}catch(Rt){var w=Rt}Reflect.construct(_,[],T)}else{try{T.call()}catch(Rt){w=Rt}_.call(T.prototype)}else{try{throw Error()}catch(Rt){w=Rt}_()}}catch(Rt){if(Rt&&w&&typeof Rt.stack=="string"){for(var P=Rt.stack.split(`
`),H=w.stack.split(`
`),Se=P.length-1,De=H.length-1;1<=Se&&0<=De&&P[Se]!==H[De];)De--;for(;1<=Se&&0<=De;Se--,De--)if(P[Se]!==H[De]){if(Se!==1||De!==1)do if(Se--,De--,0>De||P[Se]!==H[De]){var dt=`
`+P[Se].replace(" at new "," at ");return _.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",_.displayName)),dt}while(1<=Se&&0<=De);break}}}finally{Ct=!1,Error.prepareStackTrace=R}return(_=_?_.displayName||_.name:"")?It(_):""}var Ht=Object.prototype.hasOwnProperty,Zt=[],jt=-1;function Ot(_){return{current:_}}function qt(_){0>jt||(_.current=Zt[jt],Zt[jt]=null,jt--)}function Ft(_,T){jt++,Zt[jt]=_.current,_.current=T}var ln={},Fn=Ot(ln),sn=Ot(!1),$n=ln;function tn(_,T){var R=_.type.contextTypes;if(!R)return ln;var w=_.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===T)return w.__reactInternalMemoizedMaskedChildContext;var P={},H;for(H in R)P[H]=T[H];return w&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=T,_.__reactInternalMemoizedMaskedChildContext=P),P}function Un(_){return _=_.childContextTypes,_!=null}function Rn(){qt(sn),qt(Fn)}function hn(_,T,R){if(Fn.current!==ln)throw Error(l(168));Ft(Fn,T),Ft(sn,R)}function zn(_,T,R){var w=_.stateNode;if(T=T.childContextTypes,typeof w.getChildContext!="function")return R;w=w.getChildContext();for(var P in w)if(!(P in T))throw Error(l(108,k(_)||"Unknown",P));return a({},R,w)}function In(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||ln,$n=Fn.current,Ft(Fn,_),Ft(sn,sn.current),!0}function Kt(_,T,R){var w=_.stateNode;if(!w)throw Error(l(169));R?(_=zn(_,T,$n),w.__reactInternalMemoizedMergedChildContext=_,qt(sn),qt(Fn),Ft(Fn,_)):qt(sn),Ft(sn,R)}var An=Math.clz32?Math.clz32:mn,Sr=Math.log,Ri=Math.LN2;function mn(_){return _>>>=0,_===0?32:31-(Sr(_)/Ri|0)|0}var cs=64,Xs=4194304;function Cs(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function hi(_,T){var R=_.pendingLanes;if(R===0)return 0;var w=0,P=_.suspendedLanes,H=_.pingedLanes,Se=R&268435455;if(Se!==0){var De=Se&~P;De!==0?w=Cs(De):(H&=Se,H!==0&&(w=Cs(H)))}else Se=R&~P,Se!==0?w=Cs(Se):H!==0&&(w=Cs(H));if(w===0)return 0;if(T!==0&&T!==w&&!(T&P)&&(P=w&-w,H=T&-T,P>=H||P===16&&(H&4194240)!==0))return T;if(w&4&&(w|=R&16),T=_.entangledLanes,T!==0)for(_=_.entanglements,T&=w;0<T;)R=31-An(T),P=1<<R,w|=_[R],T&=~P;return w}function Rs(_,T){switch(_){case 1:case 2:case 4:return T+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dn(_,T){for(var R=_.suspendedLanes,w=_.pingedLanes,P=_.expirationTimes,H=_.pendingLanes;0<H;){var Se=31-An(H),De=1<<Se,dt=P[Se];dt===-1?(!(De&R)||De&w)&&(P[Se]=Rs(De,T)):dt<=T&&(_.expiredLanes|=De),H&=~De}}function Pr(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function jn(_){for(var T=[],R=0;31>R;R++)T.push(_);return T}function ts(_,T,R){_.pendingLanes|=T,T!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,T=31-An(T),_[T]=R}function Dr(_,T){var R=_.pendingLanes&~T;_.pendingLanes=T,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=T,_.mutableReadLanes&=T,_.entangledLanes&=T,T=_.entanglements;var w=_.eventTimes;for(_=_.expirationTimes;0<R;){var P=31-An(R),H=1<<P;T[P]=0,w[P]=-1,_[P]=-1,R&=~H}}function ti(_,T){var R=_.entangledLanes|=T;for(_=_.entanglements;R;){var w=31-An(R),P=1<<w;P&T|_[w]&T&&(_[w]|=T),R&=~P}}var rn=0;function vi(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var us=s.unstable_scheduleCallback,zi=s.unstable_cancelCallback,Gl=s.unstable_shouldYield,Br=s.unstable_requestPaint,ai=s.unstable_now,xs=s.unstable_ImmediatePriority,Qa=s.unstable_UserBlockingPriority,mr=s.unstable_NormalPriority,el=s.unstable_IdlePriority,xi=null,Ii=null;function fo(_){if(Ii&&typeof Ii.onCommitFiberRoot=="function")try{Ii.onCommitFiberRoot(xi,_,void 0,(_.current.flags&128)===128)}catch{}}function Hl(_,T){return _===T&&(_!==0||1/_===1/T)||_!==_&&T!==T}var $r=typeof Object.is=="function"?Object.is:Hl,sr=null,js=!1,gr=!1;function da(_){sr===null?sr=[_]:sr.push(_)}function Vl(_){js=!0,da(_)}function Fr(){if(!gr&&sr!==null){gr=!0;var _=0,T=rn;try{var R=sr;for(rn=1;_<R.length;_++){var w=R[_];do w=w(!0);while(w!==null)}sr=null,js=!1}catch(P){throw sr!==null&&(sr=sr.slice(_+1)),us(xs,Fr),P}finally{rn=T,gr=!1}}return null}var Oo=u.ReactCurrentBatchConfig;function po(_,T){if($r(_,T))return!0;if(typeof _!="object"||_===null||typeof T!="object"||T===null)return!1;var R=Object.keys(_),w=Object.keys(T);if(R.length!==w.length)return!1;for(w=0;w<R.length;w++){var P=R[w];if(!Ht.call(T,P)||!$r(_[P],T[P]))return!1}return!0}function Ys(_){switch(_.tag){case 5:return It(_.type);case 16:return It("Lazy");case 13:return It("Suspense");case 19:return It("SuspenseList");case 0:case 2:case 15:return _=wt(_.type,!1),_;case 11:return _=wt(_.type.render,!1),_;case 1:return _=wt(_.type,!0),_;default:return""}}function Oi(_,T){if(_&&_.defaultProps){T=a({},T),_=_.defaultProps;for(var R in _)T[R]===void 0&&(T[R]=_[R]);return T}return T}var Te=Ot(null),Ne=null,lt=null,Et=null;function _n(){Et=lt=Ne=null}function fn(_,T,R){Ye?(Ft(Te,T._currentValue),T._currentValue=R):(Ft(Te,T._currentValue2),T._currentValue2=R)}function Qt(_){var T=Te.current;qt(Te),Ye?_._currentValue=T:_._currentValue2=T}function yn(_,T,R){for(;_!==null;){var w=_.alternate;if((_.childLanes&T)!==T?(_.childLanes|=T,w!==null&&(w.childLanes|=T)):w!==null&&(w.childLanes&T)!==T&&(w.childLanes|=T),_===R)break;_=_.return}}function li(_,T){Ne=_,Et=lt=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&T&&(fs=!0),_.firstContext=null)}function ci(_){var T=Ye?_._currentValue:_._currentValue2;if(Et!==_)if(_={context:_,memoizedValue:T,next:null},lt===null){if(Ne===null)throw Error(l(308));lt=_,Ne.dependencies={lanes:0,firstContext:_}}else lt=lt.next=_;return T}var br=null,hs=!1;function Ic(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fp(_,T){_=_.updateQueue,T.updateQueue===_&&(T.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function Lo(_,T){return{eventTime:_,lane:T,tag:0,payload:null,callback:null,next:null}}function fa(_,T){var R=_.updateQueue;R!==null&&(R=R.shared,Zi!==null&&_.mode&1&&!(xn&2)?(_=R.interleaved,_===null?(T.next=T,br===null?br=[R]:br.push(R)):(T.next=_.next,_.next=T),R.interleaved=T):(_=R.pending,_===null?T.next=T:(T.next=_.next,_.next=T),R.pending=T))}function Bu(_,T,R){if(T=T.updateQueue,T!==null&&(T=T.shared,(R&4194240)!==0)){var w=T.lanes;w&=_.pendingLanes,R|=w,T.lanes=R,ti(_,R)}}function Up(_,T){var R=_.updateQueue,w=_.alternate;if(w!==null&&(w=w.updateQueue,R===w)){var P=null,H=null;if(R=R.firstBaseUpdate,R!==null){do{var Se={eventTime:R.eventTime,lane:R.lane,tag:R.tag,payload:R.payload,callback:R.callback,next:null};H===null?P=H=Se:H=H.next=Se,R=R.next}while(R!==null);H===null?P=H=T:H=H.next=T}else P=H=T;R={baseState:w.baseState,firstBaseUpdate:P,lastBaseUpdate:H,shared:w.shared,effects:w.effects},_.updateQueue=R;return}_=R.lastBaseUpdate,_===null?R.firstBaseUpdate=T:_.next=T,R.lastBaseUpdate=T}function yd(_,T,R,w){var P=_.updateQueue;hs=!1;var H=P.firstBaseUpdate,Se=P.lastBaseUpdate,De=P.shared.pending;if(De!==null){P.shared.pending=null;var dt=De,Rt=dt.next;dt.next=null,Se===null?H=Rt:Se.next=Rt,Se=dt;var Gt=_.alternate;Gt!==null&&(Gt=Gt.updateQueue,De=Gt.lastBaseUpdate,De!==Se&&(De===null?Gt.firstBaseUpdate=Rt:De.next=Rt,Gt.lastBaseUpdate=dt))}if(H!==null){var En=P.baseState;Se=0,Gt=Rt=dt=null,De=H;do{var cn=De.lane,gi=De.eventTime;if((w&cn)===cn){Gt!==null&&(Gt=Gt.next={eventTime:gi,lane:0,tag:De.tag,payload:De.payload,callback:De.callback,next:null});e:{var Jt=_,Xi=De;switch(cn=T,gi=R,Xi.tag){case 1:if(Jt=Xi.payload,typeof Jt=="function"){En=Jt.call(gi,En,cn);break e}En=Jt;break e;case 3:Jt.flags=Jt.flags&-65537|128;case 0:if(Jt=Xi.payload,cn=typeof Jt=="function"?Jt.call(gi,En,cn):Jt,cn==null)break e;En=a({},En,cn);break e;case 2:hs=!0}}De.callback!==null&&De.lane!==0&&(_.flags|=64,cn=P.effects,cn===null?P.effects=[De]:cn.push(De))}else gi={eventTime:gi,lane:cn,tag:De.tag,payload:De.payload,callback:De.callback,next:null},Gt===null?(Rt=Gt=gi,dt=En):Gt=Gt.next=gi,Se|=cn;if(De=De.next,De===null){if(De=P.shared.pending,De===null)break;cn=De,De=cn.next,cn.next=null,P.lastBaseUpdate=cn,P.shared.pending=null}}while(1);if(Gt===null&&(dt=En),P.baseState=dt,P.firstBaseUpdate=Rt,P.lastBaseUpdate=Gt,T=P.shared.interleaved,T!==null){P=T;do Se|=P.lane,P=P.next;while(P!==T)}else H===null&&(P.shared.lanes=0);ic|=Se,_.lanes=Se,_.memoizedState=En}}function Fu(_,T,R){if(_=T.effects,T.effects=null,_!==null)for(T=0;T<_.length;T++){var w=_[T],P=w.callback;if(P!==null){if(w.callback=null,w=R,typeof P!="function")throw Error(l(191,P));P.call(w)}}}var Gp=new r.Component().refs;function Uu(_,T,R,w){T=_.memoizedState,R=R(w,T),R=R==null?T:a({},T,R),_.memoizedState=R,_.lanes===0&&(_.updateQueue.baseState=R)}var Oc={isMounted:function(_){return(_=_._reactInternals)?D(_)===_:!1},enqueueSetState:function(_,T,R){_=_._reactInternals;var w=Hr(),P=Ea(_),H=Lo(w,P);H.payload=T,R!=null&&(H.callback=R),fa(_,H),T=Os(_,P,w),T!==null&&Bu(T,_,P)},enqueueReplaceState:function(_,T,R){_=_._reactInternals;var w=Hr(),P=Ea(_),H=Lo(w,P);H.tag=1,H.payload=T,R!=null&&(H.callback=R),fa(_,H),T=Os(_,P,w),T!==null&&Bu(T,_,P)},enqueueForceUpdate:function(_,T){_=_._reactInternals;var R=Hr(),w=Ea(_),P=Lo(R,w);P.tag=2,T!=null&&(P.callback=T),fa(_,P),T=Os(_,w,R),T!==null&&Bu(T,_,w)}};function No(_,T,R,w,P,H,Se){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(w,H,Se):T.prototype&&T.prototype.isPureReactComponent?!po(R,w)||!po(P,H):!0}function Hp(_,T,R){var w=!1,P=ln,H=T.contextType;return typeof H=="object"&&H!==null?H=ci(H):(P=Un(T)?$n:Fn.current,w=T.contextTypes,H=(w=w!=null)?tn(_,P):ln),T=new T(R,H),_.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Oc,_.stateNode=T,T._reactInternals=_,w&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=P,_.__reactInternalMemoizedMaskedChildContext=H),T}function Vp(_,T,R,w){_=T.state,typeof T.componentWillReceiveProps=="function"&&T.componentWillReceiveProps(R,w),typeof T.UNSAFE_componentWillReceiveProps=="function"&&T.UNSAFE_componentWillReceiveProps(R,w),T.state!==_&&Oc.enqueueReplaceState(T,T.state,null)}function Lc(_,T,R,w){var P=_.stateNode;P.props=R,P.state=_.memoizedState,P.refs=Gp,Ic(_);var H=T.contextType;typeof H=="object"&&H!==null?P.context=ci(H):(H=Un(T)?$n:Fn.current,P.context=tn(_,H)),P.state=_.memoizedState,H=T.getDerivedStateFromProps,typeof H=="function"&&(Uu(_,T,H,R),P.state=_.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(T=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),T!==P.state&&Oc.enqueueReplaceState(P,P.state,null),yd(_,R,P,w),P.state=_.memoizedState),typeof P.componentDidMount=="function"&&(_.flags|=4194308)}var zl=[],Wl=0,Sd=null,Nc=0,ws=[],Ks=0,Xl=null,pa=1,ma="";function jl(_,T){zl[Wl++]=Nc,zl[Wl++]=Sd,Sd=_,Nc=T}function kc(_,T,R){ws[Ks++]=pa,ws[Ks++]=ma,ws[Ks++]=Xl,Xl=_;var w=pa;_=ma;var P=32-An(w)-1;w&=~(1<<P),R+=1;var H=32-An(T)+P;if(30<H){var Se=P-P%5;H=(w&(1<<Se)-1).toString(32),w>>=Se,P-=Se,pa=1<<32-An(T)+P|R<<P|w,ma=H+_}else pa=1<<H|R<<P|w,ma=_}function $d(_){_.return!==null&&(jl(_,1),kc(_,1,0))}function bd(_){for(;_===Sd;)Sd=zl[--Wl],zl[Wl]=null,Nc=zl[--Wl],zl[Wl]=null;for(;_===Xl;)Xl=ws[--Ks],ws[Ks]=null,ma=ws[--Ks],ws[Ks]=null,pa=ws[--Ks],ws[Ks]=null}var Ar=null,ns=null,Li=!1,Gu=!1,Js=null;function zp(_,T){var R=lr(5,null,null,0);R.elementType="DELETED",R.stateNode=T,R.return=_,T=_.deletions,T===null?(_.deletions=[R],_.flags|=16):T.push(R)}function ga(_,T){switch(_.tag){case 5:return T=an(T,_.type,_.pendingProps),T!==null?(_.stateNode=T,Ar=_,ns=nn(T),!0):!1;case 6:return T=ei(T,_.pendingProps),T!==null?(_.stateNode=T,Ar=_,ns=null,!0):!1;case 13:if(T=fi(T),T!==null){var R=Xl!==null?{id:pa,overflow:ma}:null;return _.memoizedState={dehydrated:T,treeContext:R,retryLane:1073741824},R=lr(18,null,null,0),R.stateNode=T,R.return=_,_.child=R,Ar=_,ns=null,!0}return!1;default:return!1}}function Ad(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Cd(_){if(Li){var T=ns;if(T){var R=T;if(!ga(_,T)){if(Ad(_))throw Error(l(418));T=Ti(R);var w=Ar;T&&ga(_,T)?zp(w,R):(_.flags=_.flags&-4097|2,Li=!1,Ar=_)}}else{if(Ad(_))throw Error(l(418));_.flags=_.flags&-4097|2,Li=!1,Ar=_}}}function h_(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;Ar=_}function Hu(_){if(!Ge||_!==Ar)return!1;if(!Li)return h_(_),Li=!0,!1;if(_.tag!==3&&(_.tag!==5||at(_.type)&&!Ae(_.type,_.memoizedProps))){var T=ns;if(T){if(Ad(_)){for(_=ns;_;)_=Ti(_);throw Error(l(418))}for(;T;)zp(_,T),T=Ti(T)}}if(h_(_),_.tag===13){if(!Ge)throw Error(l(316));if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(l(317));ns=_e(_)}else ns=Ar?Ti(_.stateNode):null;return!0}function Pc(){Ge&&(ns=Ar=null,Gu=Li=!1)}function Wp(_){Js===null?Js=[_]:Js.push(_)}function Dc(_,T,R){if(_=R.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(R._owner){if(R=R._owner,R){if(R.tag!==1)throw Error(l(309));var w=R.stateNode}if(!w)throw Error(l(147,_));var P=w,H=""+_;return T!==null&&T.ref!==null&&typeof T.ref=="function"&&T.ref._stringRef===H?T.ref:(T=function(Se){var De=P.refs;De===Gp&&(De=P.refs={}),Se===null?delete De[H]:De[H]=Se},T._stringRef=H,T)}if(typeof _!="string")throw Error(l(284));if(!R._owner)throw Error(l(290,_))}return _}function Rd(_,T){throw _=Object.prototype.toString.call(T),Error(l(31,_==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":_))}function Xp(_){var T=_._init;return T(_._payload)}function d_(_){function T(et,ze){if(_){var ct=et.deletions;ct===null?(et.deletions=[ze],et.flags|=16):ct.push(ze)}}function R(et,ze){if(!_)return null;for(;ze!==null;)T(et,ze),ze=ze.sibling;return null}function w(et,ze){for(et=new Map;ze!==null;)ze.key!==null?et.set(ze.key,ze):et.set(ze.index,ze),ze=ze.sibling;return et}function P(et,ze){return et=Qs(et,ze),et.index=0,et.sibling=null,et}function H(et,ze,ct){return et.index=ct,_?(ct=et.alternate,ct!==null?(ct=ct.index,ct<ze?(et.flags|=2,ze):ct):(et.flags|=2,ze)):(et.flags|=1048576,ze)}function Se(et){return _&&et.alternate===null&&(et.flags|=2),et}function De(et,ze,ct,Pt){return ze===null||ze.tag!==6?(ze=zo(ct,et.mode,Pt),ze.return=et,ze):(ze=P(ze,ct),ze.return=et,ze)}function dt(et,ze,ct,Pt){var en=ct.type;return en===f?Gt(et,ze,ct.props.children,Pt,ct.key):ze!==null&&(ze.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===C&&Xp(en)===ze.type)?(Pt=P(ze,ct.props),Pt.ref=Dc(et,ze,ct),Pt.return=et,Pt):(Pt=fl(ct.type,ct.key,ct.props,null,et.mode,Pt),Pt.ref=Dc(et,ze,ct),Pt.return=et,Pt)}function Rt(et,ze,ct,Pt){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==ct.containerInfo||ze.stateNode.implementation!==ct.implementation?(ze=ac(ct,et.mode,Pt),ze.return=et,ze):(ze=P(ze,ct.children||[]),ze.return=et,ze)}function Gt(et,ze,ct,Pt,en){return ze===null||ze.tag!==7?(ze=To(ct,et.mode,Pt,en),ze.return=et,ze):(ze=P(ze,ct),ze.return=et,ze)}function En(et,ze,ct){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=zo(""+ze,et.mode,ct),ze.return=et,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case d:return ct=fl(ze.type,ze.key,ze.props,null,et.mode,ct),ct.ref=Dc(et,null,ze),ct.return=et,ct;case h:return ze=ac(ze,et.mode,ct),ze.return=et,ze;case C:var Pt=ze._init;return En(et,Pt(ze._payload),ct)}if(de(ze)||O(ze))return ze=To(ze,et.mode,ct,null),ze.return=et,ze;Rd(et,ze)}return null}function cn(et,ze,ct,Pt){var en=ze!==null?ze.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number")return en!==null?null:De(et,ze,""+ct,Pt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case d:return ct.key===en?dt(et,ze,ct,Pt):null;case h:return ct.key===en?Rt(et,ze,ct,Pt):null;case C:return en=ct._init,cn(et,ze,en(ct._payload),Pt)}if(de(ct)||O(ct))return en!==null?null:Gt(et,ze,ct,Pt,null);Rd(et,ct)}return null}function gi(et,ze,ct,Pt,en){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return et=et.get(ct)||null,De(ze,et,""+Pt,en);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case d:return et=et.get(Pt.key===null?ct:Pt.key)||null,dt(ze,et,Pt,en);case h:return et=et.get(Pt.key===null?ct:Pt.key)||null,Rt(ze,et,Pt,en);case C:var Sn=Pt._init;return gi(et,ze,ct,Sn(Pt._payload),en)}if(de(Pt)||O(Pt))return et=et.get(ct)||null,Gt(ze,et,Pt,en,null);Rd(ze,Pt)}return null}function Jt(et,ze,ct,Pt){for(var en=null,Sn=null,Tn=ze,Wn=ze=0,_r=null;Tn!==null&&Wn<ct.length;Wn++){Tn.index>Wn?(_r=Tn,Tn=null):_r=Tn.sibling;var Yn=cn(et,Tn,ct[Wn],Pt);if(Yn===null){Tn===null&&(Tn=_r);break}_&&Tn&&Yn.alternate===null&&T(et,Tn),ze=H(Yn,ze,Wn),Sn===null?en=Yn:Sn.sibling=Yn,Sn=Yn,Tn=_r}if(Wn===ct.length)return R(et,Tn),Li&&jl(et,Wn),en;if(Tn===null){for(;Wn<ct.length;Wn++)Tn=En(et,ct[Wn],Pt),Tn!==null&&(ze=H(Tn,ze,Wn),Sn===null?en=Tn:Sn.sibling=Tn,Sn=Tn);return Li&&jl(et,Wn),en}for(Tn=w(et,Tn);Wn<ct.length;Wn++)_r=gi(Tn,et,Wn,ct[Wn],Pt),_r!==null&&(_&&_r.alternate!==null&&Tn.delete(_r.key===null?Wn:_r.key),ze=H(_r,ze,Wn),Sn===null?en=_r:Sn.sibling=_r,Sn=_r);return _&&Tn.forEach(function(pl){return T(et,pl)}),Li&&jl(et,Wn),en}function Xi(et,ze,ct,Pt){var en=O(ct);if(typeof en!="function")throw Error(l(150));if(ct=en.call(ct),ct==null)throw Error(l(151));for(var Sn=en=null,Tn=ze,Wn=ze=0,_r=null,Yn=ct.next();Tn!==null&&!Yn.done;Wn++,Yn=ct.next()){Tn.index>Wn?(_r=Tn,Tn=null):_r=Tn.sibling;var pl=cn(et,Tn,Yn.value,Pt);if(pl===null){Tn===null&&(Tn=_r);break}_&&Tn&&pl.alternate===null&&T(et,Tn),ze=H(pl,ze,Wn),Sn===null?en=pl:Sn.sibling=pl,Sn=pl,Tn=_r}if(Yn.done)return R(et,Tn),Li&&jl(et,Wn),en;if(Tn===null){for(;!Yn.done;Wn++,Yn=ct.next())Yn=En(et,Yn.value,Pt),Yn!==null&&(ze=H(Yn,ze,Wn),Sn===null?en=Yn:Sn.sibling=Yn,Sn=Yn);return Li&&jl(et,Wn),en}for(Tn=w(et,Tn);!Yn.done;Wn++,Yn=ct.next())Yn=gi(Tn,et,Wn,Yn.value,Pt),Yn!==null&&(_&&Yn.alternate!==null&&Tn.delete(Yn.key===null?Wn:Yn.key),ze=H(Yn,ze,Wn),Sn===null?en=Yn:Sn.sibling=Yn,Sn=Yn);return _&&Tn.forEach(function(q$){return T(et,q$)}),Li&&jl(et,Wn),en}function gs(et,ze,ct,Pt){if(typeof ct=="object"&&ct!==null&&ct.type===f&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case d:e:{for(var en=ct.key,Sn=ze;Sn!==null;){if(Sn.key===en){if(en=ct.type,en===f){if(Sn.tag===7){R(et,Sn.sibling),ze=P(Sn,ct.props.children),ze.return=et,et=ze;break e}}else if(Sn.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===C&&Xp(en)===Sn.type){R(et,Sn.sibling),ze=P(Sn,ct.props),ze.ref=Dc(et,Sn,ct),ze.return=et,et=ze;break e}R(et,Sn);break}else T(et,Sn);Sn=Sn.sibling}ct.type===f?(ze=To(ct.props.children,et.mode,Pt,ct.key),ze.return=et,et=ze):(Pt=fl(ct.type,ct.key,ct.props,null,et.mode,Pt),Pt.ref=Dc(et,ze,ct),Pt.return=et,et=Pt)}return Se(et);case h:e:{for(Sn=ct.key;ze!==null;){if(ze.key===Sn)if(ze.tag===4&&ze.stateNode.containerInfo===ct.containerInfo&&ze.stateNode.implementation===ct.implementation){R(et,ze.sibling),ze=P(ze,ct.children||[]),ze.return=et,et=ze;break e}else{R(et,ze);break}else T(et,ze);ze=ze.sibling}ze=ac(ct,et.mode,Pt),ze.return=et,et=ze}return Se(et);case C:return Sn=ct._init,gs(et,ze,Sn(ct._payload),Pt)}if(de(ct))return Jt(et,ze,ct,Pt);if(O(ct))return Xi(et,ze,ct,Pt);Rd(et,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"?(ct=""+ct,ze!==null&&ze.tag===6?(R(et,ze.sibling),ze=P(ze,ct),ze.return=et,et=ze):(R(et,ze),ze=zo(ct,et.mode,Pt),ze.return=et,et=ze),Se(et)):R(et,ze)}return gs}var mo=d_(!0),Vu=d_(!1),Yl={},ds=Ot(Yl),ko=Ot(Yl),Kl=Ot(Yl);function Zs(_){if(_===Yl)throw Error(l(174));return _}function xd(_,T){Ft(Kl,T),Ft(ko,_),Ft(ds,Yl),_=Re(T),qt(ds),Ft(ds,_)}function Ei(){qt(ds),qt(ko),qt(Kl)}function f_(_){var T=Zs(Kl.current),R=Zs(ds.current);T=G(R,_.type,T),R!==T&&(Ft(ko,_),Ft(ds,T))}function Jl(_){ko.current===_&&(qt(ds),qt(ko))}var mi=Ot(0);function wd(_){for(var T=_;T!==null;){if(T.tag===13){var R=T.memoizedState;if(R!==null&&(R=R.dehydrated,R===null||Ki(R)||Ci(R)))return T}else if(T.tag===19&&T.memoizedProps.revealOrder!==void 0){if(T.flags&128)return T}else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===_)break;for(;T.sibling===null;){if(T.return===null||T.return===_)return null;T=T.return}T.sibling.return=T.return,T=T.sibling}return null}var Md=[];function zu(){for(var _=0;_<Md.length;_++){var T=Md[_];Ye?T._workInProgressVersionPrimary=null:T._workInProgressVersionSecondary=null}Md.length=0}var tl=u.ReactCurrentDispatcher,Ms=u.ReactCurrentBatchConfig,go=0,wi=null,Cr=null,or=null,Id=!1,Wu=!1,Xu=0,p_=0;function Ur(){throw Error(l(321))}function Od(_,T){if(T===null)return!1;for(var R=0;R<T.length&&R<_.length;R++)if(!$r(_[R],T[R]))return!1;return!0}function Bc(_,T,R,w,P,H){if(go=H,wi=T,T.memoizedState=null,T.updateQueue=null,T.lanes=0,tl.current=_===null||_.memoizedState===null?Qp:C_,_=R(w,P),Wu){H=0;do{if(Wu=!1,Xu=0,25<=H)throw Error(l(301));H+=1,or=Cr=null,T.updateQueue=null,tl.current=R_,_=R(w,P)}while(Wu)}if(tl.current=Zu,T=Cr!==null&&Cr.next!==null,go=0,or=Cr=wi=null,Id=!1,T)throw Error(l(300));return _}function jp(){var _=Xu!==0;return Xu=0,_}function _a(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?wi.memoizedState=or=_:or=or.next=_,or}function Po(){if(Cr===null){var _=wi.alternate;_=_!==null?_.memoizedState:null}else _=Cr.next;var T=or===null?wi.memoizedState:or.next;if(T!==null)or=T,Cr=_;else{if(_===null)throw Error(l(310));Cr=_,_={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},or===null?wi.memoizedState=or=_:or=or.next=_}return or}function Zl(_,T){return typeof T=="function"?T(_):T}function ql(_){var T=Po(),R=T.queue;if(R===null)throw Error(l(311));R.lastRenderedReducer=_;var w=Cr,P=w.baseQueue,H=R.pending;if(H!==null){if(P!==null){var Se=P.next;P.next=H.next,H.next=Se}w.baseQueue=P=H,R.pending=null}if(P!==null){H=P.next,w=w.baseState;var De=Se=null,dt=null,Rt=H;do{var Gt=Rt.lane;if((go&Gt)===Gt)dt!==null&&(dt=dt.next={lane:0,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null}),w=Rt.hasEagerState?Rt.eagerState:_(w,Rt.action);else{var En={lane:Gt,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null};dt===null?(De=dt=En,Se=w):dt=dt.next=En,wi.lanes|=Gt,ic|=Gt}Rt=Rt.next}while(Rt!==null&&Rt!==H);dt===null?Se=w:dt.next=De,$r(w,T.memoizedState)||(fs=!0),T.memoizedState=w,T.baseState=Se,T.baseQueue=dt,R.lastRenderedState=w}if(_=R.interleaved,_!==null){P=_;do H=P.lane,wi.lanes|=H,ic|=H,P=P.next;while(P!==_)}else P===null&&(R.lanes=0);return[T.memoizedState,R.dispatch]}function ju(_){var T=Po(),R=T.queue;if(R===null)throw Error(l(311));R.lastRenderedReducer=_;var w=R.dispatch,P=R.pending,H=T.memoizedState;if(P!==null){R.pending=null;var Se=P=P.next;do H=_(H,Se.action),Se=Se.next;while(Se!==P);$r(H,T.memoizedState)||(fs=!0),T.memoizedState=H,T.baseQueue===null&&(T.baseState=H),R.lastRenderedState=H}return[H,w]}function m_(){}function Yu(_,T){var R=wi,w=Po(),P=T(),H=!$r(w.memoizedState,P);if(H&&(w.memoizedState=P,fs=!0),w=w.queue,Ju(g_.bind(null,R,w,_),[_]),w.getSnapshot!==T||H||or!==null&&or.memoizedState.tag&1){if(R.flags|=2048,Fc(9,Ku.bind(null,R,w,P,T),void 0,null),Zi===null)throw Error(l(349));go&30||Yp(R,T,P)}return P}function Yp(_,T,R){_.flags|=16384,_={getSnapshot:T,value:R},T=wi.updateQueue,T===null?(T={lastEffect:null,stores:null},wi.updateQueue=T,T.stores=[_]):(R=T.stores,R===null?T.stores=[_]:R.push(_))}function Ku(_,T,R,w){T.value=R,T.getSnapshot=w,__(T)&&Os(_,1,-1)}function g_(_,T,R){return R(function(){__(T)&&Os(_,1,-1)})}function __(_){var T=_.getSnapshot;_=_.value;try{var R=T();return!$r(_,R)}catch{return!0}}function Ta(_){var T=_a();return typeof _=="function"&&(_=_()),T.memoizedState=T.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zl,lastRenderedState:_},T.queue=_,_=_.dispatch=Zp.bind(null,wi,_),[T.memoizedState,_]}function Fc(_,T,R,w){return _={tag:_,create:T,destroy:R,deps:w,next:null},T=wi.updateQueue,T===null?(T={lastEffect:null,stores:null},wi.updateQueue=T,T.lastEffect=_.next=_):(R=T.lastEffect,R===null?T.lastEffect=_.next=_:(w=R.next,R.next=_,_.next=w,T.lastEffect=_)),_}function Do(){return Po().memoizedState}function Ld(_,T,R,w){var P=_a();wi.flags|=_,P.memoizedState=Fc(1|T,R,void 0,w===void 0?null:w)}function Nd(_,T,R,w){var P=Po();w=w===void 0?null:w;var H=void 0;if(Cr!==null){var Se=Cr.memoizedState;if(H=Se.destroy,w!==null&&Od(w,Se.deps)){P.memoizedState=Fc(T,R,H,w);return}}wi.flags|=_,P.memoizedState=Fc(1|T,R,H,w)}function kd(_,T){return Ld(8390656,8,_,T)}function Ju(_,T){return Nd(2048,8,_,T)}function Ql(_,T){return Nd(4,2,_,T)}function Kp(_,T){return Nd(4,4,_,T)}function T_(_,T){if(typeof T=="function")return _=_(),T(_),function(){T(null)};if(T!=null)return _=_(),T.current=_,function(){T.current=null}}function v_(_,T,R){return R=R!=null?R.concat([_]):null,Nd(4,4,T_.bind(null,T,_),R)}function Jp(){}function E_(_,T){var R=Po();T=T===void 0?null:T;var w=R.memoizedState;return w!==null&&T!==null&&Od(T,w[1])?w[0]:(R.memoizedState=[_,T],_)}function y_(_,T){var R=Po();T=T===void 0?null:T;var w=R.memoizedState;return w!==null&&T!==null&&Od(T,w[1])?w[0]:(_=_(),R.memoizedState=[_,T],_)}function S_(_,T){var R=rn;rn=R!==0&&4>R?R:4,_(!0);var w=Ms.transition;Ms.transition={};try{_(!1),T()}finally{rn=R,Ms.transition=w}}function $_(){return Po().memoizedState}function GE(_,T,R){var w=Ea(_);R={lane:w,action:R,hasEagerState:!1,eagerState:null,next:null},b_(_)?A_(T,R):(qp(_,T,R),R=Hr(),_=Os(_,w,R),_!==null&&Pd(_,T,w))}function Zp(_,T,R){var w=Ea(_),P={lane:w,action:R,hasEagerState:!1,eagerState:null,next:null};if(b_(_))A_(T,P);else{qp(_,T,P);var H=_.alternate;if(_.lanes===0&&(H===null||H.lanes===0)&&(H=T.lastRenderedReducer,H!==null))try{var Se=T.lastRenderedState,De=H(Se,R);if(P.hasEagerState=!0,P.eagerState=De,$r(De,Se))return}catch{}finally{}R=Hr(),_=Os(_,w,R),_!==null&&Pd(_,T,w)}}function b_(_){var T=_.alternate;return _===wi||T!==null&&T===wi}function A_(_,T){Wu=Id=!0;var R=_.pending;R===null?T.next=T:(T.next=R.next,R.next=T),_.pending=T}function qp(_,T,R){Zi!==null&&_.mode&1&&!(xn&2)?(_=T.interleaved,_===null?(R.next=R,br===null?br=[T]:br.push(T)):(R.next=_.next,_.next=R),T.interleaved=R):(_=T.pending,_===null?R.next=R:(R.next=_.next,_.next=R),T.pending=R)}function Pd(_,T,R){if(R&4194240){var w=T.lanes;w&=_.pendingLanes,R|=w,T.lanes=R,ti(_,R)}}var Zu={readContext:ci,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},Qp={readContext:ci,useCallback:function(_,T){return _a().memoizedState=[_,T===void 0?null:T],_},useContext:ci,useEffect:kd,useImperativeHandle:function(_,T,R){return R=R!=null?R.concat([_]):null,Ld(4194308,4,T_.bind(null,T,_),R)},useLayoutEffect:function(_,T){return Ld(4194308,4,_,T)},useInsertionEffect:function(_,T){return Ld(4,2,_,T)},useMemo:function(_,T){var R=_a();return T=T===void 0?null:T,_=_(),R.memoizedState=[_,T],_},useReducer:function(_,T,R){var w=_a();return T=R!==void 0?R(T):T,w.memoizedState=w.baseState=T,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:T},w.queue=_,_=_.dispatch=GE.bind(null,wi,_),[w.memoizedState,_]},useRef:function(_){var T=_a();return _={current:_},T.memoizedState=_},useState:Ta,useDebugValue:Jp,useDeferredValue:function(_){var T=Ta(_),R=T[0],w=T[1];return kd(function(){var P=Ms.transition;Ms.transition={};try{w(_)}finally{Ms.transition=P}},[_]),R},useTransition:function(){var _=Ta(!1),T=_[0];return _=S_.bind(null,_[1]),_a().memoizedState=_,[T,_]},useMutableSource:function(){},useSyncExternalStore:function(_,T,R){var w=wi,P=_a();if(Li){if(R===void 0)throw Error(l(407));R=R()}else{if(R=T(),Zi===null)throw Error(l(349));go&30||Yp(w,T,R)}P.memoizedState=R;var H={value:R,getSnapshot:T};return P.queue=H,kd(g_.bind(null,w,H,_),[_]),w.flags|=2048,Fc(9,Ku.bind(null,w,H,R,T),void 0,null),R},useId:function(){var _=_a(),T=Zi.identifierPrefix;if(Li){var R=ma,w=pa;R=(w&~(1<<32-An(w)-1)).toString(32)+R,T=":"+T+"R"+R,R=Xu++,0<R&&(T+="H"+R.toString(32)),T+=":"}else R=p_++,T=":"+T+"r"+R.toString(32)+":";return _.memoizedState=T},unstable_isNewReconciler:!1},C_={readContext:ci,useCallback:E_,useContext:ci,useEffect:Ju,useImperativeHandle:v_,useInsertionEffect:Ql,useLayoutEffect:Kp,useMemo:y_,useReducer:ql,useRef:Do,useState:function(){return ql(Zl)},useDebugValue:Jp,useDeferredValue:function(_){var T=ql(Zl),R=T[0],w=T[1];return Ju(function(){var P=Ms.transition;Ms.transition={};try{w(_)}finally{Ms.transition=P}},[_]),R},useTransition:function(){var _=ql(Zl)[0],T=Po().memoizedState;return[_,T]},useMutableSource:m_,useSyncExternalStore:Yu,useId:$_,unstable_isNewReconciler:!1},R_={readContext:ci,useCallback:E_,useContext:ci,useEffect:Ju,useImperativeHandle:v_,useInsertionEffect:Ql,useLayoutEffect:Kp,useMemo:y_,useReducer:ju,useRef:Do,useState:function(){return ju(Zl)},useDebugValue:Jp,useDeferredValue:function(_){var T=ju(Zl),R=T[0],w=T[1];return Ju(function(){var P=Ms.transition;Ms.transition={};try{w(_)}finally{Ms.transition=P}},[_]),R},useTransition:function(){var _=ju(Zl)[0],T=Po().memoizedState;return[_,T]},useMutableSource:m_,useSyncExternalStore:Yu,useId:$_,unstable_isNewReconciler:!1};function ec(_,T){try{var R="",w=T;do R+=Ys(w),w=w.return;while(w);var P=R}catch(H){P=`
Error generating stack: `+H.message+`
`+H.stack}return{value:_,source:T,stack:P}}function nl(_,T){try{console.error(T.value)}catch(R){setTimeout(function(){throw R})}}var il=typeof WeakMap=="function"?WeakMap:Map;function rl(_,T,R){R=Lo(-1,R),R.tag=3,R.payload={element:null};var w=T.value;return R.callback=function(){rc||(rc=!0,tf=w),nl(_,T)},R}function Dd(_,T,R){R=Lo(-1,R),R.tag=3;var w=_.type.getDerivedStateFromError;if(typeof w=="function"){var P=T.value;R.payload=function(){return w(P)},R.callback=function(){nl(_,T)}}var H=_.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(R.callback=function(){nl(_,T),typeof w!="function"&&(cl===null?cl=new Set([this]):cl.add(this));var Se=T.stack;this.componentDidCatch(T.value,{componentStack:Se!==null?Se:""})}),R}function Bo(_,T,R){var w=_.pingCache;if(w===null){w=_.pingCache=new il;var P=new Set;w.set(T,P)}else P=w.get(T),P===void 0&&(P=new Set,w.set(T,P));P.has(R)||(P.add(R),_=Kc.bind(null,_,T,R),T.then(_,_))}function x_(_){do{var T;if((T=_.tag===13)&&(T=_.memoizedState,T=T!==null?T.dehydrated!==null:!0),T)return _;_=_.return}while(_!==null);return null}function w_(_,T,R,w,P){return _.mode&1?(_.flags|=65536,_.lanes=P,_):(_===T?_.flags|=65536:(_.flags|=128,R.flags|=131072,R.flags&=-52805,R.tag===1&&(R.alternate===null?R.tag=17:(T=Lo(-1,1),T.tag=2,fa(R,T))),R.lanes|=1),_)}function Fo(_){_.flags|=4}function M_(_,T){if(_!==null&&_.child===T.child)return!0;if(T.flags&16)return!1;for(_=T.child;_!==null;){if(_.flags&12854||_.subtreeFlags&12854)return!1;_=_.sibling}return!0}var Uc,qu,Qu,Gc;if(we)Uc=function(_,T){for(var R=T.child;R!==null;){if(R.tag===5||R.tag===6)Y(_,R.stateNode);else if(R.tag!==4&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===T)break;for(;R.sibling===null;){if(R.return===null||R.return===T)return;R=R.return}R.sibling.return=R.return,R=R.sibling}},qu=function(){},Qu=function(_,T,R,w,P){if(_=_.memoizedProps,_!==w){var H=T.stateNode,Se=Zs(ds.current);R=fe(H,R,_,w,P,Se),(T.updateQueue=R)&&Fo(T)}},Gc=function(_,T,R,w){R!==w&&Fo(T)};else if(Q){Uc=function(_,T,R,w){for(var P=T.child;P!==null;){if(P.tag===5){var H=P.stateNode;R&&w&&(H=$t(H,P.type,P.memoizedProps,P)),Y(_,H)}else if(P.tag===6)H=P.stateNode,R&&w&&(H=un(H,P.memoizedProps,P)),Y(_,H);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)H=P.child,H!==null&&(H.return=P),Uc(_,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===T)break;for(;P.sibling===null;){if(P.return===null||P.return===T)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};var I_=function(_,T,R,w){for(var P=T.child;P!==null;){if(P.tag===5){var H=P.stateNode;R&&w&&(H=$t(H,P.type,P.memoizedProps,P)),xe(_,H)}else if(P.tag===6)H=P.stateNode,R&&w&&(H=un(H,P.memoizedProps,P)),xe(_,H);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)H=P.child,H!==null&&(H.return=P),I_(_,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===T)break;for(;P.sibling===null;){if(P.return===null||P.return===T)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};qu=function(_,T){var R=T.stateNode;if(!M_(_,T)){_=R.containerInfo;var w=ge(_);I_(w,T,!1,!1),R.pendingChildren=w,Fo(T),Ke(_,w)}},Qu=function(_,T,R,w,P){var H=_.stateNode,Se=_.memoizedProps;if((_=M_(_,T))&&Se===w)T.stateNode=H;else{var De=T.stateNode,dt=Zs(ds.current),Rt=null;Se!==w&&(Rt=fe(De,R,Se,w,P,dt)),_&&Rt===null?T.stateNode=H:(H=j(H,Rt,R,Se,w,T,_,De),me(H,R,w,P,dt)&&Fo(T),T.stateNode=H,_?Fo(T):Uc(H,T,!1,!1))}},Gc=function(_,T,R,w){R!==w?(_=Zs(Kl.current),R=Zs(ds.current),T.stateNode=Ce(w,_,R,T),Fo(T)):T.stateNode=_.stateNode}}else qu=function(){},Qu=function(){},Gc=function(){};function eh(_,T){if(!Li)switch(_.tailMode){case"hidden":T=_.tail;for(var R=null;T!==null;)T.alternate!==null&&(R=T),T=T.sibling;R===null?_.tail=null:R.sibling=null;break;case"collapsed":R=_.tail;for(var w=null;R!==null;)R.alternate!==null&&(w=R),R=R.sibling;w===null?T||_.tail===null?_.tail=null:_.tail.sibling=null:w.sibling=null}}function Gr(_){var T=_.alternate!==null&&_.alternate.child===_.child,R=0,w=0;if(T)for(var P=_.child;P!==null;)R|=P.lanes|P.childLanes,w|=P.subtreeFlags&14680064,w|=P.flags&14680064,P.return=_,P=P.sibling;else for(P=_.child;P!==null;)R|=P.lanes|P.childLanes,w|=P.subtreeFlags,w|=P.flags,P.return=_,P=P.sibling;return _.subtreeFlags|=w,_.childLanes=R,T}function O_(_,T,R){var w=T.pendingProps;switch(bd(T),T.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(T),null;case 1:return Un(T.type)&&Rn(),Gr(T),null;case 3:return w=T.stateNode,Ei(),qt(sn),qt(Fn),zu(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(_===null||_.child===null)&&(Hu(T)?Fo(T):_===null||_.memoizedState.isDehydrated&&!(T.flags&256)||(T.flags|=1024,Js!==null&&(cm(Js),Js=null))),qu(_,T),Gr(T),null;case 5:Jl(T),R=Zs(Kl.current);var P=T.type;if(_!==null&&T.stateNode!=null)Qu(_,T,P,w,R),_.ref!==T.ref&&(T.flags|=512,T.flags|=2097152);else{if(!w){if(T.stateNode===null)throw Error(l(166));return Gr(T),null}if(_=Zs(ds.current),Hu(T)){if(!Ge)throw Error(l(175));_=J(T.stateNode,T.type,T.memoizedProps,R,_,T,!Gu),T.updateQueue=_,_!==null&&Fo(T)}else{var H=se(P,w,R,_,T);Uc(H,T,!1,!1),T.stateNode=H,me(H,P,w,R,_)&&Fo(T)}T.ref!==null&&(T.flags|=512,T.flags|=2097152)}return Gr(T),null;case 6:if(_&&T.stateNode!=null)Gc(_,T,_.memoizedProps,w);else{if(typeof w!="string"&&T.stateNode===null)throw Error(l(166));if(_=Zs(Kl.current),R=Zs(ds.current),Hu(T)){if(!Ge)throw Error(l(176));if(_=T.stateNode,w=T.memoizedProps,(R=B(_,w,T,!Gu))&&(P=Ar,P!==null))switch(H=(P.mode&1)!==0,P.tag){case 3:rt(P.stateNode.containerInfo,_,w,H);break;case 5:pt(P.type,P.memoizedProps,P.stateNode,_,w,H)}R&&Fo(T)}else T.stateNode=Ce(w,_,R,T)}return Gr(T),null;case 13:if(qt(mi),w=T.memoizedState,Li&&ns!==null&&T.mode&1&&!(T.flags&128)){for(_=ns;_;)_=Ti(_);return Pc(),T.flags|=98560,T}if(w!==null&&w.dehydrated!==null){if(w=Hu(T),_===null){if(!w)throw Error(l(318));if(!Ge)throw Error(l(344));if(_=T.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(l(317));le(_,T)}else Pc(),!(T.flags&128)&&(T.memoizedState=null),T.flags|=4;return Gr(T),null}return Js!==null&&(cm(Js),Js=null),T.flags&128?(T.lanes=R,T):(w=w!==null,R=!1,_===null?Hu(T):R=_.memoizedState!==null,w&&!R&&(T.child.flags|=8192,T.mode&1&&(_===null||mi.current&1?ar===0&&(ar=3):_o())),T.updateQueue!==null&&(T.flags|=4),Gr(T),null);case 4:return Ei(),qu(_,T),_===null&&Ve(T.stateNode.containerInfo),Gr(T),null;case 10:return Qt(T.type._context),Gr(T),null;case 17:return Un(T.type)&&Rn(),Gr(T),null;case 19:if(qt(mi),P=T.memoizedState,P===null)return Gr(T),null;if(w=(T.flags&128)!==0,H=P.rendering,H===null)if(w)eh(P,!1);else{if(ar!==0||_!==null&&_.flags&128)for(_=T.child;_!==null;){if(H=wd(_),H!==null){for(T.flags|=128,eh(P,!1),_=H.updateQueue,_!==null&&(T.updateQueue=_,T.flags|=4),T.subtreeFlags=0,_=R,w=T.child;w!==null;)R=w,P=_,R.flags&=14680066,H=R.alternate,H===null?(R.childLanes=0,R.lanes=P,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=H.childLanes,R.lanes=H.lanes,R.child=H.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=H.memoizedProps,R.memoizedState=H.memoizedState,R.updateQueue=H.updateQueue,R.type=H.type,P=H.dependencies,R.dependencies=P===null?null:{lanes:P.lanes,firstContext:P.firstContext}),w=w.sibling;return Ft(mi,mi.current&1|2),T.child}_=_.sibling}P.tail!==null&&ai()>ef&&(T.flags|=128,w=!0,eh(P,!1),T.lanes=4194304)}else{if(!w)if(_=wd(H),_!==null){if(T.flags|=128,w=!0,_=_.updateQueue,_!==null&&(T.updateQueue=_,T.flags|=4),eh(P,!0),P.tail===null&&P.tailMode==="hidden"&&!H.alternate&&!Li)return Gr(T),null}else 2*ai()-P.renderingStartTime>ef&&R!==1073741824&&(T.flags|=128,w=!0,eh(P,!1),T.lanes=4194304);P.isBackwards?(H.sibling=T.child,T.child=H):(_=P.last,_!==null?_.sibling=H:T.child=H,P.last=H)}return P.tail!==null?(T=P.tail,P.rendering=T,P.tail=T.sibling,P.renderingStartTime=ai(),T.sibling=null,_=mi.current,Ft(mi,w?_&1|2:_&1),T):(Gr(T),null);case 22:case 23:return Tt(),w=T.memoizedState!==null,_!==null&&_.memoizedState!==null!==w&&(T.flags|=8192),w&&T.mode&1?Is&1073741824&&(Gr(T),we&&T.subtreeFlags&6&&(T.flags|=8192)):Gr(T),null;case 24:return null;case 25:return null}throw Error(l(156,T.tag))}var em=u.ReactCurrentOwner,fs=!1;function Rr(_,T,R,w){T.child=_===null?Vu(T,null,R,w):mo(T,_.child,R,w)}function L_(_,T,R,w,P){R=R.render;var H=T.ref;return li(T,P),w=Bc(_,T,R,w,H,P),R=jp(),_!==null&&!fs?(T.updateQueue=_.updateQueue,T.flags&=-2053,_.lanes&=~P,Go(_,T,P)):(Li&&R&&$d(T),T.flags|=1,Rr(_,T,w,P),T.child)}function N_(_,T,R,w,P){if(_===null){var H=R.type;return typeof H=="function"&&!oc(H)&&H.defaultProps===void 0&&R.compare===null&&R.defaultProps===void 0?(T.tag=15,T.type=H,k_(_,T,H,w,P)):(_=fl(R.type,null,w,T,T.mode,P),_.ref=T.ref,_.return=T,T.child=_)}if(H=_.child,!(_.lanes&P)){var Se=H.memoizedProps;if(R=R.compare,R=R!==null?R:po,R(Se,w)&&_.ref===T.ref)return Go(_,T,P)}return T.flags|=1,_=Qs(H,w),_.ref=T.ref,_.return=T,T.child=_}function k_(_,T,R,w,P){if(_!==null&&po(_.memoizedProps,w)&&_.ref===T.ref)if(fs=!1,(_.lanes&P)!==0)_.flags&131072&&(fs=!0);else return T.lanes=_.lanes,Go(_,T,P);return Wt(_,T,R,w,P)}function P_(_,T,R){var w=T.pendingProps,P=w.children,H=_!==null?_.memoizedState:null;if(w.mode==="hidden")if(!(T.mode&1))T.memoizedState={baseLanes:0,cachePool:null},Ft(zc,Is),Is|=R;else if(R&1073741824)T.memoizedState={baseLanes:0,cachePool:null},w=H!==null?H.baseLanes:R,Ft(zc,Is),Is|=w;else return _=H!==null?H.baseLanes|R:R,T.lanes=T.childLanes=1073741824,T.memoizedState={baseLanes:_,cachePool:null},T.updateQueue=null,Ft(zc,Is),Is|=_,null;else H!==null?(w=H.baseLanes|R,T.memoizedState=null):w=R,Ft(zc,Is),Is|=w;return Rr(_,T,P,R),T.child}function sl(_,T){var R=T.ref;(_===null&&R!==null||_!==null&&_.ref!==R)&&(T.flags|=512,T.flags|=2097152)}function Wt(_,T,R,w,P){var H=Un(R)?$n:Fn.current;return H=tn(T,H),li(T,P),R=Bc(_,T,R,w,H,P),w=jp(),_!==null&&!fs?(T.updateQueue=_.updateQueue,T.flags&=-2053,_.lanes&=~P,Go(_,T,P)):(Li&&w&&$d(T),T.flags|=1,Rr(_,T,R,P),T.child)}function ps(_,T,R,w,P){if(Un(R)){var H=!0;In(T)}else H=!1;if(li(T,P),T.stateNode===null)_!==null&&(_.alternate=null,T.alternate=null,T.flags|=2),Hp(T,R,w),Lc(T,R,w,P),w=!0;else if(_===null){var Se=T.stateNode,De=T.memoizedProps;Se.props=De;var dt=Se.context,Rt=R.contextType;typeof Rt=="object"&&Rt!==null?Rt=ci(Rt):(Rt=Un(R)?$n:Fn.current,Rt=tn(T,Rt));var Gt=R.getDerivedStateFromProps,En=typeof Gt=="function"||typeof Se.getSnapshotBeforeUpdate=="function";En||typeof Se.UNSAFE_componentWillReceiveProps!="function"&&typeof Se.componentWillReceiveProps!="function"||(De!==w||dt!==Rt)&&Vp(T,Se,w,Rt),hs=!1;var cn=T.memoizedState;Se.state=cn,yd(T,w,Se,P),dt=T.memoizedState,De!==w||cn!==dt||sn.current||hs?(typeof Gt=="function"&&(Uu(T,R,Gt,w),dt=T.memoizedState),(De=hs||No(T,R,De,w,cn,dt,Rt))?(En||typeof Se.UNSAFE_componentWillMount!="function"&&typeof Se.componentWillMount!="function"||(typeof Se.componentWillMount=="function"&&Se.componentWillMount(),typeof Se.UNSAFE_componentWillMount=="function"&&Se.UNSAFE_componentWillMount()),typeof Se.componentDidMount=="function"&&(T.flags|=4194308)):(typeof Se.componentDidMount=="function"&&(T.flags|=4194308),T.memoizedProps=w,T.memoizedState=dt),Se.props=w,Se.state=dt,Se.context=Rt,w=De):(typeof Se.componentDidMount=="function"&&(T.flags|=4194308),w=!1)}else{Se=T.stateNode,Fp(_,T),De=T.memoizedProps,Rt=T.type===T.elementType?De:Oi(T.type,De),Se.props=Rt,En=T.pendingProps,cn=Se.context,dt=R.contextType,typeof dt=="object"&&dt!==null?dt=ci(dt):(dt=Un(R)?$n:Fn.current,dt=tn(T,dt));var gi=R.getDerivedStateFromProps;(Gt=typeof gi=="function"||typeof Se.getSnapshotBeforeUpdate=="function")||typeof Se.UNSAFE_componentWillReceiveProps!="function"&&typeof Se.componentWillReceiveProps!="function"||(De!==En||cn!==dt)&&Vp(T,Se,w,dt),hs=!1,cn=T.memoizedState,Se.state=cn,yd(T,w,Se,P);var Jt=T.memoizedState;De!==En||cn!==Jt||sn.current||hs?(typeof gi=="function"&&(Uu(T,R,gi,w),Jt=T.memoizedState),(Rt=hs||No(T,R,Rt,w,cn,Jt,dt)||!1)?(Gt||typeof Se.UNSAFE_componentWillUpdate!="function"&&typeof Se.componentWillUpdate!="function"||(typeof Se.componentWillUpdate=="function"&&Se.componentWillUpdate(w,Jt,dt),typeof Se.UNSAFE_componentWillUpdate=="function"&&Se.UNSAFE_componentWillUpdate(w,Jt,dt)),typeof Se.componentDidUpdate=="function"&&(T.flags|=4),typeof Se.getSnapshotBeforeUpdate=="function"&&(T.flags|=1024)):(typeof Se.componentDidUpdate!="function"||De===_.memoizedProps&&cn===_.memoizedState||(T.flags|=4),typeof Se.getSnapshotBeforeUpdate!="function"||De===_.memoizedProps&&cn===_.memoizedState||(T.flags|=1024),T.memoizedProps=w,T.memoizedState=Jt),Se.props=w,Se.state=Jt,Se.context=dt,w=Rt):(typeof Se.componentDidUpdate!="function"||De===_.memoizedProps&&cn===_.memoizedState||(T.flags|=4),typeof Se.getSnapshotBeforeUpdate!="function"||De===_.memoizedProps&&cn===_.memoizedState||(T.flags|=1024),w=!1)}return Ji(_,T,R,w,H,P)}function Ji(_,T,R,w,P,H){sl(_,T);var Se=(T.flags&128)!==0;if(!w&&!Se)return P&&Kt(T,R,!1),Go(_,T,H);w=T.stateNode,em.current=T;var De=Se&&typeof R.getDerivedStateFromError!="function"?null:w.render();return T.flags|=1,_!==null&&Se?(T.child=mo(T,_.child,null,H),T.child=mo(T,null,De,H)):Rr(_,T,De,H),T.memoizedState=w.state,P&&Kt(T,R,!0),T.child}function yi(_){var T=_.stateNode;T.pendingContext?hn(_,T.pendingContext,T.pendingContext!==T.context):T.context&&hn(_,T.context,!1),xd(_,T.containerInfo)}function Uo(_,T,R,w,P){return Pc(),Wp(P),T.flags|=256,Rr(_,T,R,w),T.child}var ol={dehydrated:null,treeContext:null,retryLane:0};function Nt(_){return{baseLanes:_,cachePool:null}}function Di(_,T,R){var w=T.pendingProps,P=mi.current,H=!1,Se=(T.flags&128)!==0,De;if((De=Se)||(De=_!==null&&_.memoizedState===null?!1:(P&2)!==0),De?(H=!0,T.flags&=-129):(_===null||_.memoizedState!==null)&&(P|=1),Ft(mi,P&1),_===null)return Cd(T),_=T.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(T.mode&1?Ci(_)?T.lanes=8:T.lanes=1073741824:T.lanes=1,null):(P=w.children,_=w.fallback,H?(w=T.mode,H=T.child,P={mode:"hidden",children:P},!(w&1)&&H!==null?(H.childLanes=0,H.pendingProps=P):H=Vo(P,w,0,null),_=To(_,w,R,null),H.return=T,_.return=T,H.sibling=_,T.child=H,T.child.memoizedState=Nt(R),T.memoizedState=ol,_):Bd(T,P));if(P=_.memoizedState,P!==null){if(De=P.dehydrated,De!==null){if(Se)return T.flags&256?(T.flags&=-257,th(_,T,R,Error(l(422)))):T.memoizedState!==null?(T.child=_.child,T.flags|=128,null):(H=w.fallback,P=T.mode,w=Vo({mode:"visible",children:w.children},P,0,null),H=To(H,P,R,null),H.flags|=2,w.return=T,H.return=T,w.sibling=H,T.child=w,T.mode&1&&mo(T,_.child,null,R),T.child.memoizedState=Nt(R),T.memoizedState=ol,H);if(!(T.mode&1))T=th(_,T,R,null);else if(Ci(De))T=th(_,T,R,Error(l(419)));else if(w=(R&_.childLanes)!==0,fs||w){if(w=Zi,w!==null){switch(R&-R){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}w=H&(w.suspendedLanes|R)?0:H,w!==0&&w!==P.retryLane&&(P.retryLane=w,Os(_,w,-1))}_o(),T=th(_,T,R,Error(l(421)))}else Ki(De)?(T.flags|=128,T.child=_.child,T=Jc.bind(null,_),_i(De,T),T=null):(R=P.treeContext,Ge&&(ns=yr(De),Ar=T,Li=!0,Js=null,Gu=!1,R!==null&&(ws[Ks++]=pa,ws[Ks++]=ma,ws[Ks++]=Xl,pa=R.id,ma=R.overflow,Xl=T)),T=Bd(T,T.pendingProps.children),T.flags|=4096);return T}return H?(w=Fd(_,T,w.children,w.fallback,R),H=T.child,P=_.child.memoizedState,H.memoizedState=P===null?Nt(R):{baseLanes:P.baseLanes|R,cachePool:null},H.childLanes=_.childLanes&~R,T.memoizedState=ol,w):(R=D_(_,T,w.children,R),T.memoizedState=null,R)}return H?(w=Fd(_,T,w.children,w.fallback,R),H=T.child,P=_.child.memoizedState,H.memoizedState=P===null?Nt(R):{baseLanes:P.baseLanes|R,cachePool:null},H.childLanes=_.childLanes&~R,T.memoizedState=ol,w):(R=D_(_,T,w.children,R),T.memoizedState=null,R)}function Bd(_,T){return T=Vo({mode:"visible",children:T},_.mode,0,null),T.return=_,_.child=T}function D_(_,T,R,w){var P=_.child;return _=P.sibling,R=Qs(P,{mode:"visible",children:R}),!(T.mode&1)&&(R.lanes=w),R.return=T,R.sibling=null,_!==null&&(w=T.deletions,w===null?(T.deletions=[_],T.flags|=16):w.push(_)),T.child=R}function Fd(_,T,R,w,P){var H=T.mode;_=_.child;var Se=_.sibling,De={mode:"hidden",children:R};return!(H&1)&&T.child!==_?(R=T.child,R.childLanes=0,R.pendingProps=De,T.deletions=null):(R=Qs(_,De),R.subtreeFlags=_.subtreeFlags&14680064),Se!==null?w=Qs(Se,w):(w=To(w,H,P,null),w.flags|=2),w.return=T,R.return=T,R.sibling=w,T.child=R,w}function th(_,T,R,w){return w!==null&&Wp(w),mo(T,_.child,null,R),_=Bd(T,T.pendingProps.children),_.flags|=2,T.memoizedState=null,_}function B_(_,T,R){_.lanes|=T;var w=_.alternate;w!==null&&(w.lanes|=T),yn(_.return,T,R)}function Ud(_,T,R,w,P){var H=_.memoizedState;H===null?_.memoizedState={isBackwards:T,rendering:null,renderingStartTime:0,last:w,tail:R,tailMode:P}:(H.isBackwards=T,H.rendering=null,H.renderingStartTime=0,H.last=w,H.tail=R,H.tailMode=P)}function Gd(_,T,R){var w=T.pendingProps,P=w.revealOrder,H=w.tail;if(Rr(_,T,w.children,R),w=mi.current,w&2)w=w&1|2,T.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=T.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&B_(_,R,T);else if(_.tag===19)B_(_,R,T);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===T)break e;for(;_.sibling===null;){if(_.return===null||_.return===T)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}w&=1}if(Ft(mi,w),!(T.mode&1))T.memoizedState=null;else switch(P){case"forwards":for(R=T.child,P=null;R!==null;)_=R.alternate,_!==null&&wd(_)===null&&(P=R),R=R.sibling;R=P,R===null?(P=T.child,T.child=null):(P=R.sibling,R.sibling=null),Ud(T,!1,P,R,H);break;case"backwards":for(R=null,P=T.child,T.child=null;P!==null;){if(_=P.alternate,_!==null&&wd(_)===null){T.child=P;break}_=P.sibling,P.sibling=R,R=P,P=_}Ud(T,!0,R,null,H);break;case"together":Ud(T,!1,null,null,void 0);break;default:T.memoizedState=null}return T.child}function Go(_,T,R){if(_!==null&&(T.dependencies=_.dependencies),ic|=T.lanes,!(R&T.childLanes))return null;if(_!==null&&T.child!==_.child)throw Error(l(153));if(T.child!==null){for(_=T.child,R=Qs(_,_.pendingProps),T.child=R,R.return=T;_.sibling!==null;)_=_.sibling,R=R.sibling=Qs(_,_.pendingProps),R.return=T;R.sibling=null}return T.child}function F_(_,T,R){switch(T.tag){case 3:yi(T),Pc();break;case 5:f_(T);break;case 1:Un(T.type)&&In(T);break;case 4:xd(T,T.stateNode.containerInfo);break;case 10:fn(T,T.type._context,T.memoizedProps.value);break;case 13:var w=T.memoizedState;if(w!==null)return w.dehydrated!==null?(Ft(mi,mi.current&1),T.flags|=128,null):R&T.child.childLanes?Di(_,T,R):(Ft(mi,mi.current&1),_=Go(_,T,R),_!==null?_.sibling:null);Ft(mi,mi.current&1);break;case 19:if(w=(R&T.childLanes)!==0,_.flags&128){if(w)return Gd(_,T,R);T.flags|=128}var P=T.memoizedState;if(P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Ft(mi,mi.current),w)break;return null;case 22:case 23:return T.lanes=0,P_(_,T,R)}return Go(_,T,R)}function HE(_,T){switch(bd(T),T.tag){case 1:return Un(T.type)&&Rn(),_=T.flags,_&65536?(T.flags=_&-65537|128,T):null;case 3:return Ei(),qt(sn),qt(Fn),zu(),_=T.flags,_&65536&&!(_&128)?(T.flags=_&-65537|128,T):null;case 5:return Jl(T),null;case 13:if(qt(mi),_=T.memoizedState,_!==null&&_.dehydrated!==null){if(T.alternate===null)throw Error(l(340));Pc()}return _=T.flags,_&65536?(T.flags=_&-65537|128,T):null;case 19:return qt(mi),null;case 4:return Ei(),null;case 10:return Qt(T.type._context),null;case 22:case 23:return Tt(),null;case 24:return null;default:return null}}var nh=!1,tc=!1,tm=typeof WeakSet=="function"?WeakSet:Set,kt=null;function Hd(_,T){var R=_.ref;if(R!==null)if(typeof R=="function")try{R(null)}catch(w){Vr(_,T,w)}else R.current=null}function nm(_,T,R){try{R()}catch(w){Vr(_,T,w)}}var U_=!1;function VE(_,T){for(Z(_.containerInfo),kt=T;kt!==null;)if(_=kt,T=_.child,(_.subtreeFlags&1028)!==0&&T!==null)T.return=_,kt=T;else for(;kt!==null;){_=kt;try{var R=_.alternate;if(_.flags&1024)switch(_.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var w=R.memoizedProps,P=R.memoizedState,H=_.stateNode,Se=H.getSnapshotBeforeUpdate(_.elementType===_.type?w:Oi(_.type,w),P);H.__reactInternalSnapshotBeforeUpdate=Se}break;case 3:we&&N(_.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(De){Vr(_,_.return,De)}if(T=_.sibling,T!==null){T.return=_.return,kt=T;break}kt=_.return}return R=U_,U_=!1,R}function al(_,T,R){var w=T.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var P=w=w.next;do{if((P.tag&_)===_){var H=P.destroy;P.destroy=void 0,H!==void 0&&nm(T,R,H)}P=P.next}while(P!==w)}}function ih(_,T){if(T=T.updateQueue,T=T!==null?T.lastEffect:null,T!==null){var R=T=T.next;do{if((R.tag&_)===_){var w=R.create;R.destroy=w()}R=R.next}while(R!==T)}}function Hc(_){var T=_.ref;if(T!==null){var R=_.stateNode;switch(_.tag){case 5:_=ue(R);break;default:_=R}typeof T=="function"?T(_):T.current=_}}function rh(_,T,R){if(Ii&&typeof Ii.onCommitFiberUnmount=="function")try{Ii.onCommitFiberUnmount(xi,T)}catch{}switch(T.tag){case 0:case 11:case 14:case 15:if(_=T.updateQueue,_!==null&&(_=_.lastEffect,_!==null)){var w=_=_.next;do{var P=w,H=P.destroy;P=P.tag,H!==void 0&&(P&2||P&4)&&nm(T,R,H),w=w.next}while(w!==_)}break;case 1:if(Hd(T,R),_=T.stateNode,typeof _.componentWillUnmount=="function")try{_.props=T.memoizedProps,_.state=T.memoizedState,_.componentWillUnmount()}catch(Se){Vr(T,R,Se)}break;case 5:Hd(T,R);break;case 4:we?H_(_,T,R):Q&&Q&&(T=T.stateNode.containerInfo,R=ge(T),gt(T,R))}}function G_(_,T,R){for(var w=T;;)if(rh(_,w,R),w.child===null||we&&w.tag===4){if(w===T)break;for(;w.sibling===null;){if(w.return===null||w.return===T)return;w=w.return}w.sibling.return=w.return,w=w.sibling}else w.child.return=w,w=w.child}function im(_){var T=_.alternate;T!==null&&(_.alternate=null,im(T)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(T=_.stateNode,T!==null&&tt(T)),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function rm(_){return _.tag===5||_.tag===3||_.tag===4}function sm(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||rm(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function om(_){if(we){e:{for(var T=_.return;T!==null;){if(rm(T))break e;T=T.return}throw Error(l(160))}var R=T;switch(R.tag){case 5:T=R.stateNode,R.flags&32&&(be(T),R.flags&=-33),R=sm(_),Vd(_,R,T);break;case 3:case 4:T=R.stateNode.containerInfo,R=sm(_),sh(_,R,T);break;default:throw Error(l(161))}}}function sh(_,T,R){var w=_.tag;if(w===5||w===6)_=_.stateNode,T?X(R,_,T):ht(R,_);else if(w!==4&&(_=_.child,_!==null))for(sh(_,T,R),_=_.sibling;_!==null;)sh(_,T,R),_=_.sibling}function Vd(_,T,R){var w=_.tag;if(w===5||w===6)_=_.stateNode,T?L(R,_,T):Qe(R,_);else if(w!==4&&(_=_.child,_!==null))for(Vd(_,T,R),_=_.sibling;_!==null;)Vd(_,T,R),_=_.sibling}function H_(_,T,R){for(var w=T,P=!1,H,Se;;){if(!P){P=w.return;e:for(;;){if(P===null)throw Error(l(160));switch(H=P.stateNode,P.tag){case 5:Se=!1;break e;case 3:H=H.containerInfo,Se=!0;break e;case 4:H=H.containerInfo,Se=!0;break e}P=P.return}P=!0}if(w.tag===5||w.tag===6)G_(_,w,R),Se?z(H,w.stateNode):he(H,w.stateNode);else if(w.tag===18)Se?qe(H,w.stateNode):Ze(H,w.stateNode);else if(w.tag===4){if(w.child!==null){H=w.stateNode.containerInfo,Se=!0,w.child.return=w,w=w.child;continue}}else if(rh(_,w,R),w.child!==null){w.child.return=w,w=w.child;continue}if(w===T)break;for(;w.sibling===null;){if(w.return===null||w.return===T)return;w=w.return,w.tag===4&&(P=!1)}w.sibling.return=w.return,w=w.sibling}}function am(_,T){if(we){switch(T.tag){case 0:case 11:case 14:case 15:al(3,T,T.return),ih(3,T),al(5,T,T.return);return;case 1:return;case 5:var R=T.stateNode;if(R!=null){var w=T.memoizedProps;_=_!==null?_.memoizedProps:w;var P=T.type,H=T.updateQueue;T.updateQueue=null,H!==null&&St(R,H,P,_,w,T)}return;case 6:if(T.stateNode===null)throw Error(l(162));R=T.memoizedProps,ft(T.stateNode,_!==null?_.memoizedProps:R,R);return;case 3:Ge&&_!==null&&_.memoizedState.isDehydrated&&pe(T.stateNode.containerInfo);return;case 12:return;case 13:zd(T);return;case 19:zd(T);return;case 17:return}throw Error(l(163))}switch(T.tag){case 0:case 11:case 14:case 15:al(3,T,T.return),ih(3,T),al(5,T,T.return);return;case 12:return;case 13:zd(T);return;case 19:zd(T);return;case 3:Ge&&_!==null&&_.memoizedState.isDehydrated&&pe(T.stateNode.containerInfo);break;case 22:case 23:return}e:if(Q){switch(T.tag){case 1:case 5:case 6:break e;case 3:case 4:T=T.stateNode,gt(T.containerInfo,T.pendingChildren);break e}throw Error(l(163))}}function zd(_){var T=_.updateQueue;if(T!==null){_.updateQueue=null;var R=_.stateNode;R===null&&(R=_.stateNode=new tm),T.forEach(function(w){var P=gh.bind(null,_,w);R.has(w)||(R.add(w),w.then(P,P))})}}function oh(_,T){for(kt=T;kt!==null;){T=kt;var R=T.deletions;if(R!==null)for(var w=0;w<R.length;w++){var P=R[w];try{var H=_;we?H_(H,P,T):G_(H,P,T);var Se=P.alternate;Se!==null&&(Se.return=null),P.return=null}catch(en){Vr(P,T,en)}}if(R=T.child,T.subtreeFlags&12854&&R!==null)R.return=T,kt=R;else for(;kt!==null;){T=kt;try{var De=T.flags;if(De&32&&we&&be(T.stateNode),De&512){var dt=T.alternate;if(dt!==null){var Rt=dt.ref;Rt!==null&&(typeof Rt=="function"?Rt(null):Rt.current=null)}}if(De&8192)switch(T.tag){case 13:if(T.memoizedState!==null){var Gt=T.alternate;(Gt===null||Gt.memoizedState===null)&&(Qd=ai())}break;case 22:var En=T.memoizedState!==null,cn=T.alternate,gi=cn!==null&&cn.memoizedState!==null;if(R=T,we){e:if(w=R,P=En,H=null,we)for(var Jt=w;;){if(Jt.tag===5){if(H===null){H=Jt;var Xi=Jt.stateNode;P?nt(Xi):Le(Jt.stateNode,Jt.memoizedProps)}}else if(Jt.tag===6){if(H===null){var gs=Jt.stateNode;P?Ee(gs):Be(gs,Jt.memoizedProps)}}else if((Jt.tag!==22&&Jt.tag!==23||Jt.memoizedState===null||Jt===w)&&Jt.child!==null){Jt.child.return=Jt,Jt=Jt.child;continue}if(Jt===w)break;for(;Jt.sibling===null;){if(Jt.return===null||Jt.return===w)break e;H===Jt&&(H=null),Jt=Jt.return}H===Jt&&(H=null),Jt.sibling.return=Jt.return,Jt=Jt.sibling}}if(En&&!gi&&R.mode&1){kt=R;for(var et=R.child;et!==null;){for(R=kt=et;kt!==null;){w=kt;var ze=w.child;switch(w.tag){case 0:case 11:case 14:case 15:al(4,w,w.return);break;case 1:Hd(w,w.return);var ct=w.stateNode;if(typeof ct.componentWillUnmount=="function"){var Pt=w.return;try{ct.props=w.memoizedProps,ct.state=w.memoizedState,ct.componentWillUnmount()}catch(en){Vr(w,Pt,en)}}break;case 5:Hd(w,w.return);break;case 22:if(w.memoizedState!==null){qs(R);continue}}ze!==null?(ze.return=w,kt=ze):qs(R)}et=et.sibling}}}switch(De&4102){case 2:om(T),T.flags&=-3;break;case 6:om(T),T.flags&=-3,am(T.alternate,T);break;case 4096:T.flags&=-4097;break;case 4100:T.flags&=-4097,am(T.alternate,T);break;case 4:am(T.alternate,T)}}catch(en){Vr(T,T.return,en)}if(R=T.sibling,R!==null){R.return=T.return,kt=R;break}kt=T.return}}}function V_(_,T,R){kt=_,z_(_)}function z_(_,T,R){for(var w=(_.mode&1)!==0;kt!==null;){var P=kt,H=P.child;if(P.tag===22&&w){var Se=P.memoizedState!==null||nh;if(!Se){var De=P.alternate,dt=De!==null&&De.memoizedState!==null||tc;De=nh;var Rt=tc;if(nh=Se,(tc=dt)&&!Rt)for(kt=P;kt!==null;)Se=kt,dt=Se.child,Se.tag===22&&Se.memoizedState!==null?W_(P):dt!==null?(dt.return=Se,kt=dt):W_(P);for(;H!==null;)kt=H,z_(H),H=H.sibling;kt=P,nh=De,tc=Rt}Wd(_)}else P.subtreeFlags&8772&&H!==null?(H.return=P,kt=H):Wd(_)}}function Wd(_){for(;kt!==null;){var T=kt;if(T.flags&8772){var R=T.alternate;try{if(T.flags&8772)switch(T.tag){case 0:case 11:case 15:tc||ih(5,T);break;case 1:var w=T.stateNode;if(T.flags&4&&!tc)if(R===null)w.componentDidMount();else{var P=T.elementType===T.type?R.memoizedProps:Oi(T.type,R.memoizedProps);w.componentDidUpdate(P,R.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var H=T.updateQueue;H!==null&&Fu(T,H,w);break;case 3:var Se=T.updateQueue;if(Se!==null){if(R=null,T.child!==null)switch(T.child.tag){case 5:R=ue(T.child.stateNode);break;case 1:R=T.child.stateNode}Fu(T,Se,R)}break;case 5:var De=T.stateNode;R===null&&T.flags&4&&He(De,T.type,T.memoizedProps,T);break;case 6:break;case 4:break;case 12:break;case 13:if(Ge&&T.memoizedState===null){var dt=T.alternate;if(dt!==null){var Rt=dt.memoizedState;if(Rt!==null){var Gt=Rt.dehydrated;Gt!==null&&ye(Gt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(l(163))}tc||T.flags&512&&Hc(T)}catch(En){Vr(T,T.return,En)}}if(T===_){kt=null;break}if(R=T.sibling,R!==null){R.return=T.return,kt=R;break}kt=T.return}}function qs(_){for(;kt!==null;){var T=kt;if(T===_){kt=null;break}var R=T.sibling;if(R!==null){R.return=T.return,kt=R;break}kt=T.return}}function W_(_){for(;kt!==null;){var T=kt;try{switch(T.tag){case 0:case 11:case 15:var R=T.return;try{ih(4,T)}catch(dt){Vr(T,R,dt)}break;case 1:var w=T.stateNode;if(typeof w.componentDidMount=="function"){var P=T.return;try{w.componentDidMount()}catch(dt){Vr(T,P,dt)}}var H=T.return;try{Hc(T)}catch(dt){Vr(T,H,dt)}break;case 5:var Se=T.return;try{Hc(T)}catch(dt){Vr(T,Se,dt)}}}catch(dt){Vr(T,T.return,dt)}if(T===_){kt=null;break}var De=T.sibling;if(De!==null){De.return=T.return,kt=De;break}kt=T.return}}var Ho=0,ah=1,Xd=2,nc=3,lh=4;if(typeof Symbol=="function"&&Symbol.for){var Vc=Symbol.for;Ho=Vc("selector.component"),ah=Vc("selector.has_pseudo_class"),Xd=Vc("selector.role"),nc=Vc("selector.test_id"),lh=Vc("selector.text")}function jd(_){var T=Oe(_);if(T!=null){if(typeof T.memoizedProps["data-testname"]!="string")throw Error(l(364));return T}if(_=Me(_),_===null)throw Error(l(362));return _.stateNode.current}function Yd(_,T){switch(T.$$typeof){case Ho:if(_.type===T.value)return!0;break;case ah:e:{T=T.value,_=[_,0];for(var R=0;R<_.length;){var w=_[R++],P=_[R++],H=T[P];if(w.tag!==5||!ee(w)){for(;H!=null&&Yd(w,H);)P++,H=T[P];if(P===T.length){T=!0;break e}else for(w=w.child;w!==null;)_.push(w,P),w=w.sibling}}T=!1}return T;case Xd:if(_.tag===5&&W(_.stateNode,T.value))return!0;break;case lh:if((_.tag===5||_.tag===6)&&(_=oe(_),_!==null&&0<=_.indexOf(T.value)))return!0;break;case nc:if(_.tag===5&&(_=_.memoizedProps["data-testname"],typeof _=="string"&&_.toLowerCase()===T.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function Kd(_){switch(_.$$typeof){case Ho:return"<"+(F(_.value)||"Unknown")+">";case ah:return":has("+(Kd(_)||"")+")";case Xd:return'[role="'+_.value+'"]';case lh:return'"'+_.value+'"';case nc:return'[data-testname="'+_.value+'"]';default:throw Error(l(365))}}function lm(_,T){var R=[];_=[_,0];for(var w=0;w<_.length;){var P=_[w++],H=_[w++],Se=T[H];if(P.tag!==5||!ee(P)){for(;Se!=null&&Yd(P,Se);)H++,Se=T[H];if(H===T.length)R.push(P);else for(P=P.child;P!==null;)_.push(P,H),P=P.sibling}}return R}function Jd(_,T){if(!ve)throw Error(l(363));_=jd(_),_=lm(_,T),T=[],_=Array.from(_);for(var R=0;R<_.length;){var w=_[R++];if(w.tag===5)ee(w)||T.push(w.stateNode);else for(w=w.child;w!==null;)_.push(w),w=w.sibling}return T}var X_=Math.ceil,ch=u.ReactCurrentDispatcher,Zd=u.ReactCurrentOwner,Wi=u.ReactCurrentBatchConfig,xn=0,Zi=null,qi=null,xr=0,Is=0,zc=Ot(0),ar=0,uh=null,ic=0,hh=0,qd=0,Wc=null,is=null,Qd=0,ef=1/0;function ll(){ef=ai()+500}var rc=!1,tf=null,cl=null,dh=!1,va=null,fh=0,Xc=0,nf=null,ph=-1,mh=0;function Hr(){return xn&6?ai():ph!==-1?ph:ph=ai()}function Ea(_){return _.mode&1?xn&2&&xr!==0?xr&-xr:Oo.transition!==null?(mh===0&&(_=cs,cs<<=1,!(cs&4194240)&&(cs=64),mh=_),mh):(_=rn,_!==0?_:Fe()):1}function Os(_,T,R){if(50<Xc)throw Xc=0,nf=null,Error(l(185));var w=rf(_,T);return w===null?null:(ts(w,T,R),(!(xn&2)||w!==Zi)&&(w===Zi&&(!(xn&2)&&(hh|=T),ar===4&&ul(w,xr)),ms(w,R),T===1&&xn===0&&!(_.mode&1)&&(ll(),js&&Fr())),w)}function rf(_,T){_.lanes|=T;var R=_.alternate;for(R!==null&&(R.lanes|=T),R=_,_=_.return;_!==null;)_.childLanes|=T,R=_.alternate,R!==null&&(R.childLanes|=T),R=_,_=_.return;return R.tag===3?R.stateNode:null}function ms(_,T){var R=_.callbackNode;dn(_,T);var w=hi(_,_===Zi?xr:0);if(w===0)R!==null&&zi(R),_.callbackNode=null,_.callbackPriority=0;else if(T=w&-w,_.callbackPriority!==T){if(R!=null&&zi(R),T===1)_.tag===0?Vl(Y_.bind(null,_)):da(Y_.bind(null,_)),Ue?Je(function(){xn===0&&Fr()}):us(xs,Fr),R=null;else{switch(vi(w)){case 1:R=xs;break;case 4:R=Qa;break;case 16:R=mr;break;case 536870912:R=el;break;default:R=mr}R=sc(R,j_.bind(null,_))}_.callbackPriority=T,_.callbackNode=R}}function j_(_,T){if(ph=-1,mh=0,xn&6)throw Error(l(327));var R=_.callbackNode;if(dl()&&_.callbackNode!==R)return null;var w=hi(_,_===Zi?xr:0);if(w===0)return null;if(w&30||w&_.expiredLanes||T)T=yt(_,w);else{T=w;var P=xn;xn|=2;var H=of();(Zi!==_||xr!==T)&&(ll(),Ls(_,T));do try{Ns();break}catch(De){WE(_,De)}while(1);_n(),ch.current=H,xn=P,qi!==null?T=0:(Zi=null,xr=0,T=ar)}if(T!==0){if(T===2&&(P=Pr(_),P!==0&&(w=P,T=sf(_,P))),T===1)throw R=uh,Ls(_,0),ul(_,w),ms(_,ai()),R;if(T===6)ul(_,w);else{if(P=_.current.alternate,!(w&30)&&!zE(P)&&(T=yt(_,w),T===2&&(H=Pr(_),H!==0&&(w=H,T=sf(_,H))),T===1))throw R=uh,Ls(_,0),ul(_,w),ms(_,ai()),R;switch(_.finishedWork=P,_.finishedLanes=w,T){case 0:case 1:throw Error(l(345));case 2:jc(_,is);break;case 3:if(ul(_,w),(w&130023424)===w&&(T=Qd+500-ai(),10<T)){if(hi(_,0)!==0)break;if(P=_.suspendedLanes,(P&w)!==w){Hr(),_.pingedLanes|=_.suspendedLanes&P;break}_.timeoutHandle=Ie(jc.bind(null,_,is),T);break}jc(_,is);break;case 4:if(ul(_,w),(w&4194240)===w)break;for(T=_.eventTimes,P=-1;0<w;){var Se=31-An(w);H=1<<Se,Se=T[Se],Se>P&&(P=Se),w&=~H}if(w=P,w=ai()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*X_(w/1960))-w,10<w){_.timeoutHandle=Ie(jc.bind(null,_,is),w);break}jc(_,is);break;case 5:jc(_,is);break;default:throw Error(l(329))}}}return ms(_,ai()),_.callbackNode===R?j_.bind(null,_):null}function sf(_,T){var R=Wc;return _.current.memoizedState.isDehydrated&&(Ls(_,T).flags|=256),_=yt(_,T),_!==2&&(T=is,is=R,T!==null&&cm(T)),_}function cm(_){is===null?is=_:is.push.apply(is,_)}function zE(_){for(var T=_;;){if(T.flags&16384){var R=T.updateQueue;if(R!==null&&(R=R.stores,R!==null))for(var w=0;w<R.length;w++){var P=R[w],H=P.getSnapshot;P=P.value;try{if(!$r(H(),P))return!1}catch{return!1}}}if(R=T.child,T.subtreeFlags&16384&&R!==null)R.return=T,T=R;else{if(T===_)break;for(;T.sibling===null;){if(T.return===null||T.return===_)return!0;T=T.return}T.sibling.return=T.return,T=T.sibling}}return!0}function ul(_,T){for(T&=~qd,T&=~hh,_.suspendedLanes|=T,_.pingedLanes&=~T,_=_.expirationTimes;0<T;){var R=31-An(T),w=1<<R;_[R]=-1,T&=~w}}function Y_(_){if(xn&6)throw Error(l(327));dl();var T=hi(_,0);if(!(T&1))return ms(_,ai()),null;var R=yt(_,T);if(_.tag!==0&&R===2){var w=Pr(_);w!==0&&(T=w,R=sf(_,w))}if(R===1)throw R=uh,Ls(_,0),ul(_,T),ms(_,ai()),R;if(R===6)throw Error(l(345));return _.finishedWork=_.current.alternate,_.finishedLanes=T,jc(_,is),ms(_,ai()),null}function K_(_){va!==null&&va.tag===0&&!(xn&6)&&dl();var T=xn;xn|=1;var R=Wi.transition,w=rn;try{if(Wi.transition=null,rn=1,_)return _()}finally{rn=w,Wi.transition=R,xn=T,!(xn&6)&&Fr()}}function Tt(){Is=zc.current,qt(zc)}function Ls(_,T){_.finishedWork=null,_.finishedLanes=0;var R=_.timeoutHandle;if(R!==ut&&(_.timeoutHandle=ut,We(R)),qi!==null)for(R=qi.return;R!==null;){var w=R;switch(bd(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&Rn();break;case 3:Ei(),qt(sn),qt(Fn),zu();break;case 5:Jl(w);break;case 4:Ei();break;case 13:qt(mi);break;case 19:qt(mi);break;case 10:Qt(w.type._context);break;case 22:case 23:Tt()}R=R.return}if(Zi=_,qi=_=Qs(_.current,null),xr=Is=T,ar=0,uh=null,qd=hh=ic=0,is=Wc=null,br!==null){for(T=0;T<br.length;T++)if(R=br[T],w=R.interleaved,w!==null){R.interleaved=null;var P=w.next,H=R.pending;if(H!==null){var Se=H.next;H.next=P,w.next=Se}R.pending=w}br=null}return _}function WE(_,T){do{var R=qi;try{if(_n(),tl.current=Zu,Id){for(var w=wi.memoizedState;w!==null;){var P=w.queue;P!==null&&(P.pending=null),w=w.next}Id=!1}if(go=0,or=Cr=wi=null,Wu=!1,Xu=0,Zd.current=null,R===null||R.return===null){ar=1,uh=T,qi=null;break}e:{var H=_,Se=R.return,De=R,dt=T;if(T=xr,De.flags|=32768,dt!==null&&typeof dt=="object"&&typeof dt.then=="function"){var Rt=dt,Gt=De,En=Gt.tag;if(!(Gt.mode&1)&&(En===0||En===11||En===15)){var cn=Gt.alternate;cn?(Gt.updateQueue=cn.updateQueue,Gt.memoizedState=cn.memoizedState,Gt.lanes=cn.lanes):(Gt.updateQueue=null,Gt.memoizedState=null)}var gi=x_(Se);if(gi!==null){gi.flags&=-257,w_(gi,Se,De,H,T),gi.mode&1&&Bo(H,Rt,T),T=gi,dt=Rt;var Jt=T.updateQueue;if(Jt===null){var Xi=new Set;Xi.add(dt),T.updateQueue=Xi}else Jt.add(dt);break e}else{if(!(T&1)){Bo(H,Rt,T),_o();break e}dt=Error(l(426))}}else if(Li&&De.mode&1){var gs=x_(Se);if(gs!==null){!(gs.flags&65536)&&(gs.flags|=256),w_(gs,Se,De,H,T),Wp(dt);break e}}H=dt,ar!==4&&(ar=2),Wc===null?Wc=[H]:Wc.push(H),dt=ec(dt,De),De=Se;do{switch(De.tag){case 3:De.flags|=65536,T&=-T,De.lanes|=T;var et=rl(De,dt,T);Up(De,et);break e;case 1:H=dt;var ze=De.type,ct=De.stateNode;if(!(De.flags&128)&&(typeof ze.getDerivedStateFromError=="function"||ct!==null&&typeof ct.componentDidCatch=="function"&&(cl===null||!cl.has(ct)))){De.flags|=65536,T&=-T,De.lanes|=T;var Pt=Dd(De,H,T);Up(De,Pt);break e}}De=De.return}while(De!==null)}Z_(R)}catch(en){T=en,qi===R&&R!==null&&(qi=R=R.return);continue}break}while(1)}function of(){var _=ch.current;return ch.current=Zu,_===null?Zu:_}function _o(){(ar===0||ar===3||ar===2)&&(ar=4),Zi===null||!(ic&268435455)&&!(hh&268435455)||ul(Zi,xr)}function yt(_,T){var R=xn;xn|=2;var w=of();Zi===_&&xr===T||Ls(_,T);do try{hl();break}catch(P){WE(_,P)}while(1);if(_n(),xn=R,ch.current=w,qi!==null)throw Error(l(261));return Zi=null,xr=0,ar}function hl(){for(;qi!==null;)J_(qi)}function Ns(){for(;qi!==null&&!Gl();)J_(qi)}function J_(_){var T=af(_.alternate,_,Is);_.memoizedProps=_.pendingProps,T===null?Z_(_):qi=T,Zd.current=null}function Z_(_){var T=_;do{var R=T.alternate;if(_=T.return,T.flags&32768){if(R=HE(R,T),R!==null){R.flags&=32767,qi=R;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{ar=6,qi=null;return}}else if(R=O_(R,T,Is),R!==null){qi=R;return}if(T=T.sibling,T!==null){qi=T;return}qi=T=_}while(T!==null);ar===0&&(ar=5)}function jc(_,T){var R=rn,w=Wi.transition;try{Wi.transition=null,rn=1,q_(_,T,R)}finally{Wi.transition=w,rn=R}return null}function q_(_,T,R){do dl();while(va!==null);if(xn&6)throw Error(l(327));var w=_.finishedWork,P=_.finishedLanes;if(w===null)return null;if(_.finishedWork=null,_.finishedLanes=0,w===_.current)throw Error(l(177));_.callbackNode=null,_.callbackPriority=0;var H=w.lanes|w.childLanes;if(Dr(_,H),_===Zi&&(qi=Zi=null,xr=0),!(w.subtreeFlags&2064)&&!(w.flags&2064)||dh||(dh=!0,sc(mr,function(){return dl(),null})),H=(w.flags&15990)!==0,w.subtreeFlags&15990||H){H=Wi.transition,Wi.transition=null;var Se=rn;rn=1;var De=xn;xn|=4,Zd.current=null,VE(_,w),oh(_,w),K(_.containerInfo),_.current=w,V_(w),Br(),xn=De,rn=Se,Wi.transition=H}else _.current=w;if(dh&&(dh=!1,va=_,fh=P),H=_.pendingLanes,H===0&&(cl=null),fo(w.stateNode),ms(_,ai()),T!==null)for(R=_.onRecoverableError,w=0;w<T.length;w++)R(T[w]);if(rc)throw rc=!1,_=tf,tf=null,_;return fh&1&&_.tag!==0&&dl(),H=_.pendingLanes,H&1?_===nf?Xc++:(Xc=0,nf=_):Xc=0,Fr(),null}function dl(){if(va!==null){var _=vi(fh),T=Wi.transition,R=rn;try{if(Wi.transition=null,rn=16>_?16:_,va===null)var w=!1;else{if(_=va,va=null,fh=0,xn&6)throw Error(l(331));var P=xn;for(xn|=4,kt=_.current;kt!==null;){var H=kt,Se=H.child;if(kt.flags&16){var De=H.deletions;if(De!==null){for(var dt=0;dt<De.length;dt++){var Rt=De[dt];for(kt=Rt;kt!==null;){var Gt=kt;switch(Gt.tag){case 0:case 11:case 15:al(8,Gt,H)}var En=Gt.child;if(En!==null)En.return=Gt,kt=En;else for(;kt!==null;){Gt=kt;var cn=Gt.sibling,gi=Gt.return;if(im(Gt),Gt===Rt){kt=null;break}if(cn!==null){cn.return=gi,kt=cn;break}kt=gi}}}var Jt=H.alternate;if(Jt!==null){var Xi=Jt.child;if(Xi!==null){Jt.child=null;do{var gs=Xi.sibling;Xi.sibling=null,Xi=gs}while(Xi!==null)}}kt=H}}if(H.subtreeFlags&2064&&Se!==null)Se.return=H,kt=Se;else e:for(;kt!==null;){if(H=kt,H.flags&2048)switch(H.tag){case 0:case 11:case 15:al(9,H,H.return)}var et=H.sibling;if(et!==null){et.return=H.return,kt=et;break e}kt=H.return}}var ze=_.current;for(kt=ze;kt!==null;){Se=kt;var ct=Se.child;if(Se.subtreeFlags&2064&&ct!==null)ct.return=Se,kt=ct;else e:for(Se=ze;kt!==null;){if(De=kt,De.flags&2048)try{switch(De.tag){case 0:case 11:case 15:ih(9,De)}}catch(en){Vr(De,De.return,en)}if(De===Se){kt=null;break e}var Pt=De.sibling;if(Pt!==null){Pt.return=De.return,kt=Pt;break e}kt=De.return}}if(xn=P,Fr(),Ii&&typeof Ii.onPostCommitFiberRoot=="function")try{Ii.onPostCommitFiberRoot(xi,_)}catch{}w=!0}return w}finally{rn=R,Wi.transition=T}}return!1}function Yc(_,T,R){T=ec(R,T),T=rl(_,T,1),fa(_,T),T=Hr(),_=rf(_,1),_!==null&&(ts(_,1,T),ms(_,T))}function Vr(_,T,R){if(_.tag===3)Yc(_,_,R);else for(;T!==null;){if(T.tag===3){Yc(T,_,R);break}else if(T.tag===1){var w=T.stateNode;if(typeof T.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(cl===null||!cl.has(w))){_=ec(R,_),_=Dd(T,_,1),fa(T,_),_=Hr(),T=rf(T,1),T!==null&&(ts(T,1,_),ms(T,_));break}}T=T.return}}function Kc(_,T,R){var w=_.pingCache;w!==null&&w.delete(T),T=Hr(),_.pingedLanes|=_.suspendedLanes&R,Zi===_&&(xr&R)===R&&(ar===4||ar===3&&(xr&130023424)===xr&&500>ai()-Qd?Ls(_,0):qd|=R),ms(_,T)}function ya(_,T){T===0&&(_.mode&1?(T=Xs,Xs<<=1,!(Xs&130023424)&&(Xs=4194304)):T=1);var R=Hr();_=rf(_,T),_!==null&&(ts(_,T,R),ms(_,R))}function Jc(_){var T=_.memoizedState,R=0;T!==null&&(R=T.retryLane),ya(_,R)}function gh(_,T){var R=0;switch(_.tag){case 13:var w=_.stateNode,P=_.memoizedState;P!==null&&(R=P.retryLane);break;case 19:w=_.stateNode;break;default:throw Error(l(314))}w!==null&&w.delete(T),ya(_,R)}var af;af=function(_,T,R){if(_!==null)if(_.memoizedProps!==T.pendingProps||sn.current)fs=!0;else{if(!(_.lanes&R)&&!(T.flags&128))return fs=!1,F_(_,T,R);fs=!!(_.flags&131072)}else fs=!1,Li&&T.flags&1048576&&kc(T,Nc,T.index);switch(T.lanes=0,T.tag){case 2:var w=T.type;_!==null&&(_.alternate=null,T.alternate=null,T.flags|=2),_=T.pendingProps;var P=tn(T,Fn.current);li(T,R),P=Bc(null,T,w,_,P,R);var H=jp();return T.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(T.tag=1,T.memoizedState=null,T.updateQueue=null,Un(w)?(H=!0,In(T)):H=!1,T.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,Ic(T),P.updater=Oc,T.stateNode=P,P._reactInternals=T,Lc(T,w,_,R),T=Ji(null,T,w,!0,H,R)):(T.tag=0,Li&&H&&$d(T),Rr(null,T,P,R),T=T.child),T;case 16:w=T.elementType;e:{switch(_!==null&&(_.alternate=null,T.alternate=null,T.flags|=2),_=T.pendingProps,P=w._init,w=P(w._payload),T.type=w,P=T.tag=Sa(w),_=Oi(w,_),P){case 0:T=Wt(null,T,w,_,R);break e;case 1:T=ps(null,T,w,_,R);break e;case 11:T=L_(null,T,w,_,R);break e;case 14:T=N_(null,T,w,Oi(w.type,_),R);break e}throw Error(l(306,w,""))}return T;case 0:return w=T.type,P=T.pendingProps,P=T.elementType===w?P:Oi(w,P),Wt(_,T,w,P,R);case 1:return w=T.type,P=T.pendingProps,P=T.elementType===w?P:Oi(w,P),ps(_,T,w,P,R);case 3:e:{if(yi(T),_===null)throw Error(l(387));w=T.pendingProps,H=T.memoizedState,P=H.element,Fp(_,T),yd(T,w,null,R);var Se=T.memoizedState;if(w=Se.element,Ge&&H.isDehydrated)if(H={element:w,isDehydrated:!1,cache:Se.cache,transitions:Se.transitions},T.updateQueue.baseState=H,T.memoizedState=H,T.flags&256){P=Error(l(423)),T=Uo(_,T,w,R,P);break e}else if(w!==P){P=Error(l(424)),T=Uo(_,T,w,R,P);break e}else for(Ge&&(ns=pi(T.stateNode.containerInfo),Ar=T,Li=!0,Js=null,Gu=!1),R=Vu(T,null,w,R),T.child=R;R;)R.flags=R.flags&-3|4096,R=R.sibling;else{if(Pc(),w===P){T=Go(_,T,R);break e}Rr(_,T,w,R)}T=T.child}return T;case 5:return f_(T),_===null&&Cd(T),w=T.type,P=T.pendingProps,H=_!==null?_.memoizedProps:null,Se=P.children,Ae(w,P)?Se=null:H!==null&&Ae(w,H)&&(T.flags|=32),sl(_,T),Rr(_,T,Se,R),T.child;case 6:return _===null&&Cd(T),null;case 13:return Di(_,T,R);case 4:return xd(T,T.stateNode.containerInfo),w=T.pendingProps,_===null?T.child=mo(T,null,w,R):Rr(_,T,w,R),T.child;case 11:return w=T.type,P=T.pendingProps,P=T.elementType===w?P:Oi(w,P),L_(_,T,w,P,R);case 7:return Rr(_,T,T.pendingProps,R),T.child;case 8:return Rr(_,T,T.pendingProps.children,R),T.child;case 12:return Rr(_,T,T.pendingProps.children,R),T.child;case 10:e:{if(w=T.type._context,P=T.pendingProps,H=T.memoizedProps,Se=P.value,fn(T,w,Se),H!==null)if($r(H.value,Se)){if(H.children===P.children&&!sn.current){T=Go(_,T,R);break e}}else for(H=T.child,H!==null&&(H.return=T);H!==null;){var De=H.dependencies;if(De!==null){Se=H.child;for(var dt=De.firstContext;dt!==null;){if(dt.context===w){if(H.tag===1){dt=Lo(-1,R&-R),dt.tag=2;var Rt=H.updateQueue;if(Rt!==null){Rt=Rt.shared;var Gt=Rt.pending;Gt===null?dt.next=dt:(dt.next=Gt.next,Gt.next=dt),Rt.pending=dt}}H.lanes|=R,dt=H.alternate,dt!==null&&(dt.lanes|=R),yn(H.return,R,T),De.lanes|=R;break}dt=dt.next}}else if(H.tag===10)Se=H.type===T.type?null:H.child;else if(H.tag===18){if(Se=H.return,Se===null)throw Error(l(341));Se.lanes|=R,De=Se.alternate,De!==null&&(De.lanes|=R),yn(Se,R,T),Se=H.sibling}else Se=H.child;if(Se!==null)Se.return=H;else for(Se=H;Se!==null;){if(Se===T){Se=null;break}if(H=Se.sibling,H!==null){H.return=Se.return,Se=H;break}Se=Se.return}H=Se}Rr(_,T,P.children,R),T=T.child}return T;case 9:return P=T.type,w=T.pendingProps.children,li(T,R),P=ci(P),w=w(P),T.flags|=1,Rr(_,T,w,R),T.child;case 14:return w=T.type,P=Oi(w,T.pendingProps),P=Oi(w.type,P),N_(_,T,w,P,R);case 15:return k_(_,T,T.type,T.pendingProps,R);case 17:return w=T.type,P=T.pendingProps,P=T.elementType===w?P:Oi(w,P),_!==null&&(_.alternate=null,T.alternate=null,T.flags|=2),T.tag=1,Un(w)?(_=!0,In(T)):_=!1,li(T,R),Hp(T,w,P),Lc(T,w,P,R),Ji(null,T,w,!0,_,R);case 19:return Gd(_,T,R);case 22:return P_(_,T,R)}throw Error(l(156,T.tag))};function sc(_,T){return us(_,T)}function _h(_,T,R,w){this.tag=_,this.key=R,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=T,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(_,T,R,w){return new _h(_,T,R,w)}function oc(_){return _=_.prototype,!(!_||!_.isReactComponent)}function Sa(_){if(typeof _=="function")return oc(_)?1:0;if(_!=null){if(_=_.$$typeof,_===$)return 11;if(_===A)return 14}return 2}function Qs(_,T){var R=_.alternate;return R===null?(R=lr(_.tag,T,_.key,_.mode),R.elementType=_.elementType,R.type=_.type,R.stateNode=_.stateNode,R.alternate=_,_.alternate=R):(R.pendingProps=T,R.type=_.type,R.flags=0,R.subtreeFlags=0,R.deletions=null),R.flags=_.flags&14680064,R.childLanes=_.childLanes,R.lanes=_.lanes,R.child=_.child,R.memoizedProps=_.memoizedProps,R.memoizedState=_.memoizedState,R.updateQueue=_.updateQueue,T=_.dependencies,R.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext},R.sibling=_.sibling,R.index=_.index,R.ref=_.ref,R}function fl(_,T,R,w,P,H){var Se=2;if(w=_,typeof _=="function")oc(_)&&(Se=1);else if(typeof _=="string")Se=5;else e:switch(_){case f:return To(R.children,P,H,T);case p:Se=8,P|=8;break;case m:return _=lr(12,R,T,P|2),_.elementType=m,_.lanes=H,_;case E:return _=lr(13,R,T,P),_.elementType=E,_.lanes=H,_;case S:return _=lr(19,R,T,P),_.elementType=S,_.lanes=H,_;case x:return Vo(R,P,H,T);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case v:Se=10;break e;case y:Se=9;break e;case $:Se=11;break e;case A:Se=14;break e;case C:Se=16,w=null;break e}throw Error(l(130,_==null?_:typeof _,""))}return T=lr(Se,R,T,P),T.elementType=_,T.type=w,T.lanes=H,T}function To(_,T,R,w){return _=lr(7,_,w,T),_.lanes=R,_}function Vo(_,T,R,w){return _=lr(22,_,w,T),_.elementType=x,_.lanes=R,_.stateNode={},_}function zo(_,T,R){return _=lr(6,_,null,T),_.lanes=R,_}function ac(_,T,R){return T=lr(4,_.children!==null?_.children:[],_.key,T),T.lanes=R,T.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},T}function Th(_,T,R,w,P){this.tag=T,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ut,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jn(0),this.expirationTimes=jn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jn(0),this.identifierPrefix=w,this.onRecoverableError=P,Ge&&(this.mutableSourceEagerHydrationData=null)}function $a(_,T,R,w,P,H,Se,De,dt){return _=new Th(_,T,R,De,dt),T===1?(T=1,H===!0&&(T|=8)):T=0,H=lr(3,null,null,T),_.current=H,H.stateNode=_,H.memoizedState={element:w,isDehydrated:R,cache:null,transitions:null},Ic(H),_}function vh(_){if(!_)return ln;_=_._reactInternals;e:{if(D(_)!==_||_.tag!==1)throw Error(l(170));var T=_;do{switch(T.tag){case 3:T=T.stateNode.context;break e;case 1:if(Un(T.type)){T=T.stateNode.__reactInternalMemoizedMergedChildContext;break e}}T=T.return}while(T!==null);throw Error(l(171))}if(_.tag===1){var R=_.type;if(Un(R))return zn(_,R,T)}return T}function lc(_){var T=_._reactInternals;if(T===void 0)throw typeof _.render=="function"?Error(l(188)):(_=Object.keys(_).join(","),Error(l(268,_)));return _=re(T),_===null?null:_.stateNode}function lf(_,T){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var R=_.retryLane;_.retryLane=R!==0&&R<T?R:T}}function Eh(_,T){lf(_,T),(_=_.alternate)&&lf(_,T)}function Zc(_){return _=re(_),_===null?null:_.stateNode}function um(){return null}return n.attemptContinuousHydration=function(_){if(_.tag===13){var T=Hr();Os(_,134217728,T),Eh(_,134217728)}},n.attemptHydrationAtCurrentPriority=function(_){if(_.tag===13){var T=Hr(),R=Ea(_);Os(_,R,T),Eh(_,R)}},n.attemptSynchronousHydration=function(_){switch(_.tag){case 3:var T=_.stateNode;if(T.current.memoizedState.isDehydrated){var R=Cs(T.pendingLanes);R!==0&&(ti(T,R|1),ms(T,ai()),!(xn&6)&&(ll(),Fr()))}break;case 13:var w=Hr();K_(function(){return Os(_,1,w)}),Eh(_,1)}},n.batchedUpdates=function(_,T){var R=xn;xn|=1;try{return _(T)}finally{xn=R,xn===0&&(ll(),js&&Fr())}},n.createComponentSelector=function(_){return{$$typeof:Ho,value:_}},n.createContainer=function(_,T,R,w,P,H,Se){return $a(_,T,!1,null,R,w,P,H,Se)},n.createHasPseudoClassSelector=function(_){return{$$typeof:ah,value:_}},n.createHydrationContainer=function(_,T,R,w,P,H,Se,De,dt){return _=$a(R,w,!0,_,P,H,Se,De,dt),_.context=vh(null),R=_.current,w=Hr(),P=Ea(R),H=Lo(w,P),H.callback=T??null,fa(R,H),_.current.lanes=P,ts(_,P,w),ms(_,w),_},n.createPortal=function(_,T,R){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:w==null?null:""+w,children:_,containerInfo:T,implementation:R}},n.createRoleSelector=function(_){return{$$typeof:Xd,value:_}},n.createTestNameSelector=function(_){return{$$typeof:nc,value:_}},n.createTextSelector=function(_){return{$$typeof:lh,value:_}},n.deferredUpdates=function(_){var T=rn,R=Wi.transition;try{return Wi.transition=null,rn=16,_()}finally{rn=T,Wi.transition=R}},n.discreteUpdates=function(_,T,R,w,P){var H=rn,Se=Wi.transition;try{return Wi.transition=null,rn=1,_(T,R,w,P)}finally{rn=H,Wi.transition=Se,xn===0&&ll()}},n.findAllNodes=Jd,n.findBoundingRects=function(_,T){if(!ve)throw Error(l(363));T=Jd(_,T),_=[];for(var R=0;R<T.length;R++)_.push(vt(T[R]));for(T=_.length-1;0<T;T--){R=_[T];for(var w=R.x,P=w+R.width,H=R.y,Se=H+R.height,De=T-1;0<=De;De--)if(T!==De){var dt=_[De],Rt=dt.x,Gt=Rt+dt.width,En=dt.y,cn=En+dt.height;if(w>=Rt&&H>=En&&P<=Gt&&Se<=cn){_.splice(T,1);break}else if(w!==Rt||R.width!==dt.width||cn<H||En>Se){if(!(H!==En||R.height!==dt.height||Gt<w||Rt>P)){Rt>w&&(dt.width+=Rt-w,dt.x=w),Gt<P&&(dt.width=P-Rt),_.splice(T,1);break}}else{En>H&&(dt.height+=En-H,dt.y=H),cn<Se&&(dt.height=Se-En),_.splice(T,1);break}}}return _},n.findHostInstance=lc,n.findHostInstanceWithNoPortals=function(_){return _=ce(_),_=_!==null?ne(_):null,_===null?null:_.stateNode},n.findHostInstanceWithWarning=function(_){return lc(_)},n.flushControlled=function(_){var T=xn;xn|=1;var R=Wi.transition,w=rn;try{Wi.transition=null,rn=1,_()}finally{rn=w,Wi.transition=R,xn=T,xn===0&&(ll(),Fr())}},n.flushPassiveEffects=dl,n.flushSync=K_,n.focusWithin=function(_,T){if(!ve)throw Error(l(363));for(_=jd(_),T=lm(_,T),T=Array.from(T),_=0;_<T.length;){var R=T[_++];if(!ee(R)){if(R.tag===5&&ot(R.stateNode))return!0;for(R=R.child;R!==null;)T.push(R),R=R.sibling}}return!1},n.getCurrentUpdatePriority=function(){return rn},n.getFindAllNodesFailureDescription=function(_,T){if(!ve)throw Error(l(363));var R=0,w=[];_=[jd(_),0];for(var P=0;P<_.length;){var H=_[P++],Se=_[P++],De=T[Se];if((H.tag!==5||!ee(H))&&(Yd(H,De)&&(w.push(Kd(De)),Se++,Se>R&&(R=Se)),Se<T.length))for(H=H.child;H!==null;)_.push(H,Se),H=H.sibling}if(R<T.length){for(_=[];R<T.length;R++)_.push(Kd(T[R]));return`findAllNodes was able to match part of the selector:
  `+(w.join(" > ")+`

No matching component was found for:
  `)+_.join(" > ")}return null},n.getPublicRootInstance=function(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return ue(_.child.stateNode);default:return _.child.stateNode}},n.injectIntoDevTools=function(_){if(_={bundleType:_.bundleType,version:_.version,rendererPackageName:_.rendererPackageName,rendererConfig:_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Zc,findFiberByHostInstance:_.findFiberByHostInstance||um,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")_=!1;else{var T=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(T.isDisabled||!T.supportsFiber)_=!0;else{try{xi=T.inject(_),Ii=T}catch{}_=!!T.checkDCE}}return _},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(_,T,R,w){if(!ve)throw Error(l(363));_=Jd(_,T);var P=je(_,R,w).disconnect;return{disconnect:function(){P()}}},n.registerMutableSourceForHydration=function(_,T){var R=T._getVersion;R=R(T._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[T,R]:_.mutableSourceEagerHydrationData.push(T,R)},n.runWithPriority=function(_,T){var R=rn;try{return rn=_,T()}finally{rn=R}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(_,T,R,w){var P=T.current,H=Hr(),Se=Ea(P);return R=vh(R),T.context===null?T.context=R:T.pendingContext=R,T=Lo(H,Se),T.payload={element:_},w=w===void 0?null:w,w!==null&&(T.callback=w),fa(P,T),_=Os(P,Se,H),_!==null&&Bu(_,P,Se),Se},n};bU.exports=p9;var m9=bU.exports;const g9=pd(m9);var AU={exports:{}},CU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var se=K-1>>>1,Y=G[se];if(0<s(Y,Z))G[se]=Z,G[K]=Y,K=se;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var se=0,Y=G.length,me=Y>>>1;se<me;){var fe=2*(se+1)-1,Ae=G[fe],Ce=fe+1,Ie=G[Ce];if(0>s(Ae,K))Ce<Y&&0>s(Ie,Ae)?(G[se]=Ie,G[Ce]=K,se=Ce):(G[se]=Ae,G[fe]=K,se=fe);else if(Ce<Y&&0>s(Ie,K))G[se]=Ie,G[Ce]=K,se=Ce;else break e}}return Z}function s(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var d=[],h=[],f=1,p=null,m=3,v=!1,y=!1,$=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(G){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=G)r(h),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=n(h)}}function x(G){if($=!1,C(G),!y)if(n(d)!==null)y=!0,ue(I);else{var Z=n(h);Z!==null&&Re(x,Z.startTime-G)}}function I(G,Z){y=!1,$&&($=!1,S(k),k=-1),v=!0;var K=m;try{for(C(Z),p=n(d);p!==null&&(!(p.expirationTime>Z)||G&&!ce());){var se=p.callback;if(typeof se=="function"){p.callback=null,m=p.priorityLevel;var Y=se(p.expirationTime<=Z);Z=i.unstable_now(),typeof Y=="function"?p.callback=Y:p===n(d)&&r(d),C(Z)}else r(d);p=n(d)}if(p!==null)var me=!0;else{var fe=n(h);fe!==null&&Re(x,fe.startTime-Z),me=!1}return me}finally{p=null,m=K,v=!1}}var O=!1,F=null,k=-1,D=5,U=-1;function ce(){return!(i.unstable_now()-U<D)}function re(){if(F!==null){var G=i.unstable_now();U=G;var Z=!0;try{Z=F(!0,G)}finally{Z?ae():(O=!1,F=null)}}else O=!1}var ae;if(typeof A=="function")ae=function(){A(re)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,de=ne.port2;ne.port1.onmessage=re,ae=function(){de.postMessage(null)}}else ae=function(){E(re,0)};function ue(G){F=G,O||(O=!0,ae())}function Re(G,Z){k=E(function(){G(i.unstable_now())},Z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_continueExecution=function(){y||v||(y=!0,ue(I))},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return n(d)},i.unstable_next=function(G){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var K=m;m=Z;try{return G()}finally{m=K}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=m;m=G;try{return Z()}finally{m=K}},i.unstable_scheduleCallback=function(G,Z,K){var se=i.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?se+K:se):K=se,G){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=K+Y,G={id:f++,callback:Z,priorityLevel:G,startTime:K,expirationTime:Y,sortIndex:-1},K>se?(G.sortIndex=K,e(h,G),n(d)===null&&G===n(h)&&($?(S(k),k=-1):$=!0,Re(x,K-se))):(G.sortIndex=Y,e(d,G),y||v||(y=!0,ue(I))),G},i.unstable_shouldYield=ce,i.unstable_wrapCallback=function(G){var Z=m;return function(){var K=m;m=Z;try{return G.apply(this,arguments)}finally{m=K}}}})(CU);AU.exports=CU;var ok=AU.exports;function RU(i,e,n=(r,s)=>r===s){if(i===e)return!0;if(!i||!e)return!1;const r=i.length;if(e.length!==r)return!1;for(let s=0;s<r;s++)if(!n(i[s],e[s]))return!1;return!0}const $u=[];function xU(i,e,n=!1,r={}){for(const a of $u)if(RU(e,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return a.response;if(!n)throw a.promise}const s={keys:e,equal:r.equal,promise:i(...e).then(a=>s.response=a).then(()=>{r.lifespan&&r.lifespan>0&&setTimeout(()=>{const a=$u.indexOf(s);a!==-1&&$u.splice(a,1)},r.lifespan)}).catch(a=>s.error=a)};if($u.push(s),!n)throw s.promise}const _9=(i,e,n)=>xU(i,e,!1,n),T9=(i,e,n)=>void xU(i,e,!0,n),v9=i=>{if(i===void 0||i.length===0)$u.splice(0,$u.length);else{const e=$u.find(n=>RU(i,n.keys,n.equal));if(e){const n=$u.indexOf(e);n!==-1&&$u.splice(n,1)}}},XM={},wU=i=>void Object.assign(XM,i);function E9(i,e){function n(f,{args:p=[],attach:m,...v},y){let $=`${f[0].toUpperCase()}${f.slice(1)}`,E;if(f==="primitive"){if(v.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const S=v.object;E=og(S,{type:f,root:y,attach:m,primitive:!0})}else{const S=XM[$];if(!S)throw new Error(`R3F: ${$} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(p))throw new Error("R3F: The args prop must be an array!");E=og(new S(...p),{type:f,root:y,attach:m,memoizedProps:{args:p}})}return E.__r3f.attach===void 0&&(E instanceof on?E.__r3f.attach="geometry":E instanceof ir&&(E.__r3f.attach="material")),$!=="inject"&&BC(E,v),E}function r(f,p){let m=!1;if(p){var v,y;(v=p.__r3f)!=null&&v.attach?DC(f,p,p.__r3f.attach):p.isObject3D&&f.isObject3D&&(f.add(p),m=!0),m||(y=f.__r3f)==null||y.objects.push(p),p.__r3f||og(p,{}),p.__r3f.parent=f,Wx(p),ag(p)}}function s(f,p,m){let v=!1;if(p){var y,$;if((y=p.__r3f)!=null&&y.attach)DC(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){p.parent=f,p.dispatchEvent({type:"added"});const E=f.children.filter(A=>A!==p),S=E.indexOf(m);f.children=[...E.slice(0,S),p,...E.slice(S)],v=!0}v||($=f.__r3f)==null||$.objects.push(p),p.__r3f||og(p,{}),p.__r3f.parent=f,Wx(p),ag(p)}}function a(f,p,m=!1){f&&[...f].forEach(v=>l(p,v,m))}function l(f,p,m){if(p){var v,y,$;if(p.__r3f&&(p.__r3f.parent=null),(v=f.__r3f)!=null&&v.objects&&(f.__r3f.objects=f.__r3f.objects.filter(x=>x!==p)),(y=p.__r3f)!=null&&y.attach)hk(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){var E;f.remove(p),(E=p.__r3f)!=null&&E.root&&R9(p.__r3f.root,p)}const A=($=p.__r3f)==null?void 0:$.primitive,C=m===void 0?p.dispose!==null&&!A:m;if(!A){var S;a((S=p.__r3f)==null?void 0:S.objects,p,C),a(p.children,p,C)}p.__r3f&&(delete p.__r3f.root,delete p.__r3f.objects,delete p.__r3f.handlers,delete p.__r3f.memoizedProps,A||delete p.__r3f),C&&p.dispose&&p.type!=="Scene"&&ok.unstable_scheduleCallback(ok.unstable_IdlePriority,()=>{try{p.dispose()}catch{}}),ag(f)}}function u(f,p,m,v){var y;const $=(y=f.__r3f)==null?void 0:y.parent;if(!$)return;const E=n(p,m,f.__r3f.root);if(f.children){for(const S of f.children)S.__r3f&&r(E,S);f.children=f.children.filter(S=>!S.__r3f)}f.__r3f.objects.forEach(S=>r(E,S)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||l($,f),E.parent&&(E.__r3f.autoRemovedBeforeAppend=!0),r($,E),E.raycast&&E.__r3f.eventCount&&E.__r3f.root.getState().internal.interaction.push(E),[v,v.alternate].forEach(S=>{S!==null&&(S.stateNode=E,S.ref&&(typeof S.ref=="function"?S.ref(E):S.ref.current=E))})}const d=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:g9({createInstance:n,removeChild:l,appendChild:r,appendInitialChild:r,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,p)=>{if(!p)return;const m=f.getState().scene;m.__r3f&&(m.__r3f.root=f,r(m,p))},removeChildFromContainer:(f,p)=>{p&&l(f.getState().scene,p)},insertInContainerBefore:(f,p,m)=>{if(!p||!m)return;const v=f.getState().scene;v.__r3f&&s(v,p,m)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var p;return!!((p=f==null?void 0:f.__r3f)!=null?p:{}).handlers},prepareUpdate(f,p,m,v){if(f.__r3f.primitive&&v.object&&v.object!==f)return[!0];{const{args:y=[],children:$,...E}=v,{args:S=[],children:A,...C}=m;if(!Array.isArray(y))throw new Error("R3F: the args prop must be an array!");if(y.some((I,O)=>I!==S[O]))return[!0];const x=PU(f,E,C,!0);return x.changes.length?[!1,x]:null}},commitUpdate(f,[p,m],v,y,$,E){p?u(f,v,$,E):BC(f,m)},commitMount(f,p,m,v){var y;const $=(y=f.__r3f)!=null?y:{};f.raycast&&$.handlers&&$.eventCount&&f.__r3f.root.getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>og(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var p;const{attach:m,parent:v}=(p=f.__r3f)!=null?p:{};m&&v&&hk(v,f,m),f.isObject3D&&(f.visible=!1),ag(f)},unhideInstance(f,p){var m;const{attach:v,parent:y}=(m=f.__r3f)!=null?m:{};v&&y&&DC(y,f,v),(f.isObject3D&&p.visible==null||p.visible)&&(f.visible=!0),ag(f)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>e?e():Cg.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Ui.fun(performance.now)?performance.now:Ui.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Ui.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Ui.fun(clearTimeout)?clearTimeout:void 0}),applyProps:BC}}var ak,lk;const MU=()=>{var i;return(i=XM.ColorManagement)!=null?i:null},IU=i=>i&&i.isOrthographicCamera,y9=i=>i&&i.hasOwnProperty("current"),DE=typeof window<"u"&&((ak=window.document)!=null&&ak.createElement||((lk=window.navigator)==null?void 0:lk.product)==="ReactNative")?q.useLayoutEffect:q.useEffect;function OU(i){const e=q.useRef(i);return DE(()=>void(e.current=i),[i]),e}function S9({set:i}){return DE(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}class LU extends q.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}LU.getDerivedStateFromError=()=>({error:!0});const NU="__default",ck=new Map,$9=i=>i&&!!i.memoized&&!!i.changes;function kU(i){const e=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(i)?Math.min(Math.max(i[0],e),i[1]):i}const jT=i=>{var e;return(e=i.__r3f)==null?void 0:e.root.getState()},Ui={obj:i=>i===Object(i)&&!Ui.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,arr:i=>Array.isArray(i),equ(i,e,{arrays:n="shallow",objects:r="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Ui.str(i)||Ui.num(i))return i===e;const a=Ui.obj(i);if(a&&r==="reference")return i===e;const l=Ui.arr(i);if(l&&n==="reference")return i===e;if((l||a)&&i===e)return!0;let u;for(u in i)if(!(u in e))return!1;if(a&&n==="shallow"&&r==="shallow"){for(u in s?e:i)if(!Ui.equ(i[u],e[u],{strict:s,objects:"reference"}))return!1}else for(u in s?e:i)if(i[u]!==e[u])return!1;if(Ui.und(u)){if(l&&i.length===0&&e.length===0||a&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function b9(i){const e={nodes:{},materials:{}};return i&&i.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function A9(i){i.dispose&&i.type!=="Scene"&&i.dispose();for(const e in i)e.dispose==null||e.dispose(),delete i[e]}function og(i,e){const n=i;return(e!=null&&e.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),i}function zx(i,e){let n=i;if(e.includes("-")){const r=e.split("-"),s=r.pop();return n=r.reduce((a,l)=>a[l],i),{target:n,key:s}}else return{target:n,key:e}}const uk=/-\d+$/;function DC(i,e,n){if(Ui.str(n)){if(uk.test(n)){const a=n.replace(uk,""),{target:l,key:u}=zx(i,a);Array.isArray(l[u])||(l[u]=[])}const{target:r,key:s}=zx(i,n);e.__r3f.previousAttach=r[s],r[s]=e}else e.__r3f.previousAttach=n(i,e)}function hk(i,e,n){var r,s;if(Ui.str(n)){const{target:a,key:l}=zx(i,n),u=e.__r3f.previousAttach;u===void 0?delete a[l]:a[l]=u}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(i,e);(s=e.__r3f)==null||delete s.previousAttach}function PU(i,{children:e,key:n,ref:r,...s},{children:a,key:l,ref:u,...d}={},h=!1){var f;const p=(f=i==null?void 0:i.__r3f)!=null?f:{},m=Object.entries(s),v=[];if(h){const $=Object.keys(d);for(let E=0;E<$.length;E++)s.hasOwnProperty($[E])||m.unshift([$[E],NU+"remove"])}m.forEach(([$,E])=>{var S;if((S=i.__r3f)!=null&&S.primitive&&$==="object"||Ui.equ(E,d[$]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test($))return v.push([$,E,!0,[]]);let A=[];$.includes("-")&&(A=$.split("-")),v.push([$,E,!1,A]);for(const C in s){const x=s[C];C.startsWith(`${$}-`)&&v.push([C,x,!1,C.split("-")])}});const y={...s};return p.memoizedProps&&p.memoizedProps.args&&(y.args=p.memoizedProps.args),p.memoizedProps&&p.memoizedProps.attach&&(y.attach=p.memoizedProps.attach),{memoized:y,changes:v}}function BC(i,e){var n,r,s;const a=(n=i.__r3f)!=null?n:{},l=a.root,u=(r=l==null||l.getState==null?void 0:l.getState())!=null?r:{},{memoized:d,changes:h}=$9(e)?e:PU(i,e),f=a.eventCount;i.__r3f&&(i.__r3f.memoizedProps=d);for(let m=0;m<h.length;m++){let[v,y,$,E]=h[m],S=i,A=S[v];if(E.length&&(A=E.reduce((C,x)=>C[x],i),!(A&&A.set))){const[C,...x]=E.reverse();S=x.reverse().reduce((I,O)=>I[O],i),v=C}if(y===NU+"remove")if(S.constructor){let C=ck.get(S.constructor);C||(C=new S.constructor,ck.set(S.constructor,C)),y=C[v]}else y=0;if($)y?a.handlers[v]=y:delete a.handlers[v],a.eventCount=Object.keys(a.handlers).length;else if(A&&A.set&&(A.copy||A instanceof cp)){if(Array.isArray(y))A.fromArray?A.fromArray(y):A.set(...y);else if(A.copy&&y&&y.constructor&&A.constructor===y.constructor)A.copy(y);else if(y!==void 0){const C=A instanceof xt;!C&&A.setScalar?A.setScalar(y):A instanceof cp&&y instanceof cp?A.mask=y.mask:A.set(y),!MU()&&!u.linear&&C&&A.convertSRGBToLinear()}}else S[v]=y,!u.linear&&S[v]instanceof ni&&S[v].format===Yr&&S[v].type===ia&&(S[v].encoding=Rc);ag(i)}if(a.parent&&u.internal&&i.raycast&&f!==a.eventCount){const m=u.internal.interaction.indexOf(i);m>-1&&u.internal.interaction.splice(m,1),a.eventCount&&u.internal.interaction.push(i)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(s=i.__r3f)!=null&&s.parent&&Wx(i),i}function ag(i){var e,n;const r=(e=i.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();r&&r.internal.frames===0&&r.invalidate()}function Wx(i){i.onUpdate==null||i.onUpdate(i)}function DU(i,e){i.manual||(IU(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function P0(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function C9(){var i;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Cg.DefaultEventPriority;switch((i=e.event)==null?void 0:i.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Cg.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Cg.ContinuousEventPriority;default:return Cg.DefaultEventPriority}}function BU(i,e,n,r){const s=n.get(e);s&&(n.delete(e),n.size===0&&(i.delete(r),s.target.releasePointerCapture(r)))}function R9(i,e){const{internal:n}=i.getState();n.interaction=n.interaction.filter(r=>r!==e),n.initialHits=n.initialHits.filter(r=>r!==e),n.hovered.forEach((r,s)=>{(r.eventObject===e||r.object===e)&&n.hovered.delete(s)}),n.capturedMap.forEach((r,s)=>{BU(n.capturedMap,e,r,s)})}function x9(i){function e(d){const{internal:h}=i.getState(),f=d.offsetX-h.initialClick[0],p=d.offsetY-h.initialClick[1];return Math.round(Math.sqrt(f*f+p*p))}function n(d){return d.filter(h=>["Move","Over","Enter","Out","Leave"].some(f=>{var p;return(p=h.__r3f)==null?void 0:p.handlers["onPointer"+f]}))}function r(d,h){const f=i.getState(),p=new Set,m=[],v=h?h(f.internal.interaction):f.internal.interaction;for(let S=0;S<v.length;S++){const A=jT(v[S]);A&&(A.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(d,f);function y(S){const A=jT(S);if(!A||!A.events.enabled||A.raycaster.camera===null)return[];if(A.raycaster.camera===void 0){var C;A.events.compute==null||A.events.compute(d,A,(C=A.previousRoot)==null?void 0:C.getState()),A.raycaster.camera===void 0&&(A.raycaster.camera=null)}return A.raycaster.camera?A.raycaster.intersectObject(S,!0):[]}let $=v.flatMap(y).sort((S,A)=>{const C=jT(S.object),x=jT(A.object);return!C||!x?S.distance-A.distance:x.events.priority-C.events.priority||S.distance-A.distance}).filter(S=>{const A=P0(S);return p.has(A)?!1:(p.add(A),!0)});f.events.filter&&($=f.events.filter($,f));for(const S of $){let A=S.object;for(;A;){var E;(E=A.__r3f)!=null&&E.eventCount&&m.push({...S,eventObject:A}),A=A.parent}}if("pointerId"in d&&f.internal.capturedMap.has(d.pointerId))for(let S of f.internal.capturedMap.get(d.pointerId).values())p.has(P0(S.intersection))||m.push(S.intersection);return m}function s(d,h,f,p){const m=i.getState();if(d.length){const v={stopped:!1};for(const y of d){const $=jT(y.object)||m,{raycaster:E,pointer:S,camera:A,internal:C}=$,x=new ie(S.x,S.y,0).unproject(A),I=U=>{var ce,re;return(ce=(re=C.capturedMap.get(U))==null?void 0:re.has(y.eventObject))!=null?ce:!1},O=U=>{const ce={intersection:y,target:h.target};C.capturedMap.has(U)?C.capturedMap.get(U).set(y.eventObject,ce):C.capturedMap.set(U,new Map([[y.eventObject,ce]])),h.target.setPointerCapture(U)},F=U=>{const ce=C.capturedMap.get(U);ce&&BU(C.capturedMap,y.eventObject,ce,U)};let k={};for(let U in h){let ce=h[U];typeof ce!="function"&&(k[U]=ce)}let D={...y,...k,pointer:S,intersections:d,stopped:v.stopped,delta:f,unprojectedPoint:x,ray:E.ray,camera:A,stopPropagation(){const U="pointerId"in h&&C.capturedMap.get(h.pointerId);if((!U||U.has(y.eventObject))&&(D.stopped=v.stopped=!0,C.hovered.size&&Array.from(C.hovered.values()).find(ce=>ce.eventObject===y.eventObject))){const ce=d.slice(0,d.indexOf(y));a([...ce,y])}},target:{hasPointerCapture:I,setPointerCapture:O,releasePointerCapture:F},currentTarget:{hasPointerCapture:I,setPointerCapture:O,releasePointerCapture:F},nativeEvent:h};if(p(D),v.stopped===!0)break}}return d}function a(d){const{internal:h}=i.getState();for(const f of h.hovered.values())if(!d.length||!d.find(p=>p.object===f.object&&p.index===f.index&&p.instanceId===f.instanceId)){const m=f.eventObject.__r3f,v=m==null?void 0:m.handlers;if(h.hovered.delete(P0(f)),m!=null&&m.eventCount){const y={...f,intersections:d};v.onPointerOut==null||v.onPointerOut(y),v.onPointerLeave==null||v.onPointerLeave(y)}}}function l(d,h){for(let f=0;f<h.length;f++){const p=h[f].__r3f;p==null||p.handlers.onPointerMissed==null||p.handlers.onPointerMissed(d)}}function u(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return h=>{const{internal:f}=i.getState();"pointerId"in h&&f.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(h.pointerId)&&(f.capturedMap.delete(h.pointerId),a([]))})}}return function(f){const{onPointerMissed:p,internal:m}=i.getState();m.lastEvent.current=f;const v=d==="onPointerMove",y=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",E=r(f,v?n:void 0),S=y?e(f):0;d==="onPointerDown"&&(m.initialClick=[f.offsetX,f.offsetY],m.initialHits=E.map(C=>C.eventObject)),y&&!E.length&&S<=2&&(l(f,m.interaction),p&&p(f)),v&&a(E);function A(C){const x=C.eventObject,I=x.__r3f,O=I==null?void 0:I.handlers;if(I!=null&&I.eventCount)if(v){if(O.onPointerOver||O.onPointerEnter||O.onPointerOut||O.onPointerLeave){const F=P0(C),k=m.hovered.get(F);k?k.stopped&&C.stopPropagation():(m.hovered.set(F,C),O.onPointerOver==null||O.onPointerOver(C),O.onPointerEnter==null||O.onPointerEnter(C))}O.onPointerMove==null||O.onPointerMove(C)}else{const F=O[d];F?(!y||m.initialHits.includes(x))&&(l(f,m.interaction.filter(k=>!m.initialHits.includes(k))),F(C)):y&&m.initialHits.includes(x)&&l(f,m.interaction.filter(k=>!m.initialHits.includes(k)))}}s(E,f,S,A)}}return{handlePointer:u}}const w9=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],FU=i=>!!(i!=null&&i.render),jM=q.createContext(null),M9=(i,e)=>{const n=$U((u,d)=>{const h=new ie,f=new ie,p=new ie;function m(S=d().camera,A=f,C=d().size){const{width:x,height:I,top:O,left:F}=C,k=x/I;A instanceof ie?p.copy(A):p.set(...A);const D=S.getWorldPosition(h).distanceTo(p);if(IU(S))return{width:x/S.zoom,height:I/S.zoom,top:O,left:F,factor:1,distance:D,aspect:k};{const U=S.fov*Math.PI/180,ce=2*Math.tan(U/2)*D,re=ce*(x/I);return{width:re,height:ce,top:O,left:F,factor:x/re,distance:D,aspect:k}}}let v;const y=S=>u(A=>({performance:{...A.performance,current:S}})),$=new mt;return{set:u,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(S=1)=>i(d(),S),advance:(S,A)=>e(S,A,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new HM,pointer:$,mouse:$,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=d();v&&clearTimeout(v),S.performance.current!==S.performance.min&&y(S.performance.min),v=setTimeout(()=>y(d().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:S=>u(A=>({...A,events:{...A.events,...S}})),setSize:(S,A,C,x,I)=>{const O=d().camera,F={width:S,height:A,top:x||0,left:I||0,updateStyle:C};u(k=>({size:F,viewport:{...k.viewport,...m(O,f,F)}}))},setDpr:S=>u(A=>{const C=kU(S);return{viewport:{...A.viewport,dpr:C,initialDpr:A.viewport.initialDpr||C}}}),setFrameloop:(S="always")=>{const A=d().clock;A.stop(),A.elapsedTime=0,S!=="never"&&(A.start(),A.elapsedTime=0),u(()=>({frameloop:S}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:q.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(S,A,C)=>{const x=d().internal;return x.priority=x.priority+(A>0?1:0),x.subscribers.push({ref:S,priority:A,store:C}),x.subscribers=x.subscribers.sort((I,O)=>I.priority-O.priority),()=>{const I=d().internal;I!=null&&I.subscribers&&(I.priority=I.priority-(A>0?1:0),I.subscribers=I.subscribers.filter(O=>O.ref!==S))}}}}}),r=n.getState();let s=r.size,a=r.viewport.dpr,l=r.camera;return n.subscribe(()=>{const{camera:u,size:d,viewport:h,gl:f,set:p}=n.getState();if(d!==s||h.dpr!==a){var m;s=d,a=h.dpr,DU(u,d),f.setPixelRatio(h.dpr);const v=(m=d.updateStyle)!=null?m:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(d.width,d.height,v)}u!==l&&(l=u,p(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(u)}})))}),n.subscribe(u=>i(u)),n};let D0,I9=new Set,O9=new Set,L9=new Set;function FC(i,e){if(i.size)for(const{callback:n}of i.values())n(e)}function YT(i,e){switch(i){case"before":return FC(I9,e);case"after":return FC(O9,e);case"tail":return FC(L9,e)}}let UC,GC;function HC(i,e,n){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof i=="number"&&(r=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),UC=e.internal.subscribers,D0=0;D0<UC.length;D0++)GC=UC[D0],GC.ref.current(GC.store.getState(),r,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function N9(i){let e=!1,n,r,s;function a(d){r=requestAnimationFrame(a),e=!0,n=0,YT("before",d);for(const f of i.values()){var h;s=f.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((h=s.gl.xr)!=null&&h.isPresenting)&&(n+=HC(d,s))}if(YT("after",d),n===0)return YT("tail",d),e=!1,cancelAnimationFrame(r)}function l(d,h=1){var f;if(!d)return i.forEach(p=>l(p.store.getState()),h);(f=d.gl.xr)!=null&&f.isPresenting||!d.internal.active||d.frameloop==="never"||(d.internal.frames=Math.min(60,d.internal.frames+h),e||(e=!0,requestAnimationFrame(a)))}function u(d,h=!0,f,p){if(h&&YT("before",d),f)HC(d,f,p);else for(const m of i.values())HC(d,m.store.getState());h&&YT("after",d)}return{loop:a,invalidate:l,advance:u}}function YM(){const i=q.useContext(jM);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function Mn(i=n=>n,e){return YM()(i,e)}function c_(i,e=0){const n=YM(),r=n.getState().internal.subscribe,s=OU(i);return DE(()=>r(s,e,n),[e,r,n]),null}function UU(i,e){return function(n,...r){const s=new n;return i&&i(s),Promise.all(r.map(a=>new Promise((l,u)=>s.load(a,d=>{d.scene&&Object.assign(d,b9(d.scene)),l(d)},e,d=>u(new Error(`Could not load ${a}: ${d.message})`))))))}}function ku(i,e,n,r){const s=Array.isArray(e)?e:[e],a=_9(UU(n,r),[i,...s],{equal:Ui.equ});return Array.isArray(e)?a:a[0]}ku.preload=function(i,e,n){const r=Array.isArray(e)?e:[e];return T9(UU(n),[i,...r])};ku.clear=function(i,e){const n=Array.isArray(e)?e:[e];return v9([i,...n])};const Kg=new Map,{invalidate:dk,advance:fk}=N9(Kg),{reconciler:dE,applyProps:Wf}=E9(Kg,C9),rg={objects:"shallow",strict:!1},k9=(i,e)=>{const n=typeof i=="function"?i(e):i;return FU(n)?n:new O$({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...i})};function P9(i,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:n,height:r,top:s,left:a}=i.parentElement.getBoundingClientRect();return{width:n,height:r,top:s,left:a}}else if(typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function D9(i){const e=Kg.get(i),n=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,a=r||M9(dk,fk),l=n||dE.createContainer(a,Cg.ConcurrentRoot,null,!1,null,"",s,null);e||Kg.set(i,{fiber:l,store:a});let u,d=!1,h;return{configure(f={}){let{gl:p,size:m,scene:v,events:y,onCreated:$,shadows:E=!1,linear:S=!1,flat:A=!1,legacy:C=!1,orthographic:x=!1,frameloop:I="always",dpr:O=[1,2],performance:F,raycaster:k,camera:D,onPointerMissed:U}=f,ce=a.getState(),re=ce.gl;ce.gl||ce.set({gl:re=k9(p,i)});let ae=ce.raycaster;ae||ce.set({raycaster:ae=new ho});const{params:ne,...de}=k||{};if(Ui.equ(de,ae,rg)||Wf(ae,{...de}),Ui.equ(ne,ae.params,rg)||Wf(ae,{params:{...ae.params,...ne}}),!ce.camera||ce.camera===h&&!Ui.equ(h,D,rg)){h=D;const se=D instanceof $E,Y=se?D:x?new sa(0,0,0,0,.1,1e3):new Gi(75,0,.1,1e3);se||(Y.position.z=5,D&&Wf(Y,D),!ce.camera&&!(D!=null&&D.rotation)&&Y.lookAt(0,0,0)),ce.set({camera:Y})}if(!ce.scene){let se;v instanceof Yg?se=v:(se=new Yg,v&&Wf(se,v)),ce.set({scene:og(se)})}if(!ce.xr){const se=(fe,Ae)=>{const Ce=a.getState();Ce.frameloop!=="never"&&fk(fe,!0,Ce,Ae)},Y=()=>{const fe=a.getState();fe.gl.xr.enabled=fe.gl.xr.isPresenting,fe.gl.xr.setAnimationLoop(fe.gl.xr.isPresenting?se:null),fe.gl.xr.isPresenting||dk(fe)},me={connect(){const fe=a.getState().gl;fe.xr.addEventListener("sessionstart",Y),fe.xr.addEventListener("sessionend",Y)},disconnect(){const fe=a.getState().gl;fe.xr.removeEventListener("sessionstart",Y),fe.xr.removeEventListener("sessionend",Y)}};re.xr&&me.connect(),ce.set({xr:me})}if(re.shadowMap){const se=re.shadowMap.enabled,Y=re.shadowMap.type;if(re.shadowMap.enabled=!!E,Ui.boo(E))re.shadowMap.type=xv;else if(Ui.str(E)){var ue;const me={basic:NB,percentage:S$,soft:xv,variance:wl};re.shadowMap.type=(ue=me[E])!=null?ue:xv}else Ui.obj(E)&&Object.assign(re.shadowMap,E);(se!==re.shadowMap.enabled||Y!==re.shadowMap.type)&&(re.shadowMap.needsUpdate=!0)}const Re=MU();Re&&("enabled"in Re?Re.enabled=!C:"legacyMode"in Re&&(Re.legacyMode=C));const G=S?C$:Rc,Z=A?kl:iM;re.outputEncoding!==G&&(re.outputEncoding=G),re.toneMapping!==Z&&(re.toneMapping=Z),ce.legacy!==C&&ce.set(()=>({legacy:C})),ce.linear!==S&&ce.set(()=>({linear:S})),ce.flat!==A&&ce.set(()=>({flat:A})),p&&!Ui.fun(p)&&!FU(p)&&!Ui.equ(p,re,rg)&&Wf(re,p),y&&!ce.events.handlers&&ce.set({events:y(a)});const K=P9(i,m);return Ui.equ(K,ce.size,rg)||ce.setSize(K.width,K.height,K.updateStyle,K.top,K.left),O&&ce.viewport.dpr!==kU(O)&&ce.setDpr(O),ce.frameloop!==I&&ce.setFrameloop(I),ce.onPointerMissed||ce.set({onPointerMissed:U}),F&&!Ui.equ(F,ce.performance,rg)&&ce.set(se=>({performance:{...se.performance,...F}})),u=$,d=!0,this},render(f){return d||this.configure(),dE.updateContainer(q.createElement(B9,{store:a,children:f,onCreated:u,rootElement:i}),l,null,()=>{}),a},unmount(){GU(i)}}}function B9({store:i,children:e,onCreated:n,rootElement:r}){return DE(()=>{const s=i.getState();s.set(a=>({internal:{...a.internal,active:!0}})),n&&n(s),i.getState().events.connected||s.events.connect==null||s.events.connect(r)},[]),q.createElement(jM.Provider,{value:i},e)}function GU(i,e){const n=Kg.get(i),r=n==null?void 0:n.fiber;if(r){const s=n==null?void 0:n.store.getState();s&&(s.internal.active=!1),dE.updateContainer(null,r,null,()=>{s&&setTimeout(()=>{try{var a,l,u,d;s.events.disconnect==null||s.events.disconnect(),(a=s.gl)==null||(l=a.renderLists)==null||l.dispose==null||l.dispose(),(u=s.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(d=s.gl)!=null&&d.xr&&s.xr.disconnect(),A9(s),Kg.delete(i),e&&e(i)}catch{}},500)})}}function F9(i,e,n){return q.createElement(U9,{key:e.uuid,children:i,container:e,state:n})}function U9({state:i={},children:e,container:n}){const{events:r,size:s,...a}=i,l=YM(),[u]=q.useState(()=>new ho),[d]=q.useState(()=>new mt),h=q.useCallback((p,m)=>{const v={...p};Object.keys(p).forEach($=>{(w9.includes($)||p[$]!==m[$]&&m[$])&&delete v[$]});let y;if(m&&s){const $=m.camera;y=p.viewport.getCurrentViewport($,new ie,s),$!==p.camera&&DU($,s)}return{...v,scene:n,raycaster:u,pointer:d,mouse:d,previousRoot:l,events:{...p.events,...m==null?void 0:m.events,...r},size:{...p.size,...s},viewport:{...p.viewport,...y},...a}},[i]),[f]=q.useState(()=>{const p=l.getState();return $U((v,y)=>({...p,scene:n,raycaster:u,pointer:d,mouse:d,previousRoot:l,events:{...p.events,...r},size:{...p.size,...s},...a,set:v,get:y,setEvents:$=>v(E=>({...E,events:{...E.events,...$}}))}))});return q.useEffect(()=>{const p=l.subscribe(m=>f.setState(v=>h(m,v)));return()=>{p(),f.destroy()}},[]),q.useEffect(()=>{f.setState(p=>h(l.getState(),p))},[h]),q.createElement(q.Fragment,null,dE.createPortal(q.createElement(jM.Provider,{value:f},e),f,null))}dE.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:q.version});function Xa(){return Xa=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},Xa.apply(null,arguments)}function Xx(i,e,n){var r,s,a,l,u;e==null&&(e=100);function d(){var f=Date.now()-l;f<e&&f>=0?r=setTimeout(d,e-f):(r=null,n||(u=i.apply(a,s),a=s=null))}var h=function(){a=this,s=arguments,l=Date.now();var f=n&&!r;return r||(r=setTimeout(d,e)),f&&(u=i.apply(a,s),a=s=null),u};return h.clear=function(){r&&(clearTimeout(r),r=null)},h.flush=function(){r&&(u=i.apply(a,s),a=s=null,clearTimeout(r),r=null)},h}Xx.debounce=Xx;var G9=Xx;const pk=pd(G9);function H9(i){let{debounce:e,scroll:n,polyfill:r,offsetSize:s}=i===void 0?{debounce:0,scroll:!1,offsetSize:!1}:i;const a=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[l,u]=q.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=q.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),h=e?typeof e=="number"?e:e.scroll:null,f=e?typeof e=="number"?e:e.resize:null,p=q.useRef(!1);q.useEffect(()=>(p.current=!0,()=>void(p.current=!1)));const[m,v,y]=q.useMemo(()=>{const A=()=>{if(!d.current.element)return;const{left:C,top:x,width:I,height:O,bottom:F,right:k,x:D,y:U}=d.current.element.getBoundingClientRect(),ce={left:C,top:x,width:I,height:O,bottom:F,right:k,x:D,y:U};d.current.element instanceof HTMLElement&&s&&(ce.height=d.current.element.offsetHeight,ce.width=d.current.element.offsetWidth),Object.freeze(ce),p.current&&!X9(d.current.lastBounds,ce)&&u(d.current.lastBounds=ce)};return[A,f?pk(A,f):A,h?pk(A,h):A]},[u,s,h,f]);function $(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",y,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null)}function E(){d.current.element&&(d.current.resizeObserver=new a(y),d.current.resizeObserver.observe(d.current.element),n&&d.current.scrollContainers&&d.current.scrollContainers.forEach(A=>A.addEventListener("scroll",y,{capture:!0,passive:!0})))}const S=A=>{!A||A===d.current.element||($(),d.current.element=A,d.current.scrollContainers=HU(A),E())};return z9(y,!!n),V9(v),q.useEffect(()=>{$(),E()},[n,y,v]),q.useEffect(()=>$,[]),[S,l,m]}function V9(i){q.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function z9(i,e){q.useEffect(()=>{if(e){const n=i;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[i,e])}function HU(i){const e=[];if(!i||i===document.body)return e;const{overflow:n,overflowX:r,overflowY:s}=window.getComputedStyle(i);return[n,r,s].some(a=>a==="auto"||a==="scroll")&&e.push(i),[...e,...HU(i.parentElement)]}const W9=["x","y","top","bottom","left","right","width","height"],X9=(i,e)=>W9.every(n=>i[n]===e[n]);var j9=Object.defineProperty,Y9=Object.defineProperties,K9=Object.getOwnPropertyDescriptors,mk=Object.getOwnPropertySymbols,J9=Object.prototype.hasOwnProperty,Z9=Object.prototype.propertyIsEnumerable,gk=(i,e,n)=>e in i?j9(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,_k=(i,e)=>{for(var n in e||(e={}))J9.call(e,n)&&gk(i,n,e[n]);if(mk)for(var n of mk(e))Z9.call(e,n)&&gk(i,n,e[n]);return i},q9=(i,e)=>Y9(i,K9(e)),Tk,vk;typeof window<"u"&&((Tk=window.document)!=null&&Tk.createElement||((vk=window.navigator)==null?void 0:vk.product)==="ReactNative")?q.useLayoutEffect:q.useEffect;function VU(i,e,n){if(!i)return;if(n(i)===!0)return i;let r=e?i.return:i.child;for(;r;){const s=VU(r,e,n);if(s)return s;r=e?null:r.sibling}}function zU(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const Ek=console.error;console.error=function(){const i=[...arguments].join("");if(i!=null&&i.startsWith("Warning:")&&i.includes("useContext")){console.error=Ek;return}return Ek.apply(this,arguments)};const KM=zU(q.createContext(null));class WU extends q.Component{render(){return q.createElement(KM.Provider,{value:this._reactInternals},this.props.children)}}function Q9(){const i=q.useContext(KM);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=q.useId();return q.useMemo(()=>{for(const r of[i,i==null?void 0:i.alternate]){if(!r)continue;const s=VU(r,!1,a=>{let l=a.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(s)return s}},[i,e])}function eY(){const i=Q9(),[e]=q.useState(()=>new Map);e.clear();let n=i;for(;n;){if(n.type&&typeof n.type=="object"){const s=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;s&&s!==KM&&!e.has(s)&&e.set(s,q.useContext(zU(s)))}n=n.return}return e}function tY(){const i=eY();return q.useMemo(()=>Array.from(i.keys()).reduce((e,n)=>r=>q.createElement(e,null,q.createElement(n.Provider,q9(_k({},r),{value:i.get(n)}))),e=>q.createElement(WU,_k({},e))),[i])}const VC={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function nY(i){const{handlePointer:e}=x9(i);return{priority:1,enabled:!0,compute(n,r,s){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(VC).reduce((n,r)=>({...n,[r]:e(r)}),{}),update:()=>{var n;const{events:r,internal:s}=i.getState();(n=s.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(s.lastEvent.current)},connect:n=>{var r;const{set:s,events:a}=i.getState();a.disconnect==null||a.disconnect(),s(l=>({events:{...l.events,connected:n}})),Object.entries((r=a.handlers)!=null?r:[]).forEach(([l,u])=>{const[d,h]=VC[l];n.addEventListener(d,u,{passive:h})})},disconnect:()=>{const{set:n,events:r}=i.getState();if(r.connected){var s;Object.entries((s=r.handlers)!=null?s:[]).forEach(([a,l])=>{if(r&&r.connected instanceof HTMLElement){const[u]=VC[a];r.connected.removeEventListener(u,l)}}),n(a=>({events:{...a.events,connected:void 0}}))}}}}const iY=q.forwardRef(function({children:e,fallback:n,resize:r,style:s,gl:a,events:l=nY,eventSource:u,eventPrefix:d,shadows:h,linear:f,flat:p,legacy:m,orthographic:v,frameloop:y,dpr:$,performance:E,raycaster:S,camera:A,onPointerMissed:C,onCreated:x,...I},O){q.useMemo(()=>wU(c9),[]);const F=tY(),[k,D]=H9({scroll:!0,debounce:{scroll:50,resize:0},...r}),U=q.useRef(null),ce=q.useRef(null);q.useImperativeHandle(O,()=>U.current);const re=OU(C),[ae,ne]=q.useState(!1),[de,ue]=q.useState(!1);if(ae)throw ae;if(de)throw de;const Re=q.useRef(null);DE(()=>{const Z=U.current;D.width>0&&D.height>0&&Z&&(Re.current||(Re.current=D9(Z)),Re.current.configure({gl:a,events:l,shadows:h,linear:f,flat:p,legacy:m,orthographic:v,frameloop:y,dpr:$,performance:E,raycaster:S,camera:A,size:D,onPointerMissed:(...K)=>re.current==null?void 0:re.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(u?y9(u)?u.current:u:ce.current),d&&K.setEvents({compute:(se,Y)=>{const me=se[d+"X"],fe=se[d+"Y"];Y.pointer.set(me/Y.size.width*2-1,-(fe/Y.size.height)*2+1),Y.raycaster.setFromCamera(Y.pointer,Y.camera)}}),x==null||x(K)}}),Re.current.render(q.createElement(F,null,q.createElement(LU,{set:ue},q.createElement(q.Suspense,{fallback:q.createElement(S9,{set:ne})},e)))))}),q.useEffect(()=>{const Z=U.current;if(Z)return()=>GU(Z)},[]);const G=u?"none":"auto";return q.createElement("div",Xa({ref:ce,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:G,...s}},I),q.createElement("div",{ref:k,style:{width:"100%",height:"100%"}},q.createElement("canvas",{ref:U,style:{display:"block"}},n)))}),Ka=q.forwardRef(function(e,n){return q.createElement(WU,null,q.createElement(iY,Xa({},e,{ref:n})))}),BE=new ie,JM=new ie,rY=new ie,yk=new mt;function sY(i,e,n){const r=BE.setFromMatrixPosition(i.matrixWorld);r.project(e);const s=n.width/2,a=n.height/2;return[r.x*s+s,-(r.y*a)+a]}function oY(i,e){const n=BE.setFromMatrixPosition(i.matrixWorld),r=JM.setFromMatrixPosition(e.matrixWorld),s=n.sub(r),a=e.getWorldDirection(rY);return s.angleTo(a)>Math.PI/2}function aY(i,e,n,r){const s=BE.setFromMatrixPosition(i.matrixWorld),a=s.clone();a.project(e),yk.set(a.x,a.y),n.setFromCamera(yk,e);const l=n.intersectObjects(r,!0);if(l.length){const u=l[0].distance;return s.distanceTo(n.ray.origin)<u}return!0}function lY(i,e){if(e instanceof sa)return e.zoom;if(e instanceof Gi){const n=BE.setFromMatrixPosition(i.matrixWorld),r=JM.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(s/2)*a)}else return 1}function cY(i,e,n){if(e instanceof Gi||e instanceof sa){const r=BE.setFromMatrixPosition(i.matrixWorld),s=JM.setFromMatrixPosition(e.matrixWorld),a=r.distanceTo(s),l=(n[1]-n[0])/(e.far-e.near),u=n[1]-l*e.far;return Math.round(l*a+u)}}const jx=i=>Math.abs(i)<1e-10?0:i;function XU(i,e,n=""){let r="matrix3d(";for(let s=0;s!==16;s++)r+=jx(e[s]*i.elements[s])+(s!==15?",":")");return n+r}const uY=(i=>e=>XU(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),hY=(i=>(e,n)=>XU(e,i(n),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function dY(i){return i&&typeof i=="object"&&"current"in i}const fY=q.forwardRef(({children:i,eps:e=.001,style:n,className:r,prepend:s,center:a,fullscreen:l,portal:u,distanceFactor:d,sprite:h=!1,transform:f=!1,occlude:p,onOcclude:m,castShadow:v,receiveShadow:y,material:$,geometry:E,zIndexRange:S=[16777271,0],calculatePosition:A=sY,as:C="div",wrapperClass:x,pointerEvents:I="auto",...O},F)=>{const{gl:k,camera:D,scene:U,size:ce,raycaster:re,events:ae,viewport:ne}=Mn(),[de]=q.useState(()=>document.createElement(C)),ue=q.useRef(),Re=q.useRef(null),G=q.useRef(0),Z=q.useRef([0,0]),K=q.useRef(null),se=q.useRef(null),Y=(u==null?void 0:u.current)||ae.connected||k.domElement.parentNode,me=q.useRef(null),fe=q.useRef(!1),Ae=q.useMemo(()=>p&&p!=="blending"||Array.isArray(p)&&p.length&&dY(p[0]),[p]);q.useLayoutEffect(()=>{const Ye=k.domElement;p&&p==="blending"?(Ye.style.zIndex=`${Math.floor(S[0]/2)}`,Ye.style.position="absolute",Ye.style.pointerEvents="none"):(Ye.style.zIndex=null,Ye.style.position=null,Ye.style.pointerEvents=null)},[p]),q.useLayoutEffect(()=>{if(Re.current){const Ye=ue.current=xB(de);if(U.updateMatrixWorld(),f)de.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const we=A(Re.current,D,ce);de.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${we[0]}px,${we[1]}px,0);transform-origin:0 0;`}return Y&&(s?Y.prepend(de):Y.appendChild(de)),()=>{Y&&Y.removeChild(de),Ye.unmount()}}},[Y,f]),q.useLayoutEffect(()=>{x&&(de.className=x)},[x]);const Ce=q.useMemo(()=>f?{position:"absolute",top:0,left:0,width:ce.width,height:ce.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:a?"translate3d(-50%,-50%,0)":"none",...l&&{top:-ce.height/2,left:-ce.width/2,width:ce.width,height:ce.height},...n},[n,a,l,ce,f]),Ie=q.useMemo(()=>({position:"absolute",pointerEvents:I}),[I]);q.useLayoutEffect(()=>{if(fe.current=!1,f){var Ye;(Ye=ue.current)==null||Ye.render(q.createElement("div",{ref:K,style:Ce},q.createElement("div",{ref:se,style:Ie},q.createElement("div",{ref:F,className:r,style:n,children:i}))))}else{var we;(we=ue.current)==null||we.render(q.createElement("div",{ref:F,style:Ce,className:r,children:i}))}});const We=q.useRef(!0);c_(Ye=>{if(Re.current){D.updateMatrixWorld(),Re.current.updateWorldMatrix(!0,!1);const we=f?Z.current:A(Re.current,D,ce);if(f||Math.abs(G.current-D.zoom)>e||Math.abs(Z.current[0]-we[0])>e||Math.abs(Z.current[1]-we[1])>e){const Q=oY(Re.current,D);let Ge=!1;Ae&&(Array.isArray(p)?Ge=p.map(tt=>tt.current):p!=="blending"&&(Ge=[U]));const Oe=We.current;if(Ge){const tt=aY(Re.current,D,re,Ge);We.current=tt&&!Q}else We.current=!Q;Oe!==We.current&&(m?m(!We.current):de.style.display=We.current?"block":"none");const Ve=Math.floor(S[0]/2),Fe=p?Ae?[S[0],Ve]:[Ve-1,0]:S;if(de.style.zIndex=`${cY(Re.current,D,Fe)}`,f){const[tt,Ue]=[ce.width/2,ce.height/2],Je=D.projectionMatrix.elements[5]*Ue,{isOrthographicCamera:ve,top:Me,left:vt,bottom:oe,right:ee}=D,W=uY(D.matrixWorldInverse),ot=ve?`scale(${Je})translate(${jx(-(ee+vt)/2)}px,${jx((Me+oe)/2)}px)`:`translateZ(${Je}px)`;let je=Re.current.matrixWorld;h&&(je=D.matrixWorldInverse.clone().transpose().copyPosition(je).scale(Re.current.scale),je.elements[3]=je.elements[7]=je.elements[11]=0,je.elements[15]=1),de.style.width=ce.width+"px",de.style.height=ce.height+"px",de.style.perspective=ve?"":`${Je}px`,K.current&&se.current&&(K.current.style.transform=`${ot}${W}translate(${tt}px,${Ue}px)`,se.current.style.transform=hY(je,1/((d||10)/400)))}else{const tt=d===void 0?1:lY(Re.current,D)*d;de.style.transform=`translate3d(${we[0]}px,${we[1]}px,0) scale(${tt})`}Z.current=we,G.current=D.zoom}}if(!Ae&&me.current&&!fe.current)if(f){if(K.current){const we=K.current.children[0];if(we!=null&&we.clientWidth&&we!=null&&we.clientHeight){const{isOrthographicCamera:Q}=D;if(Q||E)O.scale&&(Array.isArray(O.scale)?O.scale instanceof ie?me.current.scale.copy(O.scale.clone().divideScalar(1)):me.current.scale.set(1/O.scale[0],1/O.scale[1],1/O.scale[2]):me.current.scale.setScalar(1/O.scale));else{const Ge=(d||10)/400,Oe=we.clientWidth*Ge,Ve=we.clientHeight*Ge;me.current.scale.set(Oe,Ve,1)}fe.current=!0}}}else{const we=de.children[0];if(we!=null&&we.clientWidth&&we!=null&&we.clientHeight){const Q=1/ne.factor,Ge=we.clientWidth*Q,Oe=we.clientHeight*Q;me.current.scale.set(Ge,Oe,1),fe.current=!0}me.current.lookAt(Ye.camera.position)}});const ut=q.useMemo(()=>({vertexShader:f?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[f]);return q.createElement("group",Xa({},O,{ref:Re}),p&&!Ae&&q.createElement("mesh",{castShadow:v,receiveShadow:y,ref:me},E||q.createElement("planeGeometry",null),$||q.createElement("shaderMaterial",{side:$s,vertexShader:ut.vertexShader,fragmentShader:ut.fragmentShader})))}),jU=parseInt(Ip.replace(/\D+/g,"")),YU=jU>=125?"uv1":"uv2";function Sk(i,e){if(e===fM)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===bp||e===yE){let n=i.getIndex();if(n===null){const l=[],u=i.getAttribute("position");if(u!==void 0){for(let d=0;d<u.count;d++)l.push(d);i.setIndex(l),n=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const r=n.count-2,s=[];if(n)if(e===bp)for(let l=1;l<=r;l++)s.push(n.getX(0)),s.push(n.getX(l)),s.push(n.getX(l+1));else for(let l=0;l<r;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=i.clone();return a.setIndex(s),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var Fa=Uint8Array,jh=Uint16Array,Yx=Uint32Array,KU=new Fa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),JU=new Fa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pY=new Fa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ZU=function(i,e){for(var n=new jh(31),r=0;r<31;++r)n[r]=e+=1<<i[r-1];for(var s=new Yx(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)s[a]=a-n[r]<<5|r;return[n,s]},qU=ZU(KU,2),QU=qU[0],mY=qU[1];QU[28]=258,mY[258]=28;var gY=ZU(JU,0),_Y=gY[0],Kx=new jh(32768);for(var Hi=0;Hi<32768;++Hi){var Ph=(Hi&43690)>>>1|(Hi&21845)<<1;Ph=(Ph&52428)>>>2|(Ph&13107)<<2,Ph=(Ph&61680)>>>4|(Ph&3855)<<4,Kx[Hi]=((Ph&65280)>>>8|(Ph&255)<<8)>>>1}var Lv=function(i,e,n){for(var r=i.length,s=0,a=new jh(e);s<r;++s)++a[i[s]-1];var l=new jh(e);for(s=0;s<e;++s)l[s]=l[s-1]+a[s-1]<<1;var u;if(n){u=new jh(1<<e);var d=15-e;for(s=0;s<r;++s)if(i[s])for(var h=s<<4|i[s],f=e-i[s],p=l[i[s]-1]++<<f,m=p|(1<<f)-1;p<=m;++p)u[Kx[p]>>>d]=h}else for(u=new jh(r),s=0;s<r;++s)i[s]&&(u[s]=Kx[l[i[s]-1]++]>>>15-i[s]);return u},FE=new Fa(288);for(var Hi=0;Hi<144;++Hi)FE[Hi]=8;for(var Hi=144;Hi<256;++Hi)FE[Hi]=9;for(var Hi=256;Hi<280;++Hi)FE[Hi]=7;for(var Hi=280;Hi<288;++Hi)FE[Hi]=8;var e2=new Fa(32);for(var Hi=0;Hi<32;++Hi)e2[Hi]=5;var TY=Lv(FE,9,1),vY=Lv(e2,5,1),zC=function(i){for(var e=i[0],n=1;n<i.length;++n)i[n]>e&&(e=i[n]);return e},Cl=function(i,e,n){var r=e/8|0;return(i[r]|i[r+1]<<8)>>(e&7)&n},WC=function(i,e){var n=e/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(e&7)},EY=function(i){return(i/8|0)+(i&7&&1)},yY=function(i,e,n){(e==null||e<0)&&(e=0),(n==null||n>i.length)&&(n=i.length);var r=new(i instanceof jh?jh:i instanceof Yx?Yx:Fa)(n-e);return r.set(i.subarray(e,n)),r},SY=function(i,e,n){var r=i.length;if(!r||n&&!n.l&&r<5)return e||new Fa(0);var s=!e||n,a=!n||n.i;n||(n={}),e||(e=new Fa(r*3));var l=function(Ce){var Ie=e.length;if(Ce>Ie){var We=new Fa(Math.max(Ie*2,Ce));We.set(e),e=We}},u=n.f||0,d=n.p||0,h=n.b||0,f=n.l,p=n.d,m=n.m,v=n.n,y=r*8;do{if(!f){n.f=u=Cl(i,d,1);var $=Cl(i,d+1,3);if(d+=3,$)if($==1)f=TY,p=vY,m=9,v=5;else if($==2){var C=Cl(i,d,31)+257,x=Cl(i,d+10,15)+4,I=C+Cl(i,d+5,31)+1;d+=14;for(var O=new Fa(I),F=new Fa(19),k=0;k<x;++k)F[pY[k]]=Cl(i,d+k*3,7);d+=x*3;for(var D=zC(F),U=(1<<D)-1,ce=Lv(F,D,1),k=0;k<I;){var re=ce[Cl(i,d,U)];d+=re&15;var E=re>>>4;if(E<16)O[k++]=E;else{var ae=0,ne=0;for(E==16?(ne=3+Cl(i,d,3),d+=2,ae=O[k-1]):E==17?(ne=3+Cl(i,d,7),d+=3):E==18&&(ne=11+Cl(i,d,127),d+=7);ne--;)O[k++]=ae}}var de=O.subarray(0,C),ue=O.subarray(C);m=zC(de),v=zC(ue),f=Lv(de,m,1),p=Lv(ue,v,1)}else throw"invalid block type";else{var E=EY(d)+4,S=i[E-4]|i[E-3]<<8,A=E+S;if(A>r){if(a)throw"unexpected EOF";break}s&&l(h+S),e.set(i.subarray(E,A),h),n.b=h+=S,n.p=d=A*8;continue}if(d>y){if(a)throw"unexpected EOF";break}}s&&l(h+131072);for(var Re=(1<<m)-1,G=(1<<v)-1,Z=d;;Z=d){var ae=f[WC(i,d)&Re],K=ae>>>4;if(d+=ae&15,d>y){if(a)throw"unexpected EOF";break}if(!ae)throw"invalid length/literal";if(K<256)e[h++]=K;else if(K==256){Z=d,f=null;break}else{var se=K-254;if(K>264){var k=K-257,Y=KU[k];se=Cl(i,d,(1<<Y)-1)+QU[k],d+=Y}var me=p[WC(i,d)&G],fe=me>>>4;if(!me)throw"invalid distance";d+=me&15;var ue=_Y[fe];if(fe>3){var Y=JU[fe];ue+=WC(i,d)&(1<<Y)-1,d+=Y}if(d>y){if(a)throw"unexpected EOF";break}s&&l(h+131072);for(var Ae=h+se;h<Ae;h+=4)e[h]=e[h-ue],e[h+1]=e[h+1-ue],e[h+2]=e[h+2-ue],e[h+3]=e[h+3-ue];h=Ae}}n.l=f,n.p=Z,n.b=h,f&&(u=1,n.m=m,n.d=p,n.n=v)}while(!u);return h==e.length?e:yY(e,0,h)},$Y=new Fa(0),bY=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function B0(i,e){return SY((bY(i),i.subarray(2,-4)),e)}var AY=typeof TextDecoder<"u"&&new TextDecoder,CY=0;try{AY.decode($Y,{stream:!0}),CY=1}catch{}const RY=i=>i&&i.isCubeTexture;class xY extends Bn{constructor(e,n){var r,s;const a=RY(e),u=((s=a?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?s:1024)/4,d=Math.floor(Math.log2(u)),h=Math.pow(2,d),f=3*Math.max(h,16*7),p=4*h,m=[a?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/f}`,`#define CUBEUV_TEXEL_HEIGHT ${1/p}`,`#define CUBEUV_MAX_MIP ${d}.0`],v=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,y=m.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(Ip.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,$={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},E=new o_(1,16),S=new wo({uniforms:$,fragmentShader:y,vertexShader:v,side:$s});super(E,S)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var wY=Object.defineProperty,MY=(i,e,n)=>e in i?wY(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,gn=(i,e,n)=>(MY(i,typeof e!="symbol"?e+"":e,n),n);const F0=new Op,$k=new yu,IY=Math.cos(70*(Math.PI/180)),bk=(i,e)=>(i%e+e)%e;let OY=class extends Mc{constructor(e,n){super(),gn(this,"object"),gn(this,"domElement"),gn(this,"enabled",!0),gn(this,"target",new ie),gn(this,"minDistance",0),gn(this,"maxDistance",1/0),gn(this,"minZoom",0),gn(this,"maxZoom",1/0),gn(this,"minPolarAngle",0),gn(this,"maxPolarAngle",Math.PI),gn(this,"minAzimuthAngle",-1/0),gn(this,"maxAzimuthAngle",1/0),gn(this,"enableDamping",!1),gn(this,"dampingFactor",.05),gn(this,"enableZoom",!0),gn(this,"zoomSpeed",1),gn(this,"enableRotate",!0),gn(this,"rotateSpeed",1),gn(this,"enablePan",!0),gn(this,"panSpeed",1),gn(this,"screenSpacePanning",!0),gn(this,"keyPanSpeed",7),gn(this,"zoomToCursor",!1),gn(this,"autoRotate",!1),gn(this,"autoRotateSpeed",2),gn(this,"reverseOrbit",!1),gn(this,"reverseHorizontalOrbit",!1),gn(this,"reverseVerticalOrbit",!1),gn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),gn(this,"mouseButtons",{LEFT:Uf.ROTATE,MIDDLE:Uf.DOLLY,RIGHT:Uf.PAN}),gn(this,"touches",{ONE:Gf.ROTATE,TWO:Gf.DOLLY_PAN}),gn(this,"target0"),gn(this,"position0"),gn(this,"zoom0"),gn(this,"_domElementKeyEvents",null),gn(this,"getPolarAngle"),gn(this,"getAzimuthalAngle"),gn(this,"setPolarAngle"),gn(this,"setAzimuthalAngle"),gn(this,"getDistance"),gn(this,"getZoomScale"),gn(this,"listenToKeyEvents"),gn(this,"stopListenToKeyEvents"),gn(this,"saveState"),gn(this,"reset"),gn(this,"update"),gn(this,"connect"),gn(this,"dispose"),gn(this,"dollyIn"),gn(this,"dollyOut"),gn(this,"getScale"),gn(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=z=>{let be=bk(z,2*Math.PI),nt=f.phi;nt<0&&(nt+=2*Math.PI),be<0&&(be+=2*Math.PI);let Ee=Math.abs(be-nt);2*Math.PI-Ee<Ee&&(be<nt?be+=2*Math.PI:nt+=2*Math.PI),p.phi=be-nt,r.update()},this.setAzimuthalAngle=z=>{let be=bk(z,2*Math.PI),nt=f.theta;nt<0&&(nt+=2*Math.PI),be<0&&(be+=2*Math.PI);let Ee=Math.abs(be-nt);2*Math.PI-Ee<Ee&&(be<nt?be+=2*Math.PI:nt+=2*Math.PI),p.theta=be-nt,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=z=>{z.addEventListener("keydown",Qe),this._domElementKeyEvents=z},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Qe),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(s),r.update(),d=u.NONE},this.update=(()=>{const z=new ie,be=new ie(0,1,0),nt=new Er().setFromUnitVectors(e.up,be),Ee=nt.clone().invert(),Le=new ie,Be=new Er,N=2*Math.PI;return function(){const ge=r.object.position;nt.setFromUnitVectors(e.up,be),Ee.copy(nt).invert(),z.copy(ge).sub(r.target),z.applyQuaternion(nt),f.setFromVector3(z),r.autoRotate&&d===u.NONE&&ne(re()),r.enableDamping?(f.theta+=p.theta*r.dampingFactor,f.phi+=p.phi*r.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let xe=r.minAzimuthAngle,Ke=r.maxAzimuthAngle;isFinite(xe)&&isFinite(Ke)&&(xe<-Math.PI?xe+=N:xe>Math.PI&&(xe-=N),Ke<-Math.PI?Ke+=N:Ke>Math.PI&&(Ke-=N),xe<=Ke?f.theta=Math.max(xe,Math.min(Ke,f.theta)):f.theta=f.theta>(xe+Ke)/2?Math.max(xe,f.theta):Math.min(Ke,f.theta)),f.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,f.phi)),f.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(v,r.dampingFactor):r.target.add(v),r.zoomToCursor&&D||r.object.isOrthographicCamera?f.radius=me(f.radius):f.radius=me(f.radius*m),z.setFromSpherical(f),z.applyQuaternion(Ee),ge.copy(r.target).add(z),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,v.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),v.set(0,0,0));let gt=!1;if(r.zoomToCursor&&D){let $t=null;if(r.object instanceof Gi&&r.object.isPerspectiveCamera){const un=z.length();$t=me(un*m);const an=un-$t;r.object.position.addScaledVector(F,an),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const un=new ie(k.x,k.y,0);un.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix(),gt=!0;const an=new ie(k.x,k.y,0);an.unproject(r.object),r.object.position.sub(an).add(un),r.object.updateMatrixWorld(),$t=z.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;$t!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar($t).add(r.object.position):(F0.origin.copy(r.object.position),F0.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(F0.direction))<IY?e.lookAt(r.target):($k.setFromNormalAndCoplanarPoint(r.object.up,r.target),F0.intersectPlane($k,r.target))))}else r.object instanceof sa&&r.object.isOrthographicCamera&&(gt=m!==1,gt&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix()));return m=1,D=!1,gt||Le.distanceToSquared(r.object.position)>h||8*(1-Be.dot(r.object.quaternion))>h?(r.dispatchEvent(s),Le.copy(r.object.position),Be.copy(r.object.quaternion),gt=!1,!0):!1}})(),this.connect=z=>{r.domElement=z,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",He),r.domElement.addEventListener("pointerdown",vt),r.domElement.addEventListener("pointercancel",ee),r.domElement.addEventListener("wheel",je)},this.dispose=()=>{var z,be,nt,Ee,Le,Be;r.domElement&&(r.domElement.style.touchAction="auto"),(z=r.domElement)==null||z.removeEventListener("contextmenu",He),(be=r.domElement)==null||be.removeEventListener("pointerdown",vt),(nt=r.domElement)==null||nt.removeEventListener("pointercancel",ee),(Ee=r.domElement)==null||Ee.removeEventListener("wheel",je),(Le=r.domElement)==null||Le.ownerDocument.removeEventListener("pointermove",oe),(Be=r.domElement)==null||Be.ownerDocument.removeEventListener("pointerup",ee),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Qe)};const r=this,s={type:"change"},a={type:"start"},l={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=u.NONE;const h=1e-6,f=new Vx,p=new Vx;let m=1;const v=new ie,y=new mt,$=new mt,E=new mt,S=new mt,A=new mt,C=new mt,x=new mt,I=new mt,O=new mt,F=new ie,k=new mt;let D=!1;const U=[],ce={};function re(){return 2*Math.PI/60/60*r.autoRotateSpeed}function ae(){return Math.pow(.95,r.zoomSpeed)}function ne(z){r.reverseOrbit||r.reverseHorizontalOrbit?p.theta+=z:p.theta-=z}function de(z){r.reverseOrbit||r.reverseVerticalOrbit?p.phi+=z:p.phi-=z}const ue=(()=>{const z=new ie;return function(nt,Ee){z.setFromMatrixColumn(Ee,0),z.multiplyScalar(-nt),v.add(z)}})(),Re=(()=>{const z=new ie;return function(nt,Ee){r.screenSpacePanning===!0?z.setFromMatrixColumn(Ee,1):(z.setFromMatrixColumn(Ee,0),z.crossVectors(r.object.up,z)),z.multiplyScalar(nt),v.add(z)}})(),G=(()=>{const z=new ie;return function(nt,Ee){const Le=r.domElement;if(Le&&r.object instanceof Gi&&r.object.isPerspectiveCamera){const Be=r.object.position;z.copy(Be).sub(r.target);let N=z.length();N*=Math.tan(r.object.fov/2*Math.PI/180),ue(2*nt*N/Le.clientHeight,r.object.matrix),Re(2*Ee*N/Le.clientHeight,r.object.matrix)}else Le&&r.object instanceof sa&&r.object.isOrthographicCamera?(ue(nt*(r.object.right-r.object.left)/r.object.zoom/Le.clientWidth,r.object.matrix),Re(Ee*(r.object.top-r.object.bottom)/r.object.zoom/Le.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function Z(z){r.object instanceof Gi&&r.object.isPerspectiveCamera||r.object instanceof sa&&r.object.isOrthographicCamera?m=z:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function K(z){Z(m/z)}function se(z){Z(m*z)}function Y(z){if(!r.zoomToCursor||!r.domElement)return;D=!0;const be=r.domElement.getBoundingClientRect(),nt=z.clientX-be.left,Ee=z.clientY-be.top,Le=be.width,Be=be.height;k.x=nt/Le*2-1,k.y=-(Ee/Be)*2+1,F.set(k.x,k.y,1).unproject(r.object).sub(r.object.position).normalize()}function me(z){return Math.max(r.minDistance,Math.min(r.maxDistance,z))}function fe(z){y.set(z.clientX,z.clientY)}function Ae(z){Y(z),x.set(z.clientX,z.clientY)}function Ce(z){S.set(z.clientX,z.clientY)}function Ie(z){$.set(z.clientX,z.clientY),E.subVectors($,y).multiplyScalar(r.rotateSpeed);const be=r.domElement;be&&(ne(2*Math.PI*E.x/be.clientHeight),de(2*Math.PI*E.y/be.clientHeight)),y.copy($),r.update()}function We(z){I.set(z.clientX,z.clientY),O.subVectors(I,x),O.y>0?K(ae()):O.y<0&&se(ae()),x.copy(I),r.update()}function ut(z){A.set(z.clientX,z.clientY),C.subVectors(A,S).multiplyScalar(r.panSpeed),G(C.x,C.y),S.copy(A),r.update()}function Ye(z){Y(z),z.deltaY<0?se(ae()):z.deltaY>0&&K(ae()),r.update()}function we(z){let be=!1;switch(z.code){case r.keys.UP:G(0,r.keyPanSpeed),be=!0;break;case r.keys.BOTTOM:G(0,-r.keyPanSpeed),be=!0;break;case r.keys.LEFT:G(r.keyPanSpeed,0),be=!0;break;case r.keys.RIGHT:G(-r.keyPanSpeed,0),be=!0;break}be&&(z.preventDefault(),r.update())}function Q(){if(U.length==1)y.set(U[0].pageX,U[0].pageY);else{const z=.5*(U[0].pageX+U[1].pageX),be=.5*(U[0].pageY+U[1].pageY);y.set(z,be)}}function Ge(){if(U.length==1)S.set(U[0].pageX,U[0].pageY);else{const z=.5*(U[0].pageX+U[1].pageX),be=.5*(U[0].pageY+U[1].pageY);S.set(z,be)}}function Oe(){const z=U[0].pageX-U[1].pageX,be=U[0].pageY-U[1].pageY,nt=Math.sqrt(z*z+be*be);x.set(0,nt)}function Ve(){r.enableZoom&&Oe(),r.enablePan&&Ge()}function Fe(){r.enableZoom&&Oe(),r.enableRotate&&Q()}function tt(z){if(U.length==1)$.set(z.pageX,z.pageY);else{const nt=he(z),Ee=.5*(z.pageX+nt.x),Le=.5*(z.pageY+nt.y);$.set(Ee,Le)}E.subVectors($,y).multiplyScalar(r.rotateSpeed);const be=r.domElement;be&&(ne(2*Math.PI*E.x/be.clientHeight),de(2*Math.PI*E.y/be.clientHeight)),y.copy($)}function Ue(z){if(U.length==1)A.set(z.pageX,z.pageY);else{const be=he(z),nt=.5*(z.pageX+be.x),Ee=.5*(z.pageY+be.y);A.set(nt,Ee)}C.subVectors(A,S).multiplyScalar(r.panSpeed),G(C.x,C.y),S.copy(A)}function Je(z){const be=he(z),nt=z.pageX-be.x,Ee=z.pageY-be.y,Le=Math.sqrt(nt*nt+Ee*Ee);I.set(0,Le),O.set(0,Math.pow(I.y/x.y,r.zoomSpeed)),K(O.y),x.copy(I)}function ve(z){r.enableZoom&&Je(z),r.enablePan&&Ue(z)}function Me(z){r.enableZoom&&Je(z),r.enableRotate&&tt(z)}function vt(z){var be,nt;r.enabled!==!1&&(U.length===0&&((be=r.domElement)==null||be.ownerDocument.addEventListener("pointermove",oe),(nt=r.domElement)==null||nt.ownerDocument.addEventListener("pointerup",ee)),St(z),z.pointerType==="touch"?ht(z):W(z))}function oe(z){r.enabled!==!1&&(z.pointerType==="touch"?ft(z):ot(z))}function ee(z){var be,nt,Ee;L(z),U.length===0&&((be=r.domElement)==null||be.releasePointerCapture(z.pointerId),(nt=r.domElement)==null||nt.ownerDocument.removeEventListener("pointermove",oe),(Ee=r.domElement)==null||Ee.ownerDocument.removeEventListener("pointerup",ee)),r.dispatchEvent(l),d=u.NONE}function W(z){let be;switch(z.button){case 0:be=r.mouseButtons.LEFT;break;case 1:be=r.mouseButtons.MIDDLE;break;case 2:be=r.mouseButtons.RIGHT;break;default:be=-1}switch(be){case Uf.DOLLY:if(r.enableZoom===!1)return;Ae(z),d=u.DOLLY;break;case Uf.ROTATE:if(z.ctrlKey||z.metaKey||z.shiftKey){if(r.enablePan===!1)return;Ce(z),d=u.PAN}else{if(r.enableRotate===!1)return;fe(z),d=u.ROTATE}break;case Uf.PAN:if(z.ctrlKey||z.metaKey||z.shiftKey){if(r.enableRotate===!1)return;fe(z),d=u.ROTATE}else{if(r.enablePan===!1)return;Ce(z),d=u.PAN}break;default:d=u.NONE}d!==u.NONE&&r.dispatchEvent(a)}function ot(z){if(r.enabled!==!1)switch(d){case u.ROTATE:if(r.enableRotate===!1)return;Ie(z);break;case u.DOLLY:if(r.enableZoom===!1)return;We(z);break;case u.PAN:if(r.enablePan===!1)return;ut(z);break}}function je(z){r.enabled===!1||r.enableZoom===!1||d!==u.NONE&&d!==u.ROTATE||(z.preventDefault(),r.dispatchEvent(a),Ye(z),r.dispatchEvent(l))}function Qe(z){r.enabled===!1||r.enablePan===!1||we(z)}function ht(z){switch(X(z),U.length){case 1:switch(r.touches.ONE){case Gf.ROTATE:if(r.enableRotate===!1)return;Q(),d=u.TOUCH_ROTATE;break;case Gf.PAN:if(r.enablePan===!1)return;Ge(),d=u.TOUCH_PAN;break;default:d=u.NONE}break;case 2:switch(r.touches.TWO){case Gf.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Ve(),d=u.TOUCH_DOLLY_PAN;break;case Gf.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Fe(),d=u.TOUCH_DOLLY_ROTATE;break;default:d=u.NONE}break;default:d=u.NONE}d!==u.NONE&&r.dispatchEvent(a)}function ft(z){switch(X(z),d){case u.TOUCH_ROTATE:if(r.enableRotate===!1)return;tt(z),r.update();break;case u.TOUCH_PAN:if(r.enablePan===!1)return;Ue(z),r.update();break;case u.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ve(z),r.update();break;case u.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Me(z),r.update();break;default:d=u.NONE}}function He(z){r.enabled!==!1&&z.preventDefault()}function St(z){U.push(z)}function L(z){delete ce[z.pointerId];for(let be=0;be<U.length;be++)if(U[be].pointerId==z.pointerId){U.splice(be,1);return}}function X(z){let be=ce[z.pointerId];be===void 0&&(be=new mt,ce[z.pointerId]=be),be.set(z.pageX,z.pageY)}function he(z){const be=z.pointerId===U[0].pointerId?U[1]:U[0];return ce[be.pointerId]}this.dollyIn=(z=ae())=>{se(z),r.update()},this.dollyOut=(z=ae())=>{K(z),r.update()},this.getScale=()=>m,this.setScale=z=>{Z(z),r.update()},this.getZoomScale=()=>ae(),n!==void 0&&this.connect(n),this.update()}};function KS(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let n=0,r=i.length;n<r;n++)e+=String.fromCharCode(i[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const ep="srgb",xu="srgb-linear",Ak=3001,LY=3e3;let ZM=class extends ls{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new BY(n)}),this.register(function(n){return new FY(n)}),this.register(function(n){return new YY(n)}),this.register(function(n){return new KY(n)}),this.register(function(n){return new JY(n)}),this.register(function(n){return new GY(n)}),this.register(function(n){return new HY(n)}),this.register(function(n){return new VY(n)}),this.register(function(n){return new zY(n)}),this.register(function(n){return new DY(n)}),this.register(function(n){return new WY(n)}),this.register(function(n){return new UY(n)}),this.register(function(n){return new jY(n)}),this.register(function(n){return new XY(n)}),this.register(function(n){return new kY(n)}),this.register(function(n){return new ZY(n)}),this.register(function(n){return new qY(n)})}load(e,n,r,s){const a=this;let l;if(this.resourcePath!=="")l=this.resourcePath;else if(this.path!==""){const h=Pl.extractUrlBase(e);l=Pl.resolveURL(h,this.path)}else l=Pl.extractUrlBase(e);this.manager.itemStart(e);const u=function(h){s?s(h):console.error(h),a.manager.itemError(e),a.manager.itemEnd(e)},d=new Nr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(h){try{a.parse(h,l,function(f){n(f),a.manager.itemEnd(e)},u)}catch(f){u(f)}},r,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,s){let a;const l={},u={};if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(KS(new Uint8Array(e.slice(0,4)))===t2){try{l[Gn.KHR_BINARY_GLTF]=new QY(e)}catch(f){s&&s(f);return}a=JSON.parse(l[Gn.KHR_BINARY_GLTF].content)}else a=JSON.parse(KS(new Uint8Array(e)));else a=e;if(a.asset===void 0||a.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new dK(a,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const f=this.pluginCallbacks[h](d);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[f.name]=f,l[f.name]=!0}if(a.extensionsUsed)for(let h=0;h<a.extensionsUsed.length;++h){const f=a.extensionsUsed[h],p=a.extensionsRequired||[];switch(f){case Gn.KHR_MATERIALS_UNLIT:l[f]=new PY;break;case Gn.KHR_DRACO_MESH_COMPRESSION:l[f]=new eK(a,this.dracoLoader);break;case Gn.KHR_TEXTURE_TRANSFORM:l[f]=new tK;break;case Gn.KHR_MESH_QUANTIZATION:l[f]=new nK;break;default:p.indexOf(f)>=0&&u[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}d.setExtensions(l),d.setPlugins(u),d.parse(r,s)}parseAsync(e,n){const r=this;return new Promise(function(s,a){r.parse(e,n,s,a)})}};function NY(){let i={};return{get:function(e){return i[e]},add:function(e,n){i[e]=n},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Gn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let kY=class{constructor(e){this.parser=e,this.name=Gn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let r=0,s=n.length;r<s;r++){const a=n[r];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let s=n.cache.get(r);if(s)return s;const a=n.json,d=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let h;const f=new xt(16777215);d.color!==void 0&&f.setRGB(d.color[0],d.color[1],d.color[2],xu);const p=d.range!==void 0?d.range:0;switch(d.type){case"directional":h=new W$(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new z$(f),h.distance=p;break;case"spot":h=new V$(f),h.distance=p,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,h.angle=d.spot.outerConeAngle,h.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return h.position.set(0,0,0),h.decay=2,vu(h,d),d.intensity!==void 0&&(h.intensity=d.intensity),h.name=n.createUniqueName(d.name||"light_"+e),s=Promise.resolve(h),n.cache.add(r,s),s}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,r=this.parser,a=r.json.nodes[e],u=(a.extensions&&a.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(d){return r._getNodeRef(n.cache,u,d)})}},PY=class{constructor(){this.name=Gn.KHR_MATERIALS_UNLIT}getMaterialType(){return oi}extendParams(e,n,r){const s=[];e.color=new xt(1,1,1),e.opacity=1;const a=n.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const l=a.baseColorFactor;e.color.setRGB(l[0],l[1],l[2],xu),e.opacity=l[3]}a.baseColorTexture!==void 0&&s.push(r.assignTexture(e,"map",a.baseColorTexture,ep))}return Promise.all(s)}},DY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name].emissiveStrength;return a!==void 0&&(n.emissiveIntensity=a),Promise.resolve()}},BY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];if(l.clearcoatFactor!==void 0&&(n.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&a.push(r.assignTexture(n,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&a.push(r.assignTexture(n,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(a.push(r.assignTexture(n,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const u=l.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new mt(u,u)}return Promise.all(a)}};class FY{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name];return n.dispersion=a.dispersion!==void 0?a.dispersion:0,Promise.resolve()}}let UY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.iridescenceFactor!==void 0&&(n.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&a.push(r.assignTexture(n,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(n.iridescenceIOR=l.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&a.push(r.assignTexture(n,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(a)}},GY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];n.sheenColor=new xt(0,0,0),n.sheenRoughness=0,n.sheen=1;const l=s.extensions[this.name];if(l.sheenColorFactor!==void 0){const u=l.sheenColorFactor;n.sheenColor.setRGB(u[0],u[1],u[2],xu)}return l.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&a.push(r.assignTexture(n,"sheenColorMap",l.sheenColorTexture,ep)),l.sheenRoughnessTexture!==void 0&&a.push(r.assignTexture(n,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(a)}},HY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.transmissionFactor!==void 0&&(n.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&a.push(r.assignTexture(n,"transmissionMap",l.transmissionTexture)),Promise.all(a)}},VY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];n.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&a.push(r.assignTexture(n,"thicknessMap",l.thicknessTexture)),n.attenuationDistance=l.attenuationDistance||1/0;const u=l.attenuationColor||[1,1,1];return n.attenuationColor=new xt().setRGB(u[0],u[1],u[2],xu),Promise.all(a)}},zY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name];return n.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}},WY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];n.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&a.push(r.assignTexture(n,"specularIntensityMap",l.specularTexture));const u=l.specularColorFactor||[1,1,1];return n.specularColor=new xt().setRGB(u[0],u[1],u[2],xu),l.specularColorTexture!==void 0&&a.push(r.assignTexture(n,"specularColorMap",l.specularColorTexture,ep)),Promise.all(a)}};class XY{constructor(e){this.parser=e,this.name=Gn.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return n.bumpScale=l.bumpFactor!==void 0?l.bumpFactor:1,l.bumpTexture!==void 0&&a.push(r.assignTexture(n,"bumpMap",l.bumpTexture)),Promise.all(a)}}let jY=class{constructor(e){this.parser=e,this.name=Gn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.anisotropyStrength!==void 0&&(n.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(n.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&a.push(r.assignTexture(n,"anisotropyMap",l.anisotropyTexture)),Promise.all(a)}},YY=class{constructor(e){this.parser=e,this.name=Gn.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const a=s.extensions[this.name],l=n.options.ktx2Loader;if(!l){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,a.source,l)}},KY=class{constructor(e){this.parser=e,this.name=Gn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,s=r.json,a=s.textures[e];if(!a.extensions||!a.extensions[n])return null;const l=a.extensions[n],u=s.images[l.source];let d=r.textureLoader;if(u.uri){const h=r.options.manager.getHandler(u.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,l.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}},JY=class{constructor(e){this.parser=e,this.name=Gn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,s=r.json,a=s.textures[e];if(!a.extensions||!a.extensions[n])return null;const l=a.extensions[n],u=s.images[l.source];let d=r.textureLoader;if(u.uri){const h=r.options.manager.getHandler(u.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,l.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}},ZY=class{constructor(e){this.name=Gn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,r=n.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const s=r.extensions[this.name],a=this.parser.getDependency("buffer",s.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(u){const d=s.byteOffset||0,h=s.byteLength||0,f=s.count,p=s.byteStride,m=new Uint8Array(u,d,h);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,p,m,s.mode,s.filter).then(function(v){return v.buffer}):l.ready.then(function(){const v=new ArrayBuffer(f*p);return l.decodeGltfBuffer(new Uint8Array(v),f,p,m,s.mode,s.filter),v})})}else return null}},qY=class{constructor(e){this.name=Gn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const s=n.meshes[r.mesh];for(const h of s.primitives)if(h.mode!==Na.TRIANGLES&&h.mode!==Na.TRIANGLE_STRIP&&h.mode!==Na.TRIANGLE_FAN&&h.mode!==void 0)return null;const l=r.extensions[this.name].attributes,u=[],d={};for(const h in l)u.push(this.parser.getDependency("accessor",l[h]).then(f=>(d[h]=f,d[h])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(h=>{const f=h.pop(),p=f.isGroup?f.children:[f],m=h[0].count,v=[];for(const y of p){const $=new pn,E=new ie,S=new Er,A=new ie(1,1,1),C=new P$(y.geometry,y.material,m);for(let x=0;x<m;x++)d.TRANSLATION&&E.fromBufferAttribute(d.TRANSLATION,x),d.ROTATION&&S.fromBufferAttribute(d.ROTATION,x),d.SCALE&&A.fromBufferAttribute(d.SCALE,x),C.setMatrixAt(x,$.compose(E,S,A));for(const x in d)if(x==="_COLOR_0"){const I=d[x];C.instanceColor=new hd(I.array,I.itemSize,I.normalized)}else x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&y.geometry.setAttribute(x,d[x]);Xn.prototype.copy.call(C,y),this.parser.assignFinalMaterial(C),v.push(C)}return f.isGroup?(f.clear(),f.add(...v),f):v[0]}))}};const t2="glTF",KT=12,Ck={JSON:1313821514,BIN:5130562};let QY=class{constructor(e){this.name=Gn.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,KT);if(this.header={magic:KS(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==t2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-KT,s=new DataView(e,KT);let a=0;for(;a<r;){const l=s.getUint32(a,!0);a+=4;const u=s.getUint32(a,!0);if(a+=4,u===Ck.JSON){const d=new Uint8Array(e,KT+a,l);this.content=KS(d)}else if(u===Ck.BIN){const d=KT+a;this.body=e.slice(d,d+l)}a+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},eK=class{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Gn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const r=this.json,s=this.dracoLoader,a=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,u={},d={},h={};for(const f in l){const p=Jx[f]||f.toLowerCase();u[p]=l[f]}for(const f in e.attributes){const p=Jx[f]||f.toLowerCase();if(l[f]!==void 0){const m=r.accessors[e.attributes[f]],v=Ng[m.componentType];h[p]=v.name,d[p]=m.normalized===!0}}return n.getDependency("bufferView",a).then(function(f){return new Promise(function(p,m){s.decodeDracoFile(f,function(v){for(const y in v.attributes){const $=v.attributes[y],E=d[y];E!==void 0&&($.normalized=E)}p(v)},u,h,xu,m)})})}},tK=class{constructor(){this.name=Gn.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}},nK=class{constructor(){this.name=Gn.KHR_MESH_QUANTIZATION}},n2=class extends kp{constructor(e,n,r,s){super(e,n,r,s)}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s*3+s;for(let l=0;l!==s;l++)n[l]=r[a+l];return n}interpolate_(e,n,r,s){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=u*2,h=u*3,f=s-n,p=(r-n)/f,m=p*p,v=m*p,y=e*h,$=y-h,E=-2*v+3*m,S=v-m,A=1-E,C=S-m+p;for(let x=0;x!==u;x++){const I=l[$+x+u],O=l[$+x+d]*f,F=l[y+x+u],k=l[y+x]*f;a[x]=A*I+C*O+E*F+S*k}return a}};const iK=new Er;let rK=class extends n2{interpolate_(e,n,r,s){const a=super.interpolate_(e,n,r,s);return iK.fromArray(a).normalize().toArray(a),a}};const Na={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ng={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Rk={9728:er,9729:Dn,9984:Wg,9985:EE,9986:op,9987:Wa},xk={33071:Pi,33648:yp,10497:Bl},XC={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Jx={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...jU>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Dh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},sK={CUBICSPLINE:void 0,LINEAR:Nu,STEP:$p},jC={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function oK(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Np({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:za})),i.DefaultMaterial}function kf(i,e,n){for(const r in n.extensions)i[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function vu(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function aK(i,e,n){let r=!1,s=!1,a=!1;for(let h=0,f=e.length;h<f;h++){const p=e[h];if(p.POSITION!==void 0&&(r=!0),p.NORMAL!==void 0&&(s=!0),p.COLOR_0!==void 0&&(a=!0),r&&s&&a)break}if(!r&&!s&&!a)return Promise.resolve(i);const l=[],u=[],d=[];for(let h=0,f=e.length;h<f;h++){const p=e[h];if(r){const m=p.POSITION!==void 0?n.getDependency("accessor",p.POSITION):i.attributes.position;l.push(m)}if(s){const m=p.NORMAL!==void 0?n.getDependency("accessor",p.NORMAL):i.attributes.normal;u.push(m)}if(a){const m=p.COLOR_0!==void 0?n.getDependency("accessor",p.COLOR_0):i.attributes.color;d.push(m)}}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(d)]).then(function(h){const f=h[0],p=h[1],m=h[2];return r&&(i.morphAttributes.position=f),s&&(i.morphAttributes.normal=p),a&&(i.morphAttributes.color=m),i.morphTargetsRelative=!0,i})}function lK(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let n=0,r=e.weights.length;n<r;n++)i.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(i.morphTargetInfluences.length===n.length){i.morphTargetDictionary={};for(let r=0,s=n.length;r<s;r++)i.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function cK(i){let e;const n=i.extensions&&i.extensions[Gn.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+YC(n.attributes):e=i.indices+":"+YC(i.attributes)+":"+i.mode,i.targets!==void 0)for(let r=0,s=i.targets.length;r<s;r++)e+=":"+YC(i.targets[r]);return e}function YC(i){let e="";const n=Object.keys(i).sort();for(let r=0,s=n.length;r<s;r++)e+=n[r]+":"+i[n[r]]+";";return e}function Zx(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function uK(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const hK=new pn;let dK=class{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new NY,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=!1,a=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,a=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||s&&a<98?this.textureLoader=new BM(this.options.manager):this.textureLoader=new UM(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Nr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const r=this,s=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(l){const u={scene:l[0][s.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:s.asset,parser:r,userData:{}};return kf(a,u,s),vu(u,s),Promise.all(r._invokeAll(function(d){return d.afterRoot&&d.afterRoot(u)})).then(function(){for(const d of u.scenes)d.updateMatrixWorld();e(u)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[];for(let s=0,a=n.length;s<a;s++){const l=n[s].joints;for(let u=0,d=l.length;u<d;u++)e[l[u]].isBone=!0}for(let s=0,a=e.length;s<a;s++){const l=e[s];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(r[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,r){if(e.refs[n]<=1)return r;const s=r.clone(),a=(l,u)=>{const d=this.associations.get(l);d!=null&&this.associations.set(u,d);for(const[h,f]of l.children.entries())a(f,u.children[h])};return a(r,s),s.name+="_instance_"+e.uses[n]++,s}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let r=0;r<n.length;r++){const s=e(n[r]);if(s)return s}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const r=[];for(let s=0;s<n.length;s++){const a=e(n[s]);a&&r.push(a)}return r}getDependency(e,n){const r=e+":"+n;let s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(a){return a.loadNode&&a.loadNode(n)});break;case"mesh":s=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,n)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(r,s)}return s}getDependencies(e){let n=this.cache.get(e);if(!n){const r=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(a,l){return r.getDependency(e,l)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],r=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[Gn.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(a,l){r.load(Pl.resolveURL(n.uri,s.path),a,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(r){const s=n.byteLength||0,a=n.byteOffset||0;return r.slice(a,a+s)})}loadAccessor(e){const n=this,r=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const l=XC[s.type],u=Ng[s.componentType],d=s.normalized===!0,h=new u(s.count*l);return Promise.resolve(new Qn(h,l,d))}const a=[];return s.bufferView!==void 0?a.push(this.getDependency("bufferView",s.bufferView)):a.push(null),s.sparse!==void 0&&(a.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(a).then(function(l){const u=l[0],d=XC[s.type],h=Ng[s.componentType],f=h.BYTES_PER_ELEMENT,p=f*d,m=s.byteOffset||0,v=s.bufferView!==void 0?r.bufferViews[s.bufferView].byteStride:void 0,y=s.normalized===!0;let $,E;if(v&&v!==p){const S=Math.floor(m/v),A="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+S+":"+s.count;let C=n.cache.get(A);C||($=new h(u,S*v,s.count*v/f),C=new n_($,v/f),n.cache.add(A,C)),E=new oo(C,d,m%v/f,y)}else u===null?$=new h(s.count*d):$=new h(u,m,s.count*d),E=new Qn($,d,y);if(s.sparse!==void 0){const S=XC.SCALAR,A=Ng[s.sparse.indices.componentType],C=s.sparse.indices.byteOffset||0,x=s.sparse.values.byteOffset||0,I=new A(l[1],C,s.sparse.count*S),O=new h(l[2],x,s.sparse.count*d);u!==null&&(E=new Qn(E.array.slice(),E.itemSize,E.normalized));for(let F=0,k=I.length;F<k;F++){const D=I[F];if(E.setX(D,O[F*d]),d>=2&&E.setY(D,O[F*d+1]),d>=3&&E.setZ(D,O[F*d+2]),d>=4&&E.setW(D,O[F*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(e){const n=this.json,r=this.options,a=n.textures[e].source,l=n.images[a];let u=this.textureLoader;if(l.uri){const d=r.manager.getHandler(l.uri);d!==null&&(u=d)}return this.loadTextureImage(e,a,u)}loadTextureImage(e,n,r){const s=this,a=this.json,l=a.textures[e],u=a.images[n],d=(u.uri||u.bufferView)+":"+l.sampler;if(this.textureCache[d])return this.textureCache[d];const h=this.loadImageSource(n,r).then(function(f){f.flipY=!1,f.name=l.name||u.name||"",f.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(f.name=u.uri);const m=(a.samplers||{})[l.sampler]||{};return f.magFilter=Rk[m.magFilter]||Dn,f.minFilter=Rk[m.minFilter]||Wa,f.wrapS=xk[m.wrapS]||Bl,f.wrapT=xk[m.wrapT]||Bl,s.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[d]=h,h}loadImageSource(e,n){const r=this,s=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const l=s.images[e],u=self.URL||self.webkitURL;let d=l.uri||"",h=!1;if(l.bufferView!==void 0)d=r.getDependency("bufferView",l.bufferView).then(function(p){h=!0;const m=new Blob([p],{type:l.mimeType});return d=u.createObjectURL(m),d});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(d).then(function(p){return new Promise(function(m,v){let y=m;n.isImageBitmapLoader===!0&&(y=function($){const E=new ni($);E.needsUpdate=!0,m(E)}),n.load(Pl.resolveURL(p,a.path),y,void 0,v)})}).then(function(p){return h===!0&&u.revokeObjectURL(d),vu(p,l),p.userData.mimeType=l.mimeType||uK(l.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),p});return this.sourceCache[e]=f,f}assignTexture(e,n,r,s){const a=this;return this.getDependency("texture",r.index).then(function(l){if(!l)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(l=l.clone(),l.channel=r.texCoord),a.extensions[Gn.KHR_TEXTURE_TRANSFORM]){const u=r.extensions!==void 0?r.extensions[Gn.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const d=a.associations.get(l);l=a.extensions[Gn.KHR_TEXTURE_TRANSFORM].extendTexture(l,u),a.associations.set(l,d)}}return s!==void 0&&(typeof s=="number"&&(s=s===Ak?ep:xu),"colorSpace"in l?l.colorSpace=s:l.encoding=s===ep?Ak:LY),e[n]=l,l})}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const s=n.attributes.tangent===void 0,a=n.attributes.color!==void 0,l=n.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+r.uuid;let d=this.cache.get(u);d||(d=new CE,ir.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,d.sizeAttenuation=!1,this.cache.add(u,d)),r=d}else if(e.isLine){const u="LineBasicMaterial:"+r.uuid;let d=this.cache.get(u);d||(d=new Ai,ir.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,this.cache.add(u,d)),r=d}if(s||a||l){let u="ClonedMaterial:"+r.uuid+":";s&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),l&&(u+="flat-shading:");let d=this.cache.get(u);d||(d=r.clone(),a&&(d.vertexColors=!0),l&&(d.flatShading=!0),s&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(u,d),this.associations.set(d,this.associations.get(r))),r=d}e.material=r}getMaterialType(){return Np}loadMaterial(e){const n=this,r=this.json,s=this.extensions,a=r.materials[e];let l;const u={},d=a.extensions||{},h=[];if(d[Gn.KHR_MATERIALS_UNLIT]){const p=s[Gn.KHR_MATERIALS_UNLIT];l=p.getMaterialType(),h.push(p.extendParams(u,a,n))}else{const p=a.pbrMetallicRoughness||{};if(u.color=new xt(1,1,1),u.opacity=1,Array.isArray(p.baseColorFactor)){const m=p.baseColorFactor;u.color.setRGB(m[0],m[1],m[2],xu),u.opacity=m[3]}p.baseColorTexture!==void 0&&h.push(n.assignTexture(u,"map",p.baseColorTexture,ep)),u.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,u.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(h.push(n.assignTexture(u,"metalnessMap",p.metallicRoughnessTexture)),h.push(n.assignTexture(u,"roughnessMap",p.metallicRoughnessTexture))),l=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,u)})))}a.doubleSided===!0&&(u.side=$s);const f=a.alphaMode||jC.OPAQUE;if(f===jC.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,f===jC.MASK&&(u.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&l!==oi&&(h.push(n.assignTexture(u,"normalMap",a.normalTexture)),u.normalScale=new mt(1,1),a.normalTexture.scale!==void 0)){const p=a.normalTexture.scale;u.normalScale.set(p,p)}if(a.occlusionTexture!==void 0&&l!==oi&&(h.push(n.assignTexture(u,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&l!==oi){const p=a.emissiveFactor;u.emissive=new xt().setRGB(p[0],p[1],p[2],xu)}return a.emissiveTexture!==void 0&&l!==oi&&h.push(n.assignTexture(u,"emissiveMap",a.emissiveTexture,ep)),Promise.all(h).then(function(){const p=new l(u);return a.name&&(p.name=a.name),vu(p,a),n.associations.set(p,{materials:e}),a.extensions&&kf(s,p,a),p})}createUniqueName(e){const n=Zn.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,r=this.extensions,s=this.primitiveCache;function a(u){return r[Gn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,n).then(function(d){return wk(d,u,n)})}const l=[];for(let u=0,d=e.length;u<d;u++){const h=e[u],f=cK(h),p=s[f];if(p)l.push(p.promise);else{let m;h.extensions&&h.extensions[Gn.KHR_DRACO_MESH_COMPRESSION]?m=a(h):m=wk(new on,h,n),s[f]={primitive:h,promise:m},l.push(m)}}return Promise.all(l)}loadMesh(e){const n=this,r=this.json,s=this.extensions,a=r.meshes[e],l=a.primitives,u=[];for(let d=0,h=l.length;d<h;d++){const f=l[d].material===void 0?oK(this.cache):this.getDependency("material",l[d].material);u.push(f)}return u.push(n.loadGeometries(l)),Promise.all(u).then(function(d){const h=d.slice(0,d.length-1),f=d[d.length-1],p=[];for(let v=0,y=f.length;v<y;v++){const $=f[v],E=l[v];let S;const A=h[v];if(E.mode===Na.TRIANGLES||E.mode===Na.TRIANGLE_STRIP||E.mode===Na.TRIANGLE_FAN||E.mode===void 0)S=a.isSkinnedMesh===!0?new k$($,A):new Bn($,A),S.isSkinnedMesh===!0&&S.normalizeSkinWeights(),E.mode===Na.TRIANGLE_STRIP?S.geometry=Sk(S.geometry,yE):E.mode===Na.TRIANGLE_FAN&&(S.geometry=Sk(S.geometry,bp));else if(E.mode===Na.LINES)S=new Ya($,A);else if(E.mode===Na.LINE_STRIP)S=new pr($,A);else if(E.mode===Na.LINE_LOOP)S=new D$($,A);else if(E.mode===Na.POINTS)S=new B$($,A);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(S.geometry.morphAttributes).length>0&&lK(S,a),S.name=n.createUniqueName(a.name||"mesh_"+e),vu(S,a),E.extensions&&kf(s,S,E),n.assignFinalMaterial(S),p.push(S)}for(let v=0,y=p.length;v<y;v++)n.associations.set(p[v],{meshes:e,primitives:v});if(p.length===1)return a.extensions&&kf(s,p[0],a),p[0];const m=new ta;a.extensions&&kf(s,m,a),n.associations.set(m,{meshes:e});for(let v=0,y=p.length;v<y;v++)m.add(p[v]);return m})}loadCamera(e){let n;const r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?n=new Gi(lp.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):r.type==="orthographic"&&(n=new sa(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),vu(n,r),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],r=[];for(let s=0,a=n.joints.length;s<a;s++)r.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",n.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(s){const a=s.pop(),l=s,u=[],d=[];for(let h=0,f=l.length;h<f;h++){const p=l[h];if(p){u.push(p);const m=new pn;a!==null&&m.fromArray(a.array,h*16),d.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[h])}return new i_(u,d)})}loadAnimation(e){const n=this.json,r=this,s=n.animations[e],a=s.name?s.name:"animation_"+e,l=[],u=[],d=[],h=[],f=[];for(let p=0,m=s.channels.length;p<m;p++){const v=s.channels[p],y=s.samplers[v.sampler],$=v.target,E=$.node,S=s.parameters!==void 0?s.parameters[y.input]:y.input,A=s.parameters!==void 0?s.parameters[y.output]:y.output;$.node!==void 0&&(l.push(this.getDependency("node",E)),u.push(this.getDependency("accessor",S)),d.push(this.getDependency("accessor",A)),h.push(y),f.push($))}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(d),Promise.all(h),Promise.all(f)]).then(function(p){const m=p[0],v=p[1],y=p[2],$=p[3],E=p[4],S=[];for(let A=0,C=m.length;A<C;A++){const x=m[A],I=v[A],O=y[A],F=$[A],k=E[A];if(x===void 0)continue;x.updateMatrix&&x.updateMatrix();const D=r._createAnimationTracks(x,I,O,F,k);if(D)for(let U=0;U<D.length;U++)S.push(D[U])}return new Cp(a,void 0,S)})}createNodeMesh(e){const n=this.json,r=this,s=n.nodes[e];return s.mesh===void 0?null:r.getDependency("mesh",s.mesh).then(function(a){const l=r._getNodeRef(r.meshCache,s.mesh,a);return s.weights!==void 0&&l.traverse(function(u){if(u.isMesh)for(let d=0,h=s.weights.length;d<h;d++)u.morphTargetInfluences[d]=s.weights[d]}),l})}loadNode(e){const n=this.json,r=this,s=n.nodes[e],a=r._loadNodeShallow(e),l=[],u=s.children||[];for(let h=0,f=u.length;h<f;h++)l.push(r.getDependency("node",u[h]));const d=s.skin===void 0?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([a,Promise.all(l),d]).then(function(h){const f=h[0],p=h[1],m=h[2];m!==null&&f.traverse(function(v){v.isSkinnedMesh&&v.bind(m,hK)});for(let v=0,y=p.length;v<y;v++)f.add(p[v]);return f})}_loadNodeShallow(e){const n=this.json,r=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=n.nodes[e],l=a.name?s.createUniqueName(a.name):"",u=[],d=s._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return d&&u.push(d),a.camera!==void 0&&u.push(s.getDependency("camera",a.camera).then(function(h){return s._getNodeRef(s.cameraCache,a.camera,h)})),s._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){u.push(h)}),this.nodeCache[e]=Promise.all(u).then(function(h){let f;if(a.isBone===!0?f=new AE:h.length>1?f=new ta:h.length===1?f=h[0]:f=new Xn,f!==h[0])for(let p=0,m=h.length;p<m;p++)f.add(h[p]);if(a.name&&(f.userData.name=a.name,f.name=l),vu(f,a),a.extensions&&kf(r,f,a),a.matrix!==void 0){const p=new pn;p.fromArray(a.matrix),f.applyMatrix4(p)}else a.translation!==void 0&&f.position.fromArray(a.translation),a.rotation!==void 0&&f.quaternion.fromArray(a.rotation),a.scale!==void 0&&f.scale.fromArray(a.scale);return s.associations.has(f)||s.associations.set(f,{}),s.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const n=this.extensions,r=this.json.scenes[e],s=this,a=new ta;r.name&&(a.name=s.createUniqueName(r.name)),vu(a,r),r.extensions&&kf(n,a,r);const l=r.nodes||[],u=[];for(let d=0,h=l.length;d<h;d++)u.push(s.getDependency("node",l[d]));return Promise.all(u).then(function(d){for(let f=0,p=d.length;f<p;f++)a.add(d[f]);const h=f=>{const p=new Map;for(const[m,v]of s.associations)(m instanceof ir||m instanceof ni)&&p.set(m,v);return f.traverse(m=>{const v=s.associations.get(m);v!=null&&p.set(m,v)}),p};return s.associations=h(a),a})}_createAnimationTracks(e,n,r,s,a){const l=[],u=e.name?e.name:e.uuid,d=[];Dh[a.path]===Dh.weights?e.traverse(function(m){m.morphTargetInfluences&&d.push(m.name?m.name:m.uuid)}):d.push(u);let h;switch(Dh[a.path]){case Dh.weights:h=dd;break;case Dh.rotation:h=wc;break;case Dh.position:case Dh.scale:h=fd;break;default:switch(r.itemSize){case 1:h=dd;break;case 2:case 3:default:h=fd;break}break}const f=s.interpolation!==void 0?sK[s.interpolation]:Nu,p=this._getArrayFromAccessor(r);for(let m=0,v=d.length;m<v;m++){const y=new h(d[m]+"."+Dh[a.path],n.array,p,f);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(y),l.push(y)}return l}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const r=Zx(n.constructor),s=new Float32Array(n.length);for(let a=0,l=n.length;a<l;a++)s[a]=n[a]*r;n=s}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const s=this instanceof wc?rK:n2;return new s(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function fK(i,e,n){const r=e.attributes,s=new zs;if(r.POSITION!==void 0){const u=n.json.accessors[r.POSITION],d=u.min,h=u.max;if(d!==void 0&&h!==void 0){if(s.set(new ie(d[0],d[1],d[2]),new ie(h[0],h[1],h[2])),u.normalized){const f=Zx(Ng[u.componentType]);s.min.multiplyScalar(f),s.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const u=new ie,d=new ie;for(let h=0,f=a.length;h<f;h++){const p=a[h];if(p.POSITION!==void 0){const m=n.json.accessors[p.POSITION],v=m.min,y=m.max;if(v!==void 0&&y!==void 0){if(d.setX(Math.max(Math.abs(v[0]),Math.abs(y[0]))),d.setY(Math.max(Math.abs(v[1]),Math.abs(y[1]))),d.setZ(Math.max(Math.abs(v[2]),Math.abs(y[2]))),m.normalized){const $=Zx(Ng[m.componentType]);d.multiplyScalar($)}u.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(u)}i.boundingBox=s;const l=new Ws;s.getCenter(l.center),l.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=l}function wk(i,e,n){const r=e.attributes,s=[];function a(l,u){return n.getDependency("accessor",l).then(function(d){i.setAttribute(u,d)})}for(const l in r){const u=Jx[l]||l.toLowerCase();u in i.attributes||s.push(a(r[l],u))}if(e.indices!==void 0&&!i.index){const l=n.getDependency("accessor",e.indices).then(function(u){i.setIndex(u)});s.push(l)}return vu(i,e),fK(i,e,n),Promise.all(s).then(function(){return e.targets!==void 0?aK(i,e.targets,n):i})}class pK extends DM{constructor(e){super(e),this.type=Jr}parse(e){const l=function(k,D){switch(k){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(D||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(D||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(D||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(D||""))}},f=`
`,p=function(k,D,U){D=D||1024;let re=k.pos,ae=-1,ne=0,de="",ue=String.fromCharCode.apply(null,new Uint16Array(k.subarray(re,re+128)));for(;0>(ae=ue.indexOf(f))&&ne<D&&re<k.byteLength;)de+=ue,ne+=ue.length,re+=128,ue+=String.fromCharCode.apply(null,new Uint16Array(k.subarray(re,re+128)));return-1<ae?(U!==!1&&(k.pos+=ne+ae+1),de+ue.slice(0,ae)):!1},m=function(k){const D=/^#\?(\S+)/,U=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,ce=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,re=/^\s*FORMAT=(\S+)\s*$/,ae=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ne={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let de,ue;for((k.pos>=k.byteLength||!(de=p(k)))&&l(1,"no header found"),(ue=de.match(D))||l(3,"bad initial token"),ne.valid|=1,ne.programtype=ue[1],ne.string+=de+`
`;de=p(k),de!==!1;){if(ne.string+=de+`
`,de.charAt(0)==="#"){ne.comments+=de+`
`;continue}if((ue=de.match(U))&&(ne.gamma=parseFloat(ue[1])),(ue=de.match(ce))&&(ne.exposure=parseFloat(ue[1])),(ue=de.match(re))&&(ne.valid|=2,ne.format=ue[1]),(ue=de.match(ae))&&(ne.valid|=4,ne.height=parseInt(ue[1],10),ne.width=parseInt(ue[2],10)),ne.valid&2&&ne.valid&4)break}return ne.valid&2||l(3,"missing format specifier"),ne.valid&4||l(3,"missing image size specifier"),ne},v=function(k,D,U){const ce=D;if(ce<8||ce>32767||k[0]!==2||k[1]!==2||k[2]&128)return new Uint8Array(k);ce!==(k[2]<<8|k[3])&&l(3,"wrong scanline width");const re=new Uint8Array(4*D*U);re.length||l(4,"unable to allocate buffer space");let ae=0,ne=0;const de=4*ce,ue=new Uint8Array(4),Re=new Uint8Array(de);let G=U;for(;G>0&&ne<k.byteLength;){ne+4>k.byteLength&&l(1),ue[0]=k[ne++],ue[1]=k[ne++],ue[2]=k[ne++],ue[3]=k[ne++],(ue[0]!=2||ue[1]!=2||(ue[2]<<8|ue[3])!=ce)&&l(3,"bad rgbe scanline format");let Z=0,K;for(;Z<de&&ne<k.byteLength;){K=k[ne++];const Y=K>128;if(Y&&(K-=128),(K===0||Z+K>de)&&l(3,"bad scanline data"),Y){const me=k[ne++];for(let fe=0;fe<K;fe++)Re[Z++]=me}else Re.set(k.subarray(ne,ne+K),Z),Z+=K,ne+=K}const se=ce;for(let Y=0;Y<se;Y++){let me=0;re[ae]=Re[Y+me],me+=ce,re[ae+1]=Re[Y+me],me+=ce,re[ae+2]=Re[Y+me],me+=ce,re[ae+3]=Re[Y+me],ae+=4}G--}return re},y=function(k,D,U,ce){const re=k[D+3],ae=Math.pow(2,re-128)/255;U[ce+0]=k[D+0]*ae,U[ce+1]=k[D+1]*ae,U[ce+2]=k[D+2]*ae,U[ce+3]=1},$=function(k,D,U,ce){const re=k[D+3],ae=Math.pow(2,re-128)/255;U[ce+0]=qf.toHalfFloat(Math.min(k[D+0]*ae,65504)),U[ce+1]=qf.toHalfFloat(Math.min(k[D+1]*ae,65504)),U[ce+2]=qf.toHalfFloat(Math.min(k[D+2]*ae,65504)),U[ce+3]=qf.toHalfFloat(1)},E=new Uint8Array(e);E.pos=0;const S=m(E),A=S.width,C=S.height,x=v(E.subarray(E.pos),A,C);let I,O,F;switch(this.type){case Lr:F=x.length/4;const k=new Float32Array(F*4);for(let U=0;U<F;U++)y(x,U*4,k,U*4);I=k,O=Lr;break;case Jr:F=x.length/4;const D=new Uint16Array(F*4);for(let U=0;U<F;U++)$(x,U*4,D,U*4);I=D,O=Jr;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:A,height:C,data:I,header:S.string,gamma:S.gamma,exposure:S.exposure,type:O}}setDataType(e){return this.type=e,this}load(e,n,r,s){function a(l,u){switch(l.type){case Lr:case Jr:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=Dn,l.magFilter=Dn,l.generateMipmaps=!1,l.flipY=!0;break}n&&n(l,u)}return super.load(e,a,r,s)}}const JT="colorSpace"in new ni;class mK extends DM{constructor(e){super(e),this.type=Jr}parse(e){const D=Math.pow(2.7182818,2.2);function U(J,B){for(var le=0,_e=0;_e<65536;++_e)(_e==0||J[_e>>3]&1<<(_e&7))&&(B[le++]=_e);for(var pe=le-1;le<65536;)B[le++]=0;return pe}function ce(J){for(var B=0;B<16384;B++)J[B]={},J[B].len=0,J[B].lit=0,J[B].p=null}const re={l:0,c:0,lc:0};function ae(J,B,le,_e,pe){for(;le<J;)B=B<<8|he(_e,pe),le+=8;le-=J,re.l=B>>le&(1<<J)-1,re.c=B,re.lc=le}const ne=new Array(59);function de(J){for(var B=0;B<=58;++B)ne[B]=0;for(var B=0;B<65537;++B)ne[J[B]]+=1;for(var le=0,B=58;B>0;--B){var _e=le+ne[B]>>1;ne[B]=le,le=_e}for(var B=0;B<65537;++B){var pe=J[B];pe>0&&(J[B]=pe|ne[pe]++<<6)}}function ue(J,B,le,_e,pe,ye,Ze){for(var qe=le,at=0,rt=0;pe<=ye;pe++){if(qe.value-le.value>_e)return!1;ae(6,at,rt,J,qe);var pt=re.l;if(at=re.c,rt=re.lc,Ze[pe]=pt,pt==63){if(qe.value-le.value>_e)throw"Something wrong with hufUnpackEncTable";ae(8,at,rt,J,qe);var ke=re.l+6;if(at=re.c,rt=re.lc,pe+ke>ye+1)throw"Something wrong with hufUnpackEncTable";for(;ke--;)Ze[pe++]=0;pe--}else if(pt>=59){var ke=pt-59+2;if(pe+ke>ye+1)throw"Something wrong with hufUnpackEncTable";for(;ke--;)Ze[pe++]=0;pe--}}de(Ze)}function Re(J){return J&63}function G(J){return J>>6}function Z(J,B,le,_e){for(;B<=le;B++){var pe=G(J[B]),ye=Re(J[B]);if(pe>>ye)throw"Invalid table entry";if(ye>14){var Ze=_e[pe>>ye-14];if(Ze.len)throw"Invalid table entry";if(Ze.lit++,Ze.p){var qe=Ze.p;Ze.p=new Array(Ze.lit);for(var at=0;at<Ze.lit-1;++at)Ze.p[at]=qe[at]}else Ze.p=new Array(1);Ze.p[Ze.lit-1]=B}else if(ye)for(var rt=0,at=1<<14-ye;at>0;at--){var Ze=_e[(pe<<14-ye)+rt];if(Ze.len||Ze.p)throw"Invalid table entry";Ze.len=ye,Ze.lit=B,rt++}}return!0}const K={c:0,lc:0};function se(J,B,le,_e){J=J<<8|he(le,_e),B+=8,K.c=J,K.lc=B}const Y={c:0,lc:0};function me(J,B,le,_e,pe,ye,Ze,qe,at,rt){if(J==B){_e<8&&(se(le,_e,pe,Ze),le=K.c,_e=K.lc),_e-=8;var pt=le>>_e,pt=new Uint8Array([pt])[0];if(at.value+pt>rt)return!1;for(var ke=qe[at.value-1];pt-- >0;)qe[at.value++]=ke}else if(at.value<rt)qe[at.value++]=J;else return!1;Y.c=le,Y.lc=_e}function fe(J){return J&65535}function Ae(J){var B=fe(J);return B>32767?B-65536:B}const Ce={a:0,b:0};function Ie(J,B){var le=Ae(J),_e=Ae(B),pe=_e,ye=le+(pe&1)+(pe>>1),Ze=ye,qe=ye-pe;Ce.a=Ze,Ce.b=qe}function We(J,B){var le=fe(J),_e=fe(B),pe=le-(_e>>1)&65535,ye=_e+pe-32768&65535;Ce.a=ye,Ce.b=pe}function ut(J,B,le,_e,pe,ye,Ze){for(var qe=Ze<16384,at=le>pe?pe:le,rt=1,pt;rt<=at;)rt<<=1;for(rt>>=1,pt=rt,rt>>=1;rt>=1;){for(var ke=0,It=ke+ye*(pe-pt),Ct=ye*rt,wt=ye*pt,Ht=_e*rt,Zt=_e*pt,jt,Ot,qt,Ft;ke<=It;ke+=wt){for(var ln=ke,Fn=ke+_e*(le-pt);ln<=Fn;ln+=Zt){var sn=ln+Ht,$n=ln+Ct,tn=$n+Ht;qe?(Ie(J[ln+B],J[$n+B]),jt=Ce.a,qt=Ce.b,Ie(J[sn+B],J[tn+B]),Ot=Ce.a,Ft=Ce.b,Ie(jt,Ot),J[ln+B]=Ce.a,J[sn+B]=Ce.b,Ie(qt,Ft),J[$n+B]=Ce.a,J[tn+B]=Ce.b):(We(J[ln+B],J[$n+B]),jt=Ce.a,qt=Ce.b,We(J[sn+B],J[tn+B]),Ot=Ce.a,Ft=Ce.b,We(jt,Ot),J[ln+B]=Ce.a,J[sn+B]=Ce.b,We(qt,Ft),J[$n+B]=Ce.a,J[tn+B]=Ce.b)}if(le&rt){var $n=ln+Ct;qe?Ie(J[ln+B],J[$n+B]):We(J[ln+B],J[$n+B]),jt=Ce.a,J[$n+B]=Ce.b,J[ln+B]=jt}}if(pe&rt)for(var ln=ke,Fn=ke+_e*(le-pt);ln<=Fn;ln+=Zt){var sn=ln+Ht;qe?Ie(J[ln+B],J[sn+B]):We(J[ln+B],J[sn+B]),jt=Ce.a,J[sn+B]=Ce.b,J[ln+B]=jt}pt=rt,rt>>=1}return ke}function Ye(J,B,le,_e,pe,ye,Ze,qe,at,rt){for(var pt=0,ke=0,It=qe,Ct=Math.trunc(pe.value+(ye+7)/8);pe.value<Ct;)for(se(pt,ke,le,pe),pt=K.c,ke=K.lc;ke>=14;){var wt=pt>>ke-14&16383,Ht=B[wt];if(Ht.len)ke-=Ht.len,me(Ht.lit,Ze,pt,ke,le,_e,pe,at,rt,It),pt=Y.c,ke=Y.lc;else{if(!Ht.p)throw"hufDecode issues";var Zt;for(Zt=0;Zt<Ht.lit;Zt++){for(var jt=Re(J[Ht.p[Zt]]);ke<jt&&pe.value<Ct;)se(pt,ke,le,pe),pt=K.c,ke=K.lc;if(ke>=jt&&G(J[Ht.p[Zt]])==(pt>>ke-jt&(1<<jt)-1)){ke-=jt,me(Ht.p[Zt],Ze,pt,ke,le,_e,pe,at,rt,It),pt=Y.c,ke=Y.lc;break}}if(Zt==Ht.lit)throw"hufDecode issues"}}var Ot=8-ye&7;for(pt>>=Ot,ke-=Ot;ke>0;){var Ht=B[pt<<14-ke&16383];if(Ht.len)ke-=Ht.len,me(Ht.lit,Ze,pt,ke,le,_e,pe,at,rt,It),pt=Y.c,ke=Y.lc;else throw"hufDecode issues"}return!0}function we(J,B,le,_e,pe,ye){var Ze={value:0},qe=le.value,at=X(B,le),rt=X(B,le);le.value+=4;var pt=X(B,le);if(le.value+=4,at<0||at>=65537||rt<0||rt>=65537)throw"Something wrong with HUF_ENCSIZE";var ke=new Array(65537),It=new Array(16384);ce(It);var Ct=_e-(le.value-qe);if(ue(J,B,le,Ct,at,rt,ke),pt>8*(_e-(le.value-qe)))throw"Something wrong with hufUncompress";Z(ke,at,rt,It),Ye(ke,It,J,B,le,pt,rt,ye,pe,Ze)}function Q(J,B,le){for(var _e=0;_e<le;++_e)B[_e]=J[B[_e]]}function Ge(J){for(var B=1;B<J.length;B++){var le=J[B-1]+J[B]-128;J[B]=le}}function Oe(J,B){for(var le=0,_e=Math.floor((J.length+1)/2),pe=0,ye=J.length-1;!(pe>ye||(B[pe++]=J[le++],pe>ye));)B[pe++]=J[_e++]}function Ve(J){for(var B=J.byteLength,le=new Array,_e=0,pe=new DataView(J);B>0;){var ye=pe.getInt8(_e++);if(ye<0){var Ze=-ye;B-=Ze+1;for(var qe=0;qe<Ze;qe++)le.push(pe.getUint8(_e++))}else{var Ze=ye;B-=2;for(var at=pe.getUint8(_e++),qe=0;qe<Ze+1;qe++)le.push(at)}}return le}function Fe(J,B,le,_e,pe,ye){var sn=new DataView(ye.buffer),Ze=le[J.idx[0]].width,qe=le[J.idx[0]].height,at=3,rt=Math.floor(Ze/8),pt=Math.ceil(Ze/8),ke=Math.ceil(qe/8),It=Ze-(pt-1)*8,Ct=qe-(ke-1)*8,wt={value:0},Ht=new Array(at),Zt=new Array(at),jt=new Array(at),Ot=new Array(at),qt=new Array(at);for(let hn=0;hn<at;++hn)qt[hn]=B[J.idx[hn]],Ht[hn]=hn<1?0:Ht[hn-1]+pt*ke,Zt[hn]=new Float32Array(64),jt[hn]=new Uint16Array(64),Ot[hn]=new Uint16Array(pt*64);for(let hn=0;hn<ke;++hn){var Ft=8;hn==ke-1&&(Ft=Ct);var ln=8;for(let In=0;In<pt;++In){In==pt-1&&(ln=It);for(let Kt=0;Kt<at;++Kt)jt[Kt].fill(0),jt[Kt][0]=pe[Ht[Kt]++],tt(wt,_e,jt[Kt]),Ue(jt[Kt],Zt[Kt]),Je(Zt[Kt]);ve(Zt);for(let Kt=0;Kt<at;++Kt)Me(Zt[Kt],Ot[Kt],In*64)}let zn=0;for(let In=0;In<at;++In){const Kt=le[J.idx[In]].type;for(let An=8*hn;An<8*hn+Ft;++An){zn=qt[In][An];for(let Sr=0;Sr<rt;++Sr){const Ri=Sr*64+(An&7)*8;sn.setUint16(zn+0*2*Kt,Ot[In][Ri+0],!0),sn.setUint16(zn+1*2*Kt,Ot[In][Ri+1],!0),sn.setUint16(zn+2*2*Kt,Ot[In][Ri+2],!0),sn.setUint16(zn+3*2*Kt,Ot[In][Ri+3],!0),sn.setUint16(zn+4*2*Kt,Ot[In][Ri+4],!0),sn.setUint16(zn+5*2*Kt,Ot[In][Ri+5],!0),sn.setUint16(zn+6*2*Kt,Ot[In][Ri+6],!0),sn.setUint16(zn+7*2*Kt,Ot[In][Ri+7],!0),zn+=8*2*Kt}}if(rt!=pt)for(let An=8*hn;An<8*hn+Ft;++An){const Sr=qt[In][An]+8*rt*2*Kt,Ri=rt*64+(An&7)*8;for(let mn=0;mn<ln;++mn)sn.setUint16(Sr+mn*2*Kt,Ot[In][Ri+mn],!0)}}}for(var Fn=new Uint16Array(Ze),sn=new DataView(ye.buffer),$n=0;$n<at;++$n){le[J.idx[$n]].decoded=!0;var tn=le[J.idx[$n]].type;if(le[$n].type==2)for(var Un=0;Un<qe;++Un){const hn=qt[$n][Un];for(var Rn=0;Rn<Ze;++Rn)Fn[Rn]=sn.getUint16(hn+Rn*2*tn,!0);for(var Rn=0;Rn<Ze;++Rn)sn.setFloat32(hn+Rn*2*tn,Le(Fn[Rn]),!0)}}}function tt(J,B,le){for(var _e,pe=1;pe<64;)_e=B[J.value],_e==65280?pe=64:_e>>8==255?pe+=_e&255:(le[pe]=_e,pe++),J.value++}function Ue(J,B){B[0]=Le(J[0]),B[1]=Le(J[1]),B[2]=Le(J[5]),B[3]=Le(J[6]),B[4]=Le(J[14]),B[5]=Le(J[15]),B[6]=Le(J[27]),B[7]=Le(J[28]),B[8]=Le(J[2]),B[9]=Le(J[4]),B[10]=Le(J[7]),B[11]=Le(J[13]),B[12]=Le(J[16]),B[13]=Le(J[26]),B[14]=Le(J[29]),B[15]=Le(J[42]),B[16]=Le(J[3]),B[17]=Le(J[8]),B[18]=Le(J[12]),B[19]=Le(J[17]),B[20]=Le(J[25]),B[21]=Le(J[30]),B[22]=Le(J[41]),B[23]=Le(J[43]),B[24]=Le(J[9]),B[25]=Le(J[11]),B[26]=Le(J[18]),B[27]=Le(J[24]),B[28]=Le(J[31]),B[29]=Le(J[40]),B[30]=Le(J[44]),B[31]=Le(J[53]),B[32]=Le(J[10]),B[33]=Le(J[19]),B[34]=Le(J[23]),B[35]=Le(J[32]),B[36]=Le(J[39]),B[37]=Le(J[45]),B[38]=Le(J[52]),B[39]=Le(J[54]),B[40]=Le(J[20]),B[41]=Le(J[22]),B[42]=Le(J[33]),B[43]=Le(J[38]),B[44]=Le(J[46]),B[45]=Le(J[51]),B[46]=Le(J[55]),B[47]=Le(J[60]),B[48]=Le(J[21]),B[49]=Le(J[34]),B[50]=Le(J[37]),B[51]=Le(J[47]),B[52]=Le(J[50]),B[53]=Le(J[56]),B[54]=Le(J[59]),B[55]=Le(J[61]),B[56]=Le(J[35]),B[57]=Le(J[36]),B[58]=Le(J[48]),B[59]=Le(J[49]),B[60]=Le(J[57]),B[61]=Le(J[58]),B[62]=Le(J[62]),B[63]=Le(J[63])}function Je(J){const B=.5*Math.cos(.7853975),le=.5*Math.cos(3.14159/16),_e=.5*Math.cos(3.14159/8),pe=.5*Math.cos(3*3.14159/16),ye=.5*Math.cos(5*3.14159/16),Ze=.5*Math.cos(3*3.14159/8),qe=.5*Math.cos(7*3.14159/16);for(var at=new Array(4),rt=new Array(4),pt=new Array(4),ke=new Array(4),It=0;It<8;++It){var Ct=It*8;at[0]=_e*J[Ct+2],at[1]=Ze*J[Ct+2],at[2]=_e*J[Ct+6],at[3]=Ze*J[Ct+6],rt[0]=le*J[Ct+1]+pe*J[Ct+3]+ye*J[Ct+5]+qe*J[Ct+7],rt[1]=pe*J[Ct+1]-qe*J[Ct+3]-le*J[Ct+5]-ye*J[Ct+7],rt[2]=ye*J[Ct+1]-le*J[Ct+3]+qe*J[Ct+5]+pe*J[Ct+7],rt[3]=qe*J[Ct+1]-ye*J[Ct+3]+pe*J[Ct+5]-le*J[Ct+7],pt[0]=B*(J[Ct+0]+J[Ct+4]),pt[3]=B*(J[Ct+0]-J[Ct+4]),pt[1]=at[0]+at[3],pt[2]=at[1]-at[2],ke[0]=pt[0]+pt[1],ke[1]=pt[3]+pt[2],ke[2]=pt[3]-pt[2],ke[3]=pt[0]-pt[1],J[Ct+0]=ke[0]+rt[0],J[Ct+1]=ke[1]+rt[1],J[Ct+2]=ke[2]+rt[2],J[Ct+3]=ke[3]+rt[3],J[Ct+4]=ke[3]-rt[3],J[Ct+5]=ke[2]-rt[2],J[Ct+6]=ke[1]-rt[1],J[Ct+7]=ke[0]-rt[0]}for(var wt=0;wt<8;++wt)at[0]=_e*J[16+wt],at[1]=Ze*J[16+wt],at[2]=_e*J[48+wt],at[3]=Ze*J[48+wt],rt[0]=le*J[8+wt]+pe*J[24+wt]+ye*J[40+wt]+qe*J[56+wt],rt[1]=pe*J[8+wt]-qe*J[24+wt]-le*J[40+wt]-ye*J[56+wt],rt[2]=ye*J[8+wt]-le*J[24+wt]+qe*J[40+wt]+pe*J[56+wt],rt[3]=qe*J[8+wt]-ye*J[24+wt]+pe*J[40+wt]-le*J[56+wt],pt[0]=B*(J[wt]+J[32+wt]),pt[3]=B*(J[wt]-J[32+wt]),pt[1]=at[0]+at[3],pt[2]=at[1]-at[2],ke[0]=pt[0]+pt[1],ke[1]=pt[3]+pt[2],ke[2]=pt[3]-pt[2],ke[3]=pt[0]-pt[1],J[0+wt]=ke[0]+rt[0],J[8+wt]=ke[1]+rt[1],J[16+wt]=ke[2]+rt[2],J[24+wt]=ke[3]+rt[3],J[32+wt]=ke[3]-rt[3],J[40+wt]=ke[2]-rt[2],J[48+wt]=ke[1]-rt[1],J[56+wt]=ke[0]-rt[0]}function ve(J){for(var B=0;B<64;++B){var le=J[0][B],_e=J[1][B],pe=J[2][B];J[0][B]=le+1.5747*pe,J[1][B]=le-.1873*_e-.4682*pe,J[2][B]=le+1.8556*_e}}function Me(J,B,le){for(var _e=0;_e<64;++_e)B[le+_e]=qf.toHalfFloat(vt(J[_e]))}function vt(J){return J<=1?Math.sign(J)*Math.pow(Math.abs(J),2.2):Math.sign(J)*Math.pow(D,Math.abs(J)-1)}function oe(J){return new DataView(J.array.buffer,J.offset.value,J.size)}function ee(J){var B=J.viewer.buffer.slice(J.offset.value,J.offset.value+J.size),le=new Uint8Array(Ve(B)),_e=new Uint8Array(le.length);return Ge(le),Oe(le,_e),new DataView(_e.buffer)}function W(J){var B=J.array.slice(J.offset.value,J.offset.value+J.size),le=B0(B),_e=new Uint8Array(le.length);return Ge(le),Oe(le,_e),new DataView(_e.buffer)}function ot(J){for(var B=J.viewer,le={value:J.offset.value},_e=new Uint16Array(J.width*J.scanlineBlockSize*(J.channels*J.type)),pe=new Uint8Array(8192),ye=0,Ze=new Array(J.channels),qe=0;qe<J.channels;qe++)Ze[qe]={},Ze[qe].start=ye,Ze[qe].end=Ze[qe].start,Ze[qe].nx=J.width,Ze[qe].ny=J.lines,Ze[qe].size=J.type,ye+=Ze[qe].nx*Ze[qe].ny*Ze[qe].size;var at=Be(B,le),rt=Be(B,le);if(rt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(at<=rt)for(var qe=0;qe<rt-at+1;qe++)pe[qe+at]=z(B,le);var pt=new Uint16Array(65536),ke=U(pe,pt),It=X(B,le);we(J.array,B,le,It,_e,ye);for(var qe=0;qe<J.channels;++qe)for(var Ct=Ze[qe],wt=0;wt<Ze[qe].size;++wt)ut(_e,Ct.start+wt,Ct.nx,Ct.size,Ct.ny,Ct.nx*Ct.size,ke);Q(pt,_e,ye);for(var Ht=0,Zt=new Uint8Array(_e.buffer.byteLength),jt=0;jt<J.lines;jt++)for(var Ot=0;Ot<J.channels;Ot++){var Ct=Ze[Ot],qt=Ct.nx*Ct.size,Ft=new Uint8Array(_e.buffer,Ct.end*2,qt*2);Zt.set(Ft,Ht),Ht+=qt*2,Ct.end+=qt}return new DataView(Zt.buffer)}function je(J){var B=J.array.slice(J.offset.value,J.offset.value+J.size),le=B0(B);const _e=J.lines*J.channels*J.width,pe=J.type==1?new Uint16Array(_e):new Uint32Array(_e);let ye=0,Ze=0;const qe=new Array(4);for(let at=0;at<J.lines;at++)for(let rt=0;rt<J.channels;rt++){let pt=0;switch(J.type){case 1:qe[0]=ye,qe[1]=qe[0]+J.width,ye=qe[1]+J.width;for(let ke=0;ke<J.width;++ke){const It=le[qe[0]++]<<8|le[qe[1]++];pt+=It,pe[Ze]=pt,Ze++}break;case 2:qe[0]=ye,qe[1]=qe[0]+J.width,qe[2]=qe[1]+J.width,ye=qe[2]+J.width;for(let ke=0;ke<J.width;++ke){const It=le[qe[0]++]<<24|le[qe[1]++]<<16|le[qe[2]++]<<8;pt+=It,pe[Ze]=pt,Ze++}break}}return new DataView(pe.buffer)}function Qe(J){var B=J.viewer,le={value:J.offset.value},_e=new Uint8Array(J.width*J.lines*(J.channels*J.type*2)),pe={version:be(B,le),unknownUncompressedSize:be(B,le),unknownCompressedSize:be(B,le),acCompressedSize:be(B,le),dcCompressedSize:be(B,le),rleCompressedSize:be(B,le),rleUncompressedSize:be(B,le),rleRawSize:be(B,le),totalAcUncompressedCount:be(B,le),totalDcUncompressedCount:be(B,le),acCompression:be(B,le)};if(pe.version<2)throw"EXRLoader.parse: "+Ti.compression+" version "+pe.version+" is unsupported";for(var ye=new Array,Ze=Be(B,le)-2;Ze>0;){var qe=ht(B.buffer,le),at=z(B,le),rt=at>>2&3,pt=(at>>4)-1,ke=new Int8Array([pt])[0],It=z(B,le);ye.push({name:qe,index:ke,type:It,compression:rt}),Ze-=qe.length+3}for(var Ct=Ti.channels,wt=new Array(J.channels),Ht=0;Ht<J.channels;++Ht){var Zt=wt[Ht]={},jt=Ct[Ht];Zt.name=jt.name,Zt.compression=0,Zt.decoded=!1,Zt.type=jt.pixelType,Zt.pLinear=jt.pLinear,Zt.width=J.width,Zt.height=J.lines}for(var Ot={idx:new Array(3)},qt=0;qt<J.channels;++qt)for(var Zt=wt[qt],Ht=0;Ht<ye.length;++Ht){var Ft=ye[Ht];Zt.name==Ft.name&&(Zt.compression=Ft.compression,Ft.index>=0&&(Ot.idx[Ft.index]=qt),Zt.offset=qt)}if(pe.acCompressedSize>0)switch(pe.acCompression){case 0:var sn=new Uint16Array(pe.totalAcUncompressedCount);we(J.array,B,le,pe.acCompressedSize,sn,pe.totalAcUncompressedCount);break;case 1:var ln=J.array.slice(le.value,le.value+pe.totalAcUncompressedCount),Fn=B0(ln),sn=new Uint16Array(Fn.buffer);le.value+=pe.totalAcUncompressedCount;break}if(pe.dcCompressedSize>0){var $n={array:J.array,offset:le,size:pe.dcCompressedSize},tn=new Uint16Array(W($n).buffer);le.value+=pe.dcCompressedSize}if(pe.rleRawSize>0){var ln=J.array.slice(le.value,le.value+pe.rleCompressedSize),Fn=B0(ln),Un=Ve(Fn.buffer);le.value+=pe.rleCompressedSize}for(var Rn=0,hn=new Array(wt.length),Ht=0;Ht<hn.length;++Ht)hn[Ht]=new Array;for(var zn=0;zn<J.lines;++zn)for(var In=0;In<wt.length;++In)hn[In].push(Rn),Rn+=wt[In].width*J.type*2;Fe(Ot,hn,wt,sn,tn,_e);for(var Ht=0;Ht<wt.length;++Ht){var Zt=wt[Ht];if(!Zt.decoded)switch(Zt.compression){case 2:for(var Kt=0,An=0,zn=0;zn<J.lines;++zn){for(var Sr=hn[Ht][Kt],Ri=0;Ri<Zt.width;++Ri){for(var mn=0;mn<2*Zt.type;++mn)_e[Sr++]=Un[An+mn*Zt.width*Zt.height];An++}Kt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(_e.buffer)}function ht(J,B){for(var le=new Uint8Array(J),_e=0;le[B.value+_e]!=0;)_e+=1;var pe=new TextDecoder().decode(le.slice(B.value,B.value+_e));return B.value=B.value+_e+1,pe}function ft(J,B,le){var _e=new TextDecoder().decode(new Uint8Array(J).slice(B.value,B.value+le));return B.value=B.value+le,_e}function He(J,B){var le=L(J,B),_e=X(J,B);return[le,_e]}function St(J,B){var le=X(J,B),_e=X(J,B);return[le,_e]}function L(J,B){var le=J.getInt32(B.value,!0);return B.value=B.value+4,le}function X(J,B){var le=J.getUint32(B.value,!0);return B.value=B.value+4,le}function he(J,B){var le=J[B.value];return B.value=B.value+1,le}function z(J,B){var le=J.getUint8(B.value);return B.value=B.value+1,le}const be=function(J,B){let le;return"getBigInt64"in DataView.prototype?le=Number(J.getBigInt64(B.value,!0)):le=J.getUint32(B.value+4,!0)+Number(J.getUint32(B.value,!0)<<32),B.value+=8,le};function nt(J,B){var le=J.getFloat32(B.value,!0);return B.value+=4,le}function Ee(J,B){return qf.toHalfFloat(nt(J,B))}function Le(J){var B=(J&31744)>>10,le=J&1023;return(J>>15?-1:1)*(B?B===31?le?NaN:1/0:Math.pow(2,B-15)*(1+le/1024):6103515625e-14*(le/1024))}function Be(J,B){var le=J.getUint16(B.value,!0);return B.value+=2,le}function N(J,B){return Le(Be(J,B))}function j(J,B,le,_e){for(var pe=le.value,ye=[];le.value<pe+_e-1;){var Ze=ht(B,le),qe=L(J,le),at=z(J,le);le.value+=3;var rt=L(J,le),pt=L(J,le);ye.push({name:Ze,pixelType:qe,pLinear:at,xSampling:rt,ySampling:pt})}return le.value+=1,ye}function ge(J,B){var le=nt(J,B),_e=nt(J,B),pe=nt(J,B),ye=nt(J,B),Ze=nt(J,B),qe=nt(J,B),at=nt(J,B),rt=nt(J,B);return{redX:le,redY:_e,greenX:pe,greenY:ye,blueX:Ze,blueY:qe,whiteX:at,whiteY:rt}}function xe(J,B){var le=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],_e=z(J,B);return le[_e]}function Ke(J,B){var le=X(J,B),_e=X(J,B),pe=X(J,B),ye=X(J,B);return{xMin:le,yMin:_e,xMax:pe,yMax:ye}}function gt(J,B){var le=["INCREASING_Y"],_e=z(J,B);return le[_e]}function $t(J,B){var le=nt(J,B),_e=nt(J,B);return[le,_e]}function un(J,B){var le=nt(J,B),_e=nt(J,B),pe=nt(J,B);return[le,_e,pe]}function an(J,B,le,_e,pe){if(_e==="string"||_e==="stringvector"||_e==="iccProfile")return ft(B,le,pe);if(_e==="chlist")return j(J,B,le,pe);if(_e==="chromaticities")return ge(J,le);if(_e==="compression")return xe(J,le);if(_e==="box2i")return Ke(J,le);if(_e==="lineOrder")return gt(J,le);if(_e==="float")return nt(J,le);if(_e==="v2f")return $t(J,le);if(_e==="v3f")return un(J,le);if(_e==="int")return L(J,le);if(_e==="rational")return He(J,le);if(_e==="timecode")return St(J,le);if(_e==="preview")return le.value+=pe,"skipped";le.value+=pe}function ei(J,B,le){const _e={};if(J.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";_e.version=J.getUint8(4);const pe=J.getUint8(5);_e.spec={singleTile:!!(pe&2),longName:!!(pe&4),deepFormat:!!(pe&8),multiPart:!!(pe&16)},le.value=8;for(var ye=!0;ye;){var Ze=ht(B,le);if(Ze==0)ye=!1;else{var qe=ht(B,le),at=X(J,le),rt=an(J,B,le,qe,at);rt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${qe}'.`):_e[Ze]=rt}}if(pe&-5)throw console.error("EXRHeader:",_e),"THREE.EXRLoader: provided file is currently unsupported.";return _e}function fi(J,B,le,_e,pe){const ye={size:0,viewer:B,array:le,offset:_e,width:J.dataWindow.xMax-J.dataWindow.xMin+1,height:J.dataWindow.yMax-J.dataWindow.yMin+1,channels:J.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:J.channels[0].pixelType,uncompress:null,getter:null,format:null,[JT?"colorSpace":"encoding"]:null};switch(J.compression){case"NO_COMPRESSION":ye.lines=1,ye.uncompress=oe;break;case"RLE_COMPRESSION":ye.lines=1,ye.uncompress=ee;break;case"ZIPS_COMPRESSION":ye.lines=1,ye.uncompress=W;break;case"ZIP_COMPRESSION":ye.lines=16,ye.uncompress=W;break;case"PIZ_COMPRESSION":ye.lines=32,ye.uncompress=ot;break;case"PXR24_COMPRESSION":ye.lines=16,ye.uncompress=je;break;case"DWAA_COMPRESSION":ye.lines=32,ye.uncompress=Qe;break;case"DWAB_COMPRESSION":ye.lines=256,ye.uncompress=Qe;break;default:throw"EXRLoader.parse: "+J.compression+" is unsupported"}if(ye.scanlineBlockSize=ye.lines,ye.type==1)switch(pe){case Lr:ye.getter=N,ye.inputSize=2;break;case Jr:ye.getter=Be,ye.inputSize=2;break}else if(ye.type==2)switch(pe){case Lr:ye.getter=nt,ye.inputSize=4;break;case Jr:ye.getter=Ee,ye.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ye.type+" for "+J.compression+".";ye.blockCount=(J.dataWindow.yMax+1)/ye.scanlineBlockSize;for(var Ze=0;Ze<ye.blockCount;Ze++)be(B,_e);ye.outputChannels=ye.channels==3?4:ye.channels;const qe=ye.width*ye.height*ye.outputChannels;switch(pe){case Lr:ye.byteArray=new Float32Array(qe),ye.channels<ye.outputChannels&&ye.byteArray.fill(1,0,qe);break;case Jr:ye.byteArray=new Uint16Array(qe),ye.channels<ye.outputChannels&&ye.byteArray.fill(15360,0,qe);break;default:console.error("THREE.EXRLoader: unsupported type: ",pe);break}return ye.bytesPerLine=ye.width*ye.inputSize*ye.channels,ye.outputChannels==4?ye.format=Yr:ye.format=lM,JT?ye.colorSpace="srgb-linear":ye.encoding=3e3,ye}const Ki=new DataView(e),Ci=new Uint8Array(e),_i={value:0},Ti=ei(Ki,e,_i),nn=fi(Ti,Ki,Ci,_i,this.type),pi={value:0},yr={R:0,G:1,B:2,A:3,Y:0};for(let J=0;J<nn.height/nn.scanlineBlockSize;J++){const B=X(Ki,_i);nn.size=X(Ki,_i),nn.lines=B+nn.scanlineBlockSize>nn.height?nn.height-B:nn.scanlineBlockSize;const _e=nn.size<nn.lines*nn.bytesPerLine?nn.uncompress(nn):oe(nn);_i.value+=nn.size;for(let pe=0;pe<nn.scanlineBlockSize;pe++){const ye=pe+J*nn.scanlineBlockSize;if(ye>=nn.height)break;for(let Ze=0;Ze<nn.channels;Ze++){const qe=yr[Ti.channels[Ze].name];for(let at=0;at<nn.width;at++){pi.value=(pe*(nn.channels*nn.width)+Ze*nn.width+at)*nn.inputSize;const rt=(nn.height-1-ye)*(nn.width*nn.outputChannels)+at*nn.outputChannels+qe;nn.byteArray[rt]=nn.getter(_e,pi)}}}}return{header:Ti,width:nn.width,height:nn.height,data:nn.byteArray,format:nn.format,[JT?"colorSpace":"encoding"]:nn[JT?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,r,s){function a(l,u){JT?l.colorSpace=u.colorSpace:l.encoding=u.encoding,l.minFilter=Dn,l.magFilter=Dn,l.generateMipmaps=!1,l.flipY=!1,n&&n(l,u)}return super.load(e,a,r,s)}}const KC=new WeakMap;class gK extends ls{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,r,s){const a=new Nr(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,l=>{const u={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(l,u).then(n).catch(s)},r,s)}decodeDracoFile(e,n,r,s){const a={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,a).then(n)}decodeGeometry(e,n){for(const d in n.attributeTypes){const h=n.attributeTypes[d];h.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[d]=h.name)}const r=JSON.stringify(n);if(KC.has(e)){const d=KC.get(e);if(d.key===r)return d.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const a=this.workerNextTaskID++,l=e.byteLength,u=this._getWorker(a,l).then(d=>(s=d,new Promise((h,f)=>{s._callbacks[a]={resolve:h,reject:f},s.postMessage({type:"decode",id:a,taskConfig:n,buffer:e},[e])}))).then(d=>this._createGeometry(d.geometry));return u.catch(()=>!0).then(()=>{s&&a&&this._releaseTask(s,a)}),KC.set(e,{key:r,promise:u}),u}_createGeometry(e){const n=new on;e.index&&n.setIndex(new Qn(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const s=e.attributes[r],a=s.name,l=s.array,u=s.itemSize;n.setAttribute(a,new Qn(l,u))}return n}_loadLibrary(e,n){const r=new Nr(this.manager);return r.setPath(this.decoderPath),r.setResponseType(n),r.setWithCredentials(this.withCredentials),new Promise((s,a)=>{r.load(e,s,void 0,a)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(r=>{const s=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const a=_K.toString(),l=["/* draco decoder */",s,"","/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(a){const l=a.data;switch(l.type){case"decode":s._callbacks[l.id].resolve(l);break;case"error":s._callbacks[l.id].reject(l);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+l.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,a){return s._taskLoad>a._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=n,r._taskLoad+=n,r})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function _K(){let i,e;onmessage=function(l){const u=l.data;switch(u.type){case"init":i=u.decoderConfig,e=new Promise(function(f){i.onModuleLoaded=function(p){f({draco:p})},DracoDecoderModule(i)});break;case"decode":const d=u.buffer,h=u.taskConfig;e.then(f=>{const p=f.draco,m=new p.Decoder,v=new p.DecoderBuffer;v.Init(new Int8Array(d),d.byteLength);try{const y=n(p,m,v,h),$=y.attributes.map(E=>E.array.buffer);y.index&&$.push(y.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:y},$)}catch(y){console.error(y),self.postMessage({type:"error",id:u.id,error:y.message})}finally{p.destroy(v),p.destroy(m)}});break}};function n(l,u,d,h){const f=h.attributeIDs,p=h.attributeTypes;let m,v;const y=u.GetEncodedGeometryType(d);if(y===l.TRIANGULAR_MESH)m=new l.Mesh,v=u.DecodeBufferToMesh(d,m);else if(y===l.POINT_CLOUD)m=new l.PointCloud,v=u.DecodeBufferToPointCloud(d,m);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!v.ok()||m.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+v.error_msg());const $={index:null,attributes:[]};for(const E in f){const S=self[p[E]];let A,C;if(h.useUniqueIDs)C=f[E],A=u.GetAttributeByUniqueId(m,C);else{if(C=u.GetAttributeId(m,l[f[E]]),C===-1)continue;A=u.GetAttribute(m,C)}$.attributes.push(s(l,u,m,E,S,A))}return y===l.TRIANGULAR_MESH&&($.index=r(l,u,m)),l.destroy(m),$}function r(l,u,d){const f=d.num_faces()*3,p=f*4,m=l._malloc(p);u.GetTrianglesUInt32Array(d,p,m);const v=new Uint32Array(l.HEAPF32.buffer,m,f).slice();return l._free(m),{array:v,itemSize:1}}function s(l,u,d,h,f,p){const m=p.num_components(),y=d.num_points()*m,$=y*f.BYTES_PER_ELEMENT,E=a(l,f),S=l._malloc($);u.GetAttributeDataArrayForAllPoints(d,p,E,$,S);const A=new f(l.HEAPF32.buffer,S,y).slice();return l._free(S),{name:h,array:A,itemSize:m}}function a(l,u){switch(u){case Float32Array:return l.DT_FLOAT32;case Int8Array:return l.DT_INT8;case Int16Array:return l.DT_INT16;case Int32Array:return l.DT_INT32;case Uint8Array:return l.DT_UINT8;case Uint16Array:return l.DT_UINT16;case Uint32Array:return l.DT_UINT32}}}const Mk=new zs,U0=new ie;class qM extends Y${constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],n=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],r=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(r),this.setAttribute("position",new Yt(e,3)),this.setAttribute("uv",new Yt(n,2))}applyMatrix4(e){const n=this.attributes.instanceStart,r=this.attributes.instanceEnd;return n!==void 0&&(n.applyMatrix4(e),r.applyMatrix4(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const r=new YS(n,6,1);return this.setAttribute("instanceStart",new oo(r,3,0)),this.setAttribute("instanceEnd",new oo(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,n=3){let r;e instanceof Float32Array?r=e:Array.isArray(e)&&(r=new Float32Array(e));const s=new YS(r,n*2,1);return this.setAttribute("instanceColorStart",new oo(s,n,0)),this.setAttribute("instanceColorEnd",new oo(s,n,n)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new OM(e.geometry)),this}fromLineSegments(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new zs);const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;e!==void 0&&n!==void 0&&(this.boundingBox.setFromBufferAttribute(e),Mk.setFromBufferAttribute(n),this.boundingBox.union(Mk))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ws),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(e!==void 0&&n!==void 0){const r=this.boundingSphere.center;this.boundingBox.getCenter(r);let s=0;for(let a=0,l=e.count;a<l;a++)U0.fromBufferAttribute(e,a),s=Math.max(s,r.distanceToSquared(U0)),U0.fromBufferAttribute(n,a),s=Math.max(s,r.distanceToSquared(U0));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class i2 extends qM{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const n=e.length-3,r=new Float32Array(2*n);for(let s=0;s<n;s+=3)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5];return super.setPositions(r),this}setColors(e,n=3){const r=e.length-n,s=new Float32Array(2*r);if(n===3)for(let a=0;a<r;a+=n)s[2*a]=e[a],s[2*a+1]=e[a+1],s[2*a+2]=e[a+2],s[2*a+3]=e[a+3],s[2*a+4]=e[a+4],s[2*a+5]=e[a+5];else for(let a=0;a<r;a+=n)s[2*a]=e[a],s[2*a+1]=e[a+1],s[2*a+2]=e[a+2],s[2*a+3]=e[a+3],s[2*a+4]=e[a+4],s[2*a+5]=e[a+5],s[2*a+6]=e[a+6],s[2*a+7]=e[a+7];return super.setColors(s,n),this}fromLine(e){const n=e.geometry;return this.setPositions(n.attributes.position.array),this}}class QM extends wo{constructor(e){super({type:"LineMaterial",uniforms:oE.clone(oE.merge([Lt.common,Lt.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new mt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${parseInt(Ip.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(n){this.uniforms.diffuse.value=n}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(n){n===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(n){this.uniforms.linewidth.value=n}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(n){!!n!="USE_DASH"in this.defines&&(this.needsUpdate=!0),n===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(n){this.uniforms.dashScale.value=n}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(n){this.uniforms.dashSize.value=n}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(n){this.uniforms.dashOffset.value=n}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(n){this.uniforms.gapSize.value=n}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(n){this.uniforms.opacity.value=n}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(n){this.uniforms.resolution.value.copy(n)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(n){!!n!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),n===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const JC=new Hn,Ik=new ie,Ok=new ie,Ts=new Hn,vs=new Hn,_c=new Hn,ZC=new ie,qC=new pn,Ss=new vU,Lk=new ie,G0=new zs,H0=new Ws,Tc=new Hn;let yc,dp;function Nk(i,e,n){return Tc.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),Tc.multiplyScalar(1/Tc.w),Tc.x=dp/n.width,Tc.y=dp/n.height,Tc.applyMatrix4(i.projectionMatrixInverse),Tc.multiplyScalar(1/Tc.w),Math.abs(Math.max(Tc.x,Tc.y))}function TK(i,e){const n=i.matrixWorld,r=i.geometry,s=r.attributes.instanceStart,a=r.attributes.instanceEnd,l=Math.min(r.instanceCount,s.count);for(let u=0,d=l;u<d;u++){Ss.start.fromBufferAttribute(s,u),Ss.end.fromBufferAttribute(a,u),Ss.applyMatrix4(n);const h=new ie,f=new ie;yc.distanceSqToSegment(Ss.start,Ss.end,f,h),f.distanceTo(h)<dp*.5&&e.push({point:f,pointOnLine:h,distance:yc.origin.distanceTo(f),object:i,face:null,faceIndex:u,uv:null,[YU]:null})}}function vK(i,e,n){const r=e.projectionMatrix,a=i.material.resolution,l=i.matrixWorld,u=i.geometry,d=u.attributes.instanceStart,h=u.attributes.instanceEnd,f=Math.min(u.instanceCount,d.count),p=-e.near;yc.at(1,_c),_c.w=1,_c.applyMatrix4(e.matrixWorldInverse),_c.applyMatrix4(r),_c.multiplyScalar(1/_c.w),_c.x*=a.x/2,_c.y*=a.y/2,_c.z=0,ZC.copy(_c),qC.multiplyMatrices(e.matrixWorldInverse,l);for(let m=0,v=f;m<v;m++){if(Ts.fromBufferAttribute(d,m),vs.fromBufferAttribute(h,m),Ts.w=1,vs.w=1,Ts.applyMatrix4(qC),vs.applyMatrix4(qC),Ts.z>p&&vs.z>p)continue;if(Ts.z>p){const C=Ts.z-vs.z,x=(Ts.z-p)/C;Ts.lerp(vs,x)}else if(vs.z>p){const C=vs.z-Ts.z,x=(vs.z-p)/C;vs.lerp(Ts,x)}Ts.applyMatrix4(r),vs.applyMatrix4(r),Ts.multiplyScalar(1/Ts.w),vs.multiplyScalar(1/vs.w),Ts.x*=a.x/2,Ts.y*=a.y/2,vs.x*=a.x/2,vs.y*=a.y/2,Ss.start.copy(Ts),Ss.start.z=0,Ss.end.copy(vs),Ss.end.z=0;const $=Ss.closestPointToPointParameter(ZC,!0);Ss.at($,Lk);const E=lp.lerp(Ts.z,vs.z,$),S=E>=-1&&E<=1,A=ZC.distanceTo(Lk)<dp*.5;if(S&&A){Ss.start.fromBufferAttribute(d,m),Ss.end.fromBufferAttribute(h,m),Ss.start.applyMatrix4(l),Ss.end.applyMatrix4(l);const C=new ie,x=new ie;yc.distanceSqToSegment(Ss.start,Ss.end,x,C),n.push({point:x,pointOnLine:C,distance:yc.origin.distanceTo(x),object:i,face:null,faceIndex:m,uv:null,[YU]:null})}}}class r2 extends Bn{constructor(e=new qM,n=new QM({color:Math.random()*16777215})){super(e,n),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,n=e.attributes.instanceStart,r=e.attributes.instanceEnd,s=new Float32Array(2*n.count);for(let l=0,u=0,d=n.count;l<d;l++,u+=2)Ik.fromBufferAttribute(n,l),Ok.fromBufferAttribute(r,l),s[u]=u===0?0:s[u-1],s[u+1]=s[u]+Ik.distanceTo(Ok);const a=new YS(s,2,1);return e.setAttribute("instanceDistanceStart",new oo(a,1,0)),e.setAttribute("instanceDistanceEnd",new oo(a,1,1)),this}raycast(e,n){const r=this.material.worldUnits,s=e.camera;s===null&&!r&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const a=e.params.Line2!==void 0&&e.params.Line2.threshold||0;yc=e.ray;const l=this.matrixWorld,u=this.geometry,d=this.material;dp=d.linewidth+a,u.boundingSphere===null&&u.computeBoundingSphere(),H0.copy(u.boundingSphere).applyMatrix4(l);let h;if(r)h=dp*.5;else{const p=Math.max(s.near,H0.distanceToPoint(yc.origin));h=Nk(s,p,d.resolution)}if(H0.radius+=h,yc.intersectsSphere(H0)===!1)return;u.boundingBox===null&&u.computeBoundingBox(),G0.copy(u.boundingBox).applyMatrix4(l);let f;if(r)f=dp*.5;else{const p=Math.max(s.near,G0.distanceToPoint(yc.origin));f=Nk(s,p,d.resolution)}G0.expandByScalar(f),yc.intersectsBox(G0)!==!1&&(r?TK(this,n):vK(this,s,n))}onBeforeRender(e){const n=this.material.uniforms;n&&n.resolution&&(e.getViewport(JC),this.material.uniforms.resolution.value.set(JC.z,JC.w))}}class EK extends r2{constructor(e=new i2,n=new QM({color:Math.random()*16777215})){super(e,n),this.isLine2=!0,this.type="Line2"}}let V0;const QC=()=>{if(V0)return V0;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=i;WebAssembly.validate(n)&&(s=e);let a;const l=WebAssembly.instantiate(u(s),{}).then(p=>{a=p.instance,a.exports.__wasm_call_ctors()});function u(p){const m=new Uint8Array(p.length);for(let y=0;y<p.length;++y){const $=p.charCodeAt(y);m[y]=$>96?$-71:$>64?$-65:$>47?$+4:$>46?63:62}let v=0;for(let y=0;y<p.length;++y)m[v++]=m[y]<60?r[m[y]]:(m[y]-60)*64+m[++y];return m.buffer.slice(0,v)}function d(p,m,v,y,$,E){const S=a.exports.sbrk,A=v+3&-4,C=S(A*y),x=S($.length),I=new Uint8Array(a.exports.memory.buffer);I.set($,x);const O=p(C,v,y,x,$.length);if(O===0&&E&&E(C,A,y),m.set(I.subarray(C,C+v*y)),S(C-S(0)),O!==0)throw new Error(`Malformed buffer data: ${O}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},f={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return V0={ready:l,supported:!0,decodeVertexBuffer(p,m,v,y,$){d(a.exports.meshopt_decodeVertexBuffer,p,m,v,y,a.exports[h[$]])},decodeIndexBuffer(p,m,v,y){d(a.exports.meshopt_decodeIndexBuffer,p,m,v,y)},decodeIndexSequence(p,m,v,y){d(a.exports.meshopt_decodeIndexSequence,p,m,v,y)},decodeGltfBuffer(p,m,v,y,$,E){d(a.exports[f[$]],p,m,v,y,a.exports[h[E]])}},V0},Rl=q.forwardRef(function({children:e,follow:n=!0,lockX:r=!1,lockY:s=!1,lockZ:a=!1,...l},u){const d=q.useRef(null),h=q.useRef(null),f=new Er;return c_(({camera:p})=>{if(!n||!h.current)return;const m=h.current.rotation.clone();h.current.updateMatrix(),h.current.updateWorldMatrix(!1,!1),h.current.getWorldQuaternion(f),p.getWorldQuaternion(d.current.quaternion).premultiply(f.invert()),r&&(h.current.rotation.x=m.x),s&&(h.current.rotation.y=m.y),a&&(h.current.rotation.z=m.z)}),q.useImperativeHandle(u,()=>h.current,[]),q.createElement("group",Xa({ref:h},l),q.createElement("group",{ref:d},e))}),eI=q.forwardRef(function({points:e,color:n=16777215,vertexColors:r,linewidth:s,lineWidth:a,segments:l,dashed:u,...d},h){var f,p;const m=Mn(S=>S.size),v=q.useMemo(()=>l?new r2:new EK,[l]),[y]=q.useState(()=>new QM),$=(r==null||(f=r[0])==null?void 0:f.length)===4?4:3,E=q.useMemo(()=>{const S=l?new qM:new i2,A=e.map(C=>{const x=Array.isArray(C);return C instanceof ie||C instanceof Hn?[C.x,C.y,C.z]:C instanceof mt?[C.x,C.y,0]:x&&C.length===3?[C[0],C[1],C[2]]:x&&C.length===2?[C[0],C[1],0]:C});if(S.setPositions(A.flat()),r){n=16777215;const C=r.map(x=>x instanceof xt?x.toArray():x);S.setColors(C.flat(),$)}return S},[e,l,r,$]);return q.useLayoutEffect(()=>{v.computeLineDistances()},[e,v]),q.useLayoutEffect(()=>{u?y.defines.USE_DASH="":delete y.defines.USE_DASH,y.needsUpdate=!0},[u,y]),q.useEffect(()=>()=>{E.dispose(),y.dispose()},[E]),q.createElement("primitive",Xa({object:v,ref:h},d),q.createElement("primitive",{object:E,attach:"geometry"}),q.createElement("primitive",Xa({object:y,attach:"material",color:n,vertexColors:!!r,resolution:[m.width,m.height],linewidth:(p=s??a)!==null&&p!==void 0?p:1,dashed:u,transparent:$===4},d)))});function yK(){var i=Object.create(null);function e(s,a){var l=s.id,u=s.name,d=s.dependencies;d===void 0&&(d=[]);var h=s.init;h===void 0&&(h=function(){});var f=s.getTransferables;if(f===void 0&&(f=null),!i[l])try{d=d.map(function(m){return m&&m.isWorkerModule&&(e(m,function(v){if(v instanceof Error)throw v}),m=i[m.id].value),m}),h=r("<"+u+">.init",h),f&&(f=r("<"+u+">.getTransferables",f));var p=null;typeof h=="function"?p=h.apply(void 0,d):console.error("worker module init function failed to rehydrate"),i[l]={id:l,value:p,getTransferables:f},a(p)}catch(m){m&&m.noLog||console.error(m),a(m)}}function n(s,a){var l,u=s.id,d=s.args;(!i[u]||typeof i[u].value!="function")&&a(new Error("Worker module "+u+": not found or its 'init' did not return a function"));try{var h=(l=i[u]).value.apply(l,d);h&&typeof h.then=="function"?h.then(f,function(p){return a(p instanceof Error?p:new Error(""+p))}):f(h)}catch(p){a(p)}function f(p){try{var m=i[u].getTransferables&&i[u].getTransferables(p);(!m||!Array.isArray(m)||!m.length)&&(m=void 0),a(p,m)}catch(v){console.error(v),a(v)}}}function r(s,a){var l=void 0;self.troikaDefine=function(d){return l=d};var u=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+a+`
)`],{type:"application/javascript"}));try{importScripts(u)}catch(d){console.error(d)}return URL.revokeObjectURL(u),delete self.troikaDefine,l}self.addEventListener("message",function(s){var a=s.data,l=a.messageId,u=a.action,d=a.data;try{u==="registerModule"&&e(d,function(h){h instanceof Error?postMessage({messageId:l,success:!1,error:h.message}):postMessage({messageId:l,success:!0,result:{isCallable:typeof h=="function"}})}),u==="callModule"&&n(d,function(h,f){h instanceof Error?postMessage({messageId:l,success:!1,error:h.message}):postMessage({messageId:l,success:!0,result:h},f||void 0)})}catch(h){postMessage({messageId:l,success:!1,error:h.stack})}})}function SK(i){var e=function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=i.dependencies,r=i.init;n=Array.isArray(n)?n.map(function(a){return a&&a._getInitResult?a._getInitResult():a}):[];var s=Promise.all(n).then(function(a){return r.apply(null,a)});return e._getInitResult=function(){return s},s},e}var s2=function(){var i=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),i=!0}catch(n){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return s2=function(){return i},i},$K=0,bK=0,eR=!1,Nv=Object.create(null),kv=Object.create(null),qx=Object.create(null);function u_(i){if((!i||typeof i.init!="function")&&!eR)throw new Error("requires `options.init` function");var e=i.dependencies,n=i.init,r=i.getTransferables,s=i.workerId;if(!s2())return SK(i);s==null&&(s="#default");var a="workerModule"+ ++$K,l=i.name||a,u=null;e=e&&e.map(function(h){return typeof h=="function"&&!h.workerModuleData&&(eR=!0,h=u_({workerId:s,name:"<"+l+"> function dependency: "+h.name,init:`function(){return (
`+TS(h)+`
)}`}),eR=!1),h&&h.workerModuleData&&(h=h.workerModuleData),h});function d(){for(var h=[],f=arguments.length;f--;)h[f]=arguments[f];if(!u){u=kk(s,"registerModule",d.workerModuleData);var p=function(){u=null,kv[s].delete(p)};(kv[s]||(kv[s]=new Set)).add(p)}return u.then(function(m){var v=m.isCallable;if(v)return kk(s,"callModule",{id:a,args:h});throw new Error("Worker module function was called but `init` did not return a callable function")})}return d.workerModuleData={isWorkerModule:!0,id:a,name:l,dependencies:e,init:TS(n),getTransferables:r&&TS(r)},d}function AK(i){kv[i]&&kv[i].forEach(function(e){e()}),Nv[i]&&(Nv[i].terminate(),delete Nv[i])}function TS(i){var e=i.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function CK(i){var e=Nv[i];if(!e){var n=TS(yK);e=Nv[i]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+i.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(r){var s=r.data,a=s.messageId,l=qx[a];if(!l)throw new Error("WorkerModule response with empty or unknown messageId");delete qx[a],l(s)}}return e}function kk(i,e,n){return new Promise(function(r,s){var a=++bK;qx[a]=function(l){l.success?r(l.result):s(new Error("Error in worker "+e+" call: "+l.error))},CK(i).postMessage({messageId:a,action:e,data:n})})}function o2(){var i=function(e){function n(Z,K,se,Y,me,fe,Ae,Ce){var Ie=1-Ae;Ce.x=Ie*Ie*Z+2*Ie*Ae*se+Ae*Ae*me,Ce.y=Ie*Ie*K+2*Ie*Ae*Y+Ae*Ae*fe}function r(Z,K,se,Y,me,fe,Ae,Ce,Ie,We){var ut=1-Ie;We.x=ut*ut*ut*Z+3*ut*ut*Ie*se+3*ut*Ie*Ie*me+Ie*Ie*Ie*Ae,We.y=ut*ut*ut*K+3*ut*ut*Ie*Y+3*ut*Ie*Ie*fe+Ie*Ie*Ie*Ce}function s(Z,K){for(var se=/([MLQCZ])([^MLQCZ]*)/g,Y,me,fe,Ae,Ce;Y=se.exec(Z);){var Ie=Y[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(We){return parseFloat(We)});switch(Y[1]){case"M":Ae=me=Ie[0],Ce=fe=Ie[1];break;case"L":(Ie[0]!==Ae||Ie[1]!==Ce)&&K("L",Ae,Ce,Ae=Ie[0],Ce=Ie[1]);break;case"Q":{K("Q",Ae,Ce,Ae=Ie[2],Ce=Ie[3],Ie[0],Ie[1]);break}case"C":{K("C",Ae,Ce,Ae=Ie[4],Ce=Ie[5],Ie[0],Ie[1],Ie[2],Ie[3]);break}case"Z":(Ae!==me||Ce!==fe)&&K("L",Ae,Ce,me,fe);break}}}function a(Z,K,se){se===void 0&&(se=16);var Y={x:0,y:0};s(Z,function(me,fe,Ae,Ce,Ie,We,ut,Ye,we){switch(me){case"L":K(fe,Ae,Ce,Ie);break;case"Q":{for(var Q=fe,Ge=Ae,Oe=1;Oe<se;Oe++)n(fe,Ae,We,ut,Ce,Ie,Oe/(se-1),Y),K(Q,Ge,Y.x,Y.y),Q=Y.x,Ge=Y.y;break}case"C":{for(var Ve=fe,Fe=Ae,tt=1;tt<se;tt++)r(fe,Ae,We,ut,Ye,we,Ce,Ie,tt/(se-1),Y),K(Ve,Fe,Y.x,Y.y),Ve=Y.x,Fe=Y.y;break}}})}var l="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",u="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",d=new WeakMap,h={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function f(Z,K){var se=Z.getContext?Z.getContext("webgl",h):Z,Y=d.get(se);if(!Y){let Ve=function(Me){var vt=fe[Me];if(!vt&&(vt=fe[Me]=se.getExtension(Me),!vt))throw new Error(Me+" not supported");return vt},Fe=function(Me,vt){var oe=se.createShader(vt);return se.shaderSource(oe,Me),se.compileShader(oe),oe},tt=function(Me,vt,oe,ee){if(!Ae[Me]){var W={},ot={},je=se.createProgram();se.attachShader(je,Fe(vt,se.VERTEX_SHADER)),se.attachShader(je,Fe(oe,se.FRAGMENT_SHADER)),se.linkProgram(je),Ae[Me]={program:je,transaction:function(ht){se.useProgram(je),ht({setUniform:function(He,St){for(var L=[],X=arguments.length-2;X-- >0;)L[X]=arguments[X+2];var he=ot[St]||(ot[St]=se.getUniformLocation(je,St));se["uniform"+He].apply(se,[he].concat(L))},setAttribute:function(He,St,L,X,he){var z=W[He];z||(z=W[He]={buf:se.createBuffer(),loc:se.getAttribLocation(je,He),data:null}),se.bindBuffer(se.ARRAY_BUFFER,z.buf),se.vertexAttribPointer(z.loc,St,se.FLOAT,!1,0,0),se.enableVertexAttribArray(z.loc),me?se.vertexAttribDivisor(z.loc,X):Ve("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(z.loc,X),he!==z.data&&(se.bufferData(se.ARRAY_BUFFER,he,L),z.data=he)}})}}}Ae[Me].transaction(ee)},Ue=function(Me,vt){Ie++;try{se.activeTexture(se.TEXTURE0+Ie);var oe=Ce[Me];oe||(oe=Ce[Me]=se.createTexture(),se.bindTexture(se.TEXTURE_2D,oe),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.NEAREST),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.NEAREST)),se.bindTexture(se.TEXTURE_2D,oe),vt(oe,Ie)}finally{Ie--}},Je=function(Me,vt,oe){var ee=se.createFramebuffer();We.push(ee),se.bindFramebuffer(se.FRAMEBUFFER,ee),se.activeTexture(se.TEXTURE0+vt),se.bindTexture(se.TEXTURE_2D,Me),se.framebufferTexture2D(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,Me,0);try{oe(ee)}finally{se.deleteFramebuffer(ee),se.bindFramebuffer(se.FRAMEBUFFER,We[--We.length-1]||null)}},ve=function(){fe={},Ae={},Ce={},Ie=-1,We.length=0};var ut=Ve,Ye=Fe,we=tt,Q=Ue,Ge=Je,Oe=ve,me=typeof WebGL2RenderingContext<"u"&&se instanceof WebGL2RenderingContext,fe={},Ae={},Ce={},Ie=-1,We=[];se.canvas.addEventListener("webglcontextlost",function(Me){ve(),Me.preventDefault()},!1),d.set(se,Y={gl:se,isWebGL2:me,getExtension:Ve,withProgram:tt,withTexture:Ue,withTextureFramebuffer:Je,handleContextLoss:ve})}K(Y)}function p(Z,K,se,Y,me,fe,Ae,Ce){Ae===void 0&&(Ae=15),Ce===void 0&&(Ce=null),f(Z,function(Ie){var We=Ie.gl,ut=Ie.withProgram,Ye=Ie.withTexture;Ye("copy",function(we,Q){We.texImage2D(We.TEXTURE_2D,0,We.RGBA,me,fe,0,We.RGBA,We.UNSIGNED_BYTE,K),ut("copy",l,u,function(Ge){var Oe=Ge.setUniform,Ve=Ge.setAttribute;Ve("aUV",2,We.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),Oe("1i","image",Q),We.bindFramebuffer(We.FRAMEBUFFER,Ce||null),We.disable(We.BLEND),We.colorMask(Ae&8,Ae&4,Ae&2,Ae&1),We.viewport(se,Y,me,fe),We.scissor(se,Y,me,fe),We.drawArrays(We.TRIANGLES,0,3)})})})}function m(Z,K,se){var Y=Z.width,me=Z.height;f(Z,function(fe){var Ae=fe.gl,Ce=new Uint8Array(Y*me*4);Ae.readPixels(0,0,Y,me,Ae.RGBA,Ae.UNSIGNED_BYTE,Ce),Z.width=K,Z.height=se,p(Ae,Ce,0,0,Y,me)})}var v=Object.freeze({__proto__:null,withWebGLContext:f,renderImageData:p,resizeWebGLCanvasWithoutClearing:m});function y(Z,K,se,Y,me,fe){fe===void 0&&(fe=1);var Ae=new Uint8Array(Z*K),Ce=Y[2]-Y[0],Ie=Y[3]-Y[1],We=[];a(se,function(Ve,Fe,tt,Ue){We.push({x1:Ve,y1:Fe,x2:tt,y2:Ue,minX:Math.min(Ve,tt),minY:Math.min(Fe,Ue),maxX:Math.max(Ve,tt),maxY:Math.max(Fe,Ue)})}),We.sort(function(Ve,Fe){return Ve.maxX-Fe.maxX});for(var ut=0;ut<Z;ut++)for(var Ye=0;Ye<K;Ye++){var we=Ge(Y[0]+Ce*(ut+.5)/Z,Y[1]+Ie*(Ye+.5)/K),Q=Math.pow(1-Math.abs(we)/me,fe)/2;we<0&&(Q=1-Q),Q=Math.max(0,Math.min(255,Math.round(Q*255))),Ae[Ye*Z+ut]=Q}return Ae;function Ge(Ve,Fe){for(var tt=1/0,Ue=1/0,Je=We.length;Je--;){var ve=We[Je];if(ve.maxX+Ue<=Ve)break;if(Ve+Ue>ve.minX&&Fe-Ue<ve.maxY&&Fe+Ue>ve.minY){var Me=S(Ve,Fe,ve.x1,ve.y1,ve.x2,ve.y2);Me<tt&&(tt=Me,Ue=Math.sqrt(tt))}}return Oe(Ve,Fe)&&(Ue=-Ue),Ue}function Oe(Ve,Fe){for(var tt=0,Ue=We.length;Ue--;){var Je=We[Ue];if(Je.maxX<=Ve)break;var ve=Je.y1>Fe!=Je.y2>Fe&&Ve<(Je.x2-Je.x1)*(Fe-Je.y1)/(Je.y2-Je.y1)+Je.x1;ve&&(tt+=Je.y1<Je.y2?1:-1)}return tt!==0}}function $(Z,K,se,Y,me,fe,Ae,Ce,Ie,We){fe===void 0&&(fe=1),Ce===void 0&&(Ce=0),Ie===void 0&&(Ie=0),We===void 0&&(We=0),E(Z,K,se,Y,me,fe,Ae,null,Ce,Ie,We)}function E(Z,K,se,Y,me,fe,Ae,Ce,Ie,We,ut){fe===void 0&&(fe=1),Ie===void 0&&(Ie=0),We===void 0&&(We=0),ut===void 0&&(ut=0);for(var Ye=y(Z,K,se,Y,me,fe),we=new Uint8Array(Ye.length*4),Q=0;Q<Ye.length;Q++)we[Q*4+ut]=Ye[Q];p(Ae,we,Ie,We,Z,K,1<<3-ut,Ce)}function S(Z,K,se,Y,me,fe){var Ae=me-se,Ce=fe-Y,Ie=Ae*Ae+Ce*Ce,We=Ie?Math.max(0,Math.min(1,((Z-se)*Ae+(K-Y)*Ce)/Ie)):0,ut=Z-(se+We*Ae),Ye=K-(Y+We*Ce);return ut*ut+Ye*Ye}var A=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:$,generateIntoFramebuffer:E}),C="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",I="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),F=null,k=!1,D={},U=new WeakMap;function ce(Z){if(!k&&!de(Z))throw new Error("WebGL generation not supported")}function re(Z,K,se,Y,me,fe,Ae){if(fe===void 0&&(fe=1),Ae===void 0&&(Ae=null),!Ae&&(Ae=F,!Ae)){var Ce=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Ce)throw new Error("OffscreenCanvas or DOM canvas not supported");Ae=F=Ce.getContext("webgl",{depth:!1})}ce(Ae);var Ie=new Uint8Array(Z*K*4);f(Ae,function(we){var Q=we.gl,Ge=we.withTexture,Oe=we.withTextureFramebuffer;Ge("readable",function(Ve,Fe){Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,Z,K,0,Q.RGBA,Q.UNSIGNED_BYTE,null),Oe(Ve,Fe,function(tt){ne(Z,K,se,Y,me,fe,Q,tt,0,0,0),Q.readPixels(0,0,Z,K,Q.RGBA,Q.UNSIGNED_BYTE,Ie)})})});for(var We=new Uint8Array(Z*K),ut=0,Ye=0;ut<Ie.length;ut+=4)We[Ye++]=Ie[ut];return We}function ae(Z,K,se,Y,me,fe,Ae,Ce,Ie,We){fe===void 0&&(fe=1),Ce===void 0&&(Ce=0),Ie===void 0&&(Ie=0),We===void 0&&(We=0),ne(Z,K,se,Y,me,fe,Ae,null,Ce,Ie,We)}function ne(Z,K,se,Y,me,fe,Ae,Ce,Ie,We,ut){fe===void 0&&(fe=1),Ie===void 0&&(Ie=0),We===void 0&&(We=0),ut===void 0&&(ut=0),ce(Ae);var Ye=[];a(se,function(we,Q,Ge,Oe){Ye.push(we,Q,Ge,Oe)}),Ye=new Float32Array(Ye),f(Ae,function(we){var Q=we.gl,Ge=we.isWebGL2,Oe=we.getExtension,Ve=we.withProgram,Fe=we.withTexture,tt=we.withTextureFramebuffer,Ue=we.handleContextLoss;if(Fe("rawDistances",function(Je,ve){(Z!==Je._lastWidth||K!==Je._lastHeight)&&Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,Je._lastWidth=Z,Je._lastHeight=K,0,Q.RGBA,Q.UNSIGNED_BYTE,null),Ve("main",C,x,function(Me){var vt=Me.setAttribute,oe=Me.setUniform,ee=!Ge&&Oe("ANGLE_instanced_arrays"),W=!Ge&&Oe("EXT_blend_minmax");vt("aUV",2,Q.STATIC_DRAW,0,O),vt("aLineSegment",4,Q.DYNAMIC_DRAW,1,Ye),oe.apply(void 0,["4f","uGlyphBounds"].concat(Y)),oe("1f","uMaxDistance",me),oe("1f","uExponent",fe),tt(Je,ve,function(ot){Q.enable(Q.BLEND),Q.colorMask(!0,!0,!0,!0),Q.viewport(0,0,Z,K),Q.scissor(0,0,Z,K),Q.blendFunc(Q.ONE,Q.ONE),Q.blendEquationSeparate(Q.FUNC_ADD,Ge?Q.MAX:W.MAX_EXT),Q.clear(Q.COLOR_BUFFER_BIT),Ge?Q.drawArraysInstanced(Q.TRIANGLES,0,3,Ye.length/4):ee.drawArraysInstancedANGLE(Q.TRIANGLES,0,3,Ye.length/4)})}),Ve("post",l,I,function(Me){Me.setAttribute("aUV",2,Q.STATIC_DRAW,0,O),Me.setUniform("1i","tex",ve),Q.bindFramebuffer(Q.FRAMEBUFFER,Ce),Q.disable(Q.BLEND),Q.colorMask(ut===0,ut===1,ut===2,ut===3),Q.viewport(Ie,We,Z,K),Q.scissor(Ie,We,Z,K),Q.drawArrays(Q.TRIANGLES,0,3)})}),Q.isContextLost())throw Ue(),new Error("webgl context lost")})}function de(Z){var K=!Z||Z===F?D:Z.canvas||Z,se=U.get(K);if(se===void 0){k=!0;var Y=null;try{var me=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],fe=re(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,Z);se=fe&&me.length===fe.length&&fe.every(function(Ae,Ce){return Ae===me[Ce]}),se||(Y="bad trial run results",console.info(me,fe))}catch(Ae){se=!1,Y=Ae.message}Y&&console.warn("WebGL SDF generation not supported:",Y),k=!1,U.set(K,se)}return se}var ue=Object.freeze({__proto__:null,generate:re,generateIntoCanvas:ae,generateIntoFramebuffer:ne,isSupported:de});function Re(Z,K,se,Y,me,fe){me===void 0&&(me=Math.max(Y[2]-Y[0],Y[3]-Y[1])/2),fe===void 0&&(fe=1);try{return re.apply(ue,arguments)}catch(Ae){return console.info("WebGL SDF generation failed, falling back to JS",Ae),y.apply(A,arguments)}}function G(Z,K,se,Y,me,fe,Ae,Ce,Ie,We){me===void 0&&(me=Math.max(Y[2]-Y[0],Y[3]-Y[1])/2),fe===void 0&&(fe=1),Ce===void 0&&(Ce=0),Ie===void 0&&(Ie=0),We===void 0&&(We=0);try{return ae.apply(ue,arguments)}catch(ut){return console.info("WebGL SDF generation failed, falling back to JS",ut),$.apply(A,arguments)}}return e.forEachPathCommand=s,e.generate=Re,e.generateIntoCanvas=G,e.javascript=A,e.pathToLineSegments=a,e.webgl=ue,e.webglUtils=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return i}function RK(){var i=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},r={},s={};r.L=1,s[1]="L",Object.keys(n).forEach(function(Ue,Je){r[Ue]=1<<Je+1,s[r[Ue]]=Ue}),Object.freeze(r);var a=r.LRI|r.RLI|r.FSI,l=r.L|r.R|r.AL,u=r.B|r.S|r.WS|r.ON|r.FSI|r.LRI|r.RLI|r.PDI,d=r.BN|r.RLE|r.LRE|r.RLO|r.LRO|r.PDF,h=r.S|r.WS|r.B|a|r.PDI|d,f=null;function p(){if(!f){f=new Map;var Ue=function(ve){if(n.hasOwnProperty(ve)){var Me=0;n[ve].split(",").forEach(function(vt){var oe=vt.split("+"),ee=oe[0],W=oe[1];ee=parseInt(ee,36),W=W?parseInt(W,36):0,f.set(Me+=ee,r[ve]);for(var ot=0;ot<W;ot++)f.set(++Me,r[ve])})}};for(var Je in n)Ue(Je)}}function m(Ue){return p(),f.get(Ue.codePointAt(0))||r.L}function v(Ue){return s[m(Ue)]}var y={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function $(Ue,Je){var ve=36,Me=0,vt=new Map,oe=Je&&new Map,ee;return Ue.split(",").forEach(function W(ot){if(ot.indexOf("+")!==-1)for(var je=+ot;je--;)W(ee);else{ee=ot;var Qe=ot.split(">"),ht=Qe[0],ft=Qe[1];ht=String.fromCodePoint(Me+=parseInt(ht,ve)),ft=String.fromCodePoint(Me+=parseInt(ft,ve)),vt.set(ht,ft),Je&&oe.set(ft,ht)}}),{map:vt,reverseMap:oe}}var E,S,A;function C(){if(!E){var Ue=$(y.pairs,!0),Je=Ue.map,ve=Ue.reverseMap;E=Je,S=ve,A=$(y.canonical,!1).map}}function x(Ue){return C(),E.get(Ue)||null}function I(Ue){return C(),S.get(Ue)||null}function O(Ue){return C(),A.get(Ue)||null}var F=r.L,k=r.R,D=r.EN,U=r.ES,ce=r.ET,re=r.AN,ae=r.CS,ne=r.B,de=r.S,ue=r.ON,Re=r.BN,G=r.NSM,Z=r.AL,K=r.LRO,se=r.RLO,Y=r.LRE,me=r.RLE,fe=r.PDF,Ae=r.LRI,Ce=r.RLI,Ie=r.FSI,We=r.PDI;function ut(Ue,Je){for(var ve=125,Me=new Uint32Array(Ue.length),vt=0;vt<Ue.length;vt++)Me[vt]=m(Ue[vt]);var oe=new Map;function ee(Qt,yn){var li=Me[Qt];Me[Qt]=yn,oe.set(li,oe.get(li)-1),li&u&&oe.set(u,oe.get(u)-1),oe.set(yn,(oe.get(yn)||0)+1),yn&u&&oe.set(u,(oe.get(u)||0)+1)}for(var W=new Uint8Array(Ue.length),ot=new Map,je=[],Qe=null,ht=0;ht<Ue.length;ht++)Qe||je.push(Qe={start:ht,end:Ue.length-1,level:Je==="rtl"?1:Je==="ltr"?0:_n(ht,!1)}),Me[ht]&ne&&(Qe.end=ht,Qe=null);for(var ft=me|Y|se|K|a|We|fe|ne,He=function(Qt){return Qt+(Qt&1?1:2)},St=function(Qt){return Qt+(Qt&1?2:1)},L=0;L<je.length;L++){Qe=je[L];var X=[{_level:Qe.level,_override:0,_isolate:0}],he=void 0,z=0,be=0,nt=0;oe.clear();for(var Ee=Qe.start;Ee<=Qe.end;Ee++){var Le=Me[Ee];if(he=X[X.length-1],oe.set(Le,(oe.get(Le)||0)+1),Le&u&&oe.set(u,(oe.get(u)||0)+1),Le&ft)if(Le&(me|Y)){W[Ee]=he._level;var Be=(Le===me?St:He)(he._level);Be<=ve&&!z&&!be?X.push({_level:Be,_override:0,_isolate:0}):z||be++}else if(Le&(se|K)){W[Ee]=he._level;var N=(Le===se?St:He)(he._level);N<=ve&&!z&&!be?X.push({_level:N,_override:Le&se?k:F,_isolate:0}):z||be++}else if(Le&a){Le&Ie&&(Le=_n(Ee+1,!0)===1?Ce:Ae),W[Ee]=he._level,he._override&&ee(Ee,he._override);var j=(Le===Ce?St:He)(he._level);j<=ve&&z===0&&be===0?(nt++,X.push({_level:j,_override:0,_isolate:1,_isolInitIndex:Ee})):z++}else if(Le&We){if(z>0)z--;else if(nt>0){for(be=0;!X[X.length-1]._isolate;)X.pop();var ge=X[X.length-1]._isolInitIndex;ge!=null&&(ot.set(ge,Ee),ot.set(Ee,ge)),X.pop(),nt--}he=X[X.length-1],W[Ee]=he._level,he._override&&ee(Ee,he._override)}else Le&fe?(z===0&&(be>0?be--:!he._isolate&&X.length>1&&(X.pop(),he=X[X.length-1])),W[Ee]=he._level):Le&ne&&(W[Ee]=Qe.level);else W[Ee]=he._level,he._override&&Le!==Re&&ee(Ee,he._override)}for(var xe=[],Ke=null,gt=Qe.start;gt<=Qe.end;gt++){var $t=Me[gt];if(!($t&d)){var un=W[gt],an=$t&a,ei=$t===We;Ke&&un===Ke._level?(Ke._end=gt,Ke._endsWithIsolInit=an):xe.push(Ke={_start:gt,_end:gt,_level:un,_startsWithPDI:ei,_endsWithIsolInit:an})}}for(var fi=[],Ki=0;Ki<xe.length;Ki++){var Ci=xe[Ki];if(!Ci._startsWithPDI||Ci._startsWithPDI&&!ot.has(Ci._start)){for(var _i=[Ke=Ci],Ti=void 0;Ke&&Ke._endsWithIsolInit&&(Ti=ot.get(Ke._end))!=null;)for(var nn=Ki+1;nn<xe.length;nn++)if(xe[nn]._start===Ti){_i.push(Ke=xe[nn]);break}for(var pi=[],yr=0;yr<_i.length;yr++)for(var J=_i[yr],B=J._start;B<=J._end;B++)pi.push(B);for(var le=W[pi[0]],_e=Qe.level,pe=pi[0]-1;pe>=0;pe--)if(!(Me[pe]&d)){_e=W[pe];break}var ye=pi[pi.length-1],Ze=W[ye],qe=Qe.level;if(!(Me[ye]&a)){for(var at=ye+1;at<=Qe.end;at++)if(!(Me[at]&d)){qe=W[at];break}}fi.push({_seqIndices:pi,_sosType:Math.max(_e,le)%2?k:F,_eosType:Math.max(qe,Ze)%2?k:F})}}for(var rt=0;rt<fi.length;rt++){var pt=fi[rt],ke=pt._seqIndices,It=pt._sosType,Ct=pt._eosType,wt=W[ke[0]]&1?k:F;if(oe.get(G))for(var Ht=0;Ht<ke.length;Ht++){var Zt=ke[Ht];if(Me[Zt]&G){for(var jt=It,Ot=Ht-1;Ot>=0;Ot--)if(!(Me[ke[Ot]]&d)){jt=Me[ke[Ot]];break}ee(Zt,jt&(a|We)?ue:jt)}}if(oe.get(D))for(var qt=0;qt<ke.length;qt++){var Ft=ke[qt];if(Me[Ft]&D)for(var ln=qt-1;ln>=-1;ln--){var Fn=ln===-1?It:Me[ke[ln]];if(Fn&l){Fn===Z&&ee(Ft,re);break}}}if(oe.get(Z))for(var sn=0;sn<ke.length;sn++){var $n=ke[sn];Me[$n]&Z&&ee($n,k)}if(oe.get(U)||oe.get(ae))for(var tn=1;tn<ke.length-1;tn++){var Un=ke[tn];if(Me[Un]&(U|ae)){for(var Rn=0,hn=0,zn=tn-1;zn>=0&&(Rn=Me[ke[zn]],!!(Rn&d));zn--);for(var In=tn+1;In<ke.length&&(hn=Me[ke[In]],!!(hn&d));In++);Rn===hn&&(Me[Un]===U?Rn===D:Rn&(D|re))&&ee(Un,Rn)}}if(oe.get(D))for(var Kt=0;Kt<ke.length;Kt++){var An=ke[Kt];if(Me[An]&D){for(var Sr=Kt-1;Sr>=0&&Me[ke[Sr]]&(ce|d);Sr--)ee(ke[Sr],D);for(Kt++;Kt<ke.length&&Me[ke[Kt]]&(ce|d|D);Kt++)Me[ke[Kt]]!==D&&ee(ke[Kt],D)}}if(oe.get(ce)||oe.get(U)||oe.get(ae))for(var Ri=0;Ri<ke.length;Ri++){var mn=ke[Ri];if(Me[mn]&(ce|U|ae)){ee(mn,ue);for(var cs=Ri-1;cs>=0&&Me[ke[cs]]&d;cs--)ee(ke[cs],ue);for(var Xs=Ri+1;Xs<ke.length&&Me[ke[Xs]]&d;Xs++)ee(ke[Xs],ue)}}if(oe.get(D))for(var Cs=0,hi=It;Cs<ke.length;Cs++){var Rs=ke[Cs],dn=Me[Rs];dn&D?hi===F&&ee(Rs,F):dn&l&&(hi=dn)}if(oe.get(u)){var Pr=k|D|re,jn=Pr|F,ts=[];{for(var Dr=[],ti=0;ti<ke.length;ti++)if(Me[ke[ti]]&u){var rn=Ue[ke[ti]],vi=void 0;if(x(rn)!==null)if(Dr.length<63)Dr.push({char:rn,seqIndex:ti});else break;else if((vi=I(rn))!==null)for(var us=Dr.length-1;us>=0;us--){var zi=Dr[us].char;if(zi===vi||zi===I(O(rn))||x(O(zi))===rn){ts.push([Dr[us].seqIndex,ti]),Dr.length=us;break}}}ts.sort(function(Qt,yn){return Qt[0]-yn[0]})}for(var Gl=0;Gl<ts.length;Gl++){for(var Br=ts[Gl],ai=Br[0],xs=Br[1],Qa=!1,mr=0,el=ai+1;el<xs;el++){var xi=ke[el];if(Me[xi]&jn){Qa=!0;var Ii=Me[xi]&Pr?k:F;if(Ii===wt){mr=Ii;break}}}if(Qa&&!mr){mr=It;for(var fo=ai-1;fo>=0;fo--){var Hl=ke[fo];if(Me[Hl]&jn){var $r=Me[Hl]&Pr?k:F;$r!==wt?mr=$r:mr=wt;break}}}if(mr){if(Me[ke[ai]]=Me[ke[xs]]=mr,mr!==wt){for(var sr=ai+1;sr<ke.length;sr++)if(!(Me[ke[sr]]&d)){m(Ue[ke[sr]])&G&&(Me[ke[sr]]=mr);break}}if(mr!==wt){for(var js=xs+1;js<ke.length;js++)if(!(Me[ke[js]]&d)){m(Ue[ke[js]])&G&&(Me[ke[js]]=mr);break}}}}for(var gr=0;gr<ke.length;gr++)if(Me[ke[gr]]&u){for(var da=gr,Vl=gr,Fr=It,Oo=gr-1;Oo>=0;Oo--)if(Me[ke[Oo]]&d)da=Oo;else{Fr=Me[ke[Oo]]&Pr?k:F;break}for(var po=Ct,Ys=gr+1;Ys<ke.length;Ys++)if(Me[ke[Ys]]&(u|d))Vl=Ys;else{po=Me[ke[Ys]]&Pr?k:F;break}for(var Oi=da;Oi<=Vl;Oi++)Me[ke[Oi]]=Fr===po?Fr:wt;gr=Vl}}}for(var Te=Qe.start;Te<=Qe.end;Te++){var Ne=W[Te],lt=Me[Te];if(Ne&1?lt&(F|D|re)&&W[Te]++:lt&k?W[Te]++:lt&(re|D)&&(W[Te]+=2),lt&d&&(W[Te]=Te===0?Qe.level:W[Te-1]),Te===Qe.end||m(Ue[Te])&(de|ne))for(var Et=Te;Et>=0&&m(Ue[Et])&h;Et--)W[Et]=Qe.level}}return{levels:W,paragraphs:je};function _n(Qt,yn){for(var li=Qt;li<Ue.length;li++){var ci=Me[li];if(ci&(k|Z))return 1;if(ci&(ne|F)||yn&&ci===We)return 0;if(ci&a){var br=fn(li);li=br===-1?Ue.length:br}}return 0}function fn(Qt){for(var yn=1,li=Qt+1;li<Ue.length;li++){var ci=Me[li];if(ci&ne)break;if(ci&We){if(--yn===0)return li}else ci&a&&yn++}return-1}}var Ye="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",we;function Q(){if(!we){var Ue=$(Ye,!0),Je=Ue.map,ve=Ue.reverseMap;ve.forEach(function(Me,vt){Je.set(vt,Me)}),we=Je}}function Ge(Ue){return Q(),we.get(Ue)||null}function Oe(Ue,Je,ve,Me){var vt=Ue.length;ve=Math.max(0,ve==null?0:+ve),Me=Math.min(vt-1,Me==null?vt-1:+Me);for(var oe=new Map,ee=ve;ee<=Me;ee++)if(Je[ee]&1){var W=Ge(Ue[ee]);W!==null&&oe.set(ee,W)}return oe}function Ve(Ue,Je,ve,Me){var vt=Ue.length;ve=Math.max(0,ve==null?0:+ve),Me=Math.min(vt-1,Me==null?vt-1:+Me);var oe=[];return Je.paragraphs.forEach(function(ee){var W=Math.max(ve,ee.start),ot=Math.min(Me,ee.end);if(W<ot){for(var je=Je.levels.slice(W,ot+1),Qe=ot;Qe>=W&&m(Ue[Qe])&h;Qe--)je[Qe]=ee.level;for(var ht=ee.level,ft=1/0,He=0;He<je.length;He++){var St=je[He];St>ht&&(ht=St),St<ft&&(ft=St|1)}for(var L=ht;L>=ft;L--)for(var X=0;X<je.length;X++)if(je[X]>=L){for(var he=X;X+1<je.length&&je[X+1]>=L;)X++;X>he&&oe.push([he+W,X+W])}}}),oe}function Fe(Ue,Je,ve,Me){var vt=tt(Ue,Je,ve,Me),oe=[].concat(Ue);return vt.forEach(function(ee,W){oe[W]=(Je.levels[ee]&1?Ge(Ue[ee]):null)||Ue[ee]}),oe.join("")}function tt(Ue,Je,ve,Me){for(var vt=Ve(Ue,Je,ve,Me),oe=[],ee=0;ee<Ue.length;ee++)oe[ee]=ee;return vt.forEach(function(W){for(var ot=W[0],je=W[1],Qe=oe.slice(ot,je+1),ht=Qe.length;ht--;)oe[je-ht]=Qe[ht]}),oe}return e.closingToOpeningBracket=I,e.getBidiCharType=m,e.getBidiCharTypeName=v,e.getCanonicalBracket=O,e.getEmbeddingLevels=ut,e.getMirroredCharacter=Ge,e.getMirroredCharactersMap=Oe,e.getReorderSegments=Ve,e.getReorderedIndices=tt,e.getReorderedString=Fe,e.openingToClosingBracket=x,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return i}const a2=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Qx(i){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(r,s){let a=Ln[s];return a?Qx(a):r}return i.replace(e,n)}const Es=[];for(let i=0;i<256;i++)Es[i]=(i<16?"0":"")+i.toString(16);function xK(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Es[i&255]+Es[i>>8&255]+Es[i>>16&255]+Es[i>>24&255]+"-"+Es[e&255]+Es[e>>8&255]+"-"+Es[e>>16&15|64]+Es[e>>24&255]+"-"+Es[n&63|128]+Es[n>>8&255]+"-"+Es[n>>16&255]+Es[n>>24&255]+Es[r&255]+Es[r>>8&255]+Es[r>>16&255]+Es[r>>24&255]).toUpperCase()}const Pf=Object.assign||function(){let i=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let r=arguments[e];if(r)for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i[s]=r[s])}return i},wK=Date.now(),Pk=new WeakMap,Dk=new Map;let MK=1e10;function ew(i,e){const n=NK(e);let r=Pk.get(i);if(r||Pk.set(i,r=Object.create(null)),r[n])return new r[n];const s=`_onBeforeCompile${n}`,a=function(h,f){i.onBeforeCompile.call(this,h,f);const p=this.customProgramCacheKey()+"|"+h.vertexShader+"|"+h.fragmentShader;let m=Dk[p];if(!m){const v=IK(this,h,e,n);m=Dk[p]=v}h.vertexShader=m.vertexShader,h.fragmentShader=m.fragmentShader,Pf(h.uniforms,this.uniforms),e.timeUniform&&(h.uniforms[e.timeUniform]={get value(){return Date.now()-wK}}),this[s]&&this[s](h)},l=function(){return u(e.chained?i:i.clone())},u=function(h){const f=Object.create(h,d);return Object.defineProperty(f,"baseMaterial",{value:i}),Object.defineProperty(f,"id",{value:MK++}),f.uuid=xK(),f.uniforms=Pf({},h.uniforms,e.uniforms),f.defines=Pf({},h.defines,e.defines),f.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",f.extensions=Pf({},h.extensions,e.extensions),f._listeners=void 0,f},d={constructor:{value:l},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return i.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return a},set(h){this[s]=h}},copy:{writable:!0,configurable:!0,value:function(h){return i.copy.call(this,h),!i.isShaderMaterial&&!i.isDerivedMaterial&&(Pf(this.extensions,h.extensions),Pf(this.defines,h.defines),Pf(this.uniforms,oE.clone(h.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const h=new i.constructor;return u(h).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let h=this._depthMaterial;return h||(h=this._depthMaterial=ew(i.isDerivedMaterial?i.getDepthMaterial():new M$({depthPacking:pM}),e),h.defines.IS_DEPTH_MATERIAL="",h.uniforms=this.uniforms),h}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let h=this._distanceMaterial;return h||(h=this._distanceMaterial=ew(i.isDerivedMaterial?i.getDistanceMaterial():new I$,e),h.defines.IS_DISTANCE_MATERIAL="",h.uniforms=this.uniforms),h}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:h,_distanceMaterial:f}=this;h&&h.dispose(),f&&f.dispose(),i.dispose.call(this)}}};return r[n]=l,new l}function IK(i,{vertexShader:e,fragmentShader:n},r,s){let{vertexDefs:a,vertexMainIntro:l,vertexMainOutro:u,vertexTransform:d,fragmentDefs:h,fragmentMainIntro:f,fragmentMainOutro:p,fragmentColorTransform:m,customRewriter:v,timeUniform:y}=r;if(a=a||"",l=l||"",u=u||"",h=h||"",f=f||"",p=p||"",(d||v)&&(e=Qx(e)),(m||v)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=Qx(n)),v){let $=v({vertexShader:e,fragmentShader:n});e=$.vertexShader,n=$.fragmentShader}if(m){let $=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,E=>($.push(E),"")),p=`${m}
${$.join(`
`)}
${p}`}if(y){const $=`
uniform float ${y};
`;a=$+a,h=$+h}return d&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,a=`${a}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${d}
}
`,l=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${l}
`,e=e.replace(/\b(position|normal|uv)\b/g,($,E,S,A)=>/\battribute\s+vec[23]\s+$/.test(A.substr(0,S))?E:`troika_${E}_${s}`),i.map&&i.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=Bk(e,s,a,l,u),n=Bk(n,s,h,f,p),{vertexShader:e,fragmentShader:n}}function Bk(i,e,n,r,s){return(r||s||n)&&(i=i.replace(a2,`
${n}
void troikaOrigMain${e}() {`),i+=`
void main() {
  ${r}
  troikaOrigMain${e}();
  ${s}
}`),i}function OK(i,e){return i==="uniforms"?void 0:typeof e=="function"?e.toString():e}let LK=0;const Fk=new Map;function NK(i){const e=JSON.stringify(i,OK);let n=Fk.get(e);return n==null&&Fk.set(e,n=++LK),n}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function kK(){return typeof window>"u"&&(self.window=self),function(i){var e={parse:function(s){var a=e._bin,l=new Uint8Array(s);if(a.readASCII(l,0,4)=="ttcf"){var u=4;a.readUshort(l,u),u+=2,a.readUshort(l,u),u+=2;var d=a.readUint(l,u);u+=4;for(var h=[],f=0;f<d;f++){var p=a.readUint(l,u);u+=4,h.push(e._readFont(l,p))}return h}return[e._readFont(l,0)]},_readFont:function(s,a){var l=e._bin,u=a;l.readFixed(s,a),a+=4;var d=l.readUshort(s,a);a+=2,l.readUshort(s,a),a+=2,l.readUshort(s,a),a+=2,l.readUshort(s,a),a+=2;for(var h=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],f={_data:s,_offset:u},p={},m=0;m<d;m++){var v=l.readASCII(s,a,4);a+=4,l.readUint(s,a),a+=4;var y=l.readUint(s,a);a+=4;var $=l.readUint(s,a);a+=4,p[v]={offset:y,length:$}}for(m=0;m<h.length;m++){var E=h[m];p[E]&&(f[E.trim()]=e[E.trim()].parse(s,p[E].offset,p[E].length,f))}return f},_tabOffset:function(s,a,l){for(var u=e._bin,d=u.readUshort(s,l+4),h=l+12,f=0;f<d;f++){var p=u.readASCII(s,h,4);h+=4,u.readUint(s,h),h+=4;var m=u.readUint(s,h);if(h+=4,u.readUint(s,h),h+=4,p==a)return m}return 0}};e._bin={readFixed:function(s,a){return(s[a]<<8|s[a+1])+(s[a+2]<<8|s[a+3])/65540},readF2dot14:function(s,a){return e._bin.readShort(s,a)/16384},readInt:function(s,a){return e._bin._view(s).getInt32(a)},readInt8:function(s,a){return e._bin._view(s).getInt8(a)},readShort:function(s,a){return e._bin._view(s).getInt16(a)},readUshort:function(s,a){return e._bin._view(s).getUint16(a)},readUshorts:function(s,a,l){for(var u=[],d=0;d<l;d++)u.push(e._bin.readUshort(s,a+2*d));return u},readUint:function(s,a){return e._bin._view(s).getUint32(a)},readUint64:function(s,a){return 4294967296*e._bin.readUint(s,a)+e._bin.readUint(s,a+4)},readASCII:function(s,a,l){for(var u="",d=0;d<l;d++)u+=String.fromCharCode(s[a+d]);return u},readUnicode:function(s,a,l){for(var u="",d=0;d<l;d++){var h=s[a++]<<8|s[a++];u+=String.fromCharCode(h)}return u},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,a,l){var u=e._bin._tdec;return u&&a==0&&l==s.length?u.decode(s):e._bin.readASCII(s,a,l)},readBytes:function(s,a,l){for(var u=[],d=0;d<l;d++)u.push(s[a+d]);return u},readASCIIArray:function(s,a,l){for(var u=[],d=0;d<l;d++)u.push(String.fromCharCode(s[a+d]));return u},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,a,l,u,d){var h=e._bin,f={},p=a;h.readFixed(s,a),a+=4;var m=h.readUshort(s,a);a+=2;var v=h.readUshort(s,a);a+=2;var y=h.readUshort(s,a);return a+=2,f.scriptList=e._lctf.readScriptList(s,p+m),f.featureList=e._lctf.readFeatureList(s,p+v),f.lookupList=e._lctf.readLookupList(s,p+y,d),f},e._lctf.readLookupList=function(s,a,l){var u=e._bin,d=a,h=[],f=u.readUshort(s,a);a+=2;for(var p=0;p<f;p++){var m=u.readUshort(s,a);a+=2;var v=e._lctf.readLookupTable(s,d+m,l);h.push(v)}return h},e._lctf.readLookupTable=function(s,a,l){var u=e._bin,d=a,h={tabs:[]};h.ltype=u.readUshort(s,a),a+=2,h.flag=u.readUshort(s,a),a+=2;var f=u.readUshort(s,a);a+=2;for(var p=h.ltype,m=0;m<f;m++){var v=u.readUshort(s,a);a+=2;var y=l(s,p,d+v,h);h.tabs.push(y)}return h},e._lctf.numOfOnes=function(s){for(var a=0,l=0;l<32;l++)s>>>l&1&&a++;return a},e._lctf.readClassDef=function(s,a){var l=e._bin,u=[],d=l.readUshort(s,a);if(a+=2,d==1){var h=l.readUshort(s,a);a+=2;var f=l.readUshort(s,a);a+=2;for(var p=0;p<f;p++)u.push(h+p),u.push(h+p),u.push(l.readUshort(s,a)),a+=2}if(d==2){var m=l.readUshort(s,a);for(a+=2,p=0;p<m;p++)u.push(l.readUshort(s,a)),a+=2,u.push(l.readUshort(s,a)),a+=2,u.push(l.readUshort(s,a)),a+=2}return u},e._lctf.getInterval=function(s,a){for(var l=0;l<s.length;l+=3){var u=s[l],d=s[l+1];if(s[l+2],u<=a&&a<=d)return l}return-1},e._lctf.readCoverage=function(s,a){var l=e._bin,u={};u.fmt=l.readUshort(s,a),a+=2;var d=l.readUshort(s,a);return a+=2,u.fmt==1&&(u.tab=l.readUshorts(s,a,d)),u.fmt==2&&(u.tab=l.readUshorts(s,a,3*d)),u},e._lctf.coverageIndex=function(s,a){var l=s.tab;if(s.fmt==1)return l.indexOf(a);if(s.fmt==2){var u=e._lctf.getInterval(l,a);if(u!=-1)return l[u+2]+(a-l[u])}return-1},e._lctf.readFeatureList=function(s,a){var l=e._bin,u=a,d=[],h=l.readUshort(s,a);a+=2;for(var f=0;f<h;f++){var p=l.readASCII(s,a,4);a+=4;var m=l.readUshort(s,a);a+=2;var v=e._lctf.readFeatureTable(s,u+m);v.tag=p.trim(),d.push(v)}return d},e._lctf.readFeatureTable=function(s,a){var l=e._bin,u=a,d={},h=l.readUshort(s,a);a+=2,h>0&&(d.featureParams=u+h);var f=l.readUshort(s,a);a+=2,d.tab=[];for(var p=0;p<f;p++)d.tab.push(l.readUshort(s,a+2*p));return d},e._lctf.readScriptList=function(s,a){var l=e._bin,u=a,d={},h=l.readUshort(s,a);a+=2;for(var f=0;f<h;f++){var p=l.readASCII(s,a,4);a+=4;var m=l.readUshort(s,a);a+=2,d[p.trim()]=e._lctf.readScriptTable(s,u+m)}return d},e._lctf.readScriptTable=function(s,a){var l=e._bin,u=a,d={},h=l.readUshort(s,a);a+=2,h>0&&(d.default=e._lctf.readLangSysTable(s,u+h));var f=l.readUshort(s,a);a+=2;for(var p=0;p<f;p++){var m=l.readASCII(s,a,4);a+=4;var v=l.readUshort(s,a);a+=2,d[m.trim()]=e._lctf.readLangSysTable(s,u+v)}return d},e._lctf.readLangSysTable=function(s,a){var l=e._bin,u={};l.readUshort(s,a),a+=2,u.reqFeature=l.readUshort(s,a),a+=2;var d=l.readUshort(s,a);return a+=2,u.features=l.readUshorts(s,a,d),u},e.CFF={},e.CFF.parse=function(s,a,l){var u=e._bin;(s=new Uint8Array(s.buffer,a,l))[a=0],s[++a],s[++a],s[++a],a++;var d=[];a=e.CFF.readIndex(s,a,d);for(var h=[],f=0;f<d.length-1;f++)h.push(u.readASCII(s,a+d[f],d[f+1]-d[f]));a+=d[d.length-1];var p=[];a=e.CFF.readIndex(s,a,p);var m=[];for(f=0;f<p.length-1;f++)m.push(e.CFF.readDict(s,a+p[f],a+p[f+1]));a+=p[p.length-1];var v=m[0],y=[];a=e.CFF.readIndex(s,a,y);var $=[];for(f=0;f<y.length-1;f++)$.push(u.readASCII(s,a+y[f],y[f+1]-y[f]));if(a+=y[y.length-1],e.CFF.readSubrs(s,a,v),v.CharStrings){a=v.CharStrings,y=[],a=e.CFF.readIndex(s,a,y);var E=[];for(f=0;f<y.length-1;f++)E.push(u.readBytes(s,a+y[f],y[f+1]-y[f]));v.CharStrings=E}if(v.ROS){a=v.FDArray;var S=[];for(a=e.CFF.readIndex(s,a,S),v.FDArray=[],f=0;f<S.length-1;f++){var A=e.CFF.readDict(s,a+S[f],a+S[f+1]);e.CFF._readFDict(s,A,$),v.FDArray.push(A)}a+=S[S.length-1],a=v.FDSelect,v.FDSelect=[];var C=s[a];if(a++,C!=3)throw C;var x=u.readUshort(s,a);for(a+=2,f=0;f<x+1;f++)v.FDSelect.push(u.readUshort(s,a),s[a+2]),a+=3}return v.Encoding&&(v.Encoding=e.CFF.readEncoding(s,v.Encoding,v.CharStrings.length)),v.charset&&(v.charset=e.CFF.readCharset(s,v.charset,v.CharStrings.length)),e.CFF._readFDict(s,v,$),v},e.CFF._readFDict=function(s,a,l){var u;for(var d in a.Private&&(u=a.Private[1],a.Private=e.CFF.readDict(s,u,u+a.Private[0]),a.Private.Subrs&&e.CFF.readSubrs(s,u+a.Private.Subrs,a.Private)),a)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(d)!=-1&&(a[d]=l[a[d]-426+35])},e.CFF.readSubrs=function(s,a,l){var u=e._bin,d=[];a=e.CFF.readIndex(s,a,d);var h,f=d.length;h=f<1240?107:f<33900?1131:32768,l.Bias=h,l.Subrs=[];for(var p=0;p<d.length-1;p++)l.Subrs.push(u.readBytes(s,a+d[p],d[p+1]-d[p]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,a){for(var l=0;l<s.charset.length;l++)if(s.charset[l]==a)return l;return-1},e.CFF.glyphBySE=function(s,a){return a<0||a>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[a])},e.CFF.readEncoding=function(s,a,l){e._bin;var u=[".notdef"],d=s[a];if(a++,d!=0)throw"error: unknown encoding format: "+d;var h=s[a];a++;for(var f=0;f<h;f++)u.push(s[a+f]);return u},e.CFF.readCharset=function(s,a,l){var u=e._bin,d=[".notdef"],h=s[a];if(a++,h==0)for(var f=0;f<l;f++){var p=u.readUshort(s,a);a+=2,d.push(p)}else{if(h!=1&&h!=2)throw"error: format: "+h;for(;d.length<l;){p=u.readUshort(s,a),a+=2;var m=0;for(h==1?(m=s[a],a++):(m=u.readUshort(s,a),a+=2),f=0;f<=m;f++)d.push(p),p++}}return d},e.CFF.readIndex=function(s,a,l){var u=e._bin,d=u.readUshort(s,a)+1,h=s[a+=2];if(a++,h==1)for(var f=0;f<d;f++)l.push(s[a+f]);else if(h==2)for(f=0;f<d;f++)l.push(u.readUshort(s,a+2*f));else if(h==3)for(f=0;f<d;f++)l.push(16777215&u.readUint(s,a+3*f-1));else if(d!=1)throw"unsupported offset size: "+h+", count: "+d;return(a+=d*h)-1},e.CFF.getCharString=function(s,a,l){var u=e._bin,d=s[a],h=s[a+1];s[a+2],s[a+3],s[a+4];var f=1,p=null,m=null;d<=20&&(p=d,f=1),d==12&&(p=100*d+h,f=2),21<=d&&d<=27&&(p=d,f=1),d==28&&(m=u.readShort(s,a+1),f=3),29<=d&&d<=31&&(p=d,f=1),32<=d&&d<=246&&(m=d-139,f=1),247<=d&&d<=250&&(m=256*(d-247)+h+108,f=2),251<=d&&d<=254&&(m=256*-(d-251)-h-108,f=2),d==255&&(m=u.readInt(s,a+1)/65535,f=5),l.val=m??"o"+p,l.size=f},e.CFF.readCharString=function(s,a,l){for(var u=a+l,d=e._bin,h=[];a<u;){var f=s[a],p=s[a+1];s[a+2],s[a+3],s[a+4];var m=1,v=null,y=null;f<=20&&(v=f,m=1),f==12&&(v=100*f+p,m=2),f!=19&&f!=20||(v=f,m=2),21<=f&&f<=27&&(v=f,m=1),f==28&&(y=d.readShort(s,a+1),m=3),29<=f&&f<=31&&(v=f,m=1),32<=f&&f<=246&&(y=f-139,m=1),247<=f&&f<=250&&(y=256*(f-247)+p+108,m=2),251<=f&&f<=254&&(y=256*-(f-251)-p-108,m=2),f==255&&(y=d.readInt(s,a+1)/65535,m=5),h.push(y??"o"+v),a+=m}return h},e.CFF.readDict=function(s,a,l){for(var u=e._bin,d={},h=[];a<l;){var f=s[a],p=s[a+1];s[a+2],s[a+3],s[a+4];var m=1,v=null,y=null;if(f==28&&(y=u.readShort(s,a+1),m=3),f==29&&(y=u.readInt(s,a+1),m=5),32<=f&&f<=246&&(y=f-139,m=1),247<=f&&f<=250&&(y=256*(f-247)+p+108,m=2),251<=f&&f<=254&&(y=256*-(f-251)-p-108,m=2),f==255)throw y=u.readInt(s,a+1)/65535,m=5,"unknown number";if(f==30){var $=[];for(m=1;;){var E=s[a+m];m++;var S=E>>4,A=15&E;if(S!=15&&$.push(S),A!=15&&$.push(A),A==15)break}for(var C="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],I=0;I<$.length;I++)C+=x[$[I]];y=parseFloat(C)}f<=21&&(v=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][f],m=1,f==12&&(v=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][p],m=2)),v!=null?(d[v]=h.length==1?h[0]:h,h=[]):h.push(y),a+=m}return d},e.cmap={},e.cmap.parse=function(s,a,l){s=new Uint8Array(s.buffer,a,l),a=0;var u=e._bin,d={};u.readUshort(s,a),a+=2;var h=u.readUshort(s,a);a+=2;var f=[];d.tables=[];for(var p=0;p<h;p++){var m=u.readUshort(s,a);a+=2;var v=u.readUshort(s,a);a+=2;var y=u.readUint(s,a);a+=4;var $="p"+m+"e"+v,E=f.indexOf(y);if(E==-1){var S;E=d.tables.length,f.push(y);var A=u.readUshort(s,y);A==0?S=e.cmap.parse0(s,y):A==4?S=e.cmap.parse4(s,y):A==6?S=e.cmap.parse6(s,y):A==12?S=e.cmap.parse12(s,y):console.debug("unknown format: "+A,m,v,y),d.tables.push(S)}if(d[$]!=null)throw"multiple tables for one platform+encoding";d[$]=E}return d},e.cmap.parse0=function(s,a){var l=e._bin,u={};u.format=l.readUshort(s,a),a+=2;var d=l.readUshort(s,a);a+=2,l.readUshort(s,a),a+=2,u.map=[];for(var h=0;h<d-6;h++)u.map.push(s[a+h]);return u},e.cmap.parse4=function(s,a){var l=e._bin,u=a,d={};d.format=l.readUshort(s,a),a+=2;var h=l.readUshort(s,a);a+=2,l.readUshort(s,a),a+=2;var f=l.readUshort(s,a);a+=2;var p=f/2;d.searchRange=l.readUshort(s,a),a+=2,d.entrySelector=l.readUshort(s,a),a+=2,d.rangeShift=l.readUshort(s,a),a+=2,d.endCount=l.readUshorts(s,a,p),a+=2*p,a+=2,d.startCount=l.readUshorts(s,a,p),a+=2*p,d.idDelta=[];for(var m=0;m<p;m++)d.idDelta.push(l.readShort(s,a)),a+=2;for(d.idRangeOffset=l.readUshorts(s,a,p),a+=2*p,d.glyphIdArray=[];a<u+h;)d.glyphIdArray.push(l.readUshort(s,a)),a+=2;return d},e.cmap.parse6=function(s,a){var l=e._bin,u={};u.format=l.readUshort(s,a),a+=2,l.readUshort(s,a),a+=2,l.readUshort(s,a),a+=2,u.firstCode=l.readUshort(s,a),a+=2;var d=l.readUshort(s,a);a+=2,u.glyphIdArray=[];for(var h=0;h<d;h++)u.glyphIdArray.push(l.readUshort(s,a)),a+=2;return u},e.cmap.parse12=function(s,a){var l=e._bin,u={};u.format=l.readUshort(s,a),a+=2,a+=2,l.readUint(s,a),a+=4,l.readUint(s,a),a+=4;var d=l.readUint(s,a);a+=4,u.groups=[];for(var h=0;h<d;h++){var f=a+12*h,p=l.readUint(s,f+0),m=l.readUint(s,f+4),v=l.readUint(s,f+8);u.groups.push([p,m,v])}return u},e.glyf={},e.glyf.parse=function(s,a,l,u){for(var d=[],h=0;h<u.maxp.numGlyphs;h++)d.push(null);return d},e.glyf._parseGlyf=function(s,a){var l=e._bin,u=s._data,d=e._tabOffset(u,"glyf",s._offset)+s.loca[a];if(s.loca[a]==s.loca[a+1])return null;var h={};if(h.noc=l.readShort(u,d),d+=2,h.xMin=l.readShort(u,d),d+=2,h.yMin=l.readShort(u,d),d+=2,h.xMax=l.readShort(u,d),d+=2,h.yMax=l.readShort(u,d),d+=2,h.xMin>=h.xMax||h.yMin>=h.yMax)return null;if(h.noc>0){h.endPts=[];for(var f=0;f<h.noc;f++)h.endPts.push(l.readUshort(u,d)),d+=2;var p=l.readUshort(u,d);if(d+=2,u.length-d<p)return null;h.instructions=l.readBytes(u,d,p),d+=p;var m=h.endPts[h.noc-1]+1;for(h.flags=[],f=0;f<m;f++){var v=u[d];if(d++,h.flags.push(v),(8&v)!=0){var y=u[d];d++;for(var $=0;$<y;$++)h.flags.push(v),f++}}for(h.xs=[],f=0;f<m;f++){var E=(2&h.flags[f])!=0,S=(16&h.flags[f])!=0;E?(h.xs.push(S?u[d]:-u[d]),d++):S?h.xs.push(0):(h.xs.push(l.readShort(u,d)),d+=2)}for(h.ys=[],f=0;f<m;f++)E=(4&h.flags[f])!=0,S=(32&h.flags[f])!=0,E?(h.ys.push(S?u[d]:-u[d]),d++):S?h.ys.push(0):(h.ys.push(l.readShort(u,d)),d+=2);var A=0,C=0;for(f=0;f<m;f++)A+=h.xs[f],C+=h.ys[f],h.xs[f]=A,h.ys[f]=C}else{var x;h.parts=[];do{x=l.readUshort(u,d),d+=2;var I={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(h.parts.push(I),I.glyphIndex=l.readUshort(u,d),d+=2,1&x){var O=l.readShort(u,d);d+=2;var F=l.readShort(u,d);d+=2}else O=l.readInt8(u,d),d++,F=l.readInt8(u,d),d++;2&x?(I.m.tx=O,I.m.ty=F):(I.p1=O,I.p2=F),8&x?(I.m.a=I.m.d=l.readF2dot14(u,d),d+=2):64&x?(I.m.a=l.readF2dot14(u,d),d+=2,I.m.d=l.readF2dot14(u,d),d+=2):128&x&&(I.m.a=l.readF2dot14(u,d),d+=2,I.m.b=l.readF2dot14(u,d),d+=2,I.m.c=l.readF2dot14(u,d),d+=2,I.m.d=l.readF2dot14(u,d),d+=2)}while(32&x);if(256&x){var k=l.readUshort(u,d);for(d+=2,h.instr=[],f=0;f<k;f++)h.instr.push(u[d]),d++}}return h},e.GDEF={},e.GDEF.parse=function(s,a,l,u){var d=a;a+=4;var h=e._bin.readUshort(s,a);return{glyphClassDef:h===0?null:e._lctf.readClassDef(s,d+h)}},e.GPOS={},e.GPOS.parse=function(s,a,l,u){return e._lctf.parse(s,a,l,u,e.GPOS.subt)},e.GPOS.subt=function(s,a,l,u){var d=e._bin,h=l,f={};if(f.fmt=d.readUshort(s,l),l+=2,a==1||a==2||a==3||a==7||a==8&&f.fmt<=2){var p=d.readUshort(s,l);l+=2,f.coverage=e._lctf.readCoverage(s,p+h)}if(a==1&&f.fmt==1){var m=d.readUshort(s,l);l+=2,m!=0&&(f.pos=e.GPOS.readValueRecord(s,l,m))}else if(a==2&&f.fmt>=1&&f.fmt<=2){m=d.readUshort(s,l),l+=2;var v=d.readUshort(s,l);l+=2;var y=e._lctf.numOfOnes(m),$=e._lctf.numOfOnes(v);if(f.fmt==1){f.pairsets=[];var E=d.readUshort(s,l);l+=2;for(var S=0;S<E;S++){var A=h+d.readUshort(s,l);l+=2;var C=d.readUshort(s,A);A+=2;for(var x=[],I=0;I<C;I++){var O=d.readUshort(s,A);A+=2,m!=0&&(re=e.GPOS.readValueRecord(s,A,m),A+=2*y),v!=0&&(ae=e.GPOS.readValueRecord(s,A,v),A+=2*$),x.push({gid2:O,val1:re,val2:ae})}f.pairsets.push(x)}}if(f.fmt==2){var F=d.readUshort(s,l);l+=2;var k=d.readUshort(s,l);l+=2;var D=d.readUshort(s,l);l+=2;var U=d.readUshort(s,l);for(l+=2,f.classDef1=e._lctf.readClassDef(s,h+F),f.classDef2=e._lctf.readClassDef(s,h+k),f.matrix=[],S=0;S<D;S++){var ce=[];for(I=0;I<U;I++){var re=null,ae=null;m!=0&&(re=e.GPOS.readValueRecord(s,l,m),l+=2*y),v!=0&&(ae=e.GPOS.readValueRecord(s,l,v),l+=2*$),ce.push({val1:re,val2:ae})}f.matrix.push(ce)}}}else if(a==4&&f.fmt==1)f.markCoverage=e._lctf.readCoverage(s,d.readUshort(s,l)+h),f.baseCoverage=e._lctf.readCoverage(s,d.readUshort(s,l+2)+h),f.markClassCount=d.readUshort(s,l+4),f.markArray=e.GPOS.readMarkArray(s,d.readUshort(s,l+6)+h),f.baseArray=e.GPOS.readBaseArray(s,d.readUshort(s,l+8)+h,f.markClassCount);else if(a==6&&f.fmt==1)f.mark1Coverage=e._lctf.readCoverage(s,d.readUshort(s,l)+h),f.mark2Coverage=e._lctf.readCoverage(s,d.readUshort(s,l+2)+h),f.markClassCount=d.readUshort(s,l+4),f.mark1Array=e.GPOS.readMarkArray(s,d.readUshort(s,l+6)+h),f.mark2Array=e.GPOS.readBaseArray(s,d.readUshort(s,l+8)+h,f.markClassCount);else{if(a==9&&f.fmt==1){var ne=d.readUshort(s,l);l+=2;var de=d.readUint(s,l);if(l+=4,u.ltype==9)u.ltype=ne;else if(u.ltype!=ne)throw"invalid extension substitution";return e.GPOS.subt(s,u.ltype,h+de)}console.debug("unsupported GPOS table LookupType",a,"format",f.fmt)}return f},e.GPOS.readValueRecord=function(s,a,l){var u=e._bin,d=[];return d.push(1&l?u.readShort(s,a):0),a+=1&l?2:0,d.push(2&l?u.readShort(s,a):0),a+=2&l?2:0,d.push(4&l?u.readShort(s,a):0),a+=4&l?2:0,d.push(8&l?u.readShort(s,a):0),a+=8&l?2:0,d},e.GPOS.readBaseArray=function(s,a,l){var u=e._bin,d=[],h=a,f=u.readUshort(s,a);a+=2;for(var p=0;p<f;p++){for(var m=[],v=0;v<l;v++)m.push(e.GPOS.readAnchorRecord(s,h+u.readUshort(s,a))),a+=2;d.push(m)}return d},e.GPOS.readMarkArray=function(s,a){var l=e._bin,u=[],d=a,h=l.readUshort(s,a);a+=2;for(var f=0;f<h;f++){var p=e.GPOS.readAnchorRecord(s,l.readUshort(s,a+2)+d);p.markClass=l.readUshort(s,a),u.push(p),a+=4}return u},e.GPOS.readAnchorRecord=function(s,a){var l=e._bin,u={};return u.fmt=l.readUshort(s,a),u.x=l.readShort(s,a+2),u.y=l.readShort(s,a+4),u},e.GSUB={},e.GSUB.parse=function(s,a,l,u){return e._lctf.parse(s,a,l,u,e.GSUB.subt)},e.GSUB.subt=function(s,a,l,u){var d=e._bin,h=l,f={};if(f.fmt=d.readUshort(s,l),l+=2,a!=1&&a!=2&&a!=4&&a!=5&&a!=6)return null;if(a==1||a==2||a==4||a==5&&f.fmt<=2||a==6&&f.fmt<=2){var p=d.readUshort(s,l);l+=2,f.coverage=e._lctf.readCoverage(s,h+p)}if(a==1&&f.fmt>=1&&f.fmt<=2){if(f.fmt==1)f.delta=d.readShort(s,l),l+=2;else if(f.fmt==2){var m=d.readUshort(s,l);l+=2,f.newg=d.readUshorts(s,l,m),l+=2*f.newg.length}}else if(a==2&&f.fmt==1){m=d.readUshort(s,l),l+=2,f.seqs=[];for(var v=0;v<m;v++){var y=d.readUshort(s,l)+h;l+=2;var $=d.readUshort(s,y);f.seqs.push(d.readUshorts(s,y+2,$))}}else if(a==4)for(f.vals=[],m=d.readUshort(s,l),l+=2,v=0;v<m;v++){var E=d.readUshort(s,l);l+=2,f.vals.push(e.GSUB.readLigatureSet(s,h+E))}else if(a==5&&f.fmt==2){if(f.fmt==2){var S=d.readUshort(s,l);l+=2,f.cDef=e._lctf.readClassDef(s,h+S),f.scset=[];var A=d.readUshort(s,l);for(l+=2,v=0;v<A;v++){var C=d.readUshort(s,l);l+=2,f.scset.push(C==0?null:e.GSUB.readSubClassSet(s,h+C))}}}else if(a==6&&f.fmt==3){if(f.fmt==3){for(v=0;v<3;v++){m=d.readUshort(s,l),l+=2;for(var x=[],I=0;I<m;I++)x.push(e._lctf.readCoverage(s,h+d.readUshort(s,l+2*I)));l+=2*m,v==0&&(f.backCvg=x),v==1&&(f.inptCvg=x),v==2&&(f.ahedCvg=x)}m=d.readUshort(s,l),l+=2,f.lookupRec=e.GSUB.readSubstLookupRecords(s,l,m)}}else{if(a==7&&f.fmt==1){var O=d.readUshort(s,l);l+=2;var F=d.readUint(s,l);if(l+=4,u.ltype==9)u.ltype=O;else if(u.ltype!=O)throw"invalid extension substitution";return e.GSUB.subt(s,u.ltype,h+F)}console.debug("unsupported GSUB table LookupType",a,"format",f.fmt)}return f},e.GSUB.readSubClassSet=function(s,a){var l=e._bin.readUshort,u=a,d=[],h=l(s,a);a+=2;for(var f=0;f<h;f++){var p=l(s,a);a+=2,d.push(e.GSUB.readSubClassRule(s,u+p))}return d},e.GSUB.readSubClassRule=function(s,a){var l=e._bin.readUshort,u={},d=l(s,a),h=l(s,a+=2);a+=2,u.input=[];for(var f=0;f<d-1;f++)u.input.push(l(s,a)),a+=2;return u.substLookupRecords=e.GSUB.readSubstLookupRecords(s,a,h),u},e.GSUB.readSubstLookupRecords=function(s,a,l){for(var u=e._bin.readUshort,d=[],h=0;h<l;h++)d.push(u(s,a),u(s,a+2)),a+=4;return d},e.GSUB.readChainSubClassSet=function(s,a){var l=e._bin,u=a,d=[],h=l.readUshort(s,a);a+=2;for(var f=0;f<h;f++){var p=l.readUshort(s,a);a+=2,d.push(e.GSUB.readChainSubClassRule(s,u+p))}return d},e.GSUB.readChainSubClassRule=function(s,a){for(var l=e._bin,u={},d=["backtrack","input","lookahead"],h=0;h<d.length;h++){var f=l.readUshort(s,a);a+=2,h==1&&f--,u[d[h]]=l.readUshorts(s,a,f),a+=2*u[d[h]].length}return f=l.readUshort(s,a),a+=2,u.subst=l.readUshorts(s,a,2*f),a+=2*u.subst.length,u},e.GSUB.readLigatureSet=function(s,a){var l=e._bin,u=a,d=[],h=l.readUshort(s,a);a+=2;for(var f=0;f<h;f++){var p=l.readUshort(s,a);a+=2,d.push(e.GSUB.readLigature(s,u+p))}return d},e.GSUB.readLigature=function(s,a){var l=e._bin,u={chain:[]};u.nglyph=l.readUshort(s,a),a+=2;var d=l.readUshort(s,a);a+=2;for(var h=0;h<d-1;h++)u.chain.push(l.readUshort(s,a)),a+=2;return u},e.head={},e.head.parse=function(s,a,l){var u=e._bin,d={};return u.readFixed(s,a),a+=4,d.fontRevision=u.readFixed(s,a),a+=4,u.readUint(s,a),a+=4,u.readUint(s,a),a+=4,d.flags=u.readUshort(s,a),a+=2,d.unitsPerEm=u.readUshort(s,a),a+=2,d.created=u.readUint64(s,a),a+=8,d.modified=u.readUint64(s,a),a+=8,d.xMin=u.readShort(s,a),a+=2,d.yMin=u.readShort(s,a),a+=2,d.xMax=u.readShort(s,a),a+=2,d.yMax=u.readShort(s,a),a+=2,d.macStyle=u.readUshort(s,a),a+=2,d.lowestRecPPEM=u.readUshort(s,a),a+=2,d.fontDirectionHint=u.readShort(s,a),a+=2,d.indexToLocFormat=u.readShort(s,a),a+=2,d.glyphDataFormat=u.readShort(s,a),a+=2,d},e.hhea={},e.hhea.parse=function(s,a,l){var u=e._bin,d={};return u.readFixed(s,a),a+=4,d.ascender=u.readShort(s,a),a+=2,d.descender=u.readShort(s,a),a+=2,d.lineGap=u.readShort(s,a),a+=2,d.advanceWidthMax=u.readUshort(s,a),a+=2,d.minLeftSideBearing=u.readShort(s,a),a+=2,d.minRightSideBearing=u.readShort(s,a),a+=2,d.xMaxExtent=u.readShort(s,a),a+=2,d.caretSlopeRise=u.readShort(s,a),a+=2,d.caretSlopeRun=u.readShort(s,a),a+=2,d.caretOffset=u.readShort(s,a),a+=2,a+=8,d.metricDataFormat=u.readShort(s,a),a+=2,d.numberOfHMetrics=u.readUshort(s,a),a+=2,d},e.hmtx={},e.hmtx.parse=function(s,a,l,u){for(var d=e._bin,h={aWidth:[],lsBearing:[]},f=0,p=0,m=0;m<u.maxp.numGlyphs;m++)m<u.hhea.numberOfHMetrics&&(f=d.readUshort(s,a),a+=2,p=d.readShort(s,a),a+=2),h.aWidth.push(f),h.lsBearing.push(p);return h},e.kern={},e.kern.parse=function(s,a,l,u){var d=e._bin,h=d.readUshort(s,a);if(a+=2,h==1)return e.kern.parseV1(s,a-2,l,u);var f=d.readUshort(s,a);a+=2;for(var p={glyph1:[],rval:[]},m=0;m<f;m++){a+=2,l=d.readUshort(s,a),a+=2;var v=d.readUshort(s,a);a+=2;var y=v>>>8;if((y&=15)!=0)throw"unknown kern table format: "+y;a=e.kern.readFormat0(s,a,p)}return p},e.kern.parseV1=function(s,a,l,u){var d=e._bin;d.readFixed(s,a),a+=4;var h=d.readUint(s,a);a+=4;for(var f={glyph1:[],rval:[]},p=0;p<h;p++){d.readUint(s,a),a+=4;var m=d.readUshort(s,a);a+=2,d.readUshort(s,a),a+=2;var v=m>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;a=e.kern.readFormat0(s,a,f)}return f},e.kern.readFormat0=function(s,a,l){var u=e._bin,d=-1,h=u.readUshort(s,a);a+=2,u.readUshort(s,a),a+=2,u.readUshort(s,a),a+=2,u.readUshort(s,a),a+=2;for(var f=0;f<h;f++){var p=u.readUshort(s,a);a+=2;var m=u.readUshort(s,a);a+=2;var v=u.readShort(s,a);a+=2,p!=d&&(l.glyph1.push(p),l.rval.push({glyph2:[],vals:[]}));var y=l.rval[l.rval.length-1];y.glyph2.push(m),y.vals.push(v),d=p}return a},e.loca={},e.loca.parse=function(s,a,l,u){var d=e._bin,h=[],f=u.head.indexToLocFormat,p=u.maxp.numGlyphs+1;if(f==0)for(var m=0;m<p;m++)h.push(d.readUshort(s,a+(m<<1))<<1);if(f==1)for(m=0;m<p;m++)h.push(d.readUint(s,a+(m<<2)));return h},e.maxp={},e.maxp.parse=function(s,a,l){var u=e._bin,d={},h=u.readUint(s,a);return a+=4,d.numGlyphs=u.readUshort(s,a),a+=2,h==65536&&(d.maxPoints=u.readUshort(s,a),a+=2,d.maxContours=u.readUshort(s,a),a+=2,d.maxCompositePoints=u.readUshort(s,a),a+=2,d.maxCompositeContours=u.readUshort(s,a),a+=2,d.maxZones=u.readUshort(s,a),a+=2,d.maxTwilightPoints=u.readUshort(s,a),a+=2,d.maxStorage=u.readUshort(s,a),a+=2,d.maxFunctionDefs=u.readUshort(s,a),a+=2,d.maxInstructionDefs=u.readUshort(s,a),a+=2,d.maxStackElements=u.readUshort(s,a),a+=2,d.maxSizeOfInstructions=u.readUshort(s,a),a+=2,d.maxComponentElements=u.readUshort(s,a),a+=2,d.maxComponentDepth=u.readUshort(s,a),a+=2),d},e.name={},e.name.parse=function(s,a,l){var u=e._bin,d={};u.readUshort(s,a),a+=2;var h=u.readUshort(s,a);a+=2,u.readUshort(s,a);for(var f,p=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],m=a+=2,v=0;v<h;v++){var y=u.readUshort(s,a);a+=2;var $=u.readUshort(s,a);a+=2;var E=u.readUshort(s,a);a+=2;var S=u.readUshort(s,a);a+=2;var A=u.readUshort(s,a);a+=2;var C=u.readUshort(s,a);a+=2;var x,I=p[S],O=m+12*h+C;if(y==0)x=u.readUnicode(s,O,A/2);else if(y==3&&$==0)x=u.readUnicode(s,O,A/2);else if($==0)x=u.readASCII(s,O,A);else if($==1)x=u.readUnicode(s,O,A/2);else if($==3)x=u.readUnicode(s,O,A/2);else{if(y!=1)throw"unknown encoding "+$+", platformID: "+y;x=u.readASCII(s,O,A),console.debug("reading unknown MAC encoding "+$+" as ASCII")}var F="p"+y+","+E.toString(16);d[F]==null&&(d[F]={}),d[F][I!==void 0?I:S]=x,d[F]._lang=E}for(var k in d)if(d[k].postScriptName!=null&&d[k]._lang==1033)return d[k];for(var k in d)if(d[k].postScriptName!=null&&d[k]._lang==0)return d[k];for(var k in d)if(d[k].postScriptName!=null&&d[k]._lang==3084)return d[k];for(var k in d)if(d[k].postScriptName!=null)return d[k];for(var k in d){f=k;break}return console.debug("returning name table with languageID "+d[f]._lang),d[f]},e["OS/2"]={},e["OS/2"].parse=function(s,a,l){var u=e._bin.readUshort(s,a);a+=2;var d={};if(u==0)e["OS/2"].version0(s,a,d);else if(u==1)e["OS/2"].version1(s,a,d);else if(u==2||u==3||u==4)e["OS/2"].version2(s,a,d);else{if(u!=5)throw"unknown OS/2 table version: "+u;e["OS/2"].version5(s,a,d)}return d},e["OS/2"].version0=function(s,a,l){var u=e._bin;return l.xAvgCharWidth=u.readShort(s,a),a+=2,l.usWeightClass=u.readUshort(s,a),a+=2,l.usWidthClass=u.readUshort(s,a),a+=2,l.fsType=u.readUshort(s,a),a+=2,l.ySubscriptXSize=u.readShort(s,a),a+=2,l.ySubscriptYSize=u.readShort(s,a),a+=2,l.ySubscriptXOffset=u.readShort(s,a),a+=2,l.ySubscriptYOffset=u.readShort(s,a),a+=2,l.ySuperscriptXSize=u.readShort(s,a),a+=2,l.ySuperscriptYSize=u.readShort(s,a),a+=2,l.ySuperscriptXOffset=u.readShort(s,a),a+=2,l.ySuperscriptYOffset=u.readShort(s,a),a+=2,l.yStrikeoutSize=u.readShort(s,a),a+=2,l.yStrikeoutPosition=u.readShort(s,a),a+=2,l.sFamilyClass=u.readShort(s,a),a+=2,l.panose=u.readBytes(s,a,10),a+=10,l.ulUnicodeRange1=u.readUint(s,a),a+=4,l.ulUnicodeRange2=u.readUint(s,a),a+=4,l.ulUnicodeRange3=u.readUint(s,a),a+=4,l.ulUnicodeRange4=u.readUint(s,a),a+=4,l.achVendID=[u.readInt8(s,a),u.readInt8(s,a+1),u.readInt8(s,a+2),u.readInt8(s,a+3)],a+=4,l.fsSelection=u.readUshort(s,a),a+=2,l.usFirstCharIndex=u.readUshort(s,a),a+=2,l.usLastCharIndex=u.readUshort(s,a),a+=2,l.sTypoAscender=u.readShort(s,a),a+=2,l.sTypoDescender=u.readShort(s,a),a+=2,l.sTypoLineGap=u.readShort(s,a),a+=2,l.usWinAscent=u.readUshort(s,a),a+=2,l.usWinDescent=u.readUshort(s,a),a+=2},e["OS/2"].version1=function(s,a,l){var u=e._bin;return a=e["OS/2"].version0(s,a,l),l.ulCodePageRange1=u.readUint(s,a),a+=4,l.ulCodePageRange2=u.readUint(s,a),a+=4},e["OS/2"].version2=function(s,a,l){var u=e._bin;return a=e["OS/2"].version1(s,a,l),l.sxHeight=u.readShort(s,a),a+=2,l.sCapHeight=u.readShort(s,a),a+=2,l.usDefault=u.readUshort(s,a),a+=2,l.usBreak=u.readUshort(s,a),a+=2,l.usMaxContext=u.readUshort(s,a),a+=2},e["OS/2"].version5=function(s,a,l){var u=e._bin;return a=e["OS/2"].version2(s,a,l),l.usLowerOpticalPointSize=u.readUshort(s,a),a+=2,l.usUpperOpticalPointSize=u.readUshort(s,a),a+=2},e.post={},e.post.parse=function(s,a,l){var u=e._bin,d={};return d.version=u.readFixed(s,a),a+=4,d.italicAngle=u.readFixed(s,a),a+=4,d.underlinePosition=u.readShort(s,a),a+=2,d.underlineThickness=u.readShort(s,a),a+=2,d},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,a){var l=s.cmap,u=-1;if(l.p0e4!=null?u=l.p0e4:l.p3e1!=null?u=l.p3e1:l.p1e0!=null?u=l.p1e0:l.p0e3!=null&&(u=l.p0e3),u==-1)throw"no familiar platform and encoding!";var d=l.tables[u];if(d.format==0)return a>=d.map.length?0:d.map[a];if(d.format==4){for(var h=-1,f=0;f<d.endCount.length;f++)if(a<=d.endCount[f]){h=f;break}return h==-1||d.startCount[h]>a?0:65535&(d.idRangeOffset[h]!=0?d.glyphIdArray[a-d.startCount[h]+(d.idRangeOffset[h]>>1)-(d.idRangeOffset.length-h)]:a+d.idDelta[h])}if(d.format==12){if(a>d.groups[d.groups.length-1][1])return 0;for(f=0;f<d.groups.length;f++){var p=d.groups[f];if(p[0]<=a&&a<=p[1])return p[2]+(a-p[0])}return 0}throw"unknown cmap table format "+d.format},e.U.glyphToPath=function(s,a){var l={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[a]){var u=s.SVG.entries[a];return u==null?l:(typeof u=="string"&&(u=e.SVG.toPath(u),s.SVG.entries[a]=u),u)}if(s.CFF){var d={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},h=s.CFF,f=s.CFF.Private;if(h.ROS){for(var p=0;h.FDSelect[p+2]<=a;)p+=2;f=h.FDArray[h.FDSelect[p+1]].Private}e.U._drawCFF(s.CFF.CharStrings[a],d,h,f,l)}else s.glyf&&e.U._drawGlyf(a,s,l);return l},e.U._drawGlyf=function(s,a,l){var u=a.glyf[s];u==null&&(u=a.glyf[s]=e.glyf._parseGlyf(a,s)),u!=null&&(u.noc>-1?e.U._simpleGlyph(u,l):e.U._compoGlyph(u,a,l))},e.U._simpleGlyph=function(s,a){for(var l=0;l<s.noc;l++){for(var u=l==0?0:s.endPts[l-1]+1,d=s.endPts[l],h=u;h<=d;h++){var f=h==u?d:h-1,p=h==d?u:h+1,m=1&s.flags[h],v=1&s.flags[f],y=1&s.flags[p],$=s.xs[h],E=s.ys[h];if(h==u)if(m){if(!v){e.U.P.moveTo(a,$,E);continue}e.U.P.moveTo(a,s.xs[f],s.ys[f])}else v?e.U.P.moveTo(a,s.xs[f],s.ys[f]):e.U.P.moveTo(a,(s.xs[f]+$)/2,(s.ys[f]+E)/2);m?v&&e.U.P.lineTo(a,$,E):y?e.U.P.qcurveTo(a,$,E,s.xs[p],s.ys[p]):e.U.P.qcurveTo(a,$,E,($+s.xs[p])/2,(E+s.ys[p])/2)}e.U.P.closePath(a)}},e.U._compoGlyph=function(s,a,l){for(var u=0;u<s.parts.length;u++){var d={cmds:[],crds:[]},h=s.parts[u];e.U._drawGlyf(h.glyphIndex,a,d);for(var f=h.m,p=0;p<d.crds.length;p+=2){var m=d.crds[p],v=d.crds[p+1];l.crds.push(m*f.a+v*f.b+f.tx),l.crds.push(m*f.c+v*f.d+f.ty)}for(p=0;p<d.cmds.length;p++)l.cmds.push(d.cmds[p])}},e.U._getGlyphClass=function(s,a){var l=e._lctf.getInterval(a,s);return l==-1?0:a[l+2]},e.U._applySubs=function(s,a,l,u){for(var d=s.length-a-1,h=0;h<l.tabs.length;h++)if(l.tabs[h]!=null){var f,p=l.tabs[h];if(!p.coverage||(f=e._lctf.coverageIndex(p.coverage,s[a]))!=-1){if(l.ltype==1)s[a],p.fmt==1?s[a]=s[a]+p.delta:s[a]=p.newg[f];else if(l.ltype==4)for(var m=p.vals[f],v=0;v<m.length;v++){var y=m[v],$=y.chain.length;if(!($>d)){for(var E=!0,S=0,A=0;A<$;A++){for(;s[a+S+(1+A)]==-1;)S++;y.chain[A]!=s[a+S+(1+A)]&&(E=!1)}if(E){for(s[a]=y.nglyph,A=0;A<$+S;A++)s[a+A+1]=-1;break}}}else if(l.ltype==5&&p.fmt==2)for(var C=e._lctf.getInterval(p.cDef,s[a]),x=p.cDef[C+2],I=p.scset[x],O=0;O<I.length;O++){var F=I[O],k=F.input;if(!(k.length>d)){for(E=!0,A=0;A<k.length;A++){var D=e._lctf.getInterval(p.cDef,s[a+1+A]);if(C==-1&&p.cDef[D+2]!=k[A]){E=!1;break}}if(E){var U=F.substLookupRecords;for(v=0;v<U.length;v+=2)U[v],U[v+1]}}}else if(l.ltype==6&&p.fmt==3){if(!e.U._glsCovered(s,p.backCvg,a-p.backCvg.length)||!e.U._glsCovered(s,p.inptCvg,a)||!e.U._glsCovered(s,p.ahedCvg,a+p.inptCvg.length))continue;var ce=p.lookupRec;for(O=0;O<ce.length;O+=2){C=ce[O];var re=u[ce[O+1]];e.U._applySubs(s,a+C,re,u)}}}}},e.U._glsCovered=function(s,a,l){for(var u=0;u<a.length;u++)if(e._lctf.coverageIndex(a[u],s[l+u])==-1)return!1;return!0},e.U.glyphsToPath=function(s,a,l){for(var u={cmds:[],crds:[]},d=0,h=0;h<a.length;h++){var f=a[h];if(f!=-1){for(var p=h<a.length-1&&a[h+1]!=-1?a[h+1]:0,m=e.U.glyphToPath(s,f),v=0;v<m.crds.length;v+=2)u.crds.push(m.crds[v]+d),u.crds.push(m.crds[v+1]);for(l&&u.cmds.push(l),v=0;v<m.cmds.length;v++)u.cmds.push(m.cmds[v]);l&&u.cmds.push("X"),d+=s.hmtx.aWidth[f],h<a.length-1&&(d+=e.U.getPairAdjustment(s,f,p))}}return u},e.U.P={},e.U.P.moveTo=function(s,a,l){s.cmds.push("M"),s.crds.push(a,l)},e.U.P.lineTo=function(s,a,l){s.cmds.push("L"),s.crds.push(a,l)},e.U.P.curveTo=function(s,a,l,u,d,h,f){s.cmds.push("C"),s.crds.push(a,l,u,d,h,f)},e.U.P.qcurveTo=function(s,a,l,u,d){s.cmds.push("Q"),s.crds.push(a,l,u,d)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,a,l,u,d){for(var h=a.stack,f=a.nStems,p=a.haveWidth,m=a.width,v=a.open,y=0,$=a.x,E=a.y,S=0,A=0,C=0,x=0,I=0,O=0,F=0,k=0,D=0,U=0,ce={val:0,size:0};y<s.length;){e.CFF.getCharString(s,y,ce);var re=ce.val;if(y+=ce.size,re=="o1"||re=="o18")h.length%2!=0&&!p&&(m=h.shift()+u.nominalWidthX),f+=h.length>>1,h.length=0,p=!0;else if(re=="o3"||re=="o23")h.length%2!=0&&!p&&(m=h.shift()+u.nominalWidthX),f+=h.length>>1,h.length=0,p=!0;else if(re=="o4")h.length>1&&!p&&(m=h.shift()+u.nominalWidthX,p=!0),v&&e.U.P.closePath(d),E+=h.pop(),e.U.P.moveTo(d,$,E),v=!0;else if(re=="o5")for(;h.length>0;)$+=h.shift(),E+=h.shift(),e.U.P.lineTo(d,$,E);else if(re=="o6"||re=="o7")for(var ae=h.length,ne=re=="o6",de=0;de<ae;de++){var ue=h.shift();ne?$+=ue:E+=ue,ne=!ne,e.U.P.lineTo(d,$,E)}else if(re=="o8"||re=="o24"){ae=h.length;for(var Re=0;Re+6<=ae;)S=$+h.shift(),A=E+h.shift(),C=S+h.shift(),x=A+h.shift(),$=C+h.shift(),E=x+h.shift(),e.U.P.curveTo(d,S,A,C,x,$,E),Re+=6;re=="o24"&&($+=h.shift(),E+=h.shift(),e.U.P.lineTo(d,$,E))}else{if(re=="o11")break;if(re=="o1234"||re=="o1235"||re=="o1236"||re=="o1237")re=="o1234"&&(A=E,C=(S=$+h.shift())+h.shift(),U=x=A+h.shift(),O=x,k=E,$=(F=(I=(D=C+h.shift())+h.shift())+h.shift())+h.shift(),e.U.P.curveTo(d,S,A,C,x,D,U),e.U.P.curveTo(d,I,O,F,k,$,E)),re=="o1235"&&(S=$+h.shift(),A=E+h.shift(),C=S+h.shift(),x=A+h.shift(),D=C+h.shift(),U=x+h.shift(),I=D+h.shift(),O=U+h.shift(),F=I+h.shift(),k=O+h.shift(),$=F+h.shift(),E=k+h.shift(),h.shift(),e.U.P.curveTo(d,S,A,C,x,D,U),e.U.P.curveTo(d,I,O,F,k,$,E)),re=="o1236"&&(S=$+h.shift(),A=E+h.shift(),C=S+h.shift(),U=x=A+h.shift(),O=x,F=(I=(D=C+h.shift())+h.shift())+h.shift(),k=O+h.shift(),$=F+h.shift(),e.U.P.curveTo(d,S,A,C,x,D,U),e.U.P.curveTo(d,I,O,F,k,$,E)),re=="o1237"&&(S=$+h.shift(),A=E+h.shift(),C=S+h.shift(),x=A+h.shift(),D=C+h.shift(),U=x+h.shift(),I=D+h.shift(),O=U+h.shift(),F=I+h.shift(),k=O+h.shift(),Math.abs(F-$)>Math.abs(k-E)?$=F+h.shift():E=k+h.shift(),e.U.P.curveTo(d,S,A,C,x,D,U),e.U.P.curveTo(d,I,O,F,k,$,E));else if(re=="o14"){if(h.length>0&&!p&&(m=h.shift()+l.nominalWidthX,p=!0),h.length==4){var G=h.shift(),Z=h.shift(),K=h.shift(),se=h.shift(),Y=e.CFF.glyphBySE(l,K),me=e.CFF.glyphBySE(l,se);e.U._drawCFF(l.CharStrings[Y],a,l,u,d),a.x=G,a.y=Z,e.U._drawCFF(l.CharStrings[me],a,l,u,d)}v&&(e.U.P.closePath(d),v=!1)}else if(re=="o19"||re=="o20")h.length%2!=0&&!p&&(m=h.shift()+u.nominalWidthX),f+=h.length>>1,h.length=0,p=!0,y+=f+7>>3;else if(re=="o21")h.length>2&&!p&&(m=h.shift()+u.nominalWidthX,p=!0),E+=h.pop(),$+=h.pop(),v&&e.U.P.closePath(d),e.U.P.moveTo(d,$,E),v=!0;else if(re=="o22")h.length>1&&!p&&(m=h.shift()+u.nominalWidthX,p=!0),$+=h.pop(),v&&e.U.P.closePath(d),e.U.P.moveTo(d,$,E),v=!0;else if(re=="o25"){for(;h.length>6;)$+=h.shift(),E+=h.shift(),e.U.P.lineTo(d,$,E);S=$+h.shift(),A=E+h.shift(),C=S+h.shift(),x=A+h.shift(),$=C+h.shift(),E=x+h.shift(),e.U.P.curveTo(d,S,A,C,x,$,E)}else if(re=="o26")for(h.length%2&&($+=h.shift());h.length>0;)S=$,A=E+h.shift(),$=C=S+h.shift(),E=(x=A+h.shift())+h.shift(),e.U.P.curveTo(d,S,A,C,x,$,E);else if(re=="o27")for(h.length%2&&(E+=h.shift());h.length>0;)A=E,C=(S=$+h.shift())+h.shift(),x=A+h.shift(),$=C+h.shift(),E=x,e.U.P.curveTo(d,S,A,C,x,$,E);else if(re=="o10"||re=="o29"){var fe=re=="o10"?u:l;if(h.length==0)console.debug("error: empty stack");else{var Ae=h.pop(),Ce=fe.Subrs[Ae+fe.Bias];a.x=$,a.y=E,a.nStems=f,a.haveWidth=p,a.width=m,a.open=v,e.U._drawCFF(Ce,a,l,u,d),$=a.x,E=a.y,f=a.nStems,p=a.haveWidth,m=a.width,v=a.open}}else if(re=="o30"||re=="o31"){var Ie=h.length,We=(Re=0,re=="o31");for(Re+=Ie-(ae=-3&Ie);Re<ae;)We?(A=E,C=(S=$+h.shift())+h.shift(),E=(x=A+h.shift())+h.shift(),ae-Re==5?($=C+h.shift(),Re++):$=C,We=!1):(S=$,A=E+h.shift(),C=S+h.shift(),x=A+h.shift(),$=C+h.shift(),ae-Re==5?(E=x+h.shift(),Re++):E=x,We=!0),e.U.P.curveTo(d,S,A,C,x,$,E),Re+=4}else{if((re+"").charAt(0)=="o")throw console.debug("Unknown operation: "+re,s),re;h.push(re)}}}a.x=$,a.y=E,a.nStems=f,a.haveWidth=p,a.width=m,a.open=v};var n=e,r={Typr:n};return i.Typr=n,i.default=r,Object.defineProperty(i,"__esModule",{value:!0}),i}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function PK(){return function(i){var e=Uint8Array,n=Uint16Array,r=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(re,ae){for(var ne=new n(31),de=0;de<31;++de)ne[de]=ae+=1<<re[de-1];var ue=new r(ne[30]);for(de=1;de<30;++de)for(var Re=ne[de];Re<ne[de+1];++Re)ue[Re]=Re-ne[de]<<5|de;return[ne,ue]},d=u(s,2),h=d[0],f=d[1];h[28]=258,f[258]=28;for(var p=u(a,0)[0],m=new n(32768),v=0;v<32768;++v){var y=(43690&v)>>>1|(21845&v)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,m[v]=((65280&y)>>>8|(255&y)<<8)>>>1}var $=function(re,ae,ne){for(var de=re.length,ue=0,Re=new n(ae);ue<de;++ue)++Re[re[ue]-1];var G,Z=new n(ae);for(ue=0;ue<ae;++ue)Z[ue]=Z[ue-1]+Re[ue-1]<<1;if(ne){G=new n(1<<ae);var K=15-ae;for(ue=0;ue<de;++ue)if(re[ue])for(var se=ue<<4|re[ue],Y=ae-re[ue],me=Z[re[ue]-1]++<<Y,fe=me|(1<<Y)-1;me<=fe;++me)G[m[me]>>>K]=se}else for(G=new n(de),ue=0;ue<de;++ue)re[ue]&&(G[ue]=m[Z[re[ue]-1]++]>>>15-re[ue]);return G},E=new e(288);for(v=0;v<144;++v)E[v]=8;for(v=144;v<256;++v)E[v]=9;for(v=256;v<280;++v)E[v]=7;for(v=280;v<288;++v)E[v]=8;var S=new e(32);for(v=0;v<32;++v)S[v]=5;var A=$(E,9,1),C=$(S,5,1),x=function(re){for(var ae=re[0],ne=1;ne<re.length;++ne)re[ne]>ae&&(ae=re[ne]);return ae},I=function(re,ae,ne){var de=ae/8|0;return(re[de]|re[de+1]<<8)>>(7&ae)&ne},O=function(re,ae){var ne=ae/8|0;return(re[ne]|re[ne+1]<<8|re[ne+2]<<16)>>(7&ae)},F=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(re,ae,ne){var de=new Error(ae||F[re]);if(de.code=re,Error.captureStackTrace&&Error.captureStackTrace(de,k),!ne)throw de;return de},D=function(re,ae,ne){var de=re.length;if(!de||ne&&!ne.l&&de<5)return ae||new e(0);var ue=!ae||ne,Re=!ne||ne.i;ne||(ne={}),ae||(ae=new e(3*de));var G,Z=function(he){var z=ae.length;if(he>z){var be=new e(Math.max(2*z,he));be.set(ae),ae=be}},K=ne.f||0,se=ne.p||0,Y=ne.b||0,me=ne.l,fe=ne.d,Ae=ne.m,Ce=ne.n,Ie=8*de;do{if(!me){ne.f=K=I(re,se,1);var We=I(re,se+1,3);if(se+=3,!We){var ut=re[(ve=((G=se)/8|0)+(7&G&&1)+4)-4]|re[ve-3]<<8,Ye=ve+ut;if(Ye>de){Re&&k(0);break}ue&&Z(Y+ut),ae.set(re.subarray(ve,Ye),Y),ne.b=Y+=ut,ne.p=se=8*Ye;continue}if(We==1)me=A,fe=C,Ae=9,Ce=5;else if(We==2){var we=I(re,se,31)+257,Q=I(re,se+10,15)+4,Ge=we+I(re,se+5,31)+1;se+=14;for(var Oe=new e(Ge),Ve=new e(19),Fe=0;Fe<Q;++Fe)Ve[l[Fe]]=I(re,se+3*Fe,7);se+=3*Q;var tt=x(Ve),Ue=(1<<tt)-1,Je=$(Ve,tt,1);for(Fe=0;Fe<Ge;){var ve,Me=Je[I(re,se,Ue)];if(se+=15&Me,(ve=Me>>>4)<16)Oe[Fe++]=ve;else{var vt=0,oe=0;for(ve==16?(oe=3+I(re,se,3),se+=2,vt=Oe[Fe-1]):ve==17?(oe=3+I(re,se,7),se+=3):ve==18&&(oe=11+I(re,se,127),se+=7);oe--;)Oe[Fe++]=vt}}var ee=Oe.subarray(0,we),W=Oe.subarray(we);Ae=x(ee),Ce=x(W),me=$(ee,Ae,1),fe=$(W,Ce,1)}else k(1);if(se>Ie){Re&&k(0);break}}ue&&Z(Y+131072);for(var ot=(1<<Ae)-1,je=(1<<Ce)-1,Qe=se;;Qe=se){var ht=(vt=me[O(re,se)&ot])>>>4;if((se+=15&vt)>Ie){Re&&k(0);break}if(vt||k(2),ht<256)ae[Y++]=ht;else{if(ht==256){Qe=se,me=null;break}var ft=ht-254;if(ht>264){var He=s[Fe=ht-257];ft=I(re,se,(1<<He)-1)+h[Fe],se+=He}var St=fe[O(re,se)&je],L=St>>>4;if(St||k(3),se+=15&St,W=p[L],L>3&&(He=a[L],W+=O(re,se)&(1<<He)-1,se+=He),se>Ie){Re&&k(0);break}ue&&Z(Y+131072);for(var X=Y+ft;Y<X;Y+=4)ae[Y]=ae[Y-W],ae[Y+1]=ae[Y+1-W],ae[Y+2]=ae[Y+2-W],ae[Y+3]=ae[Y+3-W];Y=X}}ne.l=me,ne.p=Qe,ne.b=Y,me&&(K=1,ne.m=Ae,ne.d=fe,ne.n=Ce)}while(!K);return Y==ae.length?ae:function(he,z,be){(z==null||z<0)&&(z=0),(be==null||be>he.length)&&(be=he.length);var nt=new(he instanceof n?n:he instanceof r?r:e)(be-z);return nt.set(he.subarray(z,be)),nt}(ae,0,Y)},U=new e(0),ce=typeof TextDecoder<"u"&&new TextDecoder;try{ce.decode(U,{stream:!0})}catch{}return i.convert_streams=function(re){var ae=new DataView(re),ne=0;function de(){var we=ae.getUint16(ne);return ne+=2,we}function ue(){var we=ae.getUint32(ne);return ne+=4,we}function Re(we){ut.setUint16(Ye,we),Ye+=2}function G(we){ut.setUint32(Ye,we),Ye+=4}for(var Z={signature:ue(),flavor:ue(),length:ue(),numTables:de(),reserved:de(),totalSfntSize:ue(),majorVersion:de(),minorVersion:de(),metaOffset:ue(),metaLength:ue(),metaOrigLength:ue(),privOffset:ue(),privLength:ue()},K=0;Math.pow(2,K)<=Z.numTables;)K++;K--;for(var se=16*Math.pow(2,K),Y=16*Z.numTables-se,me=12,fe=[],Ae=0;Ae<Z.numTables;Ae++)fe.push({tag:ue(),offset:ue(),compLength:ue(),origLength:ue(),origChecksum:ue()}),me+=16;var Ce,Ie=new Uint8Array(12+16*fe.length+fe.reduce(function(we,Q){return we+Q.origLength+4},0)),We=Ie.buffer,ut=new DataView(We),Ye=0;return G(Z.flavor),Re(Z.numTables),Re(se),Re(K),Re(Y),fe.forEach(function(we){G(we.tag),G(we.origChecksum),G(me),G(we.origLength),we.outOffset=me,(me+=we.origLength)%4!=0&&(me+=4-me%4)}),fe.forEach(function(we){var Q,Ge=re.slice(we.offset,we.offset+we.compLength);if(we.compLength!=we.origLength){var Oe=new Uint8Array(we.origLength);Q=new Uint8Array(Ge,2),D(Q,Oe)}else Oe=new Uint8Array(Ge);Ie.set(Oe,we.outOffset);var Ve=0;(me=we.outOffset+we.origLength)%4!=0&&(Ve=4-me%4),Ie.set(new Uint8Array(Ve).buffer,we.outOffset+we.origLength),Ce=me+Ve}),We.slice(0,Ce)},Object.defineProperty(i,"__esModule",{value:!0}),i}({}).convert_streams}function DK(i,e){const n={M:2,L:2,Q:4,C:6,Z:0},r={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,a=2,l=4,u=8,d=16,h=32;let f;function p(F){if(!f){const k={R:a,L:s,D:l,C:d,U:h,T:u};f=new Map;for(let D in r){let U=0;r[D].split(",").forEach(ce=>{let[re,ae]=ce.split("+");re=parseInt(re,36),ae=ae?parseInt(ae,36):0,f.set(U+=re,k[D]);for(let ne=ae;ne--;)f.set(++U,k[D])})}}return f.get(F)||h}const m=1,v=2,y=3,$=4,E=[null,"isol","init","fina","medi"];function S(F){const k=new Uint8Array(F.length);let D=h,U=m,ce=-1;for(let re=0;re<F.length;re++){const ae=F.codePointAt(re);let ne=p(ae)|0,de=m;ne&u||(D&(s|l|d)?ne&(a|l|d)?(de=y,(U===m||U===y)&&k[ce]++):ne&(s|h)&&(U===v||U===$)&&k[ce]--:D&(a|h)&&(U===v||U===$)&&k[ce]--,U=k[re]=de,D=ne,ce=re,ae>65535&&re++)}return k}function A(F,k){const D=[];for(let ce=0;ce<k.length;ce++){const re=k.codePointAt(ce);re>65535&&ce++,D.push(i.U.codeToGlyph(F,re))}const U=F.GSUB;if(U){const{lookupList:ce,featureList:re}=U;let ae;const ne=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,de=[];re.forEach(ue=>{if(ne.test(ue.tag))for(let Re=0;Re<ue.tab.length;Re++){if(de[ue.tab[Re]])continue;de[ue.tab[Re]]=!0;const G=ce[ue.tab[Re]],Z=/^(isol|init|fina|medi)$/.test(ue.tag);Z&&!ae&&(ae=S(k));for(let K=0;K<D.length;K++)(!ae||!Z||E[ae[K]]===ue.tag)&&i.U._applySubs(D,K,G,ce)}})}return D}function C(F,k){const D=new Int16Array(k.length*3);let U=0;for(;U<k.length;U++){const ne=k[U];if(ne===-1)continue;D[U*3+2]=F.hmtx.aWidth[ne];const de=F.GPOS;if(de){const ue=de.lookupList;for(let Re=0;Re<ue.length;Re++){const G=ue[Re];for(let Z=0;Z<G.tabs.length;Z++){const K=G.tabs[Z];if(G.ltype===1){if(i._lctf.coverageIndex(K.coverage,ne)!==-1&&K.pos){ae(K.pos,U);break}}else if(G.ltype===2){let se=null,Y=ce();if(Y!==-1){const me=i._lctf.coverageIndex(K.coverage,k[Y]);if(me!==-1){if(K.fmt===1){const fe=K.pairsets[me];for(let Ae=0;Ae<fe.length;Ae++)fe[Ae].gid2===ne&&(se=fe[Ae])}else if(K.fmt===2){const fe=i.U._getGlyphClass(k[Y],K.classDef1),Ae=i.U._getGlyphClass(ne,K.classDef2);se=K.matrix[fe][Ae]}if(se){se.val1&&ae(se.val1,Y),se.val2&&ae(se.val2,U);break}}}}else if(G.ltype===4){const se=i._lctf.coverageIndex(K.markCoverage,ne);if(se!==-1){const Y=ce(re),me=Y===-1?-1:i._lctf.coverageIndex(K.baseCoverage,k[Y]);if(me!==-1){const fe=K.markArray[se],Ae=K.baseArray[me][fe.markClass];D[U*3]=Ae.x-fe.x+D[Y*3]-D[Y*3+2],D[U*3+1]=Ae.y-fe.y+D[Y*3+1];break}}}else if(G.ltype===6){const se=i._lctf.coverageIndex(K.mark1Coverage,ne);if(se!==-1){const Y=ce();if(Y!==-1){const me=k[Y];if(x(F,me)===3){const fe=i._lctf.coverageIndex(K.mark2Coverage,me);if(fe!==-1){const Ae=K.mark1Array[se],Ce=K.mark2Array[fe][Ae.markClass];D[U*3]=Ce.x-Ae.x+D[Y*3]-D[Y*3+2],D[U*3+1]=Ce.y-Ae.y+D[Y*3+1];break}}}}}}}}else if(F.kern&&!F.cff){const ue=ce();if(ue!==-1){const Re=F.kern.glyph1.indexOf(k[ue]);if(Re!==-1){const G=F.kern.rval[Re].glyph2.indexOf(ne);G!==-1&&(D[ue*3+2]+=F.kern.rval[Re].vals[G])}}}}return D;function ce(ne){for(let de=U-1;de>=0;de--)if(k[de]!==-1&&(!ne||ne(k[de])))return de;return-1}function re(ne){return x(F,ne)===1}function ae(ne,de){for(let ue=0;ue<3;ue++)D[de*3+ue]+=ne[ue]||0}}function x(F,k){const D=F.GDEF&&F.GDEF.glyphClassDef;return D?i.U._getGlyphClass(k,D):0}function I(...F){for(let k=0;k<F.length;k++)if(typeof F[k]=="number")return F[k]}function O(F){const k=Object.create(null),D=F["OS/2"],U=F.hhea,ce=F.head.unitsPerEm,re=I(D&&D.sTypoAscender,U&&U.ascender,ce),ae={unitsPerEm:ce,ascender:re,descender:I(D&&D.sTypoDescender,U&&U.descender,0),capHeight:I(D&&D.sCapHeight,re),xHeight:I(D&&D.sxHeight,re),lineGap:I(D&&D.sTypoLineGap,U&&U.lineGap),supportsCodePoint(ne){return i.U.codeToGlyph(F,ne)>0},forEachGlyph(ne,de,ue,Re){let G=0;const Z=1/ae.unitsPerEm*de,K=A(F,ne);let se=0;const Y=C(F,K);return K.forEach((me,fe)=>{if(me!==-1){let Ae=k[me];if(!Ae){const{cmds:Ce,crds:Ie}=i.U.glyphToPath(F,me);let We="",ut=0;for(let Oe=0,Ve=Ce.length;Oe<Ve;Oe++){const Fe=n[Ce[Oe]];We+=Ce[Oe];for(let tt=1;tt<=Fe;tt++)We+=(tt>1?",":"")+Ie[ut++]}let Ye,we,Q,Ge;if(Ie.length){Ye=we=1/0,Q=Ge=-1/0;for(let Oe=0,Ve=Ie.length;Oe<Ve;Oe+=2){let Fe=Ie[Oe],tt=Ie[Oe+1];Fe<Ye&&(Ye=Fe),tt<we&&(we=tt),Fe>Q&&(Q=Fe),tt>Ge&&(Ge=tt)}}else Ye=Q=we=Ge=0;Ae=k[me]={index:me,advanceWidth:F.hmtx.aWidth[me],xMin:Ye,yMin:we,xMax:Q,yMax:Ge,path:We}}Re.call(null,Ae,G+Y[fe*3]*Z,Y[fe*3+1]*Z,se),G+=Y[fe*3+2]*Z,ue&&(G+=ue*de)}se+=ne.codePointAt(se)>65535?2:1}),G}};return ae}return function(k){const D=new Uint8Array(k,0,4),U=i._bin.readASCII(D,0,4);if(U==="wOFF")k=e(k);else if(U==="wOF2")throw new Error("woff2 fonts not supported");return O(i.parse(k)[0])}}const BK=u_({name:"Typr Font Parser",dependencies:[kK,PK,DK],init(i,e,n){const r=i(),s=e();return n(r,s)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function FK(){return function(i){var e=function(){this.buckets=new Map};e.prototype.add=function(C){var x=C>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&C))},e.prototype.has=function(C){var x=this.buckets.get(C>>5);return x!==void 0&&(x&1<<(31&C))!=0},e.prototype.serialize=function(){var C=[];return this.buckets.forEach(function(x,I){C.push((+I).toString(36)+":"+x.toString(36))}),C.join(",")},e.prototype.deserialize=function(C){var x=this;this.buckets.clear(),C.split(",").forEach(function(I){var O=I.split(":");x.buckets.set(parseInt(O[0],36),parseInt(O[1],36))})};var n=Math.pow(2,8),r=n-1,s=~r;function a(C){var x=function(O){return O&s}(C).toString(16),I=function(O){return(O&s)+n-1}(C).toString(16);return"codepoint-index/plane"+(C>>16)+"/"+x+"-"+I+".json"}function l(C,x){var I=C&r,O=x.codePointAt(I/6|0);return((O=(O||48)-48)&1<<I%6)!=0}function u(C,x){var I;(I=C,I.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(O){return O.split("-").map(function(F){return parseInt(F.trim(),16)})})).forEach(function(O){var F=O[0],k=O[1];k===void 0&&(k=F),x(F,k)})}function d(C,x){u(C,function(I,O){for(var F=I;F<=O;F++)x(F)})}var h={},f={},p=new WeakMap,m="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function v(C){var x=p.get(C);return x||(x=new e,d(C.ranges,function(I){return x.add(I)}),p.set(C,x)),x}var y,$=new Map;function E(C,x,I){return C[x]?x:C[I]?I:function(O){for(var F in O)return F}(C)}function S(C,x){var I=x;if(!C.includes(I)){I=1/0;for(var O=0;O<C.length;O++)Math.abs(C[O]-x)<Math.abs(I-x)&&(I=C[O])}return I}function A(C){return y||(y=new Set,d("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(x){y.add(x)})),y.has(C)}return i.CodePointSet=e,i.clearCache=function(){h={},f={}},i.getFontsForString=function(C,x){x===void 0&&(x={});var I,O=x.lang;O===void 0&&(O=/\p{Script=Hangul}/u.test(I=C)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(I)?"ja":"en");var F=x.category;F===void 0&&(F="sans-serif");var k=x.style;k===void 0&&(k="normal");var D=x.weight;D===void 0&&(D=400);var U=(x.dataUrl||m).replace(/\/$/g,""),ce=new Map,re=new Uint8Array(C.length),ae={},ne={},de=new Array(C.length),ue=new Map,Re=!1;function G(se){var Y=$.get(se);return Y||(Y=fetch(U+"/"+se).then(function(me){if(!me.ok)throw new Error(me.statusText);return me.json().then(function(fe){if(!Array.isArray(fe)||fe[0]!==1)throw new Error("Incorrect schema version; need 1, got "+fe[0]);return fe[1]})}).catch(function(me){if(U!==m)return Re||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+U+'", trying default CDN. '+me.message),Re=!0),U=m,$.delete(se),G(se);throw me}),$.set(se,Y)),Y}for(var Z=function(se){var Y=C.codePointAt(se),me=a(Y);de[se]=me,h[me]||ue.has(me)||ue.set(me,G(me).then(function(fe){h[me]=fe})),Y>65535&&(se++,K=se)},K=0;K<C.length;K++)Z(K);return Promise.all(ue.values()).then(function(){ue.clear();for(var se=function(me){var fe=C.codePointAt(me),Ae=null,Ce=h[de[me]],Ie=void 0;for(var We in Ce){var ut=ne[We];if(ut===void 0&&(ut=ne[We]=new RegExp(We).test(O||"en")),ut){for(var Ye in Ie=We,Ce[We])if(l(fe,Ce[We][Ye])){Ae=Ye;break}break}}if(!Ae){e:for(var we in Ce)if(we!==Ie){for(var Q in Ce[we])if(l(fe,Ce[we][Q])){Ae=Q;break e}}}Ae||(console.debug("No font coverage for U+"+fe.toString(16)),Ae="latin"),de[me]=Ae,f[Ae]||ue.has(Ae)||ue.set(Ae,G("font-meta/"+Ae+".json").then(function(Ge){f[Ae]=Ge})),fe>65535&&(me++,Y=me)},Y=0;Y<C.length;Y++)se(Y);return Promise.all(ue.values())}).then(function(){for(var se,Y=null,me=0;me<C.length;me++){var fe=C.codePointAt(me);if(Y&&(A(fe)||v(Y).has(fe)))re[me]=re[me-1];else{Y=f[de[me]];var Ae=ae[Y.id];if(!Ae){var Ce=Y.typeforms,Ie=E(Ce,F,"sans-serif"),We=E(Ce[Ie],k,"normal"),ut=S((se=Ce[Ie])===null||se===void 0?void 0:se[We],D);Ae=ae[Y.id]=U+"/font-files/"+Y.id+"/"+Ie+"."+We+"."+ut+".woff"}var Ye=ce.get(Ae);Ye==null&&(Ye=ce.size,ce.set(Ae,Ye)),re[me]=Ye}fe>65535&&(me++,re[me]=re[me-1])}return{fontUrls:Array.from(ce.keys()),chars:re}})},Object.defineProperty(i,"__esModule",{value:!0}),i}({})}function UK(i,e){const n=Object.create(null),r=Object.create(null);function s(l,u){const d=h=>{console.error(`Failure loading font ${l}`,h)};try{const h=new XMLHttpRequest;h.open("get",l,!0),h.responseType="arraybuffer",h.onload=function(){if(h.status>=400)d(new Error(h.statusText));else if(h.status>0)try{const f=i(h.response);f.src=l,u(f)}catch(f){d(f)}},h.onerror=d,h.send()}catch(h){d(h)}}function a(l,u){let d=n[l];d?u(d):r[l]?r[l].push(u):(r[l]=[u],s(l,h=>{h.src=l,n[l]=h,r[l].forEach(f=>f(h)),delete r[l]}))}return function(l,u,{lang:d,fonts:h=[],style:f="normal",weight:p="normal",unicodeFontsURL:m}={}){const v=new Uint8Array(l.length),y=[];l.length||A();const $=new Map,E=[];if(f!=="italic"&&(f="normal"),typeof p!="number"&&(p=p==="bold"?700:400),h&&!Array.isArray(h)&&(h=[h]),h=h.slice().filter(x=>!x.lang||x.lang.test(d)).reverse(),h.length){let F=0;(function k(D=0){for(let U=D,ce=l.length;U<ce;U++){const re=l.codePointAt(U);if(F===1&&y[v[U-1]].supportsCodePoint(re)||/\s/.test(l[U]))v[U]=v[U-1],F===2&&(E[E.length-1][1]=U);else for(let ae=v[U],ne=h.length;ae<=ne;ae++)if(ae===ne){const de=F===2?E[E.length-1]:E[E.length]=[U,U];de[1]=U,F=2}else{v[U]=ae;const{src:de,unicodeRange:ue}=h[ae];if(!ue||C(re,ue)){const Re=n[de];if(!Re){a(de,()=>{k(U)});return}if(Re.supportsCodePoint(re)){let G=$.get(Re);typeof G!="number"&&(G=y.length,y.push(Re),$.set(Re,G)),v[U]=G,F=1;break}}}re>65535&&U+1<ce&&(v[U+1]=v[U],U++,F===2&&(E[E.length-1][1]=U))}S()})()}else E.push([0,l.length-1]),S();function S(){if(E.length){const x=E.map(I=>l.substring(I[0],I[1]+1)).join(`
`);e.getFontsForString(x,{lang:d||void 0,style:f,weight:p,dataUrl:m}).then(({fontUrls:I,chars:O})=>{const F=y.length;let k=0;E.forEach(U=>{for(let ce=0,re=U[1]-U[0];ce<=re;ce++)v[U[0]+ce]=O[k++]+F;k++});let D=0;I.forEach((U,ce)=>{a(U,re=>{y[ce+F]=re,++D===I.length&&A()})})})}else A()}function A(){u({chars:v,fonts:y})}function C(x,I){for(let O=0;O<I.length;O++){const[F,k=F]=I[O];if(F<=x&&x<=k)return!0}return!1}}}const GK=u_({name:"FontResolver",dependencies:[UK,BK,FK],init(i,e,n){return i(e,n())}});function HK(i,e){const r=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,s="[^\\S\\u00A0]",a=new RegExp(`${s}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function l({text:y,lang:$,fonts:E,style:S,weight:A,preResolvedFonts:C,unicodeFontsURL:x},I){const O=({chars:F,fonts:k})=>{let D,U;const ce=[];for(let re=0;re<F.length;re++)F[re]!==U?(U=F[re],ce.push(D={start:re,end:re,fontObj:k[F[re]]})):D.end=re;I(ce)};C?O(C):i(y,O,{lang:$,fonts:E,style:S,weight:A,unicodeFontsURL:x})}function u({text:y="",font:$,lang:E,sdfGlyphSize:S=64,fontSize:A=400,fontWeight:C=1,fontStyle:x="normal",letterSpacing:I=0,lineHeight:O="normal",maxWidth:F=1/0,direction:k,textAlign:D="left",textIndent:U=0,whiteSpace:ce="normal",overflowWrap:re="normal",anchorX:ae=0,anchorY:ne=0,metricsOnly:de=!1,unicodeFontsURL:ue,preResolvedFonts:Re=null,includeCaretPositions:G=!1,chunkedBoundsSize:Z=8192,colorRanges:K=null},se){const Y=p(),me={fontLoad:0,typesetting:0};y.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),y=y.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),A=+A,I=+I,F=+F,O=O||"normal",U=+U,l({text:y,lang:E,style:x,weight:C,fonts:typeof $=="string"?[{src:$}]:$,unicodeFontsURL:ue,preResolvedFonts:Re},fe=>{me.fontLoad=p()-Y;const Ae=isFinite(F);let Ce=null,Ie=null,We=null,ut=null,Ye=null,we=null,Q=null,Ge=null,Oe=0,Ve=0,Fe=ce!=="nowrap";const tt=new Map,Ue=p();let Je=U,ve=0,Me=new m;const vt=[Me];fe.forEach(je=>{const{fontObj:Qe}=je,{ascender:ht,descender:ft,unitsPerEm:He,lineGap:St,capHeight:L,xHeight:X}=Qe;let he=tt.get(Qe);if(!he){const Le=A/He,Be=O==="normal"?(ht-ft+St)*Le:O*A,N=(Be-(ht-ft)*Le)/2,j=Math.min(Be,(ht-ft)*Le),ge=(ht+ft)/2*Le+j/2;he={index:tt.size,src:Qe.src,fontObj:Qe,fontSizeMult:Le,unitsPerEm:He,ascender:ht*Le,descender:ft*Le,capHeight:L*Le,xHeight:X*Le,lineHeight:Be,baseline:-N-ht*Le,caretTop:ge,caretBottom:ge-j},tt.set(Qe,he)}const{fontSizeMult:z}=he,be=y.slice(je.start,je.end+1);let nt,Ee;Qe.forEachGlyph(be,A,I,(Le,Be,N,j)=>{Be+=ve,j+=je.start,nt=Be,Ee=Le;const ge=y.charAt(j),xe=Le.advanceWidth*z,Ke=Me.count;let gt;if("isEmpty"in Le||(Le.isWhitespace=!!ge&&new RegExp(s).test(ge),Le.canBreakAfter=!!ge&&a.test(ge),Le.isEmpty=Le.xMin===Le.xMax||Le.yMin===Le.yMax||r.test(ge)),!Le.isWhitespace&&!Le.isEmpty&&Ve++,Fe&&Ae&&!Le.isWhitespace&&Be+xe+Je>F&&Ke){if(Me.glyphAt(Ke-1).glyphObj.canBreakAfter)gt=new m,Je=-Be;else for(let un=Ke;un--;)if(un===0&&re==="break-word"){gt=new m,Je=-Be;break}else if(Me.glyphAt(un).glyphObj.canBreakAfter){gt=Me.splitAt(un+1);const an=gt.glyphAt(0).x;Je-=an;for(let ei=gt.count;ei--;)gt.glyphAt(ei).x-=an;break}gt&&(Me.isSoftWrapped=!0,Me=gt,vt.push(Me),Oe=F)}let $t=Me.glyphAt(Me.count);$t.glyphObj=Le,$t.x=Be+Je,$t.y=N,$t.width=xe,$t.charIndex=j,$t.fontData=he,ge===`
`&&(Me=new m,vt.push(Me),Je=-(Be+xe+I*A)+U)}),ve=nt+Ee.advanceWidth*z+I*A});let oe=0;vt.forEach(je=>{let Qe=!0;for(let ht=je.count;ht--;){const ft=je.glyphAt(ht);Qe&&!ft.glyphObj.isWhitespace&&(je.width=ft.x+ft.width,je.width>Oe&&(Oe=je.width),Qe=!1);let{lineHeight:He,capHeight:St,xHeight:L,baseline:X}=ft.fontData;He>je.lineHeight&&(je.lineHeight=He);const he=X-je.baseline;he<0&&(je.baseline+=he,je.cap+=he,je.ex+=he),je.cap=Math.max(je.cap,je.baseline+St),je.ex=Math.max(je.ex,je.baseline+L)}je.baseline-=oe,je.cap-=oe,je.ex-=oe,oe+=je.lineHeight});let ee=0,W=0;if(ae&&(typeof ae=="number"?ee=-ae:typeof ae=="string"&&(ee=-Oe*(ae==="left"?0:ae==="center"?.5:ae==="right"?1:h(ae)))),ne&&(typeof ne=="number"?W=-ne:typeof ne=="string"&&(W=ne==="top"?0:ne==="top-baseline"?-vt[0].baseline:ne==="top-cap"?-vt[0].cap:ne==="top-ex"?-vt[0].ex:ne==="middle"?oe/2:ne==="bottom"?oe:ne==="bottom-baseline"?-vt[vt.length-1].baseline:h(ne)*oe)),!de){const je=e.getEmbeddingLevels(y,k);Ce=new Uint16Array(Ve),Ie=new Uint8Array(Ve),We=new Float32Array(Ve*2),ut={},Q=[1/0,1/0,-1/0,-1/0],Ge=[],G&&(we=new Float32Array(y.length*4)),K&&(Ye=new Uint8Array(Ve*3));let Qe=0,ht=-1,ft=-1,He,St;if(vt.forEach((L,X)=>{let{count:he,width:z}=L;if(he>0){let be=0;for(let j=he;j--&&L.glyphAt(j).glyphObj.isWhitespace;)be++;let nt=0,Ee=0;if(D==="center")nt=(Oe-z)/2;else if(D==="right")nt=Oe-z;else if(D==="justify"&&L.isSoftWrapped){let j=0;for(let ge=he-be;ge--;)L.glyphAt(ge).glyphObj.isWhitespace&&j++;Ee=(Oe-z)/j}if(Ee||nt){let j=0;for(let ge=0;ge<he;ge++){let xe=L.glyphAt(ge);const Ke=xe.glyphObj;xe.x+=nt+j,Ee!==0&&Ke.isWhitespace&&ge<he-be&&(j+=Ee,xe.width+=Ee)}}const Le=e.getReorderSegments(y,je,L.glyphAt(0).charIndex,L.glyphAt(L.count-1).charIndex);for(let j=0;j<Le.length;j++){const[ge,xe]=Le[j];let Ke=1/0,gt=-1/0;for(let $t=0;$t<he;$t++)if(L.glyphAt($t).charIndex>=ge){let un=$t,an=$t;for(;an<he;an++){let ei=L.glyphAt(an);if(ei.charIndex>xe)break;an<he-be&&(Ke=Math.min(Ke,ei.x),gt=Math.max(gt,ei.x+ei.width))}for(let ei=un;ei<an;ei++){const fi=L.glyphAt(ei);fi.x=gt-(fi.x+fi.width-Ke)}break}}let Be;const N=j=>Be=j;for(let j=0;j<he;j++){const ge=L.glyphAt(j);Be=ge.glyphObj;const xe=Be.index,Ke=je.levels[ge.charIndex]&1;if(Ke){const gt=e.getMirroredCharacter(y[ge.charIndex]);gt&&ge.fontData.fontObj.forEachGlyph(gt,0,0,N)}if(G){const{charIndex:gt,fontData:$t}=ge,un=ge.x+ee,an=ge.x+ge.width+ee;we[gt*4]=Ke?an:un,we[gt*4+1]=Ke?un:an,we[gt*4+2]=L.baseline+$t.caretBottom+W,we[gt*4+3]=L.baseline+$t.caretTop+W;const ei=gt-ht;ei>1&&f(we,ht,ei),ht=gt}if(K){const{charIndex:gt}=ge;for(;gt>ft;)ft++,K.hasOwnProperty(ft)&&(St=K[ft])}if(!Be.isWhitespace&&!Be.isEmpty){const gt=Qe++,{fontSizeMult:$t,src:un,index:an}=ge.fontData,ei=ut[un]||(ut[un]={});ei[xe]||(ei[xe]={path:Be.path,pathBounds:[Be.xMin,Be.yMin,Be.xMax,Be.yMax]});const fi=ge.x+ee,Ki=ge.y+L.baseline+W;We[gt*2]=fi,We[gt*2+1]=Ki;const Ci=fi+Be.xMin*$t,_i=Ki+Be.yMin*$t,Ti=fi+Be.xMax*$t,nn=Ki+Be.yMax*$t;Ci<Q[0]&&(Q[0]=Ci),_i<Q[1]&&(Q[1]=_i),Ti>Q[2]&&(Q[2]=Ti),nn>Q[3]&&(Q[3]=nn),gt%Z===0&&(He={start:gt,end:gt,rect:[1/0,1/0,-1/0,-1/0]},Ge.push(He)),He.end++;const pi=He.rect;if(Ci<pi[0]&&(pi[0]=Ci),_i<pi[1]&&(pi[1]=_i),Ti>pi[2]&&(pi[2]=Ti),nn>pi[3]&&(pi[3]=nn),Ce[gt]=xe,Ie[gt]=an,K){const yr=gt*3;Ye[yr]=St>>16&255,Ye[yr+1]=St>>8&255,Ye[yr+2]=St&255}}}}}),we){const L=y.length-ht;L>1&&f(we,ht,L)}}const ot=[];tt.forEach(({index:je,src:Qe,unitsPerEm:ht,ascender:ft,descender:He,lineHeight:St,capHeight:L,xHeight:X})=>{ot[je]={src:Qe,unitsPerEm:ht,ascender:ft,descender:He,lineHeight:St,capHeight:L,xHeight:X}}),me.typesetting=p()-Ue,se({glyphIds:Ce,glyphFontIndices:Ie,glyphPositions:We,glyphData:ut,fontData:ot,caretPositions:we,glyphColors:Ye,chunkedBounds:Ge,fontSize:A,topBaseline:W+vt[0].baseline,blockBounds:[ee,W-oe,ee+Oe,W],visibleBounds:Q,timings:me})})}function d(y,$){u({...y,metricsOnly:!0},E=>{const[S,A,C,x]=E.blockBounds;$({width:C-S,height:x-A})})}function h(y){let $=y.match(/^([\d.]+)%$/),E=$?parseFloat($[1]):NaN;return isNaN(E)?0:E/100}function f(y,$,E){const S=y[$*4],A=y[$*4+1],C=y[$*4+2],x=y[$*4+3],I=(A-S)/E;for(let O=0;O<E;O++){const F=($+O)*4;y[F]=S+I*O,y[F+1]=S+I*(O+1),y[F+2]=C,y[F+3]=x}}function p(){return(self.performance||Date).now()}function m(){this.data=[]}const v=["glyphObj","x","y","width","charIndex","fontData"];return m.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/v.length)},glyphAt(y){let $=m.flyweight;return $.data=this.data,$.index=y,$},splitAt(y){let $=new m;return $.data=this.data.splice(y*v.length),$}},m.flyweight=v.reduce((y,$,E,S)=>(Object.defineProperty(y,$,{get(){return this.data[this.index*v.length+E]},set(A){this.data[this.index*v.length+E]=A}}),y),{data:null,index:0}),{typeset:u,measure:d}}const fp=()=>(self.performance||Date).now(),K$=o2();let Uk;function VK(i,e,n,r,s,a,l,u,d,h,f=!0){return f?WK(i,e,n,r,s,a,l,u,d,h).then(null,p=>(Uk||(console.warn("WebGL SDF generation failed, falling back to JS",p),Uk=!0),Hk(i,e,n,r,s,a,l,u,d,h))):Hk(i,e,n,r,s,a,l,u,d,h)}const vS=[],zK=5;let tw=0;function l2(){const i=fp();for(;vS.length&&fp()-i<zK;)vS.shift()();tw=vS.length?setTimeout(l2,0):0}const WK=(...i)=>new Promise((e,n)=>{vS.push(()=>{const r=fp();try{K$.webgl.generateIntoCanvas(...i),e({timing:fp()-r})}catch(s){n(s)}}),tw||(tw=setTimeout(l2,0))}),XK=4,jK=2e3,Gk={};let YK=0;function Hk(i,e,n,r,s,a,l,u,d,h){const f="TroikaTextSDFGenerator_JS_"+YK++%XK;let p=Gk[f];return p||(p=Gk[f]={workerModule:u_({name:f,workerId:f,dependencies:[o2,fp],init(m,v){const y=m().javascript.generate;return function(...$){const E=v();return{textureData:y(...$),timing:v()-E}}},getTransferables(m){return[m.textureData.buffer]}}),requests:0,idleTimer:null}),p.requests++,clearTimeout(p.idleTimer),p.workerModule(i,e,n,r,s,a).then(({textureData:m,timing:v})=>{const y=fp(),$=new Uint8Array(m.length*4);for(let E=0;E<m.length;E++)$[E*4+h]=m[E];return K$.webglUtils.renderImageData(l,$,u,d,i,e,1<<3-h),v+=fp()-y,--p.requests===0&&(p.idleTimer=setTimeout(()=>{AK(f)},jK)),{timing:v}})}function KK(i){i._warm||(K$.webgl.isSupported(i),i._warm=!0)}const JK=K$.webglUtils.resizeWebGLCanvasWithoutClearing,lg={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ZK=new xt;function sg(){return(self.performance||Date).now()}const Vk=Object.create(null);function c2(i,e){i=e7({},i);const n=sg(),{defaultFontURL:r}=lg,s=[];if(r&&s.push({label:"default",src:zk(r)}),i.font&&s.push({label:"user",src:zk(i.font)}),i.font=s,i.text=""+i.text,i.sdfGlyphSize=i.sdfGlyphSize||lg.sdfGlyphSize,i.unicodeFontsURL=i.unicodeFontsURL||lg.unicodeFontsURL,i.colorRanges!=null){let m={};for(let v in i.colorRanges)if(i.colorRanges.hasOwnProperty(v)){let y=i.colorRanges[v];typeof y!="number"&&(y=ZK.set(y).getHex()),m[v]=y}i.colorRanges=m}Object.freeze(i);const{textureWidth:a,sdfExponent:l}=lg,{sdfGlyphSize:u}=i,d=a/u*4;let h=Vk[u];if(!h){const m=document.createElement("canvas");m.width=a,m.height=u*256/d,h=Vk[u]={glyphCount:0,sdfGlyphSize:u,sdfCanvas:m,sdfTexture:new ni(m,void 0,void 0,void 0,Dn,Dn),contextLost:!1,glyphsByFont:new Map},h.sdfTexture.generateMipmaps=!1,qK(h)}const{sdfTexture:f,sdfCanvas:p}=h;n7(i).then(m=>{const{glyphIds:v,glyphFontIndices:y,fontData:$,glyphPositions:E,fontSize:S,timings:A}=m,C=[],x=new Float32Array(v.length*4);let I=0,O=0;const F=sg(),k=$.map(ae=>{let ne=h.glyphsByFont.get(ae.src);return ne||h.glyphsByFont.set(ae.src,ne=new Map),ne});v.forEach((ae,ne)=>{const de=y[ne],{src:ue,unitsPerEm:Re}=$[de];let G=k[de].get(ae);if(!G){const{path:me,pathBounds:fe}=m.glyphData[ue][ae],Ae=Math.max(fe[2]-fe[0],fe[3]-fe[1])/u*(lg.sdfMargin*u+.5),Ce=h.glyphCount++,Ie=[fe[0]-Ae,fe[1]-Ae,fe[2]+Ae,fe[3]+Ae];k[de].set(ae,G={path:me,atlasIndex:Ce,sdfViewBox:Ie}),C.push(G)}const{sdfViewBox:Z}=G,K=E[O++],se=E[O++],Y=S/Re;x[I++]=K+Z[0]*Y,x[I++]=se+Z[1]*Y,x[I++]=K+Z[2]*Y,x[I++]=se+Z[3]*Y,v[ne]=G.atlasIndex}),A.quads=(A.quads||0)+(sg()-F);const D=sg();A.sdf={};const U=p.height,ce=Math.ceil(h.glyphCount/d),re=Math.pow(2,Math.ceil(Math.log2(ce*u)));re>U&&(console.info(`Increasing SDF texture size ${U}->${re}`),JK(p,a,re),f.dispose()),Promise.all(C.map(ae=>u2(ae,h,i.gpuAccelerateSDF).then(({timing:ne})=>{A.sdf[ae.atlasIndex]=ne}))).then(()=>{C.length&&!h.contextLost&&(h2(h),f.needsUpdate=!0),A.sdfTotal=sg()-D,A.total=sg()-n,e(Object.freeze({parameters:i,sdfTexture:f,sdfGlyphSize:u,sdfExponent:l,glyphBounds:x,glyphAtlasIndices:v,glyphColors:m.glyphColors,caretPositions:m.caretPositions,chunkedBounds:m.chunkedBounds,ascender:m.ascender,descender:m.descender,lineHeight:m.lineHeight,capHeight:m.capHeight,xHeight:m.xHeight,topBaseline:m.topBaseline,blockBounds:m.blockBounds,visibleBounds:m.visibleBounds,timings:m.timings}))})}),Promise.resolve().then(()=>{h.contextLost||KK(p)})}function u2({path:i,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:r,sdfCanvas:s,contextLost:a},l){if(a)return Promise.resolve({timing:-1});const{textureWidth:u,sdfExponent:d}=lg,h=Math.max(n[2]-n[0],n[3]-n[1]),f=Math.floor(e/4),p=f%(u/r)*r,m=Math.floor(f/(u/r))*r,v=e%4;return VK(r,r,i,n,h,d,s,p,m,v,l)}function qK(i){const e=i.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),i.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),i.contextLost=!1;const r=[];i.glyphsByFont.forEach(s=>{s.forEach(a=>{r.push(u2(a,i,!0))})}),Promise.all(r).then(()=>{h2(i),i.sdfTexture.needsUpdate=!0})})}function QK({font:i,characters:e,sdfGlyphSize:n},r){let s=Array.isArray(e)?e.join(`
`):""+e;c2({font:i,sdfGlyphSize:n,text:s},r)}function e7(i,e){for(let n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i}let z0;function zk(i){return z0||(z0=typeof document>"u"?{}:document.createElement("a")),z0.href=i,z0.href}function h2(i){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=i,{width:r,height:s}=e,a=i.sdfCanvas.getContext("webgl");let l=n.image.data;(!l||l.length!==r*s*4)&&(l=new Uint8Array(r*s*4),n.image={width:r,height:s,data:l},n.flipY=!1,n.isDataTexture=!0),a.readPixels(0,0,r,s,a.RGBA,a.UNSIGNED_BYTE,l)}}const t7=u_({name:"Typesetter",dependencies:[HK,GK,RK],init(i,e,n){return i(e,n())}}),n7=u_({name:"Typesetter",dependencies:[t7],init(i){return function(e){return new Promise(n=>{i.typeset(e,n)})}},getTransferables(i){const e=[];for(let n in i)i[n]&&i[n].buffer&&e.push(i[n].buffer);return e}}),Wk={};function i7(i){let e=Wk[i];if(!e){const n=new ja(1,1,i,i),r=n.clone(),s=n.attributes,a=r.attributes,l=new on,u=s.uv.count;for(let d=0;d<u;d++)a.position.array[d*3]*=-1,a.normal.array[d*3+2]*=-1;["position","normal","uv"].forEach(d=>{l.setAttribute(d,new Yt([...s[d].array,...a[d].array],s[d].itemSize))}),l.setIndex([...n.index.array,...r.index.array.map(d=>d+u)]),l.translate(.5,.5,0),e=Wk[i]=l}return e}const r7="aTroikaGlyphBounds",Xk="aTroikaGlyphIndex",s7="aTroikaGlyphColor";class o7 extends Y${constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Ws,this.boundingBox=new zs}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const n=this.getIndex().count;this.setDrawRange(e===Hs?n/2:0,e===$s?n:n/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=i7(e);["position","normal","uv"].forEach(r=>{this.attributes[r]=n.attributes[r].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,r,s,a){tR(this,r7,e,4),tR(this,Xk,n,1),tR(this,s7,a,3),this._blockBounds=r,this._chunkedBounds=s,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:r}=this;if(n){const{PI:s,floor:a,min:l,max:u,sin:d,cos:h}=Math,f=s/2,p=s*2,m=Math.abs(n),v=e[0]/m,y=e[2]/m,$=a((v+f)/p)!==a((y+f)/p)?-m:l(d(v)*m,d(y)*m),E=a((v-f)/p)!==a((y-f)/p)?m:u(d(v)*m,d(y)*m),S=a((v+s)/p)!==a((y+s)/p)?m*2:u(m-h(v)*m,m-h(y)*m);r.min.set($,e[1],n<0?-S:0),r.max.set(E,e[3],n<0?0:S)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(Xk).count,r=this._chunkedBounds;if(r)for(let s=r.length;s--;){n=r[s].end;let a=r[s].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}this.instanceCount=n}}function tR(i,e,n,r){const s=i.getAttribute(e);n?s&&s.array.length===n.length?(s.array.set(n),s.needsUpdate=!0):(i.setAttribute(e,new hd(n,r)),delete i._maxInstanceCount,i.dispose()):s&&i.deleteAttribute(e)}const a7=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,l7=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,c7=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,u7=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function h7(i){const e=ew(i,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new mt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Hn(0,0,0,0)},uTroikaClipRect:{value:new Hn(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new mt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new xt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Nn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:a7,vertexTransform:l7,fragmentDefs:c7,fragmentColorTransform:u7,customRewriter({vertexShader:n,fragmentShader:r}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(r)&&(r=r.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(n)||(n=n.replace(a2,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:r}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const tI=new oi({color:16777215,side:$s,transparent:!0}),jk=8421504,Yk=new pn,W0=new ie,nR=new ie,ZT=[],d7=new ie,iR="+x+y";function Kk(i){return Array.isArray(i)?i[0]:i}let d2=()=>{const i=new Bn(new ja(1,1),tI);return d2=()=>i,i},f2=()=>{const i=new Bn(new ja(1,1,32,1),tI);return f2=()=>i,i};const f7={type:"syncstart"},p7={type:"synccomplete"},p2=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],m7=p2.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let m2=class extends Bn{constructor(){const e=new o7;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=jk,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=iR,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(f7),c2({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{r.forEach(s=>s&&s())})),this.dispatchEvent(p7),e&&e()})))}onBeforeRender(e,n,r,s,a,l){this.sync(),a.isTroikaTextMaterial&&this._prepareForRender(a),a._hadOwnSide=a.hasOwnProperty("side"),this.geometry.setSide(a._actualSide=a.side),a.side=za}onAfterRender(e,n,r,s,a,l){a._hadOwnSide?a.side=a._actualSide:delete a.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=tI.clone());if((!e||e.baseMaterial!==n)&&(e=this._derivedMaterial=h7(n),n.addEventListener("dispose",function r(){n.removeEventListener("dispose",r),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let r=e._outlineMtl;return r||(r=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),r.isTextOutlineMaterial=!0,r.depthWrite=!1,r.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),r.dispose()})),[r,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Kk(this.material).getDepthMaterial()}get customDistanceMaterial(){return Kk(this.material).getDistanceMaterial()}_prepareForRender(e){const n=e.isTextOutlineMaterial,r=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:u,blockBounds:d}=s;r.uTroikaSDFTexture.value=u,r.uTroikaSDFTextureSize.value.set(u.image.width,u.image.height),r.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,r.uTroikaSDFExponent.value=s.sdfExponent,r.uTroikaTotalBounds.value.fromArray(d),r.uTroikaUseGlyphColors.value=!n&&!!s.glyphColors;let h=0,f=0,p=0,m,v,y,$=0,E=0;if(n){let{outlineWidth:A,outlineOffsetX:C,outlineOffsetY:x,outlineBlur:I,outlineOpacity:O}=this;h=this._parsePercent(A)||0,f=Math.max(0,this._parsePercent(I)||0),m=O,$=this._parsePercent(C)||0,E=this._parsePercent(x)||0}else p=Math.max(0,this._parsePercent(this.strokeWidth)||0),p&&(y=this.strokeColor,r.uTroikaStrokeColor.value.set(y??jk),v=this.strokeOpacity,v==null&&(v=1)),m=this.fillOpacity;r.uTroikaDistanceOffset.value=h,r.uTroikaPositionOffset.value.set($,E),r.uTroikaBlurRadius.value=f,r.uTroikaStrokeWidth.value=p,r.uTroikaStrokeOpacity.value=v,r.uTroikaFillOpacity.value=m??1,r.uTroikaCurveRadius.value=this.curveRadius||0;let S=this.clipRect;if(S&&Array.isArray(S)&&S.length===4)r.uTroikaClipRect.value.fromArray(S);else{const A=(this.fontSize||.1)*100;r.uTroikaClipRect.value.set(d[0]-A,d[1]-A,d[2]+A,d[3]+A)}this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const a=n?this.outlineColor||0:this.color;if(a==null)delete e.color;else{const u=e.hasOwnProperty("color")?e.color:e.color=new xt;(a!==u._input||typeof a=="object")&&u.set(u._input=a)}let l=this.orientation||iR;if(l!==e._orientation){let u=r.uTroikaOrient.value;l=l.replace(/[^-+xyz]/g,"");let d=l!==iR&&l.match(/^([-+])([xyz])([-+])([xyz])$/);if(d){let[,h,f,p,m]=d;W0.set(0,0,0)[f]=h==="-"?1:-1,nR.set(0,0,0)[m]=p==="-"?-1:1,Yk.lookAt(d7,W0.cross(nR),nR),u.setFromMatrix4(Yk)}else u.identity();e._orientation=l}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),r=n?parseFloat(n[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new mt){n.copy(e);const r=this.curveRadius;return r&&(n.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),n}worldPositionToTextCoords(e,n=new mt){return W0.copy(e),this.localPositionToTextCoords(this.worldToLocal(W0),n)}raycast(e,n){const{textRenderInfo:r,curveRadius:s}=this;if(r){const a=r.blockBounds,l=s?f2():d2(),u=l.geometry,{position:d,uv:h}=u.attributes;for(let f=0;f<h.count;f++){let p=a[0]+h.getX(f)*(a[2]-a[0]);const m=a[1]+h.getY(f)*(a[3]-a[1]);let v=0;s&&(v=s-Math.cos(p/s)*s,p=Math.sin(p/s)*s),d.setXYZ(f,p,m,v)}u.boundingSphere=this.geometry.boundingSphere,u.boundingBox=this.geometry.boundingBox,l.matrixWorld=this.matrixWorld,l.material.side=this.material.side,ZT.length=0,l.raycast(e,ZT);for(let f=0;f<ZT.length;f++)ZT[f].object=this,n.push(ZT[f])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,m7.forEach(r=>{this[r]=e[r]}),this}clone(){return new this.constructor().copy(this)}};p2.forEach(i=>{const e="_private_"+i;Object.defineProperty(m2.prototype,i,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});const g7=i=>typeof i=="object"&&typeof i.then=="function",X0=[];function _7(i,e,n=(r,s)=>r===s){if(i===e)return!0;if(!i||!e)return!1;const r=i.length;if(e.length!==r)return!1;for(let s=0;s<r;s++)if(!n(i[s],e[s]))return!1;return!0}function T7(i,e=null,n=!1,r={}){e===null&&(e=[i]);for(const a of X0)if(_7(e,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return r.lifespan&&r.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,r.lifespan)),a.response;if(!n)throw a.promise}const s={keys:e,equal:r.equal,remove:()=>{const a=X0.indexOf(s);a!==-1&&X0.splice(a,1)},promise:(g7(i)?i:i(...e)).then(a=>{s.response=a,r.lifespan&&r.lifespan>0&&(s.timeout=setTimeout(s.remove,r.lifespan))}).catch(a=>s.error=a)};if(X0.push(s),!n)throw s.promise}const v7=(i,e,n)=>T7(i,e,!1,n),Fi=q.forwardRef(({sdfGlyphSize:i=64,anchorX:e="center",anchorY:n="middle",font:r,fontSize:s=1,children:a,characters:l,onSync:u,...d},h)=>{const f=Mn(({invalidate:y})=>y),[p]=q.useState(()=>new m2),[m,v]=q.useMemo(()=>{const y=[];let $="";return q.Children.forEach(a,E=>{typeof E=="string"||typeof E=="number"?$+=E:y.push(E)}),[y,$]},[a]);return v7(()=>new Promise(y=>QK({font:r,characters:l},y)),["troika-text",r,l]),q.useLayoutEffect(()=>void p.sync(()=>{f(),u&&u(p)})),q.useEffect(()=>()=>p.dispose(),[p]),q.createElement("primitive",Xa({object:p,ref:h,font:r,text:v,anchorX:e,anchorY:n,fontSize:s,sdfGlyphSize:i},d),m)});let j0=null,g2="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function _2(i=!0,e=!0,n){return r=>{n&&n(r),i&&(j0||(j0=new gK),j0.setDecoderPath(typeof i=="string"?i:g2),r.setDRACOLoader(j0)),e&&r.setMeshoptDecoder(typeof QC=="function"?QC():QC)}}const es=(i,e,n,r)=>ku(ZM,i,_2(e,n,r));es.preload=(i,e,n,r)=>ku.preload(ZM,i,_2(e,n,r));es.clear=i=>ku.clear(ZM,i);es.setDecoderPath=i=>{g2=i};function E7(i,e,n){const r=Mn(m=>m.size),s=Mn(m=>m.viewport),a=typeof i=="number"?i:r.width*s.dpr,l=typeof e=="number"?e:r.height*s.dpr,u=(typeof i=="number"?n:i)||{},{samples:d=0,depth:h,...f}=u,p=q.useMemo(()=>{const m=new lo(a,l,{minFilter:Dn,magFilter:Dn,type:Jr,...f});return h&&(m.depthTexture=new $M(a,l,Lr)),m.samples=d,m},[]);return q.useLayoutEffect(()=>{p.setSize(a,l),d&&(p.samples=d)},[d,p,a,l]),q.useEffect(()=>()=>p.dispose(),[]),p}const y7=i=>typeof i=="function",S7=q.forwardRef(({envMap:i,resolution:e=256,frames:n=1/0,makeDefault:r,children:s,...a},l)=>{const u=Mn(({set:E})=>E),d=Mn(({camera:E})=>E),h=Mn(({size:E})=>E),f=q.useRef(null);q.useImperativeHandle(l,()=>f.current,[]);const p=q.useRef(null),m=E7(e);q.useLayoutEffect(()=>{a.manual||(f.current.aspect=h.width/h.height)},[h,a]),q.useLayoutEffect(()=>{f.current.updateProjectionMatrix()});let v=0,y=null;const $=y7(s);return c_(E=>{$&&(n===1/0||v<n)&&(p.current.visible=!1,E.gl.setRenderTarget(m),y=E.scene.background,i&&(E.scene.background=i),E.gl.render(E.scene,f.current),E.scene.background=y,E.gl.setRenderTarget(null),p.current.visible=!0,v++)}),q.useLayoutEffect(()=>{if(r){const E=d;return u(()=>({camera:f.current})),()=>u(()=>({camera:E}))}},[f,r,u]),q.createElement(q.Fragment,null,q.createElement("perspectiveCamera",Xa({ref:f},a),!$&&s),q.createElement("group",{ref:p},$&&s(m.texture)))}),Ja=q.forwardRef(({makeDefault:i,camera:e,regress:n,domElement:r,enableDamping:s=!0,keyEvents:a=!1,onChange:l,onStart:u,onEnd:d,...h},f)=>{const p=Mn(O=>O.invalidate),m=Mn(O=>O.camera),v=Mn(O=>O.gl),y=Mn(O=>O.events),$=Mn(O=>O.setEvents),E=Mn(O=>O.set),S=Mn(O=>O.get),A=Mn(O=>O.performance),C=e||m,x=r||y.connected||v.domElement,I=q.useMemo(()=>new OY(C),[C]);return c_(()=>{I.enabled&&I.update()},-1),q.useEffect(()=>(a&&I.connect(a===!0?x:a),I.connect(x),()=>void I.dispose()),[a,x,n,I,p]),q.useEffect(()=>{const O=D=>{p(),n&&A.regress(),l&&l(D)},F=D=>{u&&u(D)},k=D=>{d&&d(D)};return I.addEventListener("change",O),I.addEventListener("start",F),I.addEventListener("end",k),()=>{I.removeEventListener("start",F),I.removeEventListener("end",k),I.removeEventListener("change",O)}},[l,u,d,I,p,$]),q.useEffect(()=>{if(i){const O=S().controls;return E({controls:I}),()=>E({controls:O})}},[i,I]),q.createElement("primitive",Xa({ref:f,object:I,enableDamping:s},h))}),$7=3e3,b7=3001,T2=(i,e,n)=>{let r;switch(i){case ia:r=new Uint8ClampedArray(e*n*4);break;case Jr:r=new Uint16Array(e*n*4);break;case Sc:r=new Uint32Array(e*n*4);break;case rM:r=new Int8Array(e*n*4);break;case sM:r=new Int16Array(e*n*4);break;case b$:r=new Int32Array(e*n*4);break;case Lr:r=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return r};let Y0;const A7=(i,e,n,r)=>{if(Y0!==void 0)return Y0;const s=new lo(1,1,r);e.setRenderTarget(s);const a=new Bn(new ja,new oi({color:16777215}));e.render(a,n),e.setRenderTarget(null);const l=T2(i,s.width,s.height);return e.readRenderTargetPixels(s,0,0,s.width,s.height,l),s.dispose(),a.geometry.dispose(),a.material.dispose(),Y0=l[0]!==0,Y0};class nI{constructor(e){var n,r,s,a,l,u,d,h,f,p,m,v,y,$,E,S;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(C){throw this._renderer.setRenderTarget(null),C}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const A={format:Yr,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(r=e.renderTargetOptions)===null||r===void 0?void 0:r.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps)!==void 0?(a=e.renderTargetOptions)===null||a===void 0?void 0:a.generateMipmaps:!1,magFilter:((l=e.renderTargetOptions)===null||l===void 0?void 0:l.magFilter)!==void 0?(u=e.renderTargetOptions)===null||u===void 0?void 0:u.magFilter:Dn,minFilter:((d=e.renderTargetOptions)===null||d===void 0?void 0:d.minFilter)!==void 0?(h=e.renderTargetOptions)===null||h===void 0?void 0:h.minFilter:Dn,samples:((f=e.renderTargetOptions)===null||f===void 0?void 0:f.samples)!==void 0?(p=e.renderTargetOptions)===null||p===void 0?void 0:p.samples:void 0,wrapS:((m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapS)!==void 0?(v=e.renderTargetOptions)===null||v===void 0?void 0:v.wrapS:Pi,wrapT:((y=e.renderTargetOptions)===null||y===void 0?void 0:y.wrapT)!==void 0?($=e.renderTargetOptions)===null||$===void 0?void 0:$.wrapT:Pi};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=nI.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Yg,this._camera=new sa,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!A7(this._type,this._renderer,this._camera,A)){let C;switch(this._type){case Jr:C=this._renderer.extensions.has("EXT_color_buffer_float")?Lr:void 0;break}C!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Lr}`),this._type=C):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Bn(new ja,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new lo(this.width,this.height,A),this._renderTarget.texture.mapping=((E=e.renderTargetOptions)===null||E===void 0?void 0:E.mapping)!==void 0?(S=e.renderTargetOptions)===null||S===void 0?void 0:S.mapping:cd}static instantiateRenderer(){const e=new O$;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=T2(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new up(this.toArray(),this.width,this.height,Yr,this._type,(e==null?void 0:e.mapping)||cd,(e==null?void 0:e.wrapS)||Pi,(e==null?void 0:e.wrapT)||Pi,(e==null?void 0:e.magFilter)||Dn,(e==null?void 0:e.minFilter)||Dn,(e==null?void 0:e.anisotropy)||1,xo);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof wo&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof ni&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof ni&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const C7=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,R7=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class x7 extends wo{constructor({gamma:e,offsetHdr:n,offsetSdr:r,gainMapMin:s,gainMapMax:a,maxDisplayBoost:l,hdrCapacityMin:u,hdrCapacityMax:d,sdr:h,gainMap:f}){super({name:"GainMapDecoderMaterial",vertexShader:C7,fragmentShader:R7,uniforms:{sdr:{value:h},gainMap:{value:f},gamma:{value:new ie(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ie().fromArray(n)},offsetSdr:{value:new ie().fromArray(r)},gainMapMin:{value:new ie().fromArray(s)},gainMapMax:{value:new ie().fromArray(a)},weightFactor:{value:(Math.log2(l)-u)/(d-u)}},blending:Cc,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=l,this._hdrCapacityMin=u,this._hdrCapacityMax=d,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class v2 extends Error{}class E2 extends Error{}const qT=(i,e,n)=>{var r;let s;const a=(r=i.attributes.getNamedItem(e))===null||r===void 0?void 0:r.nodeValue;if(a)s=a;else{const l=i.getElementsByTagName(e)[0];if(l){const u=l.getElementsByTagName("rdf:li");if(u.length===3)s=Array.from(u).map(d=>d.innerHTML);else throw new Error(`Gainmap metadata contains an array of items for ${e} but its length is not 3`)}else{if(n)return n;throw new Error(`Can't find ${e} in gainmap metadata`)}}return s},w7=i=>{var e,n;let r;typeof TextDecoder<"u"?r=new TextDecoder().decode(i):r=i.toString();let s=r.indexOf("<x:xmpmeta");const a=new DOMParser;for(;s!==-1;){const l=r.indexOf("x:xmpmeta>",s);r.slice(s,l+10);const u=r.slice(s,l+10);try{const h=a.parseFromString(u,"text/xml").getElementsByTagName("rdf:Description")[0],f=qT(h,"hdrgm:GainMapMin","0"),p=qT(h,"hdrgm:GainMapMax"),m=qT(h,"hdrgm:Gamma","1"),v=qT(h,"hdrgm:OffsetSDR","0.015625"),y=qT(h,"hdrgm:OffsetHDR","0.015625");let $=(e=h.attributes.getNamedItem("hdrgm:HDRCapacityMin"))===null||e===void 0?void 0:e.nodeValue;$||($="0");const E=(n=h.attributes.getNamedItem("hdrgm:HDRCapacityMax"))===null||n===void 0?void 0:n.nodeValue;if(!E)throw new Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(f)?f.map(S=>parseFloat(S)):[parseFloat(f),parseFloat(f),parseFloat(f)],gainMapMax:Array.isArray(p)?p.map(S=>parseFloat(S)):[parseFloat(p),parseFloat(p),parseFloat(p)],gamma:Array.isArray(m)?m.map(S=>parseFloat(S)):[parseFloat(m),parseFloat(m),parseFloat(m)],offsetSdr:Array.isArray(v)?v.map(S=>parseFloat(S)):[parseFloat(v),parseFloat(v),parseFloat(v)],offsetHdr:Array.isArray(y)?y.map(S=>parseFloat(S)):[parseFloat(y),parseFloat(y),parseFloat(y)],hdrCapacityMin:parseFloat($),hdrCapacityMax:parseFloat(E)}}catch{}s=r.indexOf("<x:xmpmeta",l)}};class M7{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,r)=>{const s=this.options.debug,a=new DataView(e.buffer);if(a.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const l=a.byteLength;let u=2,d=0,h;for(;u<l;){if(++d>250){r(new Error(`Found no marker after ${d} loops `));return}if(a.getUint8(u)!==255){r(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${a.getUint8(u).toString(16)}`));return}if(h=a.getUint8(u+1),s&&console.log(`Marker: ${h.toString(16)}`),h===226){s&&console.log("Found APP2 marker (0xffe2)");const f=u+4;if(a.getUint32(f)===1297106432){const p=f+4;let m;if(a.getUint16(p)===18761)m=!1;else if(a.getUint16(p)===19789)m=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(a.getUint16(p+2,!m)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const v=a.getUint32(p+4,!m);if(v<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const y=p+v,$=a.getUint16(y,!m),E=y+2;let S=0;for(let I=E;I<E+12*$;I+=12)a.getUint16(I,!m)===45057&&(S=a.getUint32(I+8,!m));const A=4,C=y+2+$*12+A,x=[];for(let I=C;I<C+S*16;I+=16){const O={MPType:a.getUint32(I,!m),size:a.getUint32(I+4,!m),dataOffset:a.getUint32(I+8,!m),dependantImages:a.getUint32(I+12,!m),start:-1,end:-1,isFII:!1};O.dataOffset?(O.start=p+O.dataOffset,O.isFII=!1):(O.start=0,O.isFII=!0),O.end=O.start+O.size,x.push(O)}if(this.options.extractNonFII&&x.length){const I=new Blob([a]),O=[];for(const F of x){if(F.isFII&&!this.options.extractFII)continue;const k=I.slice(F.start,F.end+1,"image/jpeg");O.push(k)}n(O)}}}u+=2+a.getUint16(u+2)}})}}const I7=async i=>{const e=w7(i);if(!e)throw new E2("Gain map XMP metadata not found");const r=await new M7({extractFII:!0,extractNonFII:!0}).extract(i);if(r.length!==2)throw new v2("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},Jk=i=>new Promise((e,n)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=s=>{n(s)},r.src=URL.createObjectURL(i)});class y2 extends ls{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new H$}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new x7({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new ni,sdr:new ni});return new nI({width:16,height:16,type:Jr,colorSpace:xo,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,r,s){const a=s?new Blob([s],{type:"image/jpeg"}):void 0,l=new Blob([r],{type:"image/jpeg"});let u,d,h=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([a?Jk(a):Promise.resolve(void 0),Jk(l)]);d=m[0],u=m[1],h=!0}else{const m=await Promise.all([a?createImageBitmap(a,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(l,{imageOrientation:"flipY"})]);d=m[0],u=m[1]}const f=new ni(d||new ImageData(2,2),cd,Pi,Pi,Dn,ux,Yr,ia,1,xo);f.flipY=h,f.needsUpdate=!0;const p=new ni(u,cd,Pi,Pi,Dn,ux,Yr,ia,1,vn);p.flipY=h,p.needsUpdate=!0,e.width=u.width,e.height=u.height,e.material.gainMap=f,e.material.sdr=p,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class O7 extends y2{load([e,n,r],s,a,l){const u=this.prepareQuadRenderer();let d,h,f;const p=async()=>{if(d&&h&&f){try{await this.render(u,f,d,h)}catch(D){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(r),typeof l=="function"&&l(D),u.disposeOnDemandRenderer();return}typeof s=="function"&&s(u),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(r),u.disposeOnDemandRenderer()}};let m=!0,v=0,y=0,$=!0,E=0,S=0,A=!0,C=0,x=0;const I=()=>{if(typeof a=="function"){const D=v+E+C,U=y+S+x,ce=m&&$&&A;a(new ProgressEvent("progress",{lengthComputable:ce,loaded:U,total:D}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(r);const O=new Nr(this._internalLoadingManager);O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(this.withCredentials),O.load(e,async D=>{if(typeof D=="string")throw new Error("Invalid sdr buffer");d=D,await p()},D=>{m=D.lengthComputable,y=D.loaded,v=D.total,I()},D=>{this.manager.itemError(e),typeof l=="function"&&l(D)});const F=new Nr(this._internalLoadingManager);F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setPath(this.path),F.setWithCredentials(this.withCredentials),F.load(n,async D=>{if(typeof D=="string")throw new Error("Invalid gainmap buffer");h=D,await p()},D=>{$=D.lengthComputable,S=D.loaded,E=D.total,I()},D=>{this.manager.itemError(n),typeof l=="function"&&l(D)});const k=new Nr(this._internalLoadingManager);return k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(this.withCredentials),k.load(r,async D=>{if(typeof D!="string")throw new Error("Invalid metadata string");f=JSON.parse(D),await p()},D=>{A=D.lengthComputable,x=D.loaded,C=D.total,I()},D=>{this.manager.itemError(r),typeof l=="function"&&l(D)}),u}}class L7 extends y2{load(e,n,r,s){const a=this.prepareQuadRenderer(),l=new Nr(this._internalLoadingManager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(this.withCredentials),this.manager.itemStart(e),l.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(u);let h,f,p;try{const m=await I7(d);h=m.sdr,f=m.gainMap,p=m.metadata}catch(m){if(m instanceof E2||m instanceof v2)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),p={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=d;else throw m}try{await this.render(a,p,h,f)}catch(m){this.manager.itemError(e),typeof s=="function"&&s(m),a.disposeOnDemandRenderer();return}typeof n=="function"&&n(a),this.manager.itemEnd(e),a.disposeOnDemandRenderer()},r,u=>{this.manager.itemError(e),typeof s=="function"&&s(u)}),a}}const fE={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},S2="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",kg=i=>Array.isArray(i),iI=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function J$({files:i=iI,path:e="",preset:n=void 0,encoding:r=void 0,extensions:s}={}){let a=null,l=!1;n&&(rI(n),i=fE[n],e=S2),l=kg(i);const{extension:u,isCubemap:d}=sI(i);if(a=oI(u),!a)throw new Error("useEnvironment: Unrecognized file extension: "+i);const h=Mn(v=>v.gl);q.useLayoutEffect(()=>{if(u!=="webp"&&u!=="jpg"&&u!=="jpeg")return;function v(){ku.clear(a,l?[i]:i)}h.domElement.addEventListener("webglcontextlost",v,{once:!0})},[i,h.domElement]);const f=ku(a,l?[i]:i,v=>{(u==="webp"||u==="jpg"||u==="jpeg")&&v.setRenderer(h),v.setPath==null||v.setPath(e),s&&s(v)});let p=l?f[0]:f;if(u==="jpg"||u==="jpeg"||u==="webp"){var m;p=(m=p.renderTarget)==null?void 0:m.texture}return p.mapping=d?Lu:zg,"colorSpace"in p?p.colorSpace=r??d?"srgb":"srgb-linear":p.encoding=r??d?b7:$7,p}const N7={files:iI,path:"",preset:void 0,extensions:void 0};J$.preload=i=>{const e={...N7,...i};let{files:n,path:r=""}=e;const{preset:s,extensions:a}=e;s&&(rI(s),n=fE[s],r=S2);const{extension:l}=sI(n);if(l==="webp"||l==="jpg"||l==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=oI(l);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+n);ku.preload(u,kg(n)?[n]:n,d=>{d.setPath==null||d.setPath(r),a&&a(d)})};const k7={files:iI,preset:void 0};J$.clear=i=>{const e={...k7,...i};let{files:n}=e;const{preset:r}=e;r&&(rI(r),n=fE[r]);const{extension:s}=sI(n),a=oI(s);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+n);ku.clear(a,kg(n)?[n]:n)};function rI(i){if(!(i in fE))throw new Error("Preset must be one of: "+Object.keys(fE).join(", "))}function sI(i){var e;const n=kg(i)&&i.length===6,r=kg(i)&&i.length===3&&i.some(l=>l.endsWith("json")),s=kg(i)?i[0]:i;return{extension:n?"cube":r?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":(e=s.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:n,isGainmap:r}}function oI(i){return i==="cube"?uU:i==="hdr"?pK:i==="exr"?mK:i==="jpg"||i==="jpeg"?L7:i==="webp"?O7:null}const P7=i=>i.current&&i.current.isScene,D7=i=>P7(i)?i.current:i;function aI(i,e,n,r,s={}){var a,l,u,d,h;s={backgroundBlurriness:(a=s.blur)!==null&&a!==void 0?a:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...s};const f=D7(e||n),p=f.background,m=f.environment,v={backgroundBlurriness:f.backgroundBlurriness,backgroundIntensity:f.backgroundIntensity,backgroundRotation:(l=(u=f.backgroundRotation)==null||u.clone==null?void 0:u.clone())!==null&&l!==void 0?l:[0,0,0],environmentIntensity:f.environmentIntensity,environmentRotation:(d=(h=f.environmentRotation)==null||h.clone==null?void 0:h.clone())!==null&&d!==void 0?d:[0,0,0]};return i!=="only"&&(f.environment=r),i&&(f.background=r),Wf(f,s),()=>{i!=="only"&&(f.environment=m),i&&(f.background=p),Wf(f,v)}}function lI({scene:i,background:e=!1,map:n,...r}){const s=Mn(a=>a.scene);return q.useLayoutEffect(()=>{if(n)return aI(e,i,s,n,r)}),null}function $2({background:i=!1,scene:e,blur:n,backgroundBlurriness:r,backgroundIntensity:s,backgroundRotation:a,environmentIntensity:l,environmentRotation:u,...d}){const h=J$(d),f=Mn(p=>p.scene);return q.useLayoutEffect(()=>aI(i,e,f,h,{blur:n,backgroundBlurriness:r,backgroundIntensity:s,backgroundRotation:a,environmentIntensity:l,environmentRotation:u})),null}function B7({children:i,near:e=1,far:n=1e3,resolution:r=256,frames:s=1,map:a,background:l=!1,blur:u,backgroundBlurriness:d,backgroundIntensity:h,backgroundRotation:f,environmentIntensity:p,environmentRotation:m,scene:v,files:y,path:$,preset:E=void 0,extensions:S}){const A=Mn(k=>k.gl),C=Mn(k=>k.scene),x=q.useRef(null),[I]=q.useState(()=>new Yg),O=q.useMemo(()=>{const k=new yM(r);return k.texture.type=Jr,k},[r]);q.useLayoutEffect(()=>(s===1&&x.current.update(A,I),aI(l,v,C,O.texture,{blur:u,backgroundBlurriness:d,backgroundIntensity:h,backgroundRotation:f,environmentIntensity:p,environmentRotation:m})),[i,I,O.texture,v,C,l,s,A]);let F=1;return c_(()=>{(s===1/0||F<s)&&(x.current.update(A,I),F++)}),q.createElement(q.Fragment,null,F9(q.createElement(q.Fragment,null,i,q.createElement("cubeCamera",{ref:x,args:[e,n,O]}),y||E?q.createElement($2,{background:!0,files:y,preset:E,path:$,extensions:S}):a?q.createElement(lI,{background:!0,map:a,extensions:S}):null),I))}function F7(i){var e,n,r,s;const a=J$(i),l=i.map||a;q.useMemo(()=>wU({GroundProjectedEnvImpl:xY}),[]);const u=q.useMemo(()=>[l],[l]),d=(e=i.ground)==null?void 0:e.height,h=(n=i.ground)==null?void 0:n.radius,f=(r=(s=i.ground)==null?void 0:s.scale)!==null&&r!==void 0?r:1e3;return q.createElement(q.Fragment,null,q.createElement(lI,Xa({},i,{map:l})),q.createElement("groundProjectedEnvImpl",{args:u,scale:f,height:d,radius:h}))}function Za(i){return i.ground?q.createElement(F7,i):i.map?q.createElement(lI,i):i.children?q.createElement(B7,i):q.createElement($2,i)}function U7(i){return{all:i=i||new Map,on:function(e,n){var r=i.get(e);r?r.push(n):i.set(e,[n])},off:function(e,n){var r=i.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):i.set(e,[]))},emit:function(e,n){var r=i.get(e);r&&r.slice().map(function(s){s(n)}),(r=i.get("*"))&&r.slice().map(function(s){s(e,n)})}}}const bt=U7(),QT=2.54,rR=1,G7="INCHES",H7="RESET",Mo=lw.forwardRef(({mouseControlEnabled:i,measurementViewEnabled:e,droneScale:n,cameraOffset:r,lineColor:s,flyerText:a,droneSpeed:l=.033333333332,droneInitialPosition:u=[0,0,0],droneCameraRef:d},h)=>{var We,ut,Ye;const f=q.useMemo(()=>es("assets/models/drone.glb"),[]),p=h||q.useRef(),m=q.useRef(new ie(0,0,0)),v=q.useRef({w:!1,a:!1,s:!1,d:!1,u:!1,p:!1,t:!1}),{camera:y}=Mn(),[$,E]=q.useState([new ie(0,0,0)]),[S,A]=q.useState(!1),[C,x]=q.useState(!1),I=l,O=(we,[Q,Ge])=>new Promise(Oe=>{const Ve=p.current;if(!Ve)return Oe();const Fe=l,tt=Ge==="INCHES"?Q*QT:Q,Ue=we.clone().normalize().applyQuaternion(Ve.quaternion),Je=Ve.position.clone().add(Ue.clone().multiplyScalar(tt)),ve=()=>{if(!p.current)return Oe();const Me=Ve.position.clone(),vt=Je.clone().sub(Me);if(vt.length()<=Fe)return Ve.position.copy(Je),Oe();const ee=vt.normalize().multiplyScalar(Fe);Ve.position.add(ee);const W=Je.clone();W.y=Ve.position.y,Ve.lookAt(W),requestAnimationFrame(ve)};ve()}),F=async([we,Q])=>{await de("z",[we,Q],1)},k=async([we,Q])=>{await de("z",[we+rR,Q],-1)},D=async([we,Q])=>{await de("x",[we,Q],1)},U=async([we,Q])=>{await de("x",[we+rR,Q],-1)},ce=async([we,Q])=>{await de("y",[we,Q],1)},re=async([we,Q])=>{if(we==-1/0)if(Q.split(",")[1]!=null){const Oe=Q.split(",")[1];await Re([p.current.position.x,0,p.current.position.z,"CM"]),se([parseInt(Oe),!0])}else await Re([p.current.position.x,0,p.current.position.z,"CM"]);else await de("y",[we+rR,Q],-1)},ae=async we=>{await Re(we)},ne=async we=>{if(!p.current)return;const[Q]=we;console.log("commanding to flip it",Q),x(!0);const Ge=p.current.rotation.clone(),Oe=Math.PI*2,tt=1*60,Ue=Oe/tt;let Je=0;const ve=()=>{if(Je<tt){switch(Q){case"FORWARD":p.current.rotation.x+=Ue;break;case"BACKWARD":p.current.rotation.x-=Ue;break;case"RIGHT":p.current.rotation.z+=Ue;break;case"LEFT":p.current.rotation.z-=Ue;break;default:console.warn("Invalid flip direction"),x(!1);return}Je++,requestAnimationFrame(ve)}else p.current.rotation.copy(Ge),x(!1),console.log(`${Q} Flip complete`)};ve()},de=async(we,[Q,Ge],Oe=1)=>{if(!p.current)return;const Ve=p.current.position.clone();if(Ge==="SECONDS"){const Fe=new ie(we==="x"?Oe:0,we==="y"?Oe:0,we==="z"?Oe:0);ue(Fe,Q)}else{const Fe=Ge==="INCHES"?Q*QT:Q;Ve[we]+=Fe*Oe,await O(new ie(Ve.x,Ve.y,Ve.z),[Q,Ge])}},ue=(we,Q)=>{const Oe=Date.now(),Ve=Q*1e3,Fe=we.clone().applyQuaternion(p.current.quaternion).normalize(),tt=()=>{Date.now()-Oe<Ve?(p.current.position.add(Fe.clone().multiplyScalar(.075)),requestAnimationFrame(tt)):console.log("Movement complete.")};tt()},Re=async we=>{let[Q,Ge,Oe,Ve]=we;Ve==H7&&E([new ie(0,0,0)]),Ve===G7&&(Q*=QT,Ge*=QT,Oe*=QT);const Fe=new ie(Q,Ge,Oe),tt=l,Ue=()=>{const Je=p.current.position.clone(),ve=Je.distanceTo(Fe);if(ve<.01)p.current.position.copy(Fe);else{const Me=Fe.clone().sub(Je).normalize(),vt=Math.min(ve,tt);p.current.position.add(Me.multiplyScalar(vt)),requestAnimationFrame(Ue)}};Ue()},G=we=>{const[Q,Ge,Oe,Ve]=we,Ue=(Ve==="INCHES"?Oe*2.54:Oe)/100,Je=lp.degToRad(Ge),ve=Q==="CIRCLE_RIGHT"||Q==="ARC_RIGHT"||Q=="RIGHT";Z(Ue,Je,ve)},Z=(we,Q,Ge)=>{const Oe=p.current.rotation.y,Ve=Q/60,Fe=p.current.position.clone(),tt=Fe.x-we*Math.sin(Oe),Ue=Fe.z-we*Math.cos(Oe);let Je=0;const ve=()=>{if(Math.abs(Je)>=Math.abs(Q))return;Je+=Ve;const Me=Oe+(Ge?-Je:Je),vt=tt+we*Math.sin(Me),oe=Ue+we*Math.cos(Me);p.current.position.set(vt,Fe.y,oe),p.current.rotation.y=Me,requestAnimationFrame(ve)};ve()},K=we=>new Promise(Q=>setTimeout(Q,we*1e3)),se=async([we,Q])=>{A(!0),await K(we),A(!1),Q&&await O(new ie(p.current.position.x,p.current.position.y+5,p.current.position.z),[5,"CM"])},Y=we=>{l=I*we},me=async()=>{await O(new ie(0,0,0),[5,"CM"]),E([new ie(0,0,0)])};q.useEffect(()=>{bt.on("commandFlyFoward",F),bt.on("commandFlyBackward",k),bt.on("commandFlyUp",ce),bt.on("commandFlyDown",re),bt.on("commandFlyLeft",D),bt.on("commandFlyRight",U),bt.on("commandFlyTo",ae),bt.on("commandRotate",G),bt.on("resetSimulationEnv",me),bt.on("commandSetWaitTime",se),bt.on("commandSetSpeed",Y),bt.on("commandFlip",ne);const we=Ge=>{v.current[Ge.key]=!0},Q=Ge=>{v.current[Ge.key]=!1};return window.addEventListener("keydown",we),window.addEventListener("keyup",Q),()=>{bt.off("commandFlyFoward",F),bt.off("commandFlyBackward",k),bt.off("commandFlyLeft",U),bt.off("commandFlyRight",D),bt.off("commandFlyUp",ce),bt.off("commandFlyTo",ae),bt.off("commandRotate",G),bt.on("resetSimulationEnv",me),bt.off("commandSetWaitTime",se),bt.off("commandSetSpeed",Y),bt.off("commandFlip",ne),window.removeEventListener("keydown",we),window.removeEventListener("keyup",Q)}},[v]);const fe=()=>{if(m.current.set(0,0,0),!p.current)return;if(C){y.lookAt(p.current.position);return}const we=new ie(0,0,1).applyQuaternion(p.current.quaternion),Q=new ie(0,0,-1).applyQuaternion(p.current.quaternion),Ge=new ie(1,0,0).applyQuaternion(p.current.quaternion),Oe=new ie(-1,0,0).applyQuaternion(p.current.quaternion);if(v.current.w&&m.current.add(we.multiplyScalar(l)),v.current.s&&m.current.add(Q.multiplyScalar(l)),v.current.a&&m.current.add(Ge.multiplyScalar(l)),v.current.d&&m.current.add(Oe.multiplyScalar(l)),v.current.z&&(p.current.rotation.y+=lp.degToRad(1)),v.current.c&&(p.current.rotation.y-=lp.degToRad(1)),v.current.u&&(m.current.y+=l),v.current.p&&(m.current.y-=l),p.current.position.add(m.current),!i&&!e){const[Fe,tt,Ue]=r,Je=new ie(Fe,tt,Ue);Je.applyQuaternion(p.current.quaternion),y.position.copy(p.current.position.clone().add(Je)),y.lookAt(p.current.position)}const Ve=p.current.position.clone();E(Fe=>[...Fe,Ve])};c_(()=>{p.current&&fe()});const Ae=((We=p.current)==null?void 0:We.position.x)||0,Ce=((ut=p.current)==null?void 0:ut.position.y)||0,Ie=((Ye=p.current)==null?void 0:Ye.position.z)||0;return V.jsxs(V.Fragment,{children:[V.jsxs("mesh",{ref:p,children:[V.jsx(S7,{makeDefault:!1,ref:d,fov:75,rotation:[0,59.6,0],position:[0,1,0]}),V.jsx("primitive",{object:f.scene,position:u,scale:n})]}),a&&V.jsxs(V.Fragment,{children:[V.jsxs("mesh",{position:[Ae+0,Ce-.4,Ie+0],children:[V.jsx("planeGeometry",{args:[100,10]}),V.jsx("meshBasicMaterial",{color:"white",side:$s})]}),V.jsxs(Fi,{position:[0,0,1],fontSize:5,color:"black",anchorX:"center",anchorY:"middle",children:[" ",a," "]})]}),V.jsx(eI,{points:$,color:s,lineWidth:3})]})});Mo.propTypes={mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool,droneScale:zt.number,cameraOffset:zt.arrayOf(zt.number),lineColor:zt.string,droneSpeed:zt.number,flyerText:zt.string,droneInitialPosition:zt.arrayOf(zt.number)};class qa extends s_{constructor(e,n={}){const r=n.font;if(r===void 0)super();else{const s=r.generateShapes(e,n.size);n.depth=n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(s,n)}this.type="TextGeometry"}}class Io extends ls{constructor(e){super(e)}load(e,n,r,s){const a=this,l=new Nr(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){const d=a.parse(JSON.parse(u));n&&n(d)},r,s)}parse(e){return new V7(e)}}class V7{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100){const r=[],s=z7(e,n,this.data);for(let a=0,l=s.length;a<l;a++)r.push(...s[a].toShapes());return r}}function z7(i,e,n){const r=Array.from(i),s=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*s,l=[];let u=0,d=0;for(let h=0;h<r.length;h++){const f=r[h];if(f===`
`)u=0,d-=a;else{const p=W7(f,s,u,d,n);u+=p.offsetX,l.push(p.path)}}return l}function W7(i,e,n,r,s){const a=s.glyphs[i]||s.glyphs["?"];if(!a){console.error('THREE.Font: character "'+i+'" does not exists in font family '+s.familyName+".");return}const l=new yU;let u,d,h,f,p,m,v,y;if(a.o){const $=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(let E=0,S=$.length;E<S;)switch($[E++]){case"m":u=$[E++]*e+n,d=$[E++]*e+r,l.moveTo(u,d);break;case"l":u=$[E++]*e+n,d=$[E++]*e+r,l.lineTo(u,d);break;case"q":h=$[E++]*e+n,f=$[E++]*e+r,p=$[E++]*e+n,m=$[E++]*e+r,l.quadraticCurveTo(p,m,h,f);break;case"b":h=$[E++]*e+n,f=$[E++]*e+r,p=$[E++]*e+n,m=$[E++]*e+r,v=$[E++]*e+n,y=$[E++]*e+r,l.bezierCurveTo(p,m,v,y,h,f);break}}return{offsetX:a.ha*e,path:l}}const UE=({droneCameraRef:i,environment:e})=>{const{gl:n,scene:r,size:s}=Mn(),a=()=>{const l=new lo(s.width,s.height),u=n.getRenderTarget();n.setRenderTarget(l),n.render(r,i.current);const d=new Uint8Array(s.width*s.height*4);n.readRenderTargetPixels(l,0,0,s.width,s.height,d);const h=document.createElement("canvas");h.width=s.width,h.height=s.height;const f=h.getContext("2d"),p=f.createImageData(s.width,s.height);for(let $=0;$<s.height;$++)for(let E=0;E<s.width;E++){const S=($*s.width+E)*4,A=((s.height-$-1)*s.width+E)*4;p.data[S]=d[A],p.data[S+1]=d[A+1],p.data[S+2]=d[A+2],p.data[S+3]=d[A+3]}f.putImageData(p,0,0);const m=h.toDataURL("image/png"),v=new Date().toISOString().replace(/[:.]/g,"-"),y=document.createElement("a");y.href=m,y.download=`${e}_${v}.png`,y.click(),n.setRenderTarget(u),l.dispose()};return q.useEffect(()=>{const l=()=>{i.current&&a()};return bt.on("commandTakeScreenShot",l),()=>{bt.off("commandTakeScreenShot",l)}},[i]),null},X7=new Io;let b2,JS,K0=null,j7="white",Y7="black",K7="yellow",J7="white",Z7="lightgreen",q7="black";const Q7=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(0,10,0),e.lookAt(new ie(0,5,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),b2=e,JS=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},eJ=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.1,4,4]}),V.jsx("meshStandardMaterial",{color:Y7})]}),tJ=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,b2);const h=d.intersectObject(JS,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),K0==null&&(K0=r.current.position.clone());const p=[K0,f],m=new on().setFromPoints(p),v=new Ai({color:j7}),y=new pr(m,v);JS.add(y),K0.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;nJ($,f)}}},nJ=(i,e)=>{X7.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.2,height:.01,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.02,bevelSegments:1}),s=new oi({color:q7}),a=new Bn(r,s);console.log(e),a.position.set(e.x,e.y+1,e.z),a.rotation.x=-Math.PI/2,JS.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},iJ=()=>{const i=q.useRef(),e=13;return V.jsxs(V.Fragment,{children:[V.jsxs("mesh",{ref:i,rotation:[-Math.PI/2,0,0],position:[0,-2,0],children:[V.jsx("planeGeometry",{args:[e,e]}),V.jsx("meshStandardMaterial",{color:Z7,roughness:.9})]}),V.jsx(J0,{position:[-e/2,-2,-e/2]})," ",V.jsx(J0,{position:[e/2,-2,-e/2]}),"  ",V.jsx(J0,{position:[-e/2,-2,e/2]}),"  ",V.jsx(J0,{position:[e/2,-2,e/2]}),"   "]})},J0=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("boxGeometry",{args:[1,.1,1]}),V.jsx("meshStandardMaterial",{color:J7})]}),A2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),s=q.useRef(),[a,l]=q.useState([]);return V.jsxs(Ka,{shadows:!0,style:{background:"gray"},onClick:u=>tJ(u,l,e,i),children:[V.jsx("ambientLight",{intensity:.4,color:new xt(0)}),V.jsx(Za,{preset:"sunset",intensity:.5}),V.jsx(iJ,{}),a.map((u,d)=>V.jsx(eJ,{position:u},d)),V.jsx(Q7,{measurementViewEnabled:e}),V.jsx(UE,{droneCameraRef:s,environment:"mountain"}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,cameraOffset:[0,6,-5],droneScale:.1,lineColor:K7,droneCameraRef:s})]})};A2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};var C2={exports:{}},sR={exports:{}},Zk;function cI(){return Zk||(Zk=1,function(i,e){(function(n,r){i.exports=r()})(tp,function(){var n={},r,s,a,l,u,d,h,f,p,m,v,y,$,E,S,A,C,x,I,O,F,k,D,U,ce,re,ae,ne,de,ue,Re,G,Z,K,se,Y,me,fe,Ae,Ce,Ie,We,ut,Ye,we,Q,Ge,Oe,Ve,Fe,tt,Ue,Je,ve,Me,vt,oe,ee,W,ot,je,Qe,ht,ft,He,St,L,X,he,z,be,nt,Ee,Le,Be,N,j,ge,xe,Ke,gt,$t,un,an,ei,fi,Ki,Ci,_i,Ti,nn,pi,yr,J,B,le,_e,pe,ye,Ze,qe,at,rt,pt,ke,It,Ct,wt,Ht,Zt,jt,Ot,qt,Ft,ln,Fn,sn,$n,tn,Un,Rn,hn,zn,In,Kt,An,Sr,Ri,mn,cs,Xs,Cs,hi,Rs,dn,Pr,jn,ts,Dr,ti,rn,vi,us,zi,Gl,Br,ai,xs,Qa,mr,el,xi,Ii,fo,Hl,$r,sr,js,gr,da,Vl,Fr,Oo,po,Ys,Oi,Te,Ne,lt,Et,_n,fn,Qt,yn,li,ci,br,hs,Ic,Fp,Lo,fa,Bu,Up,yd,Fu,Gp,Uu,Oc,No,Hp,Vp,Lc,zl,Wl,Sd,Nc,ws,Ks,Xl,pa,ma,jl,kc,$d,bd,Ar,ns,Li,Gu,Js,zp,ga,Ad,Cd,h_,Hu,Pc,Wp,Dc,Rd,Xp,d_,mo,Vu,Yl,ds,ko,Kl,Zs,xd,Ei,f_,Jl,mi,wd,Md,zu,tl,Ms,go,wi,Cr,or,Id,Wu,Xu,p_,Ur,Od,Bc,jp,_a,Po,Zl,ql,ju,m_,Yu,Yp,Ku,g_,__,Ta,Fc,Do,Ld,Nd,kd,Ju,Ql,Kp,T_,v_,Jp,E_,y_,S_,$_,GE,Zp,b_,A_,qp,Pd,Zu,Qp,C_,R_,ec,nl,il,rl,Dd,Bo,x_,w_,Fo,M_,Uc,qu,Qu,Gc,I_,eh,Gr,O_,em,fs,Rr,L_,N_,k_,P_,sl,Wt,ps,Ji,yi,Uo,ol,Nt,Di,Bd,D_,Fd,th,B_,Ud,Gd,Go,F_,HE,nh,tc,tm,kt,Hd,nm,U_,VE,al,ih,Hc,rh,G_,im,rm,sm,om,sh,Vd,H_,am,zd,oh,V_,z_,Wd,qs,W_,Ho,ah,Xd,nc,lh,Vc,jd,Yd,Kd,lm,Jd,X_,ch,Zd,Wi,xn,Zi,qi,xr,Is,zc,ar,uh,ic,hh,qd,Wc,is,Qd,ef,ll,rc,tf,cl,dh,va,fh,Xc,nf,ph,mh,Hr,Ea,Os,rf,ms,j_,sf,cm,zE,ul,Y_,K_,Tt;r=function(t,o,c,g){if(!(t instanceof yt)&&typeof t!="string"||`${t}`.trim()==="")throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=`${t}`.toLowerCase(),typeof o!="string"||o.trim()==="")throw Error('Invalid name "'+o+'". The name must be a non-empty string.');const b=o.toLowerCase();if(!c)throw Error("Can not register a null value");let M=Ls[t],te=of[t];if(M||(M=Ls[t]=Object.create(null),te=of[t]=Object.create(null)),s(t,c),!g&&M[b]&&M[b]!==c)throw Error('Name "'+b+'" with type "'+t+'" already registered.');M[b]=c,te[b]=o},s=function(t,o){switch(t){case String(yt.FIELD):if(typeof o.fromJson!="function")throw Error('Type "'+t+'" must have a fromJson function')}},a=function(t,o){t=`${t}`.toLowerCase(),o=o.toLowerCase();const c=Ls[t];c&&c[o]?(delete Ls[t][o],delete of[t][o]):console.warn("Unable to unregister ["+o+"]["+t+"] from the registry.")},l=function(t,o,c){t=`${t}`.toLowerCase(),o=o.toLowerCase();const g=Ls[t];if(!g||!g[o]){if(o="Unable to find ["+o+"]["+t+"] in the registry.",c)throw Error(o+" You must require or register a "+t+" plugin.");return console.warn(o),null}return g[o]},u=function(t,o){return t=`${t}`.toLowerCase(),o=o.toLowerCase(),(t=Ls[t])?!!t[o]:!1},d=function(t,o,c){return l(t,o,c)},h=function(t,o,c){return l(t,o,c)},f=function(t,o,c){t=`${t}`.toLowerCase();var g=Ls[t];if(!g){if(g=`Unable to find [${t}] in the registry.`,c)throw Error(`${g} You must require or register a ${t} plugin.`);return console.warn(g),null}if(!o)return g;t=of[t],c=Object.create(null);for(const b of Object.keys(g))c[t[b]]=g[b];return c},p=function(t,o,c){return o=o.plugins[String(t)]||_o,typeof o=="function"?o:d(t,o,c)},m=function(){return"blockly-"+(jc++).toString(36)},v=function(){return Z_.genUid()},n.setRecordUndo$$module$build$src$core$events$utils=function(t){Yc=t},y=function(){return Yc},$=function(t){um.fireInternal(t)},E=function(t){if(x()){if(!Zc.length)try{requestAnimationFrame(()=>{setTimeout(S,0)})}catch{setTimeout(S,0)}Zc.push(t)}},S=function(){var t=A(Zc,!0);Zc.length=0;for(let c=0,g;g=t[c];c++)if(g.workspaceId){var o=U(g.workspaceId);o&&o.fireChangeListener(g)}t=new Set(t.map(c=>c.workspaceId));for(const c of t){if(!c||(t=U(c),!t))continue;t=t.getUndoStack();let g;for(o=t.length;0<o;o--){const b=t[o-1];if(b.group==="")break;if(g===void 0)g=b.group;else if(b.group!==g)break}g&&o!=t.length-1&&(o=t.splice(o,t.length-o),o=A(o,!0),t.push(...o))}},A=function(t,o){t=t.slice(),o||t.reverse();const c=[],g=Object.create(null);for(let te=0,$e;$e=t[te];te++)if(!$e.isNull()){var b=[$e.isUiEvent?af:$e.type,$e.blockId,$e.workspaceId].join(" "),M=g[b];const it=M?M.event:null;M?$e.type===n.MOVE$$module$build$src$core$events$utils&&M.index===te-1?(b=$e,it.newParentId=b.newParentId,it.newInputName=b.newInputName,it.newCoordinate=b.newCoordinate,b.reason&&(it.reason?(b=new Set(b.reason.concat(it.reason)),it.reason=Array.from(b)):it.reason=b.reason),M.index=te):$e.type===n.CHANGE$$module$build$src$core$events$utils&&$e.element===it.element&&$e.name===it.name?it.newValue=$e.newValue:$e.type===Vo?(M=$e,it.viewTop=M.viewTop,it.viewLeft=M.viewLeft,it.scale=M.scale,it.oldScale=M.oldScale):($e.type!==lr||it.type!==Sa)&&(g[b]={event:$e,index:te},c.push($e)):(g[b]={event:$e,index:te},c.push($e))}t=c.filter(function(te){return!te.isNull()}),o||t.reverse();for(let te=1,$e;$e=t[te];te++)$e.type===n.CHANGE$$module$build$src$core$events$utils&&$e.element==="mutation"&&t.unshift(t.splice(te,1)[0]);return t},C=function(){for(let t=0,o;o=Zc[t];t++)o.recordUndo=!1},n.disable$$module$build$src$core$events$utils=function(){Vr++},n.enable$$module$build$src$core$events$utils=function(){Vr--},x=function(){return Vr===0},n.getGroup$$module$build$src$core$events$utils=function(){return dl},n.setGroup$$module$build$src$core$events$utils=function(t){um.setGroupInternal(t)},I=function(t){dl=typeof t=="boolean"?t?v():"":t},O=function(t){const o=[];t=t.getDescendants(!1);for(let c=0,g;g=t[c];c++)o[c]=g.id;return o},F=function(t,o){const c=k(t.type);if(!c)throw Error("Unknown event type.");return c.fromJson(t,o)},k=function(t){const o=d(yt.EVENT,t);if(!o)throw Error(`Event type ${t} not found in registry.`);return o},D=function(t){if((t.type===n.MOVE$$module$build$src$core$events$utils||t.type===n.CREATE$$module$build$src$core$events$utils)&&t.workspaceId){var o=U(t.workspaceId);if(!t.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(t=o.getBlockById(t.blockId)){const c=Yc;try{Yc=!1;const g=t.getParent();if(g&&!g.hasDisabledReason(lf)){const b=t.getDescendants(!1);for(let M=0,te;te=b[M];M++)te.setDisabledReason(!1,lf)}else if((t.outputConnection||t.previousConnection)&&!o.isDragging())do t.setDisabledReason(!0,lf),t=t.getNextBlock();while(t)}finally{Yc=c}}}},U=function(t){return T[t]||null},ce=function(){const t=[];for(const o in T)t.push(T[o]);return t},re=function(t){T[t.id]=t},ae=function(t){delete T[t.id]},ne=function(){return R},de=function(t){R=t},ue=function(){return w},n.setSelected$$module$build$src$core$common=function(t){if(w!==t){var o,c,g,b,M,te,$e=new(k(_h))((g=(o=w)==null?void 0:o.id)!=null?g:null,(b=t==null?void 0:t.id)!=null?b:null,(te=(M=t==null?void 0:t.workspace.id)!=null?M:(c=w)==null?void 0:c.workspace.id)!=null?te:"");$($e);var it;(it=w)==null||it.unselect(),w=t;var Dt;(Dt=w)==null||Dt.select()}},Re=function(){return P},G=function(t){P=t},Z=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;const o=t.getParentSvg(),c=t.getCachedParentSvgSize();var g=o.parentElement;if(g instanceof HTMLElement){var b=g.offsetWidth;g=g.offsetHeight,c.width!==b&&(o.setAttribute("width",b+"px"),t.setCachedParentSvgSize(b,null)),c.height!==g&&(o.setAttribute("height",g+"px"),t.setCachedParentSvgSize(null,g)),t.resize()}},K=function(t,o){const c=Object.create(null),g=t.getDescendants(!0);o&&(t=t.getNextBlock())&&(t=g.indexOf(t),g.splice(t,g.length-t));for(let b=0,M;M=g[b];b++)c[M.type]?c[M.type]++:c[M.type]=1;return c},se=function(t){return function(){this.jsonInit(t)}},Y=function(t){Se.defineBlocksWithJsonArrayInternal(t)},me=function(t){n.defineBlocks$$module$build$src$core$common(n.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(t))},n.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){const o={};for(let c=0;c<t.length;c++){const g=t[c];if(!g){console.warn(`Block definition #${c} in JSON array is ${g}. Skipping`);continue}const b=g.type;b?o[b]={init:se(g)}:console.warn(`Block definition #${c} in JSON array is missing a type attribute. Skipping.`)}return o},n.defineBlocks$$module$build$src$core$common=function(t){for(const o of Object.keys(t)){const c=t[o];o in Ns&&console.warn(`Block definition "${o}" overwrites previous definition.`),Ns[o]=c}},fe=function(t,o){Ae(),gs=setTimeout(function(){o&&o.handleRightClick(t)},cn)},Ae=function(){gs&&(clearTimeout(gs),gs=0)},Ce=function(){Jt=null},Ie=function(t){return!t.type.startsWith("pointer")||t instanceof PointerEvent&&ut(t)},We=function(t){return`${t.pointerId}`},ut=function(t){const o=We(t);return Jt?Jt===o:t.type==="pointerdown"?(Jt=o,!0):!1},Ye=function(t,o,c,g,b){function M($e){(b||Ie($e))&&(c?g.call(c,$e):g($e))}const te=[];if(o in Xi)for(let $e=0;$e<Xi[o].length;$e++){const it=Xi[o][$e];t.addEventListener(it,M,!1),te.push([t,it,M])}else t.addEventListener(o,M,!1),te.push([t,o,M]);return te},we=function(t,o,c,g){function b(te){c?g.call(c,te):g(te)}const M=[];if(o in Xi)for(let te=0;te<Xi[o].length;te++){const $e=Xi[o][te];t.addEventListener($e,b,!1),M.push([t,$e,b])}else t.addEventListener(o,b,!1),M.push([t,o,b]);return M},Q=function(t){const o=t[t.length-1][2];for(;t.length;){const[c,g,b]=t.pop();c.removeEventListener(g,b,!1)}return o},Ge=function(t){if(t.target instanceof HTMLElement){if(t.target.isContentEditable||t.target.getAttribute("data-is-text-input")==="true")return!0;if(t.target instanceof HTMLInputElement)return t=t.target,t.type==="text"||t.type==="number"||t.type==="email"||t.type==="password"||t.type==="search"||t.type==="tel"||t.type==="url";if(t.target instanceof HTMLTextAreaElement)return!0}return!1},Oe=function(t){return t.ctrlKey&&eb?!0:t.button===2},Ve=function(t,o,c){const g=o.createSVGPoint();return g.x=t.clientX,g.y=t.clientY,c||(c=o.getScreenCTM().inverse()),g.matrixTransform(c)},Fe=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*EI,y:t.deltaY*EI};case 2:return{x:t.deltaX*yI,y:t.deltaY*yI}}},tt=function(t,o){return o=t.indexOf(o),o===-1?!1:(t.splice(o,1),!0)},Ue=function(t){if(tb)throw Error("CSS already injected");nb+=`
`+t},Je=function(t,o){tb||(tb=!0,t&&(t=o.replace(/[\\/]$/,""),o=nb.replace(/<<<PATH>>>/g,t),nb="",t=document.createElement("style"),t.id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild)))},ve=function(t,o,c){t=document.createElementNS(eT,`${t}`);for(const g in o)t.setAttribute(g,`${o[g]}`);return c&&c.appendChild(t),t},Me=function(t,o){return o=o.split(" "),o.every(c=>t.classList.contains(c))?!1:(t.classList.add(...o),!0)},vt=function(t,o){t.classList.remove(...o.split(" "))},oe=function(t,o){return o=o.split(" "),o.every(c=>!t.classList.contains(c))?!1:(t.classList.remove(...o),!0)},ee=function(t,o){return t.classList.contains(o)},W=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},ot=function(t,o){const c=o.nextSibling;if(o=o.parentNode,!o)throw Error("Reference node has no parent.");c?o.insertBefore(t,c):o.appendChild(t)},je=function(t,o){t.style.transform=o,t.style["-webkit-transform"]=o},Qe=function(){rb++,ml||(ml=Object.create(null))},ht=function(){rb--,rb||(ml=null)},ft=function(t){const o=t.textContent+`
`+t.className.baseVal;let c;if(ml&&(c=ml[o]))return c;try{c=t.getComputedTextLength()}catch{return 8*t.textContent.length}return ml&&(ml[o]=c),c},He=function(t,o,c,g){return St(t,o+"pt",c,g)},St=function(t,o,c,g){const b=t.textContent;t=b+`
`+t.className.baseVal;var M;return ml&&(M=ml[t])||(XE||(M=document.createElement("canvas"),M.className="blocklyComputeCanvas",document.body.appendChild(M),XE=M.getContext("2d")),XE.font=c+" "+o+" "+g,M=b?XE.measureText(b).width:0,ml&&(ml[t]=M)),M},L=function(t,o,c,g){const b=document.createElement("span");b.style.font=c+" "+o+" "+g,b.textContent=t,t=document.createElement("div"),t.style.width="1px",t.style.height="0",o=document.createElement("div"),o.style.display="flex",o.style.position="fixed",o.style.top="0",o.style.left="0",o.appendChild(b),o.appendChild(t),document.body.appendChild(o),c={height:0,baseline:0};try{o.style.alignItems="baseline",c.baseline=t.offsetTop-b.offsetTop,o.style.alignItems="flex-end",c.height=t.offsetTop-b.offsetTop}finally{document.body.removeChild(o)}return c},X=function(t){return $I.getSizeInternal(t)},he=function(t){if(be(t,"display")!=="none")return z(t);const o=t.style,c=o.display,g=o.visibility,b=o.position;o.visibility="hidden",o.position="absolute",o.display="inline";const M=t.offsetWidth;return t=t.offsetHeight,o.display=c,o.position=b,o.visibility=g,new Kn(M,t)},z=function(t){return new Kn(t.offsetWidth,t.offsetHeight)},be=function(t,o){return t=window.getComputedStyle(t),t[o]||t.getPropertyValue(o)},nt=function(t){const o=new At(0,0);t=t.getBoundingClientRect();var c=document.documentElement;return c=new At(window.pageXOffset||c.scrollLeft,window.pageYOffset||c.scrollTop),o.x=t.left+c.x,o.y=t.top+c.y,o},Ee=function(){const t=document.body,o=document.documentElement;return new At(t.scrollLeft||o.scrollLeft,t.scrollTop||o.scrollTop)},Le=function(t){const o=parseFloat(be(t,"borderLeftWidth")),c=parseFloat(be(t,"borderRightWidth")),g=parseFloat(be(t,"borderTopWidth"));return t=parseFloat(be(t,"borderBottomWidth")),new Si(g,t,o,c)},Be=function(t,o,c){t=N(t,o,c),o.scrollLeft=t.x,o.scrollTop=t.y},N=function(t,o,c){var g=nt(t),b=nt(o),M=Le(o);const te=g.x-b.x-M.left;return g=g.y-b.y-M.top,b=z(t),t=o.clientWidth-b.width,b=o.clientHeight-b.height,M=o.scrollLeft,o=o.scrollTop,c?(M+=te-t/2,o+=g-b/2):(M+=Math.min(te,Math.max(te-t,0)),o+=Math.min(g,Math.max(g-b,0))),new At(M,o)},j=function(t){const o=new At(0,0);var c=t.x&&t.getAttribute("x");const g=t.y&&t.getAttribute("y");return c&&(o.x=parseInt(c)),g&&(o.y=parseInt(g)),(c=(c=t.getAttribute("transform"))&&c.match(bI))&&(o.x+=Number(c[1]),c[3]&&(o.y+=Number(c[3]))),(t=t.getAttribute("style"))&&t.includes("translate")&&(t=t.match(AI))&&(o.x+=Number(t[1]),t[3]&&(o.y+=Number(t[3]))),o},ge=function(t){let o=0,c=0;for(;t;){const g=j(t);if(o+=g.x,c+=g.y,(" "+(t.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;t=t.parentNode}return new At(o,c)},xe=function(){const t=Ee();return new Si(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},Ke=function(){const t=document.documentElement,o=window;return new At(o.pageXOffset||t.scrollLeft,o.pageYOffset||t.scrollTop)},gt=function(t,o){var c=o.x;o=o.y;const g=t.getInjectionDiv().getBoundingClientRect();return c=new At(c-g.left,o-g.top),o=t.getOriginOffsetInPixels(),At.difference(c,o).scale(1/t.scale)},$t=function(t,o){var c=o.scale(t.scale);o=c.x,c=c.y;const g=t.getInjectionDiv().getBoundingClientRect();return t=t.getOriginOffsetInPixels(),new At(o+g.left+t.x,c+g.top+t.y)},un=function(t){({document:YE=YE,DOMParser:tT=tT,XMLSerializer:nT=nT}=t),jE=new tT,sb=new nT},n.createElement$$module$build$src$core$utils$xml=function(t){return YE.createElementNS(CI,t)},n.createTextNode$$module$build$src$core$utils$xml=function(t){return YE.createTextNode(t)},n.textToDom$$module$build$src$core$utils$xml=function(t){let o=jE.parseFromString(t,"text/xml");if(o&&o.documentElement&&!o.getElementsByTagName("parsererror").length)return o.documentElement;if((o=jE.parseFromString(t,"text/html"))&&o.body.firstChild&&o.body.firstChild.nodeName.toLowerCase()==="xml")return o.body.firstChild;throw Error(`DOMParser was unable to parse: ${t}`)},an=function(t){return ei(sb.serializeToString(t))},ei=function(t){return t.replace(eG,o=>`&#${o.charCodeAt(0)};`)},fi=function(t){return t?((t instanceof Element||typeof t=="string")&&(t=B(t),t=pi(t)),Ki(t),t):null},Ki=function(t){const o=t.kind;if(t=t.contents,o&&o!==RI&&o!==ob)throw Error("Invalid toolbox kind "+o+". Please supply either "+RI+" or "+ob);if(!t)throw Error("Toolbox must have a contents attribute.")},Ci=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:yr(t):[]},_i=function(t){return xI.hasCategoriesInternal(t)},Ti=function(t){if(!t)return!1;const o=t.kind;return o?o===ob:!!t.contents.filter(function(c){return c.kind.toUpperCase()==="CATEGORY"}).length},nn=function(t){return t&&t.contents?!!t.contents.filter(function(o){return o.kind.toUpperCase()==="CATEGORY"}).length:!1},pi=function(t){const o={contents:yr(t)};return t instanceof Node&&J(t,o),o},yr=function(t){const o=[];let c=t.childNodes;c||(c=t);for(let g=0,b;b=c[g];g++){if(!b.tagName)continue;t={};const M=b.tagName.toUpperCase();t.kind=M,M==="BLOCK"?t.blockxml=b:b.childNodes&&0<b.childNodes.length&&(t.contents=yr(b)),J(b,t),o.push(t)}return o},J=function(t,o){for(let c=0;c<t.attributes.length;c++){const g=t.attributes[c];g.nodeName.includes("css-")?(o.cssconfig=o.cssconfig||{},o.cssconfig[g.nodeName.replace("css-","")]=g.value):o[g.nodeName]=g.value}},B=function(t){let o=null;if(t)if(typeof t=="string"){if(o=n.textToDom$$module$build$src$core$utils$xml(t),o.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else t instanceof Element&&(o=t);return o},le=function(t,o,c,g,b,M){const te=M.scrollbar&&M.scrollbar.canScrollVertically();return t.horizontal===dm.LEFT?(c=b.absoluteMetrics.left+c,te&&M.RTL&&(c+=cr.scrollbarThickness)):(c=b.absoluteMetrics.left+b.viewMetrics.width-o.width-c,te&&!M.RTL&&(c-=cr.scrollbarThickness)),t.vertical===tu.TOP?t=b.absoluteMetrics.top+g:(t=b.absoluteMetrics.top+b.viewMetrics.height-o.height-g,M.scrollbar&&M.scrollbar.canScrollHorizontally()&&(t-=cr.scrollbarThickness)),new Si(t,t+o.height,c,c+o.width)},_e=function(t,o){return{horizontal:o.toolboxMetrics.position===Cn.LEFT||t.horizontalLayout&&!t.RTL?dm.RIGHT:dm.LEFT,vertical:o.toolboxMetrics.position===Cn.BOTTOM?tu.TOP:tu.BOTTOM}},pe=function(t,o,c,g){const b=t.left,M=t.right-t.left,te=t.bottom-t.top;for(let $e=0;$e<g.length;$e++){const it=g[$e];t.intersects(it)&&(t=c===$h.UP?it.top-te-o:it.bottom+o,t=new Si(t,t+te,b,b+M),$e=-1)}return t},ye=function(t,o){MI(t,o)},Ze=function(t){MI=t},qe=function(t,o){LI.confirmInternal(t,o)},at=function(t,o){II(t,o)},rt=function(t){II=t},pt=function(t,o,c){OI(t,o,c)},ke=function(t){OI=t},It=function(t){return t.getVariableModel!==void 0},Ct=function(t){return t.getProcedureDef!==void 0},wt=function(t){return t.getProcedureCall!==void 0&&t.renameProcedure!==void 0},n.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const o=new Set;for(let c=0;c<t.length;c++){const g=t[c].getVarModels();if(g)for(let b=0;b<g.length;b++){const M=g[b];M.getId()&&o.add(M)}}return Array.from(o.values())},n.allDeveloperVariables$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const o=new Set;for(let g=0,b;b=t[g];g++){var c=b.getDeveloperVariables;if(c){c=c();for(let M=0;M<c.length;M++)o.add(c[M])}}return Array.from(o.values())},Ht=function(t){let o=[];const c=document.createElement("button");return c.setAttribute("text","%{BKY_NEW_VARIABLE}"),c.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(g){Ft(g.getTargetWorkspace())}),o.push(c),t=Zt(t),o=o.concat(t)},Zt=function(t){t=t.getVariablesOfType("");const o=[];if(0<t.length){var c=t[t.length-1];if(Ns.variables_set){var g=n.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type","variables_set"),g.setAttribute("gap",Ns.math_change?"8":"24"),g.appendChild(Rn(c)),o.push(g)}if(Ns.math_change&&(g=n.createElement$$module$build$src$core$utils$xml("block"),g.setAttribute("type","math_change"),g.setAttribute("gap",Ns.variables_get?"20":"8"),g.appendChild(Rn(c)),c=n.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),g.appendChild(c),o.push(g)),Ns.variables_get){t.sort(sT.compareByName);for(let b=0,M;M=t[b];b++)c=n.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","variables_get"),c.setAttribute("gap","8"),c.appendChild(Rn(M)),o.push(c)}}return o},jt=function(t){return kI.generateUniqueNameInternal(t)},Ot=function(t){return qt(ub.charAt(0),t.getAllVariableNames())},qt=function(t,o){if(!o.length)return t;const c=ub;let g="",b=c.indexOf(t);for(;;){let M=!1;for(let te=0;te<o.length;te++)if(o[te].toLowerCase()===t){M=!0;break}if(!M)break;b++,b===c.length&&(b=0,g=`${Number(g)+1}`),t=c.charAt(b)+g}return t},Ft=function(t,o,c){function g(M){ln(n.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,M,function(te){if(te){var $e=sn(te,t);if($e){if($e.type===b)var it=n.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",$e.name);else it=n.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,it=it.replace("%1",$e.name).replace("%2",$e.type);ye(it,function(){g(te)})}else t.createVariable(te,b),o&&o(te)}else o&&o(null)})}const b=c||"";g("")},n.renameVariable$$module$build$src$core$variables=function(t,o,c){function g(b){const M=n.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",o.name);ln(M,b,function(te){if(te){var $e=Fn(te,o.type,t),it=$n(o.name,te,t);if($e||it){var Dt="";$e?Dt=n.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",$e.name).replace("%2",$e.type):it&&(Dt=n.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",te).replace("%2",it)),ye(Dt,function(){g(te)})}else t.renameVariableById(o.getId(),te),c&&c(te)}else c&&c(null)})}g("")},ln=function(t,o,c){pt(t,o,function(g){g&&(g=g.replace(/[\s\xa0]+/g," ").trim(),g===n.Msg$$module$build$src$core$msg.RENAME_VARIABLE||g===n.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(g=null),c(g)})},Fn=function(t,o,c){c=c.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let g=0,b;b=c[g];g++)if(b.name.toLowerCase()===t&&b.type!==o)return b;return null},sn=function(t,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let c=0,g;g=o[c];c++)if(g.name.toLowerCase()===t)return g;return null},$n=function(t,o,c){return c.getProcedureMap().getProcedures().length?tn(t,o,c):Un(t,o,c)},tn=function(t,o,c){t=t.toLowerCase(),o=o.toLowerCase(),c=c.getProcedureMap().getProcedures();for(const b of c){var g=b.getParameters().filter(It).map(M=>M.getVariableModel().name);if(g&&(c=g.some(M=>M.toLowerCase()===t),g=g.some(M=>M.toLowerCase()===o),c&&g))return b.getName()}return null},Un=function(t,o,c){t=t.toLowerCase(),o=o.toLowerCase(),c=c.getAllBlocks(!1);for(const b of c){if(!Ct(b))continue;c=b.getProcedureDef();var g=c[1];const M=g.some(te=>te.toLowerCase()===t);if(g=g.some(te=>te.toLowerCase()===o),M&&g)return c[0]}return null},Rn=function(t){const o=n.createElement$$module$build$src$core$utils$xml("field");return o.setAttribute("name","VAR"),o.setAttribute("id",t.getId()),o.setAttribute("variabletype",t.type),t=n.createTextNode$$module$build$src$core$utils$xml(t.name),o.appendChild(t),o},n.getOrCreateVariablePackage$$module$build$src$core$variables=function(t,o,c,g){let b=n.getVariable$$module$build$src$core$variables(t,o,c,g);return b||(b=hn(t,o,c,g)),b},n.getVariable$$module$build$src$core$variables=function(t,o,c,g){const b=t.getPotentialVariableMap();let M=null;if(o&&(M=t.getVariableById(o),!M&&b&&(M=b.getVariableById(o)),M))return M;if(c){if(g===void 0)throw Error("Tried to look up a variable by name without a type");M=t.getVariable(c,g),!M&&b&&(M=b.getVariable(c,g))}return M},hn=function(t,o,c,g){const b=t.getPotentialVariableMap();return c||(c=jt(t.isFlyout?t.targetWorkspace:t)),b?b.createVariable(c,g,o):t.createVariable(c,g,o)},zn=function(t,o){t=t.getAllVariables();const c=[];if(o.length!==t.length)for(let g=0;g<t.length;g++){const b=t[g];o.includes(b)||c.push(b)}return c},In=function(t){return Ri(t),Sr()?(mn(),Promise.resolve()):(fm||(fm=new Promise(o=>{fb=o,PI=window.requestAnimationFrame(()=>{mn(),o()})})),fm)},Kt=function(){return fm||Promise.resolve()},An=function(t){t||window.cancelAnimationFrame(PI),mn(t),!t&&fb&&fb()},Sr=function(){return gI},Ri=function(t){hb.add(t),db.set(t,n.getGroup$$module$build$src$core$events$utils());const o=t.getParent();o?Ri(o):JE.add(t)},mn=function(t){const o=t?new Set([t]):new Set([...JE].map(M=>M.workspace)),c=[...JE].filter(Xs).filter(M=>o.has(M.workspace));for(var g of c)Cs(g);for(const M of o)M.resizeContents();for(var b of c)g=b.getRelativeToSurfaceXY(),b.updateComponentLocations(g);for(const M of c)b=n.getGroup$$module$build$src$core$events$utils(),(g=db.get(M))&&n.setGroup$$module$build$src$core$events$utils(g),M.bumpNeighbours(),n.setGroup$$module$build$src$core$events$utils(b);for(const M of c)cs(M);t||(fm=null)},cs=function(t){JE.delete(t),hb.delete(t),db.delete(t);for(const o of t.getChildren(!1))cs(o)},Xs=function(t){return!t.isDisposed()&&!t.getParent()},Cs=function(t){if(hb.has(t)&&t.initialized){for(const o of t.getChildren(!1))Cs(o);t.renderEfficiently()}},hi=function(t,o){r(yt.SERIALIZER,t,o)},Rs=function(t){a(yt.SERIALIZER,t)},dn=function(t,{addCoordinates:o=!1,saveIds:c=!0}={}){const g=t.workspace,b=Object.create(null);return b.height=t.getSize().height,b.width=t.getSize().width,c&&(b.id=t.id),o&&(o=t.getRelativeToSurfaceXY(),b.x=g.RTL?g.getWidth()-o.x:o.x,b.y=o.y),t.getText()&&(b.text=t.getText()),t.isCollapsed()&&(b.collapsed=!0),t.isOwnEditable()||(b.editable=!1),t.isOwnMovable()||(b.movable=!1),t.isOwnDeletable()||(b.deletable=!1),b},Pr=function(t,o,{recordUndo:c=!1}={}){const g=y();if(n.setRecordUndo$$module$build$src$core$events$utils(c),c=o.newComment(t.id),t.text!==void 0&&c.setText(t.text),t.x!==void 0||t.y!==void 0){const M=c.getRelativeToSurfaceXY();let te,$e=(te=t.x)!=null?te:M.x;$e=o.RTL?o.getWidth()-$e:$e;var b;o=(b=t.y)!=null?b:M.y,c.moveTo(new At($e,o))}if(t.width!==void 0||t.height){b=c.getSize();let M,te;c.setSize(new Kn((M=t.width)!=null?M:b.width,(te=t.height)!=null?te:b.height))}return t.collapsed!==void 0&&c.setCollapsed(t.collapsed),t.editable!==void 0&&c.setEditable(t.editable),t.movable!==void 0&&c.setMovable(t.movable),t.deletable!==void 0&&c.setDeletable(t.deletable),n.setRecordUndo$$module$build$src$core$events$utils(g),c},jn=function(t,o){r(yt.PASTER,t,o)},ts=function(t){a(yt.PASTER,t)},Dr=function(t){const o=t.workspace,c=t.getRelativeToSurfaceXY(),g=new At(0,0),b=o.getTopComments(!1).filter(M=>M.id!==t.id).map(M=>M.getRelativeToSurfaceXY());for(;ti(At.sum(c,g),b);)g.translate(o.RTL?-30:30,30);t.moveTo(At.sum(c,g))},ti=function(t,o){return o.some(c=>1>=Math.abs(c.x-t.x)&&1>=Math.abs(c.y-t.y))},rn=function(t,o){t.setAttribute(rG,o)},vi=function(t,o,c){Array.isArray(c)&&(c=c.join(" ")),t.setAttribute(iG+o,`${c}`)},us=function(t){return t.saveState!==void 0&&t.loadState!==void 0},zi=function(t,{addCoordinates:o=!1,addInputBlocks:c=!0,addNextBlocks:g=!0,doFullSerialization:b=!0,saveIds:M=!0}={}){if(t.isInsertionMarker())return null;const te={type:t.type,id:M?t.id:void 0};return o&&Br(t,te),Gl(t,te),ai(t,te,b),xs(t,te,b),Qa(t,te,b),c&&mr(t,te,b,M),g&&el(t,te,b,M),te},Gl=function(t,o){t.isCollapsed()&&(o.collapsed=!0),t.isEnabled()||(o.disabledReasons=Array.from(t.getDisabledReasons())),t.isOwnDeletable()||(o.deletable=!1),t.isOwnMovable()||(o.movable=!1),t.isOwnEditable()||(o.editable=!1),t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&(o.inline=t.inputsInline),t.data&&(o.data=t.data)},Br=function(t,o){const c=t.workspace;t=t.getRelativeToSurfaceXY(),o.x=Math.round(c.RTL?c.getWidth()-t.x:t.x),o.y=Math.round(t.y)},ai=function(t,o,c){t.saveExtraState?(t=t.saveExtraState(c),t!==null&&(o.extraState=t)):t.mutationToDom&&(t=t.mutationToDom(),t!==null&&(o.extraState=Do(t).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},xs=function(t,o,c){const g=Object.create(null);for(const b of t.getIcons())us(b)&&(t=b.saveState(c))&&(g[b.getType().toString()]=t);Object.keys(g).length&&(o.icons=g)},Qa=function(t,o,c){const g=Object.create(null);for(let b=0;b<t.inputList.length;b++){const M=t.inputList[b];for(let te=0;te<M.fieldRow.length;te++){const $e=M.fieldRow[te];$e.isSerializable()&&(g[$e.name]=$e.saveState(c))}}Object.keys(g).length&&(o.fields=g)},mr=function(t,o,c,g){const b=Object.create(null);for(let M=0;M<t.inputList.length;M++){const te=t.inputList[M];if(!te.connection)continue;const $e=xi(te.connection,c,g);$e&&(b[te.name]=$e)}Object.keys(b).length&&(o.inputs=b)},el=function(t,o,c,g){t.nextConnection&&(t=xi(t.nextConnection,c,g))&&(o.next=t)},xi=function(t,o,c){const g=t.getShadowState(!0);if(t=t.targetBlock(),!g&&!t)return null;const b=Object.create(null);return g&&(b.shadow=g),t&&!t.isShadow()&&(b.block=zi(t,{doFullSerialization:o,saveIds:c})),b},Ii=function(t,o,{recordUndo:c=!1}={}){return t=fo(t,o,{recordUndo:c}),o.rendered&&An(),t},fo=function(t,o,{parentConnection:c,isShadow:g=!1,recordUndo:b=!1}={}){const M=y();n.setRecordUndo$$module$build$src$core$events$utils(b),(b=n.getGroup$$module$build$src$core$events$utils())||n.setGroup$$module$build$src$core$events$utils(!0),n.disable$$module$build$src$core$events$utils();const te=o.getAllVariables();let $e;try{$e=Hl(t,o,{parentConnection:c,isShadow:g})}finally{n.enable$$module$build$src$core$events$utils()}if($r(o,te),x()&&$(new(k(n.CREATE$$module$build$src$core$events$utils))($e)),n.setGroup$$module$build$src$core$events$utils(b),n.setRecordUndo$$module$build$src$core$events$utils(M),o.rendered){const it=$e;setTimeout(()=>{it.disposed||it.setConnectionTracking(!0)},1)}return $e},Hl=function(t,o,{parentConnection:c,isShadow:g=!1}={}){if(!t.type)throw new zI(t);const b=o.newBlock(t.type,t.id);return b.setShadow(g),sr(b,t),js(b,t),gr(b,t),da(c,b,t),Vl(b,t),Fr(b,t),Oo(b,t),po(b,t),Oi(b,o.rendered),b},$r=function(t,o){if(x())for(t=zn(t,o),o=0;o<t.length;o++){const c=t[o];$(new(k(ya))(c))}},sr=function(t,o){let c=o.x===void 0?0:o.x;o=o.y===void 0?0:o.y;const g=t.workspace;c=g.RTL?g.getWidth()-c:c,t.moveBy(c,o)},js=function(t,o){if(o.collapsed&&t.setCollapsed(!0),o.deletable===!1&&t.setDeletable(!1),o.movable===!1&&t.setMovable(!1),o.editable===!1&&t.setEditable(!1),o.enabled===!1&&t.setDisabledReason(!0,ba),Array.isArray(o.disabledReasons))for(const c of o.disabledReasons)t.setDisabledReason(!0,c);o.inline!==void 0&&t.setInputsInline(o.inline),o.data!==void 0&&(t.data=o.data)},gr=function(t,o){o.extraState&&(t.loadExtraState?t.loadExtraState(o.extraState):t.domToMutation&&t.domToMutation(n.textToDom$$module$build$src$core$utils$xml(o.extraState)))},da=function(t,o,c){if(t){if(t.getSourceBlock().isShadow()&&!o.isShadow())throw new XI(c);if(t.type===n.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var g=o.outputConnection;if(!g)throw new aT("output",o,c)}else if(g=o.previousConnection,!g)throw new aT("previous",o,c);if(!t.connect(g)){const b=o.workspace.connectionChecker;throw new WI(b.getErrorMessage(b.canConnectWithReason(g,t,!1),g,t),t.type===n.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",o,c)}}},Vl=function(t,o){if(o.icons){var c=Object.keys(o.icons);for(const b of c){c=o.icons[b];var g=t.getIcon(b);if(!g){if(g=d(yt.ICON,b,!1),!g)throw new jI(b,t,o);g=new g(t),t.addIcon(g)}us(g)&&g.loadState(c)}}},Fr=function(t,o){if(o.fields){var c=Object.keys(o.fields);for(let g=0;g<c.length;g++){const b=c[g],M=o.fields[b],te=t.getField(b);te?te.loadState(M):console.warn(`Ignoring non-existant field ${b} in block ${t.type}`)}}},Oo=function(t,o){if(o.inputs){var c=Object.keys(o.inputs);for(let g=0;g<c.length;g++){const b=c[g],M=t.getInput(b);if(!M||!M.connection)throw new aT(b,t,o);Ys(M.connection,o.inputs[b])}}},po=function(t,o){if(o.next){if(!t.nextConnection)throw new aT("next",t,o);Ys(t.nextConnection,o.next)}},Ys=function(t,o){o.shadow&&t.setShadowState(o.shadow),o.block&&Hl(o.block,t.getSourceBlock().workspace,{parentConnection:t})},Oi=function(t,o){if(o){t.setConnectionTracking(!1),t.initSvg(),t.queueRender();for(const c of t.getIcons())c.onLocationChange(t.getRelativeToSurfaceXY())}else t.initModel()},Te=function(t){return t.bubbleIsVisible!==void 0&&t.setBubbleVisible!==void 0},Ne=function(t){return t*Math.PI/180},lt=function(t){return 180*t/Math.PI},Et=function(t,o,c){if(c<t){const g=c;c=t,t=g}return Math.max(t,Math.min(o,c))},_n=function(){document.querySelector(".blocklyDropDownDiv")||(ii=document.createElement("div"),ii.className="blocklyDropDownDiv",(Re()||document.body).appendChild(ii),Tm=document.createElement("div"),Tm.className="blocklyDropDownContent",ii.appendChild(Tm),gf=document.createElement("div"),gf.className="blocklyDropDownArrow",ii.appendChild(gf),ii.style.opacity="0",ii.style.transition="transform "+ny+"s, opacity "+ny+"s",ii.addEventListener("focusin",function(){Me(ii,"blocklyFocused")}),ii.addEventListener("focusout",function(){oe(ii,"blocklyFocused")}))},fn=function(t){$b=t},Qt=function(){return bh},yn=function(){return Tm},li=function(){Tm.textContent="",Tm.style.width=""},ci=function(t,o){ii.style.backgroundColor=t,ii.style.borderColor=o},br=function(t,o,c,g){return Lo(Ic(o),t,c,g)},hs=function(t,o,c){return JI=!0,Lo(Fp(t),t,o,c)},Ic=function(t){var o=t.getSvgRoot();const c=t.workspace.scale,g=t.height*c;return t=t.width*c,o=nt(o),new Si(o.y,o.y+g,o.x,o.x+t)},Fp=function(t){return t=t.getScaledBBox(),new Si(t.top,t.bottom,t.left,t.right)},Lo=function(t,o,c,g){const b=t.left+(t.right-t.left)/2,M=t.bottom;t=t.top,g&&(t+=g),g=o.getSourceBlock();let te=g.workspace;for(;te.options.parentWorkspace;)te=te.options.parentWorkspace;return fn(te.getParentSvg().parentNode),fa(o,g.RTL,b,M,b,t,c)},fa=function(t,o,c,g,b,M,te){return bh=t,mf=te||null,ii.style.direction=o?"rtl":"ltr",t=ne(),gm=t.getRenderer().getClassName(),_m=t.getTheme().getClassName(),gm&&Me(ii,gm),_m&&Me(ii,_m),Hp(c,g,b,M)},Bu=function(t,o,c,g){return t=Fu(t,c.left,c.right,g.width),{initialX:t.divX,initialY:o,finalX:t.divX,finalY:o+yb,arrowX:t.arrowX,arrowY:-(cT/2+Eb),arrowAtTop:!0,arrowVisible:!0}},Up=function(t,o,c,g){return t=Fu(t,c.left,c.right,g.width),{initialX:t.divX,initialY:o-g.height,finalX:t.divX,finalY:o-g.height-yb,arrowX:t.arrowX,arrowY:g.height-2*Eb-cT/2,arrowAtTop:!1,arrowVisible:!0}},yd=function(t,o,c){return t=Fu(t,o.left,o.right,c.width),{initialX:t.divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Fu=function(t,o,c,g){return o=Et(o,t-g/2,c-g),t=t-cT/2-o,c=KI,t=Et(c,t,g-c-cT),{arrowX:t,divX:o}},Gp=function(){return!!bh},Uu=function(t,o){return bh===t?(o?No():Oc(),!0):!1},Oc=function(){ii.style.transform="translate(0, 0)",ii.style.opacity="0",Sb=setTimeout(function(){No()},1e3*ny),mf&&(mf(),mf=null)},No=function(){Gp()&&(Sb&&clearTimeout(Sb),ii.style.transform="",ii.style.left="",ii.style.top="",ii.style.opacity="0",ii.style.display="none",ii.style.backgroundColor="",ii.style.borderColor="",mf&&(mf(),mf=null),li(),bh=null,gm&&(oe(ii,gm),gm=""),_m&&(oe(ii,_m),_m=""),ne().markFocused())},Hp=function(t,o,c,g){t=bb.getPositionMetrics(t,o,c,g),t.arrowVisible?(gf.style.display="",gf.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",gf.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):gf.style.display="none",o=Math.floor(t.initialX),c=Math.floor(t.initialY),g=Math.floor(t.finalX);const b=Math.floor(t.finalY);return ii.style.left=o+"px",ii.style.top=c+"px",ii.style.display="block",ii.style.opacity="1",ii.style.transform="translate("+(g-o)+"px,"+(b-c)+"px)",!!t.arrowAtTop},Vp=function(){if(bh){var t=bh.getSourceBlock();t=JI?Fp(bh):Ic(t);const o=t.left+(t.right-t.left)/2;Hp(o,t.bottom,o,t.top)}else Oc()},Lc=function(t){return t.length?t.reduce(function(o,c){return o.length<c.length?o:c}).length:0},zl=function(t,o){if(!t.length)return 0;if(t.length===1)return t[0].length;let c=0;o=o||Lc(t);let g;for(g=0;g<o;g++){for(var b=t[0][g],M=1;M<t.length;M++)if(b!==t[M][g])return c;b===" "&&(c=g+1)}for(b=1;b<t.length;b++)if((M=t[b][g])&&M!==" ")return c;return o},Wl=function(t,o){if(!t.length)return 0;if(t.length===1)return t[0].length;let c=0;o=o||Lc(t);let g;for(g=0;g<o;g++){for(var b=t[0].substr(-g-1,1),M=1;M<t.length;M++)if(b!==t[M].substr(-g-1,1))return c;b===" "&&(c=g+1)}for(b=1;b<t.length;b++)if((M=t[b].charAt(t[b].length-g-1))&&M!==" ")return c;return o},n.wrap$$module$build$src$core$utils$string=function(t,o){t=t.split(`
`);for(let c=0;c<t.length;c++)t[c]=Sd(t[c],o);return t.join(`
`)},Sd=function(t,o){if(t.length<=o)return t;const c=t.trim().split(/\s+/);for(var g=0;g<c.length;g++)c[g].length>o&&(o=c[g].length);var b=-1/0;let M,te=1;do{g=b,M=t,t=[],b=c.length/te;let $e=1;for(let it=0;it<c.length-1;it++)$e<(it+1.5)/b?($e++,t[it]=!0):t[it]=!1;t=ws(c,t,o),b=Nc(c,t,o),t=Ks(c,t),te++}while(b>g);return M},Nc=function(t,o,c){const g=[0],b=[];for(var M=0;M<t.length;M++)g[g.length-1]+=t[M].length,o[M]===!0?(g.push(0),b.push(t[M].charAt(t[M].length-1))):o[M]===!1&&g[g.length-1]++;for(t=Math.max(...g),o=0,M=0;M<g.length;M++)o-=2*Math.pow(Math.abs(c-g[M]),1.5),o-=Math.pow(t-g[M],1.5),".?!".includes(b[M])?o+=c/3:",;)]}".includes(b[M])&&(o+=c/4);return 1<g.length&&g[g.length-1]<=g[g.length-2]&&(o+=.5),o},ws=function(t,o,c){let g=Nc(t,o,c),b;for(let M=0;M<o.length-1;M++){if(o[M]===o[M+1])continue;const te=[].concat(o);te[M]=!te[M],te[M+1]=!te[M+1];const $e=Nc(t,te,c);$e>g&&(g=$e,b=te)}return b?ws(t,b,c):o},Ks=function(t,o){const c=[];for(let g=0;g<t.length;g++)c.push(t[g]),o[g]!==void 0&&c.push(o[g]?`
`:" ");return c.join("")},n.isNumber$$module$build$src$core$utils$string=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},Xl=function(t){iy=t},pa=function(){return iy},ma=function(){return hT},jl=function(){return Mr},kc=function(t){if(t=$d(t)){for(t=t.tooltip;typeof t=="function";)t=t();if(typeof t!="string")throw Error("Tooltip function must return a string.");return t}return""},$d=function(t){for(;t&&t.tooltip;){if(typeof t.tooltip=="string"||typeof t.tooltip=="function")return t;t=t.tooltip}return null},bd=function(){document.querySelector(".blocklyTooltipDiv")||(Mr=document.createElement("div"),Mr.className="blocklyTooltipDiv",(Re()||document.body).appendChild(Mr))},Ar=function(t){t.mouseOverWrapper_=we(t,"pointerover",null,Li),t.mouseOutWrapper_=we(t,"pointerout",null,Gu),t.addEventListener("pointermove",Js,!1)},ns=function(t){t&&(Q(t.mouseOverWrapper_),Q(t.mouseOutWrapper_),t.removeEventListener("pointermove",Js))},Li=function(t){Em||(t=$d(t.currentTarget),Aa!==t&&(ga(),dT=null,Aa=t),clearTimeout(qI))},Gu=function(t){Em||(qI=setTimeout(function(){dT=Aa=null,ga()},1),clearTimeout(_f),_f=0)},Js=function(t){if(Aa&&Aa.tooltip&&!Em)if(hT){const o=Ab-t.pageX;t=Cb-t.pageY,Math.sqrt(o*o+t*t)>QI&&ga()}else dT!==Aa&&(clearTimeout(_f),Ab=t.pageX,Cb=t.pageY,_f=setTimeout(Wp,e1))},zp=function(){dT=Aa=null,ga()},ga=function(){hT&&(hT=!1,Mr&&(Mr.style.display="none")),_f&&(clearTimeout(_f),_f=0)},Ad=function(){ga(),Em=!0},Cd=function(){Em=!1},h_=function(){Mr&&Aa&&(typeof iy=="function"?iy(Mr,Aa):Hu())},Hu=function(){var t=kc(Aa);t=n.wrap$$module$build$src$core$utils$string(t,ZI),t=t.split(`
`);for(let o=0;o<t.length;o++){const c=document.createElement("div");c.appendChild(document.createTextNode(t[o])),Mr.appendChild(c)}},Pc=function(t){const o=document.documentElement.clientWidth,c=document.documentElement.clientHeight;let g=Ab;g=t?g-(Rb+Mr.offsetWidth):g+Rb;let b=Cb+xb;return b+Mr.offsetHeight>c+window.scrollY&&(b-=Mr.offsetHeight+2*xb),t?g=Math.max(ry-window.scrollX,g):g+Mr.offsetWidth>o+window.scrollX-2*ry&&(g=o-Mr.offsetWidth-2*ry),{x:g,y:b}},Wp=function(){if(!Em&&(dT=Aa,Mr)){Mr.textContent="",h_();var t=Aa.RTL;Mr.style.direction=t?"rtl":"ltr",Mr.style.display="block",hT=!0;var{x:o,y:c}=Pc(t);Mr.style.left=o+"px",Mr.style.top=c+"px"}},Dc=function(){return wb},Rd=function(t){wb=t},Xp=function(){return Mb},d_=function(t){Mb=t},mo=function(t){t=`${t}`.toLowerCase().trim();var o=t1[t];if(o||(o=t.substring(0,2)==="0x"?"#"+t.substring(2):t,o=o[0]==="#"?o:"#"+o,/^#[0-9a-f]{6}$/.test(o)))return o;if(/^#[0-9a-f]{3}$/.test(o))return["#",o[1],o[1],o[2],o[2],o[3],o[3]].join("");var c=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return c&&(t=Number(c[1]),o=Number(c[2]),c=Number(c[3]),0<=t&&256>t&&0<=o&&256>o&&0<=c&&256>c)?Vu(t,o,c):null},Vu=function(t,o,c){return o=t<<16|o<<8|c,16>t?"#"+(16777216|o).toString(16).substr(1):"#"+o.toString(16)},Yl=function(t){return t=mo(t),t?(t=parseInt(t.substr(1),16),[t>>16,t>>8&255,t&255]):[0,0,0]},ds=function(t,o,c){let g=0,b=0,M=0;if(o===0)M=b=g=c;else{const te=Math.floor(t/60),$e=t/60-te;t=c*(1-o);const it=c*(1-o*$e);switch(o=c*(1-o*(1-$e)),te){case 1:g=it,b=c,M=t;break;case 2:g=t,b=c,M=o;break;case 3:g=t,b=it,M=c;break;case 4:g=o,b=t,M=c;break;case 5:g=c,b=t,M=it;break;case 6:case 0:g=c,b=o,M=t}}return Vu(Math.floor(g),Math.floor(b),Math.floor(M))},ko=function(t,o,c){return t=mo(t),!t||(o=mo(o),!o)?null:(t=Yl(t),o=Yl(o),Vu(Math.round(o[0]+c*(t[0]-o[0])),Math.round(o[1]+c*(t[1]-o[1])),Math.round(o[2]+c*(t[2]-o[2]))))},Kl=function(t){return ds(t,wb,255*Mb)},Zs=function(t,o,c){const g=[];var b=t.split("");b.push("");var M=0;t=[];let te=null;for(let Dt=0;Dt<b.length;Dt++){var $e=b[Dt];if(M===0)if($e==="%")(M=t.join(""))&&g.push(M),t.length=0,M=1;else if(c&&$e===`
`){const Ni=t.join("");Ni&&g.push(Ni),t.length=0,g.push($e)}else t.push($e);else if(M===1)$e==="%"?(t.push($e),M=0):o&&"0"<=$e&&"9">=$e?(M=2,te=$e,($e=t.join(""))&&g.push($e),t.length=0):$e==="{"?M=3:(t.push("%",$e),M=0);else if(M===2)if("0"<=$e&&"9">=$e)te+=$e;else{var it=void 0;g.push(parseInt((it=te)!=null?it:"",10)),Dt--,M=0}else M===3&&($e===""?(t.splice(0,0,"%{"),Dt--,M=0):$e!=="}"?t.push($e):(M=t.join(""),/[A-Z]\w*/i.test(M)?($e=M.toUpperCase(),($e=$e.startsWith("BKY_")?$e.substring(4):null)&&$e in n.Msg$$module$build$src$core$msg?(M=n.Msg$$module$build$src$core$msg[$e],typeof M=="string"?Array.prototype.push.apply(g,Zs(M,o,c)):o?g.push(`${M}`):g.push(M)):g.push("%{"+M+"}")):g.push("%{"+M+"}"),M=t.length=0))}for((o=t.join(""))&&g.push(o),it=[],t.length=0,b=0;b<g.length;b++)typeof g[b]!="string"||c&&g[b]===`
`?((o=t.join(""))&&it.push(o),t.length=0,it.push(g[b])):t.push(g[b]);return(o=t.join(""))&&it.push(o),t.length=0,it},xd=function(t){return Zs(t,!0,!0)},Ei=function(t){return typeof t!="string"?t:(t=Zs(t,!1,!1),t.length?String(t[0]):"")},f_=function(t){let o=!0;const c=n.Msg$$module$build$src$core$msg,g=t.match(/%{BKY_[A-Z]\w*}/gi);if(g)for(let b=0;b<g.length;b++){const M=g[b].toUpperCase();c[M.slice(6,-1)]===void 0&&(console.warn("No message string for "+g[b]+" in "+t),o=!1)}return o},Jl=function(t){const o=typeof t=="string"?Ei(t):t;var c=Number(o);if(!isNaN(c)&&0<=c&&360>=c)return{hue:c,hex:ds(c,Dc(),255*Xp())};if(c=mo(o))return{hue:null,hex:c};throw c='Invalid colour: "'+o+'"',t!==o&&(c+=' (from "'+t+'")'),Error(c)},mi=function(){return _l},wd=function(t){if(_l=t,t===null){let o;(o=document.querySelector("."+oy))==null||o.remove()}},Md=function(){const t=Re()||document.body;document.querySelector("."+oy)?_l=document.querySelector("."+oy):(_l=document.createElement("div"),_l.className=oy),t.appendChild(_l)},zu=function(t,o,c,g){if(tl(),ym=t,sy=c,c=_l){if(c.style.direction=o?"rtl":"ltr",c.style.display="block",!g&&t instanceof $i){let te;g=(te=t.getSourceBlock())==null?void 0:te.workspace}var b;Ib=(b=g)!=null?b:null;var M;t=(M=g)!=null?M:ne(),Sm=t.getRenderer().getClassName(),$m=t.getTheme().getClassName(),Sm&&Me(c,Sm),$m&&Me(c,$m)}},tl=function(){if(Ms()){ym=null;var t=_l;t&&(t.style.display="none",t.style.left="",t.style.top="",sy&&sy(),sy=null,t.textContent="",Sm&&(oe(t,Sm),Sm=""),$m&&(oe(t,$m),$m=""),ne().markFocused())}},Ms=function(){return!!ym},go=function(t){ym===t&&tl()},wi=function(t){Ib!==null&&Ib!==t||tl()},Cr=function(t,o,c){_l.style.left=t+"px",_l.style.top=o+"px",_l.style.height=c+"px"},or=function(t,o,c,g){const b=Wu(t,o,c);t=Id(t,o,c,g),0>b?Cr(t,0,c.height+b):Cr(t,b,c.height)},Id=function(t,o,c,g){return g?Math.min(Math.max(o.right-c.width,t.left),t.right-c.width):Math.max(Math.min(o.left,t.right-c.width),t.left)},Wu=function(t,o,c){return o.bottom+c.height>=t.bottom?o.top-c.height:o.bottom},Xu=function(t){return!(t==null||!t.repositionForWindowResize)},p_=function(){Xu(ym)&&ym.repositionForWindowResize()||tl()},Ur=function(){return ay},Od=function(t){ay=t},Bc=function(t,o,c,g){if(zu(n1,c,ju,g),o.length){var b=jp(o,c,t);ly=b,_a(b,t,c),setTimeout(function(){b.focus()},1),ay=null}else ql()},jp=function(t,o,c){const g=new Tb;g.setRole(gl.MENU);for(let b=0;b<t.length;b++){const M=t[b],te=new vb(M.text);te.setRightToLeft(o),te.setRole(gl.MENUITEM),g.addChild(te),te.setEnabled(M.enabled),M.enabled&&te.onAction(function(){ql(),requestAnimationFrame(()=>{setTimeout(()=>{M.callback(M.scope,c)},0)})},{})}return g},_a=function(t,o,c){const g=xe();o=new Si(o.clientY+g.top,o.clientY+g.top,o.clientX+g.left,o.clientX+g.left),Po(t);const b=t.getSize();c&&(o.left+=b.width,o.right+=b.width,g.left+=b.width,g.right+=b.width),or(g,o,b,c),t.focus()},Po=function(t){var o=mi();if(!o)throw Error("Attempting to create a context menu when widget div is null");o=t.render(o),Me(o,"blocklyContextMenu"),Ye(o,"contextmenu",null,Zl),t.focus()},Zl=function(t){t.preventDefault(),t.stopPropagation()},ql=function(){go(n1),ay=null},ju=function(){ly&&(ly.dispose(),ly=null)},n.callbackFactory$$module$build$src$core$contextmenu=function(t,o){return()=>{n.disable$$module$build$src$core$events$utils();let c;try{c=o instanceof Element?Ql(o,t.workspace):fo(o,t.workspace);const g=t.getRelativeToSurfaceXY();g.x=t.RTL?g.x-n.config$$module$build$src$core$config.snapRadius:g.x+n.config$$module$build$src$core$config.snapRadius,g.y+=2*n.config$$module$build$src$core$config.snapRadius,c.moveBy(g.x,g.y)}finally{n.enable$$module$build$src$core$events$utils()}return x()&&!c.isShadow()&&$(new(k(n.CREATE$$module$build$src$core$events$utils))(c)),n.setSelected$$module$build$src$core$common(c),c}},m_=function(t,o=!1){const c=n.createElement$$module$build$src$core$utils$xml("xml");var g=Yp(n.allUsedVarModels$$module$build$src$core$variables(t));g.hasChildNodes()&&c.appendChild(g);for(const b of t.getTopComments())c.appendChild(Yu(b,o));for(t=t.getTopBlocks(!0),g=0;g<t.length;g++)c.appendChild(Ku(t[g],o));return c},Yu=function(t,o=!1){const c=n.createElement$$module$build$src$core$utils$xml("comment");o||c.setAttribute("id",t.id),o=t.workspace;const g=t.getRelativeToSurfaceXY();return g.x=o.RTL?o.getWidth()-g.x:g.x,c.setAttribute("x",`${g.x}`),c.setAttribute("y",`${g.y}`),c.setAttribute("w",`${t.getSize().width}`),c.setAttribute("h",`${t.getSize().height}`),t.getText()&&(c.textContent=t.getText()),t.isCollapsed()&&c.setAttribute("collapsed","true"),t.isOwnEditable()||c.setAttribute("editable","false"),t.isOwnMovable()||c.setAttribute("movable","false"),t.isOwnDeletable()||c.setAttribute("deletable","false"),c},Yp=function(t){const o=n.createElement$$module$build$src$core$utils$xml("variables");for(let c=0;c<t.length;c++){const g=t[c],b=n.createElement$$module$build$src$core$utils$xml("variable");b.appendChild(n.createTextNode$$module$build$src$core$utils$xml(g.name)),g.type&&b.setAttribute("type",g.type),b.id=g.getId(),o.appendChild(b)}return o},Ku=function(t,o){if(t.isInsertionMarker()&&(t=t.getChildren(!1)[0],!t))return new DocumentFragment;let c=0;if(t.workspace.RTL&&(c=t.workspace.getWidth()),o=Ta(t,o),qp(o)){const g=t.getRelativeToSurfaceXY();o.setAttribute("x",String(Math.round(t.workspace.RTL?c-g.x:g.x))),o.setAttribute("y",String(Math.round(g.y)))}return o},g_=function(t){if(t.isSerializable()){const o=n.createElement$$module$build$src$core$utils$xml("field");return o.setAttribute("name",t.name||""),t.toXml(o)}return null},__=function(t,o){for(let c=0;c<t.inputList.length;c++){const g=t.inputList[c];for(let b=0;b<g.fieldRow.length;b++){const M=g_(g.fieldRow[b]);M&&o.appendChild(M)}}},Ta=function(t,o){if(t.isInsertionMarker())return(o=t.getChildren(!1)[0])?Ta(o):new DocumentFragment;const c=n.createElement$$module$build$src$core$utils$xml(t.isShadow()?"shadow":"block");if(c.setAttribute("type",t.type),o||(c.id=t.id),t.mutationToDom){var g=t.mutationToDom();g&&(g.hasChildNodes()||g.hasAttributes())&&c.appendChild(g)}if(__(t,c),g=t.getCommentText()){var b=t.getIcon(wr.COMMENT),M=b.getBubbleSize();b=b.bubbleIsVisible();var te=n.createElement$$module$build$src$core$utils$xml("comment");te.appendChild(n.createTextNode$$module$build$src$core$utils$xml(g)),te.setAttribute("pinned",`${b}`),te.setAttribute("h",String(M.height)),te.setAttribute("w",String(M.width)),c.appendChild(te)}for(t.data&&(g=n.createElement$$module$build$src$core$utils$xml("data"),g.appendChild(n.createTextNode$$module$build$src$core$utils$xml(t.data)),c.appendChild(g)),g=0;g<t.inputList.length;g++){M=t.inputList[g];var $e=void 0;if(b=!0,M.type!==n.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&M.type!==n.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){te=M.connection.targetBlock(),M.type===n.inputTypes$$module$build$src$core$inputs$input_types.VALUE?$e=n.createElement$$module$build$src$core$utils$xml("value"):M.type===n.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&($e=n.createElement$$module$build$src$core$utils$xml("statement"));const Dt=M.connection.getShadowDom();!Dt||te&&te.isShadow()||$e.appendChild(Fc(Dt,o)),te&&(te=Ta(te,o),te.nodeType===eu.ELEMENT_NODE&&($e.appendChild(te),b=!1)),$e.setAttribute("name",M.name),b||c.appendChild($e)}}t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&c.setAttribute("inline",String(t.inputsInline)),t.isCollapsed()&&c.setAttribute("collapsed","true"),t.isEnabled()||c.setAttribute("disabled-reasons",Array.from(t.getDisabledReasons()).map(encodeURIComponent).join(",")),t.isOwnDeletable()||c.setAttribute("deletable","false"),t.isOwnMovable()||c.setAttribute("movable","false"),t.isOwnEditable()||c.setAttribute("editable","false"),$e=t.getNextBlock();let it;return $e&&(g=Ta($e,o),g.nodeType===eu.ELEMENT_NODE&&(it=n.createElement$$module$build$src$core$utils$xml("next"),it.appendChild(g),c.appendChild(it))),t=t.nextConnection&&t.nextConnection.getShadowDom(),!t||$e&&$e.isShadow()||it.appendChild(Fc(t,o)),c},Fc=function(t,o){let c=t=t.cloneNode(!0),g;for(;c;)if(o&&c.nodeName==="shadow"&&c.removeAttribute("id"),c.firstChild)c=c.firstChild;else{for(;c&&!c.nextSibling;){g=c,c=c.parentNode;let b;g.nodeType===eu.TEXT_NODE&&g.data.trim()===""&&((b=c)==null?void 0:b.firstChild)!==g&&W(g)}c&&(g=c,c=c.nextSibling,g.nodeType===eu.TEXT_NODE&&g.data.trim()===""&&W(g))}return t},Do=function(t){return an(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Ld=function(t){t=Do(t).split("<");let o="";for(let c=1;c<t.length;c++){const g=t[c];g[0]==="/"&&(o=o.substring(2)),t[c]=o+"<"+g,g[0]!=="/"&&g.slice(-2)!=="/>"&&(o+="  ")}return t=t.join(`
`),t=t.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),t.replace(/^\n/,"")},Nd=function(t,o){return o.setResizesEnabled(!1),o.clear(),t=n.domToWorkspace$$module$build$src$core$xml(t,o),o.setResizesEnabled(!0),t},n.domToWorkspace$$module$build$src$core$xml=function(t,o){let c=0;o.RTL&&(c=o.getWidth());const g=[];Qe();const b=n.getGroup$$module$build$src$core$events$utils();b||n.setGroup$$module$build$src$core$events$utils(!0),o.setResizesEnabled&&o.setResizesEnabled(!1);let M=!0;try{for(let te=0,$e;$e=t.childNodes[te];te++){const it=$e.nodeName.toLowerCase(),Dt=$e;if(it==="block"||it==="shadow"&&!y()){const Ni=Ql(Dt,o);g.push(Ni.id);let Mi;const vo=parseInt((Mi=Dt.getAttribute("x"))!=null?Mi:"10",10);let Nm;const xT=parseInt((Nm=Dt.getAttribute("y"))!=null?Nm:"10",10);isNaN(vo)||isNaN(xT)||Ni.moveBy(o.RTL?c-vo:vo,xT,["create"]),M=!1}else{if(it==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(it==="comment")kd(Dt,o);else if(it==="variables"){if(M)Kp(Dt,o);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");M=!1}}}}finally{n.setGroup$$module$build$src$core$events$utils(b),o.setResizesEnabled&&o.setResizesEnabled(!0),o.rendered&&An(),ht()}return $(new(k(lc))(o)),g},kd=function(t,o){var c;const g=(c=t.getAttribute("id"))!=null?c:void 0;c=o.rendered?new cy(o,g):new qE(o,g);var b;c.setText((b=t.textContent)!=null?b:"");var M;b=parseInt((M=t.getAttribute("x"))!=null?M:"",10);let te;M=parseInt((te=t.getAttribute("y"))!=null?te:"",10),isNaN(b)||isNaN(M)||(b=o.RTL?o.getWidth()-b:b,c.moveTo(new At(b,M)));var $e;o=parseInt(($e=t.getAttribute("w"))!=null?$e:"",10);let it;return $e=parseInt((it=t.getAttribute("h"))!=null?it:"",10),isNaN(o)||isNaN($e)||c.setSize(new Kn(o,$e)),t.getAttribute("collapsed")==="true"&&c.setCollapsed(!0),t.getAttribute("editable")==="false"&&c.setEditable(!1),t.getAttribute("movable")==="false"&&c.setMovable(!1),t.getAttribute("deletable")==="false"&&c.setDeletable(!1),c},Ju=function(t,o){if(!o.getBlocksBoundingBox)return n.domToWorkspace$$module$build$src$core$xml(t,o);var c=o.getBlocksBoundingBox();if(t=n.domToWorkspace$$module$build$src$core$xml(t,o),c&&c.top!==c.bottom){var g=c.bottom;c=o.RTL?c.right:c.left;var b=1/0;let M=-1/0,te=1/0;for(let $e=0;$e<t.length;$e++){const it=o.getBlockById(t[$e]).getRelativeToSurfaceXY();it.y<te&&(te=it.y),it.x<b&&(b=it.x),it.x>M&&(M=it.x)}for(g=g-te+10,c=o.RTL?c-M:c-b,b=0;b<t.length;b++)o.getBlockById(t[b]).moveBy(c,g,["create"])}return t},n.domToBlock$$module$build$src$core$xml=function(t,o){return t=Ql(t,o),o.rendered&&An(),t},Ql=function(t,o){n.disable$$module$build$src$core$events$utils();var c=o.getAllVariables();let g;try{if(g=Zp(t,o),o.rendered){const b=g,M=g.getDescendants(!1);b.setConnectionTracking(!1);for(let te=M.length-1;0<=te;te--)M[te].initSvg();for(let te=M.length-1;0<=te;te--)M[te].queueRender();setTimeout(function(){b.disposed||b.setConnectionTracking(!0)},1),o.resizeContents()}else{const b=g.getDescendants(!1);for(let M=b.length-1;0<=M;M--)b[M].initModel()}}finally{n.enable$$module$build$src$core$events$utils()}if(x()){for(t=zn(o,c),o=0;o<t.length;o++)c=t[o],$(new(k(ya))(c));$(new(k(n.CREATE$$module$build$src$core$events$utils))(g))}return g},Kp=function(t,o){for(let g=0;g<t.children.length;g++){var c=t.children[g];const b=c.getAttribute("type"),M=c.getAttribute("id");if(c=c.textContent,!c)break;o.createVariable(c,b,M)}},T_=function(t){const o={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let c=0;c<t.children.length;c++){const g=t.children[c];if(g.nodeType!==eu.TEXT_NODE)switch(g.nodeName.toLowerCase()){case"mutation":o.mutation.push(g);break;case"comment":o.comment.push(g);break;case"data":o.data.push(g);break;case"title":case"field":o.field.push(g);break;case"value":case"statement":o.input.push(g);break;case"next":o.next.push(g);break;default:console.warn("Ignoring unknown tag: "+g.nodeName)}}return o},v_=function(t,o){let c=!1;for(let g=0;g<t.length;g++){const b=t[g];o.domToMutation&&(o.domToMutation(b),o.initSvg&&(c=!0))}return c},Jp=function(t,o){for(let g=0;g<t.length;g++){var c=t[g];const b=c.textContent,M=c.getAttribute("pinned")==="true";let te;const $e=parseInt((te=c.getAttribute("w"))!=null?te:"50",10);let it;c=parseInt((it=c.getAttribute("h"))!=null?it:"50",10),o.setCommentText(b);const Dt=o.getIcon(wr.COMMENT);isNaN($e)||isNaN(c)||Dt.setBubbleSize(new Kn($e,c)),Dt.setBubbleVisible(M),setTimeout(()=>Dt.setBubbleVisible(M),1)}},E_=function(t,o){for(let c=0;c<t.length;c++)o.data=t[c].textContent},y_=function(t,o){for(let c=0;c<t.length;c++){const g=t[c],b=g.getAttribute("name");b?b_(o,b,g):console.warn(`Ignoring unnamed field in block ${o.type}`)}},S_=function(t){let o=null,c=null;for(let g=0;g<t.childNodes.length;g++){const b=t.childNodes[g];qp(b)&&(b.nodeName.toLowerCase()==="block"?o=b:b.nodeName.toLowerCase()==="shadow"&&(c=b))}return{childBlockElement:o,childShadowElement:c}},$_=function(t,o,c,g){for(let M=0;M<t.length;M++){var b=t[M];const te=b.getAttribute("name"),$e=te?c.getInput(te):null;if(!$e){console.warn("Ignoring non-existent input "+te+" in block "+g);break}if(b=S_(b),b.childBlockElement){if(!$e.connection)throw TypeError("Input connection does not exist.");Zp(b.childBlockElement,o,$e.connection,!1)}if(b.childShadowElement){let it;(it=$e.connection)==null||it.setShadowDom(b.childShadowElement)}}},GE=function(t,o,c){for(let g=0;g<t.length;g++){const b=S_(t[g]);if(b.childBlockElement){if(!c.nextConnection)throw TypeError("Next statement does not exist.");if(c.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Zp(b.childBlockElement,o,c.nextConnection,!0)}b.childShadowElement&&c.nextConnection&&c.nextConnection.setShadowDom(b.childShadowElement)}},Zp=function(t,o,c,g){var b;const M=t.getAttribute("type");if(!M)throw TypeError("Block type unspecified: "+t.outerHTML);var te=(b=t.getAttribute("id"))!=null?b:void 0;b=o.newBlock(M,te),te=T_(t);const $e=v_(te.mutation,b);if(Jp(te.comment,b),E_(te.data,b),c)if(g)if(b.previousConnection)c.connect(b.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(b.outputConnection)c.connect(b.outputConnection);else if(b.previousConnection)c.connect(b.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(y_(te.field,b),$_(te.input,o,b,M),GE(te.next,o,b),$e&&b.initSvg(),(o=t.getAttribute("inline"))&&b.setInputsInline(o==="true"),(o=t.getAttribute("disabled"))&&b.setDisabledReason(o==="true"||o==="disabled",ba),o=t.getAttribute("disabled-reasons"),o!==null)for(var it of o.split(","))b.setDisabledReason(!0,decodeURIComponent(it));if((it=t.getAttribute("deletable"))&&b.setDeletable(it==="true"),(it=t.getAttribute("movable"))&&b.setMovable(it==="true"),(it=t.getAttribute("editable"))&&b.setEditable(it==="true"),(it=t.getAttribute("collapsed"))&&b.setCollapsed(it==="true"),t.nodeName.toLowerCase()==="shadow"){for(t=b.getChildren(!1),it=0;it<t.length;it++)if(!t[it].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");b.setShadow(!0)}return b},b_=function(t,o,c){const g=t.getField(o);g?g.fromXml(c):console.warn("Ignoring non-existent field "+o+" in block "+t.type)},A_=function(t){for(let o=0;o<t.childNodes.length;o++){const c=t.childNodes[o];if(c.nodeName.toLowerCase()==="next"){t.removeChild(c);break}}},qp=function(t){return t.nodeType===eu.ELEMENT_NODE},Pd=function(t){if(!(100<t.getDescendants(!1).length)){var o=t.workspace,c=t.getSvgRoot();o.getAudioManager().play("delete");var g=t.getRelativeToSurfaceXY(),b=c.cloneNode(!0);b.setAttribute("transform","translate("+g.x+","+g.y+")");var M;(M=o.getLayerManager())==null||M.appendToAnimationLayer({getSvgRoot:()=>b}),Zu(b,{x:g.x,y:g.y,width:t.width,height:t.height},o.RTL,new Date)}},Zu=function(t,o,c,g){const b=(new Date().getTime()-g.getTime())/150;1<b?W(t):(t.setAttribute("transform","translate("+(o.x+(c?-1:1)*o.width/2*b)+","+(o.y+o.height/2*b)+") scale("+(1-b)+")"),setTimeout(Zu,10,t,o,c,g))},Qp=function(t){var o=t.workspace;const c=o.scale;if(o.getAudioManager().play("click"),!(1>c)){var g=o.getSvgXY(t.getSvgRoot());t.outputConnection?(g.x+=(t.RTL?3:-3)*c,g.y+=13*c):t.previousConnection&&(g.x+=(t.RTL?-23:23)*c,g.y+=3*c);var b=ve(Xe.CIRCLE,{cx:g.x,cy:g.y,r:0,fill:"none",stroke:"#888","stroke-width":10},o.getParentSvg());t=ve(Xe.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*c},b),o=ve(Xe.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},b),t.beginElement(),o.beginElement(),setTimeout(()=>void W(b),150)}},C_=function(t){if(ec(),t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var o=t.getHeightWidth().height;o=Math.atan(10/o)/Math.PI*180,t.RTL||(o*=-1),pT=t,R_(t,o,new Date)}},R_=function(t,o,c){const g=(new Date().getTime()-c.getTime())/200;let b="";1>=g&&(b=`skewX(${Math.round(Math.sin(g*Math.PI*3)*(1-g)*o)})`,uy=setTimeout(R_,10,t,o,c)),t.getSvgRoot().setAttribute("transform",`${t.getTranslation()} ${b}`)},ec=function(){pT&&(uy&&(clearTimeout(uy),uy=null),pT.getSvgRoot().setAttribute("transform",pT.getTranslation()),pT=null)},nl=function(t){return t.getRelativeToSurfaceXY!==void 0&&t.isMovable!==void 0&&t.startDrag!==void 0&&t.drag!==void 0&&t.endDrag!==void 0&&t.revertDrag!==void 0},il=function(t,o){for(const c in o)t[c]=o[c]!==null&&typeof o[c]=="object"?il(t[c]||Object.create(null),o[c]):o[c];return t},rl=function(t){return t.getProcedureModel!==void 0&&t.doProcedureUpdate!==void 0&&t.isProcedureDef!==void 0},Dd=function(t){return t.startPublishing!==void 0&&t.stopPublishing!==void 0},Bo=function(t,o){r(yt.FIELD,t,o)},x_=function(t){a(yt.FIELD,t)},n.fromJson$$module$build$src$core$field_registry=function(t){return o1.fromJsonInternal(t)},w_=function(t){const o=h(yt.FIELD,t.type);return o?o.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Fo=function(t){let o=!1;const c=t.map(([te,$e])=>typeof te=="string"?[Ei(te),$e]:(o=!0,[te.alt!==null?Object.assign({},te,{alt:Ei(te.alt)}):Object.assign({},te),$e]));if(o||2>t.length)return{options:c};var g=c.map(([te])=>te),b=Lc(g);t=zl(g,b);const M=Wl(g,b);return!t&&!M||b<=t+M?{options:c}:(b=t?g[0].substring(0,t-1):void 0,g=M?g[0].substr(1-M):void 0,{options:M_(c,t,M),prefix:b,suffix:g})},M_=function(t,o,c){return t.map(([g,b])=>[g.substring(o,g.length-c),b])},Uc=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let o=!1;for(let c=0;c<t.length;c++){const g=t[c];Array.isArray(g)?typeof g[1]!="string"?(o=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option id must be a string. Found "+g[1]+" in: ",g)):g[0]&&typeof g[0]!="string"&&typeof g[0].src!="string"&&(o=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must have a string label or image description. Found"+g[0]+" in: ",g)):(o=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must be an array. Found: ",g))}if(o)throw TypeError("Found invalid FieldDropdown options.")},n.register$$module$build$src$core$extensions=function(t,o){if(typeof t!="string"||t.trim()==="")throw Error('Error: Invalid extension name "'+t+'"');if(Am[t])throw Error('Error: Extension "'+t+'" is already registered.');if(typeof o!="function")throw Error('Error: Extension "'+t+'" must be a function');Am[t]=o},n.registerMixin$$module$build$src$core$extensions=function(t,o){if(!o||typeof o!="object")throw Error('Error: Mixin "'+t+'" must be a object');n.register$$module$build$src$core$extensions(t,function(){this.mixin(o)})},n.registerMutator$$module$build$src$core$extensions=function(t,o,c,g){const b='Error when registering mutator "'+t+'": ';fs(b,o);const M=O_(o,b);if(c&&typeof c!="function")throw Error(b+'Extension "'+t+'" is not a function');n.register$$module$build$src$core$extensions(t,function(){M&&this.setMutator(new n.MutatorIcon$$module$build$src$core$icons$mutator_icon(g||[],this)),this.mixin(o),c&&c.apply(this)})},qu=function(t){Qu(t)?delete Am[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},Qu=function(t){return!!Am[t]},Gc=function(t,o,c){const g=Am[t];if(typeof g!="function")throw Error('Error: Extension "'+t+'" not found.');let b;if(c?I_(t,o):b=Rr(o),g.apply(o),c)fs('Error after applying mutator "'+t+'": ',o);else if(!L_(b,o))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},I_=function(t,o){if(Rr(o).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+o.id)},eh=function(t,o){return em(t.mutationToDom,t.domToMutation,o+" mutationToDom/domToMutation")},Gr=function(t,o){return em(t.saveExtraState,t.loadExtraState,o+" saveExtraState/loadExtraState")},O_=function(t,o){return em(t.compose,t.decompose,o+" compose/decompose")},em=function(t,o,c){if(t&&o){if(typeof t!="function"||typeof o!="function")throw Error(c+" must be a function");return!0}if(!t&&!o)return!1;throw Error(c+"Must have both or neither functions")},fs=function(t,o){const c=eh(o,t),g=Gr(o,t);if(!c&&!g)throw Error(t+"Mutations must contain either XML hooks, or JSON hooks, or both");O_(o,t)},Rr=function(t){const o=[];return t.domToMutation!==void 0&&o.push(t.domToMutation),t.mutationToDom!==void 0&&o.push(t.mutationToDom),t.saveExtraState!==void 0&&o.push(t.saveExtraState),t.loadExtraState!==void 0&&o.push(t.loadExtraState),t.compose!==void 0&&o.push(t.compose),t.decompose!==void 0&&o.push(t.decompose),o},L_=function(t,o){if(o=Rr(o),o.length!==t.length)return!1;for(let c=0;c<o.length;c++)if(t[c]!==o[c])return!1;return!0},N_=function(t){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")t();else{const o=setInterval(function(){document.readyState==="complete"&&(clearInterval(o),t())},10)}},n.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,o){const c=[];return function(){c.includes(this.type)||(k_(this,t,o),c.push(this.type)),this.setTooltip((function(){const g=String(this.getFieldValue(t));return Ei(o[g])}).bind(this))}},k_=function(t,o,c){var g=t.getField(o);if(g instanceof uc&&!g.isOptionListDynamic()){g=g.getOptions();for(const[,b]of g)c[b]===void 0&&console.warn(`No tooltip mapping for value ${b} of field ${o} of block type ${t.type}.`)}},n.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,o){return function(){this.setTooltip((function(){const c=this.getField(o);return Ei(t).replace("%1",c?c.getText():"")}).bind(this))}},P_=function(){const t=this.tooltip;this.setTooltip((function(){const o=this.getParent();return o&&o.getInputsInline()&&o.tooltip||t}).bind(this))},sl=function(t,o,c,g){t=t+" was deprecated in "+o+" and will be deleted in "+c+".",g&&(t+=`
Use `+g+" instead."),l1.has(t)||(l1.add(t),console.warn(t))},Wt=function(t,o){return" "+t+","+o+" "},ps=function(t,o){return" "+t+o.join("")},Ji=function(t,o){return" M "+t+","+o+" "},yi=function(t,o){return" m "+t+","+o+" "},Uo=function(t,o){return" l "+t+","+o+" "},ol=function(t){return" l"+t.join("")},Nt=function(t,o){return" "+t+" "+o+" "},Di=function(t,o,c,g){return t+" "+c+" "+c+" "+o+g},Bd=function(t,o){r(yt.ICON,t.toString(),o)},D_=function(t){a(yt.ICON,t)},Fd=function(t){const o=t.getProcedureMap().getProcedures().filter(g=>!g.getReturnTypes()).map(g=>[g.getName(),g.getParameters().map(b=>b.getName()),!1]);t.getBlocksByType("procedures_defnoreturn",!1).forEach(g=>{!rl(g)&&Ct(g)&&o.push(g.getProcedureDef())});const c=t.getProcedureMap().getProcedures().filter(g=>!!g.getReturnTypes()).map(g=>[g.getName(),g.getParameters().map(b=>b.getName()),!0]);return t.getBlocksByType("procedures_defreturn",!1).forEach(g=>{!rl(g)&&Ct(g)&&c.push(g.getProcedureDef())}),o.sort(th),c.sort(th),[o,c]},th=function(t,o){return t[0].localeCompare(o[0],void 0,{sensitivity:"base"})},n.findLegalName$$module$build$src$core$procedures=function(t,o){if(o.isInFlyout)return t;for(t=t||n.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!B_(t,o.workspace,o);){const c=t.match(/^(.*?)(\d+)$/);t=c?c[1]+(parseInt(c[2])+1):t+"2"}return t},B_=function(t,o,c){return!Ud(t,o,c)},Ud=function(t,o,c){for(const g of o.getAllBlocks(!1))if(g!==c&&Ct(g)&&n.Names$$module$build$src$core$names.equals(g.getProcedureDef()[0],t))return!0;c=c&&rl(c)?c==null?void 0:c.getProcedureModel():void 0;for(const g of o.getProcedureMap().getProcedures())if(g!==c&&n.Names$$module$build$src$core$names.equals(g.getName(),t))return!0;return!1},n.rename$$module$build$src$core$procedures=function(t){var o=this.getSourceBlock();if(!o)throw new ur;t=t.trim();const c=n.findLegalName$$module$build$src$core$procedures(t,o);rl(o)&&!o.isInsertionMarker()&&o.getProcedureModel().setName(c);const g=this.getValue();if(g!==t&&g!==c)for(t=o.workspace.getAllBlocks(!1),o=0;o<t.length;o++){const b=t[o];b.renameProcedure&&b.renameProcedure(g,c)}return c},Gd=function(t){function o(M,te){for(let it=0;it<M.length;it++){var $e=M[it][0];const Dt=M[it][1],Ni=n.createElement$$module$build$src$core$utils$xml("block");Ni.setAttribute("type",te),Ni.setAttribute("gap","16");const Mi=n.createElement$$module$build$src$core$utils$xml("mutation");for(Mi.setAttribute("name",$e),Ni.appendChild(Mi),$e=0;$e<Dt.length;$e++){const vo=n.createElement$$module$build$src$core$utils$xml("arg");vo.setAttribute("name",Dt[$e]),Mi.appendChild(vo)}c.push(Ni)}}const c=[];if(Ns.procedures_defnoreturn){var g=n.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type","procedures_defnoreturn"),g.setAttribute("gap","16");var b=n.createElement$$module$build$src$core$utils$xml("field");b.setAttribute("name","NAME"),b.appendChild(n.createTextNode$$module$build$src$core$utils$xml(n.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),g.appendChild(b),c.push(g)}return Ns.procedures_defreturn&&(g=n.createElement$$module$build$src$core$utils$xml("block"),g.setAttribute("type","procedures_defreturn"),g.setAttribute("gap","16"),b=n.createElement$$module$build$src$core$utils$xml("field"),b.setAttribute("name","NAME"),b.appendChild(n.createTextNode$$module$build$src$core$utils$xml(n.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),g.appendChild(b),c.push(g)),Ns.procedures_ifreturn&&(g=n.createElement$$module$build$src$core$utils$xml("block"),g.setAttribute("type","procedures_ifreturn"),g.setAttribute("gap","16"),c.push(g)),c.length&&c[c.length-1].setAttribute("gap","24"),t=Fd(t),o(t[0],"procedures_callnoreturn"),o(t[1],"procedures_callreturn"),c},Go=function(t){var o=[],c=t.getBlocksByType("procedures_mutatorarg",!1);for(let M=0,te;te=c[M];M++)o.push(te.getFieldValue("NAME"));c=n.createElement$$module$build$src$core$utils$xml("xml");const g=n.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type","procedures_mutatorarg");const b=n.createElement$$module$build$src$core$utils$xml("field");b.setAttribute("name","NAME"),o=qt(n.DEFAULT_ARG$$module$build$src$core$procedures,o),o=n.createTextNode$$module$build$src$core$utils$xml(o),b.appendChild(o),g.appendChild(b),c.appendChild(g),t.updateToolbox(c)},F_=function(t){if(t.type===Sa&&t.bubbleType==="mutator"&&t.isOpen&&t.blockId){t=U(t.workspaceId).getBlockById(t.blockId);var o=t.type;(o==="procedures_defnoreturn"||o==="procedures_defreturn")&&(t=t.getIcon(n.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Go(t),t.addChangeListener(HE))}},HE=function(t){(t.type===n.CREATE$$module$build$src$core$events$utils||t.type===n.DELETE$$module$build$src$core$events$utils||t.type===n.CHANGE$$module$build$src$core$events$utils||t.type===Kc)&&(t=U(t.workspaceId),Go(t))},nh=function(t,o){return o.getAllBlocks(!1).filter(c=>tc(c,t)||wt(c)&&n.Names$$module$build$src$core$names.equals(c.getProcedureCall(),t))},tc=function(t,o){return rl(t)&&!t.isProcedureDef()&&t.getProcedureModel()&&n.Names$$module$build$src$core$names.equals(t.getProcedureModel().getName(),o)},n.mutateCallers$$module$build$src$core$procedures=function(t){const o=y();var c=t.getProcedureDef()[0];const g=t.mutationToDom(!0);t=nh(c,t.workspace);for(let M=0,te;te=t[M];M++){c=(c=te.mutationToDom())&&an(c),te.domToMutation&&te.domToMutation(g);var b=te.mutationToDom();b=b&&an(b),c!==b&&(n.setRecordUndo$$module$build$src$core$events$utils(!1),$(new(k(n.CHANGE$$module$build$src$core$events$utils))(te,"mutation",null,c,b)),n.setRecordUndo$$module$build$src$core$events$utils(o))}},n.getDefinition$$module$build$src$core$procedures=function(t,o){for(const c of o.getAllBlocks(!1))if(rl(c)&&c.isProcedureDef()&&n.Names$$module$build$src$core$names.equals(c.getProcedureModel().getName(),t)||Ct(c)&&n.Names$$module$build$src$core$names.equals(c.getProcedureDef()[0],t))return c;return null},tm=function(t){return t.isDynamic},kt=function(t){return t.pathDown!==void 0&&t.pathUp!==void 0},Hd=function(t){return t.pathLeft!==void 0&&t.pathRight!==void 0},nm=function(t,o){if(!t||!o)throw Error("Cannot connect null connections.");t.targetConnection=o,o.targetConnection=t},U_=function(t,o){let c=null;o=o.outputConnection;const g=o==null?void 0:o.getConnectionChecker();for(let b=0,M;M=t.inputList[b];b++){const te=M.connection;let $e;if(te&&(($e=g)!=null&&$e.canConnect(o,te,!1))){if(c)return null;c=te}}return c},VE=function(t,o){let c;for(;c=U_(t,o);)if(t=c.targetBlock(),!t||t.isShadow())return c;return null},al=function(t){return t.getType!==void 0&&t.initView!==void 0&&t.dispose!==void 0&&t.getWeight!==void 0&&t.getSize!==void 0&&t.applyColour!==void 0&&t.hideForInsertionMarker!==void 0&&t.updateEditable!==void 0&&t.updateCollapsed!==void 0&&t.isShownWhenCollapsed!==void 0&&t.setOffsetInBlock!==void 0&&t.onLocationChange!==void 0&&t.onClick!==void 0},ih=function(t){return al(t)&&Te(t)&&us(t)&&t.setText!==void 0&&t.getText!==void 0&&t.setBubbleSize!==void 0&&t.getBubbleSize!==void 0&&t.getType()===wr.COMMENT},Hc=function(t){let o=t.outputConnection;return(!o||t.previousConnection&&t.previousConnection.isConnected())&&(o=t.previousConnection),o},rh=function(t,o){r(yt.RENDERER,t,o)},G_=function(t){a(yt.RENDERER,t)},im=function(t,o,c){return t=new(d(yt.RENDERER,t))(t),t.init(o,c),t},rm=function(t){Ft(t.getTargetWorkspace(),void 0,"String")},sm=function(t){Ft(t.getTargetWorkspace(),void 0,"Number")},om=function(t){Ft(t.getTargetWorkspace(),void 0,"Colour")},sh=function(t){let o=[],c=document.createElement("button");return c.setAttribute("text",n.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),o.push(c),c=document.createElement("button"),c.setAttribute("text",n.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),o.push(c),c=document.createElement("button"),c.setAttribute("text",n.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),o.push(c),t.registerButtonCallback("CREATE_VARIABLE_STRING",rm),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",sm),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",om),t=Vd(t),o=o.concat(t)},Vd=function(t){t=t.getAllVariables();const o=[];if(0<t.length){if(Ns.variables_set_dynamic){var c=t[t.length-1];const g=n.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type","variables_set_dynamic"),g.setAttribute("gap","24"),g.appendChild(Rn(c)),o.push(g)}if(Ns.variables_get_dynamic){t.sort(sT.compareByName);for(let g=0,b;b=t[g];g++)c=n.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","variables_get_dynamic"),c.setAttribute("gap","8"),c.appendChild(Rn(b)),o.push(c)}}return o},H_=function(t,o){const c=t.workspace,g=n.config$$module$build$src$core$config.snapRadius,b=At.difference(o,t.getRelativeToSurfaceXY()),M=new At(0,0),te=c.getAllBlocks(!1).filter($e=>$e.id!=t.id).map($e=>$e.getRelativeToSurfaceXY());for(;am(At.sum(o,M),te)||zd(t,At.sum(b,M),g);)c.RTL?M.translate(-g,2*g):M.translate(g,2*g);t.moveTo(At.sum(o,M))},am=function(t,o){return o.some(c=>1>=Math.abs(c.x-t.x)&&1>=Math.abs(c.y-t.y))},zd=function(t,o,c){return t.getConnections_(!1).some(g=>!!g.closest(c,o).connection)},oh=function(t,o,c){const g=c.getBoundingRectangle(),b=g.right-g.left,M=Et(o.top,g.top,o.top+o.height-(g.bottom-g.top))-g.top;let te=o.left;return o=o.left+o.width-b,t.RTL?te=Math.min(o,te):o=Math.max(te,o),(t=Et(te,g.left,o)-g.left)||M?(c.moveBy(t,M,["inbounds"]),!0):!1},V_=function(t){return o=>{var c=t.getMetricsManager();if(c.hasFixedEdges()&&!t.isDragging()){var g;if(Eh.includes((g=o.type)!=null?g:"")){g=c.getScrollMetrics(!0);const b=z_(t,o);b&&(c=n.getGroup$$module$build$src$core$events$utils()||!1,n.setGroup$$module$build$src$core$events$utils(o.group),oh(t,g,b)&&!o.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),n.setGroup$$module$build$src$core$events$utils(c))}else o.type===Vo&&o.scale&&o.oldScale&&o.scale>o.oldScale&&Wd(t)}}},z_=function(t,o){let c=null;switch(o.type){case n.CREATE$$module$build$src$core$events$utils:case n.MOVE$$module$build$src$core$events$utils:(c=t.getBlockById(o.blockId))&&(c=c.getRootBlock());break;case zo:case $a:c=t.getCommentById(o.commentId)}return c},Wd=function(t){var o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging()){o=o.getScrollMetrics(!0);var c=t.getTopBoundedElements();for(let g=0,b;b=c[g];g++)oh(t,o,b)}},qs=function(t){return t.isDeletable!==void 0&&t.dispose!==void 0&&t.setDeleteStyle!==void 0},W_=function(t){const o=t.toCopyData();aA=o;let c;return lA=(c=t.workspace)!=null?c:null,o},Ho=function(t,o,c){return t&&o?ah(t,o,c):aA&&lA?ah(aA,lA):null},ah=function(t,o,c){let g;o=(g=o.getRootWorkspace())!=null?g:o;let b,M;return(M=(b=h(yt.PASTER,t.paster,!1))==null?void 0:b.paste(t,o,c))!=null?M:null},Xd=function(t){const o=t.toCopyData();return o?Ho(o,t.workspace):null},nc=function(t){return t.toCopyData!==void 0},lh=function(){ri.registry.register({name:fc.ESCAPE,preconditionFn(t){return!t.options.readOnly},callback(t){return t.hideChaff(),!0},keyCodes:[On.ESC]})},Vc=function(){ri.registry.register({name:fc.DELETE,preconditionFn(t){const o=ue();return!t.options.readOnly&&o!=null&&qs(o)&&o.isDeletable()&&!nu.inProgress()},callback(t,o){return o.preventDefault(),t=ue(),t instanceof Ia?t.checkAndDelete():qs(t)&&t.isDeletable()&&(n.setGroup$$module$build$src$core$events$utils(!0),t.dispose(),n.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[On.DELETE,On.BACKSPACE]})},jd=function(){const t=ri.registry.createSerializedKey(On.C,[On.CTRL]),o=ri.registry.createSerializedKey(On.C,[On.ALT]),c=ri.registry.createSerializedKey(On.C,[On.META]);ri.registry.register({name:fc.COPY,preconditionFn(g){const b=ue();return!g.options.readOnly&&!nu.inProgress()&&b!=null&&qs(b)&&b.isDeletable()&&nl(b)&&b.isMovable()&&nc(b)},callback(g,b){return b.preventDefault(),g.hideChaff(),b=ue(),!b||!nc(b)?!1:(Rh=b.toCopyData(),xh=g,Im=nl(b)?b.getRelativeToSurfaceXY():null,!!Rh)},keyCodes:[t,o,c]})},Yd=function(){const t=ri.registry.createSerializedKey(On.X,[On.CTRL]),o=ri.registry.createSerializedKey(On.X,[On.ALT]),c=ri.registry.createSerializedKey(On.X,[On.META]);ri.registry.register({name:fc.CUT,preconditionFn(g){const b=ue();return!g.options.readOnly&&!nu.inProgress()&&b!=null&&qs(b)&&b.isDeletable()&&nl(b)&&b.isMovable()&&!b.workspace.isFlyout},callback(g){const b=ue();return b instanceof Ia?(Rh=b.toCopyData(),xh=g,Im=b.getRelativeToSurfaceXY(),b.checkAndDelete(),!0):qs(b)&&b.isDeletable()&&nc(b)?(Rh=b.toCopyData(),xh=g,Im=nl(b)?b.getRelativeToSurfaceXY():null,b.dispose(),!0):!1},keyCodes:[t,o,c]})},Kd=function(){const t=ri.registry.createSerializedKey(On.V,[On.CTRL]),o=ri.registry.createSerializedKey(On.V,[On.ALT]),c=ri.registry.createSerializedKey(On.V,[On.META]);ri.registry.register({name:fc.PASTE,preconditionFn(g){return!g.options.readOnly&&!nu.inProgress()},callback(){if(!Rh||!xh)return!1;if(!Im)return!!Ho(Rh,xh);const{left:g,top:b,width:M,height:te}=xh.getMetricsManager().getViewMetrics(!0);if(new Si(b,b+te,g,g+M).contains(Im.x,Im.y))return!!Ho(Rh,xh);const $e=new At(g+M/2,b+te/2);return!!Ho(Rh,xh,$e)},keyCodes:[t,o,c]})},lm=function(){const t=ri.registry.createSerializedKey(On.Z,[On.CTRL]),o=ri.registry.createSerializedKey(On.Z,[On.ALT]),c=ri.registry.createSerializedKey(On.Z,[On.META]);ri.registry.register({name:fc.UNDO,preconditionFn(g){return!g.options.readOnly&&!nu.inProgress()},callback(g,b){return g.hideChaff(),g.undo(!1),b.preventDefault(),!0},keyCodes:[t,o,c]})},Jd=function(){const t=ri.registry.createSerializedKey(On.Z,[On.SHIFT,On.CTRL]),o=ri.registry.createSerializedKey(On.Z,[On.SHIFT,On.ALT]),c=ri.registry.createSerializedKey(On.Z,[On.SHIFT,On.META]),g=ri.registry.createSerializedKey(On.Y,[On.CTRL]);ri.registry.register({name:fc.REDO,preconditionFn(b){return!nu.inProgress()&&!b.options.readOnly},callback(b,M){return b.hideChaff(),b.undo(!0),M.preventDefault(),!0},keyCodes:[t,o,c,g]})},X_=function(){lh(),Vc(),jd(),Yd(),Kd(),lm(),Jd()},ch=function(t){const o=t.saveState();return t.getParameters().length&&(o.parameters=t.getParameters().map(c=>c.saveState())),o},Zd=function(t,o,c,g){if(t=t.loadState(c,g),!c.parameters)return t;for(const[b,M]of c.parameters.entries())t.insertParameter(o.loadState(M,g),b);return t},Wi=function(t){const o=Object.create(null),c=f(yt.SERIALIZER,!0);for(const g in c){let b;const M=(b=c[g])==null?void 0:b.save(t);M&&(o[g]=M)}return o},xn=function(t,o,{recordUndo:c=!1}={}){var g=f(yt.SERIALIZER,!0);if(g){g=Object.entries(g).sort((M,te)=>te[1].priority-M[1].priority);var b=y();n.setRecordUndo$$module$build$src$core$events$utils(c),(c=n.getGroup$$module$build$src$core$events$utils())||n.setGroup$$module$build$src$core$events$utils(!0),Qe(),o instanceof Ma&&o.setResizesEnabled(!1);for(const[,M]of g.reverse()){let te;(te=M)==null||te.clear(o)}for(const[M,te]of g.reverse())if(t[M]){let $e;($e=te)==null||$e.load(t[M],o)}o instanceof Ma&&o.setResizesEnabled(!0),ht(),$(new(k(lc))(o)),n.setGroup$$module$build$src$core$events$utils(c),n.setRecordUndo$$module$build$src$core$events$utils(b)}},Zi=function(t,o){let c=null;c=typeof t=="string"?document.getElementById(t)||document.querySelector(t):t;var g;if(!document.contains(c)&&document!==((g=c)==null?void 0:g.ownerDocument))throw Error("Error: container is not in current document");t=new Ra(o||{}),g=document.createElement("div"),Me(g,"injectionDiv"),o!=null&&o.rtl&&Me(g,"blocklyRTL"),g.tabIndex=0,vi(g,Wr.LABEL,n.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),c.appendChild(g),o=qi(g,t);const b=xr(g,o,t);return Is(b),de(b),Z(b),g.addEventListener("focusin",function(){de(b)}),b},qi=function(t,o){t.setAttribute("dir","LTR"),Je(o.hasCss,o.pathToMedia),t=ve(Xe.SVG,{xmlns:eT,"xmlns:html":cc,"xmlns:xlink":Wo,version:"1.1",class:"blocklySvg",tabindex:"0"},t);const c=ve(Xe.DEFS,{},t),g=String(Math.random()).substring(2);return o.gridPattern=kb.createDom(g,o.gridOptions,c),t},xr=function(t,o,c){c.parentWorkspace=null,c=new Ma(c);const g=c.options;c.scale=g.zoomOptions.startScale,o.appendChild(c.createDom("blocklyMainBackground",t));var b=c.getRenderer().getClassName();return b&&Me(t,b),(b=c.getTheme().getClassName())&&Me(t,b),!g.hasCategories&&g.languageTree&&(t=c.addFlyout(Xe.SVG),ot(t,o)),g.hasTrashcan&&c.addTrashcan(),g.zoomOptions&&g.zoomOptions.controls&&c.addZoomControls(),c.getThemeManager().subscribe(o,"workspaceBackgroundColour","background-color"),c.translate(0,0),c.addChangeListener(V_(c)),Z(c),Md(),_n(),bd(),c},Is=function(t){const o=t.options;var c=t.getParentSvg();if(Ye(c.parentNode,"contextmenu",null,function(g){Ge(g)||g.preventDefault()}),c=Ye(window,"resize",null,function(){ga(),t.hideComponents(!0),Vp(),p_(),Z(t),Wd(t)}),t.setResizeHandlerWrapper(c),ar(),o.languageTree){c=t.getToolbox();const g=t.getFlyout(!0);c?c.init():g&&(g.init(t),g.show(o.languageTree),typeof g.scrollToStart=="function"&&g.scrollToStart())}o.hasTrashcan&&t.trashcan.init(),o.zoomOptions&&o.zoomOptions.controls&&t.zoomControls_.init(),o.moveOptions&&o.moveOptions.scrollbars?(t.scrollbar=new uA(t,o.moveOptions.scrollbars===!0||!!o.moveOptions.scrollbars.horizontal,o.moveOptions.scrollbars===!0||!!o.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),o.hasSounds&&uh(o.pathToMedia,t)},zc=function(t){const o=ne();o&&!(Ge(t)||o.rendered&&!o.isVisible())&&ri.registry.onKeyDown(o,t)},ar=function(){z1||(Ye(document,"scroll",null,function(){const t=ce();for(let o=0,c;c=t[o];o++)c instanceof Ma&&c.updateInverseScreenCTM()}),Ye(document,"keydown",null,zc),we(document,"touchend",null,Ae),we(document,"touchcancel",null,Ae),Q_&&Ye(window,"orientationchange",document,function(){Z(ne())})),z1=!0},uh=function(t,o){function c(){for(;b.length;){const M=b.pop();M&&Q(M)}g.preload()}const g=o.getAudioManager();g.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),g.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),g.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");const b=[];b.push(Ye(document,"pointermove",null,c,!0)),b.push(Ye(document,"touchstart",null,c,!0))},ic=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.UNDO},preconditionFn(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!1)},scopeType:wn.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},hh=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.REDO},preconditionFn(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!0)},scopeType:wn.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},qd=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(t){t.workspace.cleanUp()},scopeType:wn.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Wc=function(t,o){function c(M){b--,M.setCollapsed(t),b===0&&n.setGroup$$module$build$src$core$events$utils(!1)}let g=0,b=0;n.setGroup$$module$build$src$core$events$utils(!0);for(let M=0;M<o.length;M++){let te=o[M];for(;te;)b++,setTimeout(c.bind(null,te),g),te=te.getNextBlock(),g+=10}},is=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let o=0;o<t.length;o++){let c=t[o];for(;c;){if(!c.isCollapsed())return"enabled";c=c.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Wc(!0,t.workspace.getTopBlocks(!0))},scopeType:wn.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Qd=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let o=0;o<t.length;o++){let c=t[o];for(;c;){if(c.isCollapsed())return"enabled";c=c.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Wc(!1,t.workspace.getTopBlocks(!0))},scopeType:wn.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},ef=function(t,o){if(t.isDeletable())Array.prototype.push.apply(o,t.getDescendants(!1));else{t=t.getChildren(!1);for(let c=0;c<t.length;c++)ef(t[c],o)}},ll=function(t){const o=[];t=t.getTopBlocks(!0);for(let c=0;c<t.length;c++)ef(t[c],o);return o},rc=function(t,o){o?n.setGroup$$module$build$src$core$events$utils(o):(n.setGroup$$module$build$src$core$events$utils(!0),o=n.getGroup$$module$build$src$core$events$utils());const c=t.shift();c&&(c.isDeadOrDying()?rc(t,o):(c.dispose(!1,!0),setTimeout(rc,10,t,o))),n.setGroup$$module$build$src$core$events$utils(!1)},tf=function(){wn.registry.register({displayText(t){return t.workspace?(t=ll(t.workspace).length,t===1?n.Msg$$module$build$src$core$msg.DELETE_BLOCK:n.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)):""},preconditionFn(t){return t.workspace&&0<ll(t.workspace).length?"enabled":"disabled"},callback(t){if(t.workspace){t.workspace.cancelCurrentGesture();var o=ll(t.workspace);2>o.length?rc(o):qe(n.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(o.length)),function(c){c&&rc(o)})}},scopeType:wn.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},cl=function(){ic(),hh(),qd(),is(),Qd(),tf()},dh=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){if(t.block){var o=t.block.toCopyData();o&&Ho(o,t.block.workspace)}},scopeType:wn.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},va=function(){wn.registry.register({displayText(t){return t.block.hasIcon(su.TYPE)?n.Msg$$module$build$src$core$msg.REMOVE_COMMENT:n.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.comments&&!t.isCollapsed()&&t.isEditable()?"enabled":"hidden"},callback(t){t=t.block,t.hasIcon(su.TYPE)?t.setCommentText(null):t.setCommentText("")},scopeType:wn.ScopeType.BLOCK,id:"blockComment",weight:2})},fh=function(){wn.registry.register({displayText(t){return t.block.getInputsInline()?n.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:n.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(t){if(t=t.block,!t.isInFlyout&&t.isMovable()&&!t.isCollapsed()){for(let o=1;o<t.inputList.length;o++)if(!(t.inputList[o-1]instanceof wy||t.inputList[o]instanceof wy))return"enabled"}return"hidden"},callback(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:wn.ScopeType.BLOCK,id:"blockInline",weight:3})},Xc=function(){wn.registry.register({displayText(t){return t.block.isCollapsed()?n.Msg$$module$build$src$core$msg.EXPAND_BLOCK:n.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:wn.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},nf=function(){wn.registry.register({displayText(t){return t.block.hasDisabledReason(ba)?n.Msg$$module$build$src$core$msg.ENABLE_BLOCK:n.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(t){if(t=t.block,!t.isInFlyout&&t.workspace.options.disable&&t.isEditable()){var o=t.getDisabledReasons();return o=o.size>(o.has(ba)?1:0),t.getInheritedDisabled()||o?"disabled":"enabled"}return"hidden"},callback(t){t=t.block;const o=n.getGroup$$module$build$src$core$events$utils();o||n.setGroup$$module$build$src$core$events$utils(!0),t.setDisabledReason(!t.hasDisabledReason(ba),ba),n.setGroup$$module$build$src$core$events$utils(o)},scopeType:wn.ScopeType.BLOCK,id:"blockDisable",weight:5})},ph=function(){wn.registry.register({displayText(t){var o=t.block;return t=o.getDescendants(!1).length,(o=o.getNextBlock())&&(t-=o.getDescendants(!1).length),t===1?n.Msg$$module$build$src$core$msg.DELETE_BLOCK:n.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)},preconditionFn(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback(t){t.block&&t.block.checkAndDelete()},scopeType:wn.ScopeType.BLOCK,id:"blockDelete",weight:6})},mh=function(){wn.registry.register({displayText(){return n.Msg$$module$build$src$core$msg.HELP},preconditionFn(t){return t=t.block,(typeof t.helpUrl=="function"?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(t){t.block.showHelp()},scopeType:wn.ScopeType.BLOCK,id:"blockHelp",weight:7})},Hr=function(){wn.registry.register({displayText:()=>n.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(t){let o;return(o=t.comment)!=null&&o.isDeletable()?"enabled":"hidden"},callback(t){n.setGroup$$module$build$src$core$events$utils(!0);let o;(o=t.comment)==null||o.dispose(),n.setGroup$$module$build$src$core$events$utils(!1)},scopeType:wn.ScopeType.COMMENT,id:"commentDelete",weight:6})},Ea=function(){wn.registry.register({displayText:()=>n.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(t){let o;return(o=t.comment)!=null&&o.isMovable()?"enabled":"hidden"},callback(t){if(t.comment){var o=t.comment.toCopyData();o&&Ho(o,t.comment.workspace)}},scopeType:wn.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Os=function(){wn.registry.register({displayText:()=>n.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:()=>"enabled",callback:(t,o)=>{if(t=t.workspace){n.setGroup$$module$build$src$core$events$utils(!0);var c=new cy(t);c.setText(n.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),c.moveTo(rf(new At(o.clientX,o.clientY),t)),n.setSelected$$module$build$src$core$common(c),n.setGroup$$module$build$src$core$events$utils(!1)}},scopeType:wn.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},rf=function(t,o){var c=o.getInjectionDiv().getBoundingClientRect();return t=new At(t.x-c.left,t.y-c.top),c=o.getOriginOffsetInPixels(),t=At.difference(t,c),t.scale(1/o.scale),t},ms=function(){dh(),va(),fh(),Xc(),nf(),ph(),mh()},j_=function(){Ea(),Hr(),Os()},sf=function(){cl(),ms()},cm=function(t){return t.paste!==void 0},zE=function(t){return t.getSvgRoot!==void 0},ul=function(t){return typeof t.id=="string"&&t.workspace!==void 0&&t.select!==void 0&&t.unselect!==void 0},Y_=function(t){return t.isSelectable()},K_=function(t){ne().hideChaff(t)},Tt=Tt||{},Tt.scope={},Tt.ASSUME_ES5=!1,Tt.ASSUME_NO_NATIVE_MAP=!1,Tt.ASSUME_NO_NATIVE_SET=!1,Tt.SIMPLE_FROUND_POLYFILL=!1,Tt.ISOLATE_POLYFILLS=!1,Tt.FORCE_POLYFILL_PROMISE=!1,Tt.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Tt.defineProperty=Tt.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(t,o,c){return t==Array.prototype||t==Object.prototype||(t[o]=c.value),t},Tt.getGlobal=function(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof tp=="object"&&tp];for(var o=0;o<t.length;++o){var c=t[o];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")},Tt.global=Tt.getGlobal(this),Tt.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",Tt.TRUST_ES6_POLYFILLS=!Tt.ISOLATE_POLYFILLS||Tt.IS_SYMBOL_NATIVE,Tt.polyfills={},Tt.propertyToPolyfillSymbol={},Tt.POLYFILL_PREFIX="$jscp$",Tt.polyfill=function(t,o,c,g){o&&(Tt.ISOLATE_POLYFILLS?Tt.polyfillIsolated(t,o,c,g):Tt.polyfillUnisolated(t,o,c,g))},Tt.polyfillUnisolated=function(t,o,c,g){for(c=Tt.global,t=t.split("."),g=0;g<t.length-1;g++){var b=t[g];if(!(b in c))return;c=c[b]}t=t[t.length-1],g=c[t],o=o(g),o!=g&&o!=null&&Tt.defineProperty(c,t,{configurable:!0,writable:!0,value:o})},Tt.polyfillIsolated=function(t,o,c,g){var b=t.split(".");t=b.length===1,g=b[0],g=!t&&g in Tt.polyfills?Tt.polyfills:Tt.global;for(var M=0;M<b.length-1;M++){var te=b[M];if(!(te in g))return;g=g[te]}b=b[b.length-1],c=Tt.IS_SYMBOL_NATIVE&&c==="es6"?g[b]:null,o=o(c),o!=null&&(t?Tt.defineProperty(Tt.polyfills,b,{configurable:!0,writable:!0,value:o}):o!==c&&(Tt.propertyToPolyfillSymbol[b]===void 0&&(c=1e9*Math.random()>>>0,Tt.propertyToPolyfillSymbol[b]=Tt.IS_SYMBOL_NATIVE?Tt.global.Symbol(b):Tt.POLYFILL_PREFIX+c+"$"+b),Tt.defineProperty(g,Tt.propertyToPolyfillSymbol[b],{configurable:!0,writable:!0,value:o})))},Tt.underscoreProtoCanBeSet=function(){var t={a:!0},o={};try{return o.__proto__=t,o.a}catch{}return!1},Tt.setPrototypeOf=Tt.TRUST_ES6_POLYFILLS&&typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf:Tt.underscoreProtoCanBeSet()?function(t,o){if(t.__proto__=o,t.__proto__!==o)throw new TypeError(t+" is not extensible");return t}:null,Tt.arrayIteratorImpl=function(t){var o=0;return function(){return o<t.length?{done:!1,value:t[o++]}:{done:!0}}},Tt.arrayIterator=function(t){return{next:Tt.arrayIteratorImpl(t)}},Tt.makeIterator=function(t){var o=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];if(o)return o.call(t);if(typeof t.length=="number")return Tt.arrayIterator(t);throw Error(String(t)+" is not an iterable or ArrayLike")},Tt.generator={},Tt.generator.ensureIteratorResultIsObject_=function(t){if(!(t instanceof Object))throw new TypeError("Iterator result "+t+" is not an object")},Tt.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},Tt.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},Tt.generator.Context.prototype.stop_=function(){this.isRunning_=!1},Tt.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},Tt.generator.Context.prototype.next_=function(t){this.yieldResult=t},Tt.generator.Context.prototype.throw_=function(t){this.abruptCompletion_={exception:t,isException:!0},this.jumpToErrorHandler_()},Tt.generator.Context.prototype.return=function(t){this.abruptCompletion_={return:t},this.nextAddress=this.finallyAddress_},Tt.generator.Context.prototype.jumpThroughFinallyBlocks=function(t){this.abruptCompletion_={jumpTo:t},this.nextAddress=this.finallyAddress_},Tt.generator.Context.prototype.yield=function(t,o){return this.nextAddress=o,{value:t}},Tt.generator.Context.prototype.yieldAll=function(t,o){t=Tt.makeIterator(t);var c=t.next();if(Tt.generator.ensureIteratorResultIsObject_(c),c.done)this.yieldResult=c.value,this.nextAddress=o;else return this.yieldAllIterator_=t,this.yield(c.value,o)},Tt.generator.Context.prototype.jumpTo=function(t){this.nextAddress=t},Tt.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},Tt.generator.Context.prototype.setCatchFinallyBlocks=function(t,o){this.catchAddress_=t,o!=null&&(this.finallyAddress_=o)},Tt.generator.Context.prototype.setFinallyBlock=function(t){this.catchAddress_=0,this.finallyAddress_=t||0},Tt.generator.Context.prototype.leaveTryBlock=function(t,o){this.nextAddress=t,this.catchAddress_=o||0},Tt.generator.Context.prototype.enterCatchBlock=function(t){return this.catchAddress_=t||0,t=this.abruptCompletion_.exception,this.abruptCompletion_=null,t},Tt.generator.Context.prototype.enterFinallyBlock=function(t,o,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=t||0,this.finallyAddress_=o||0},Tt.generator.Context.prototype.leaveFinallyBlock=function(t,o){if(o=this.finallyContexts_.splice(o||0)[0],o=this.abruptCompletion_=this.abruptCompletion_||o){if(o.isException)return this.jumpToErrorHandler_();o.jumpTo!=null&&this.finallyAddress_<o.jumpTo?(this.nextAddress=o.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=t},Tt.generator.Context.prototype.forIn=function(t){return new Tt.generator.Context.PropertyIterator(t)},Tt.generator.Context.PropertyIterator=function(t){this.object_=t,this.properties_=[];for(var o in t)this.properties_.push(o);this.properties_.reverse()},Tt.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var t=this.properties_.pop();if(t in this.object_)return t}return null},Tt.generator.Engine_=function(t){this.context_=new Tt.generator.Context,this.program_=t},Tt.generator.Engine_.prototype.next_=function(t){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,t,this.context_.next_):(this.context_.next_(t),this.nextStep_())},Tt.generator.Engine_.prototype.return_=function(t){this.context_.start_();var o=this.context_.yieldAllIterator_;return o?this.yieldAllStep_("return"in o?o.return:function(c){return{value:c,done:!0}},t,this.context_.return):(this.context_.return(t),this.nextStep_())},Tt.generator.Engine_.prototype.throw_=function(t){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,t,this.context_.next_):(this.context_.throw_(t),this.nextStep_())},Tt.generator.Engine_.prototype.yieldAllStep_=function(t,o,c){try{var g=t.call(this.context_.yieldAllIterator_,o);if(Tt.generator.ensureIteratorResultIsObject_(g),!g.done)return this.context_.stop_(),g;var b=g.value}catch(M){return this.context_.yieldAllIterator_=null,this.context_.throw_(M),this.nextStep_()}return this.context_.yieldAllIterator_=null,c.call(this.context_,b),this.nextStep_()},Tt.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var t=this.program_(this.context_);if(t)return this.context_.stop_(),{value:t.value,done:!1}}catch(o){this.context_.yieldResult=void 0,this.context_.throw_(o)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(t=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,t.isException)throw t.exception;return{value:t.return,done:!0}}return{value:void 0,done:!0}},Tt.generator.Generator_=function(t){this.next=function(o){return t.next_(o)},this.throw=function(o){return t.throw_(o)},this.return=function(o){return t.return_(o)},this[Symbol.iterator]=function(){return this}},Tt.generator.createGenerator=function(t,o){return o=new Tt.generator.Generator_(new Tt.generator.Engine_(o)),Tt.setPrototypeOf&&t.prototype&&Tt.setPrototypeOf(o,t.prototype),o},Tt.asyncExecutePromiseGenerator=function(t){function o(g){return t.next(g)}function c(g){return t.throw(g)}return new Promise(function(g,b){function M(te){te.done?g(te.value):Promise.resolve(te.value).then(o,c).then(M,b)}M(t.next())})},Tt.asyncExecutePromiseGeneratorFunction=function(t){return Tt.asyncExecutePromiseGenerator(t())},Tt.asyncExecutePromiseGeneratorProgram=function(t){return Tt.asyncExecutePromiseGenerator(new Tt.generator.Generator_(new Tt.generator.Engine_(t)))},Tt.polyfill("globalThis",function(t){return t||Tt.global},"es_2020","es3"),Tt.polyfill("Array.prototype.includes",function(t){return t||function(o,c){var g=this;g instanceof String&&(g=String(g));var b=g.length;for(c=c||0,0>c&&(c=Math.max(c+b,0));c<b;c++){var M=g[c];if(M===o||Object.is(M,o))return!0}return!1}},"es7","es3"),Tt.initSymbol=function(){},Tt.iteratorPrototype=function(t){return t={next:t},t[Symbol.iterator]=function(){return this},t},Tt.iteratorFromArray=function(t,o){t instanceof String&&(t+="");var c=0,g=!1,b={next:function(){if(!g&&c<t.length){var M=c++;return{value:o(M,t[M]),done:!1}}return g=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b},Tt.polyfill("Array.prototype.values",function(t){return t||function(){return Tt.iteratorFromArray(this,function(o,c){return c})}},"es8","es3"),Tt.polyfill("Array.prototype.flat",function(t){return t||function(o){o=o===void 0?1:o;var c=[];return Array.prototype.forEach.call(this,function(g){Array.isArray(g)&&0<o?(g=Array.prototype.flat.call(g,o-1),c.push.apply(c,g)):c.push(g)}),c}},"es9","es5"),Tt.polyfill("Array.prototype.flatMap",function(t){return t||function(o,c){var g=[];return Array.prototype.forEach.call(this,function(b,M){b=o.call(c,b,M,this),Array.isArray(b)?g.push.apply(g,b):g.push(b)}),g}},"es9","es5"),Tt.owns=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},Tt.polyfill("Object.entries",function(t){return t||function(o){var c=[],g;for(g in o)Tt.owns(o,g)&&c.push([g,o[g]]);return c}},"es8","es3"),Tt.polyfill("Object.values",function(t){return t||function(o){var c=[],g;for(g in o)Tt.owns(o,g)&&c.push(o[g]);return c}},"es8","es3");var Ls=Object.create(null),WE={typeMap:Ls},of=Object.create(null),_o="default",yt=class{constructor(t){this.name=t}toString(){return this.name}};yt.CONNECTION_CHECKER=new yt("connectionChecker"),yt.CONNECTION_PREVIEWER=new yt("connectionPreviewer"),yt.CURSOR=new yt("cursor"),yt.EVENT=new yt("event"),yt.FIELD=new yt("field"),yt.INPUT=new yt("input"),yt.RENDERER=new yt("renderer"),yt.TOOLBOX=new yt("toolbox"),yt.THEME=new yt("theme"),yt.TOOLBOX_ITEM=new yt("toolboxItem"),yt.FLYOUTS_VERTICAL_TOOLBOX=new yt("flyoutsVerticalToolbox"),yt.FLYOUTS_HORIZONTAL_TOOLBOX=new yt("flyoutsHorizontalToolbox"),yt.METRICS_MANAGER=new yt("metricsManager"),yt.BLOCK_DRAGGER=new yt("blockDragger"),yt.SERIALIZER=new yt("serializer"),yt.ICON=new yt("icon"),yt.PASTER=new yt("paster");var hl={DEFAULT:_o,TEST_ONLY:WE};hl.Type=yt,hl.getAllItems=f,hl.getClass=d,hl.getClassFromOptions=p,hl.getObject=h,hl.hasItem=u,hl.register=r,hl.unregister=a;var Ns=Object.create(null),J_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Z_={genUid:()=>{const t=J_.length,o=[];for(let c=0;20>c;c++)o[c]=J_.charAt(Math.random()*t);return o.join("")}},jc=0,q_={TEST_ONLY:Z_};q_.genUid=v,q_.getNextUniqueId=m;var dl,Yc,Vr,Kc,ya,Jc,gh,af,sc,_h,lr,oc,Sa,Qs,fl,To,Vo,zo,ac,Th,$a,vh,lc,lf,Eh,Zc,um,_;dl="",Yc=!0,Vr=0,n.CREATE$$module$build$src$core$events$utils="create",n.CREATE$$module$build$src$core$events$utils,n.DELETE$$module$build$src$core$events$utils="delete",n.DELETE$$module$build$src$core$events$utils,n.CHANGE$$module$build$src$core$events$utils="change",n.CHANGE$$module$build$src$core$events$utils,Kc="block_field_intermediate_change",n.MOVE$$module$build$src$core$events$utils="move",n.MOVE$$module$build$src$core$events$utils,ya="var_create",Jc="var_delete",gh="var_rename",af="ui",sc="drag",_h="selected",lr="click",oc="marker_move",Sa="bubble_open",Qs="trashcan_open",fl="toolbox_item_select",To="theme_change",Vo="viewport_change",zo="comment_create",ac="comment_delete",Th="comment_change",$a="comment_move",vh="comment_collapse",lc="finished_loading",lf="ORPHANED_BLOCK",Eh=[n.CREATE$$module$build$src$core$events$utils,n.MOVE$$module$build$src$core$events$utils,zo,$a],Zc=[],um={FIRE_QUEUE:Zc,fireNow:S,fireInternal:E,setGroupInternal:I},_={BLOCK_CHANGE:n.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:n.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:n.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:sc,BLOCK_FIELD_INTERMEDIATE_CHANGE:Kc,BLOCK_MOVE:n.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:Sa,BUMP_EVENTS:Eh,CHANGE:n.CHANGE$$module$build$src$core$events$utils,CLICK:lr,COMMENT_CHANGE:Th,COMMENT_COLLAPSE:vh,COMMENT_CREATE:zo,COMMENT_DELETE:ac,COMMENT_MOVE:$a,CREATE:n.CREATE$$module$build$src$core$events$utils,DELETE:n.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:lc,MARKER_MOVE:oc,MOVE:n.MOVE$$module$build$src$core$events$utils,SELECTED:_h,TEST_ONLY:um,THEME_CHANGE:To,TOOLBOX_ITEM_SELECT:fl,TRASHCAN_OPEN:Qs,UI:af,VAR_CREATE:ya,VAR_DELETE:Jc,VAR_RENAME:gh,VIEWPORT_CHANGE:Vo},_.clearPendingUndo=C,_.disable=n.disable$$module$build$src$core$events$utils,_.disableOrphans=D,_.enable=n.enable$$module$build$src$core$events$utils,_.filter=A,_.fire=$,_.fromJson=F,_.get=k,_.getDescendantIds=O,_.getGroup=n.getGroup$$module$build$src$core$events$utils,_.getRecordUndo=y,_.isEnabled=x,_.setGroup=n.setGroup$$module$build$src$core$events$utils,_.setRecordUndo=n.setRecordUndo$$module$build$src$core$events$utils;var T=Object.create(null),R,w=null,P,H=[],Se={defineBlocksWithJsonArrayInternal:me},De={TEST_ONLY:Se};De.createBlockDefinitionsFromJsonArray=n.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,De.defineBlocks=n.defineBlocks$$module$build$src$core$common,De.defineBlocksWithJsonArray=Y,De.draggingConnections=H,De.getAllWorkspaces=ce,De.getBlockTypeCounts=K,De.getMainWorkspace=ne,De.getParentContainer=Re,De.getSelected=ue,De.getWorkspaceById=U,De.registerWorkspace=re,De.setMainWorkspace=de,De.setParentContainer=G,De.setSelected=n.setSelected$$module$build$src$core$common,De.svgResize=Z,De.unregisterWorkpace=ae;var dt=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=n.getGroup$$module$build$src$core$events$utils(),this.recordUndo=y()}toJson(){return{type:this.type,group:this.group}}static fromJson(t,o,c){return c.isBlank=!1,c.group=t.group||"",c.workspaceId=o.id,c}isNull(){return!1}run(t){}getEventWorkspace_(){let t;if(this.workspaceId&&(t=U(this.workspaceId)),!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t}},Rt=class extends dt{constructor(t){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof t>"u",this.workspaceId=t||""}},Gt=class extends Rt{constructor(t,o,c){o=t?t.workspace.id:o,o===null&&(o=void 0),super(o),this.type=lr,this.blockId=t?t.id:void 0,this.targetType=c}toJson(){const t=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return t.targetType=this.targetType,t.blockId=this.blockId,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Gt),o.targetType=t.targetType,o.blockId=t.blockId,o}},En;(function(t){t.BLOCK="block",t.WORKSPACE="workspace",t.ZOOM_CONTROLS="zoom_controls"})(En||(En={})),r(yt.EVENT,lr,Gt);var cn=750,gi="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Jt=null,Xi={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},gs=0,et={TOUCH_ENABLED:gi,TOUCH_MAP:Xi};et.checkTouchIdentifier=ut,et.clearTouchIdentifier=Ce,et.getTouchIdentifierFromEvent=We,et.longStart=fe,et.longStop=Ae,et.shouldHandleEvent=Ie;var ze,ct,Pt,en,Sn,Tn,Wn,_r,Yn,pl;(function(t){function o(g){return c.includes(g.toUpperCase())}ze=t;const c=ze.toUpperCase();ct=o("JavaFX"),Pt=o("WebKit"),en=o("Gecko")&&!Pt,Sn=o("Android"),t=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Tn=o("iPad")||o("Macintosh")&&0<t,Wn=o("iPhone")&&!Tn,_r=o("Macintosh"),Yn=Tn||Sn&&!o("Mobile")||o("Silk"),pl=!Yn&&(Wn||Sn)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var q$=ze,gI=ct,_I=en,Q$=Sn,Q_=Tn,TI=Wn,eb=_r,vI=pl,q2={ANDROID:Q$,GECKO:_I,IPAD:Q_,IPHONE:TI,JavaFx:gI,MAC:eb,MOBILE:vI,raw:q$},EI=40,yI=125,qc={};qc.bind=we,qc.conditionalBind=Ye,qc.getScrollDeltaPixels=Fe,qc.isRightButton=Oe,qc.isTargetInput=Ge,qc.mouseToSvg=Ve,qc.unbind=Q;var SI={};SI.removeElem=tt;var Qc=class{constructor(t){this.name_=t}toString(){return this.name_}};Qc.POSITIONABLE=new Qc("positionable"),Qc.DRAG_TARGET=new Qc("drag_target"),Qc.DELETE_AREA=new Qc("delete_area"),Qc.AUTOHIDEABLE=new Qc("autohideable");var zr=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(t,o){const c=t.component.id;if(!o&&this.componentData.has(c)){var g;throw Error('Plugin "'+c+'" with capabilities "'+((g=this.componentData.get(c))==null?void 0:g.capabilities)+'" already added.')}for(this.componentData.set(c,t),o=[],g=0;g<t.capabilities.length;g++){const b=String(t.capabilities[g]).toLowerCase();if(o.push(b),this.capabilityToComponentIds.has(b)){let M;(M=this.capabilityToComponentIds.get(b))==null||M.push(c)}else this.capabilityToComponentIds.set(b,[c])}this.componentData.get(c).capabilities=o}removeComponent(t){const o=this.componentData.get(t);if(o){for(let c=0;c<o.capabilities.length;c++){const g=String(o.capabilities[c]).toLowerCase();tt(this.capabilityToComponentIds.get(g),t)}this.componentData.delete(t)}}addCapability(t,o){if(!this.getComponent(t))throw Error('Cannot add capability, "'+o+'". Plugin "'+t+'" has not been added to the ComponentManager');if(this.hasCapability(t,o))console.warn('Plugin "'+t+'already has capability "'+o+'"');else{o=`${o}`.toLowerCase();var c;(c=this.componentData.get(t))==null||c.capabilities.push(o);var g;(g=this.capabilityToComponentIds.get(o))==null||g.push(t)}}removeCapability(t,o){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+o+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,o)?(o=`${o}`.toLowerCase(),tt(this.componentData.get(t).capabilities,o),tt(this.capabilityToComponentIds.get(o),t)):console.warn('Plugin "'+t+`doesn't have capability "`+o+'" to remove')}hasCapability(t,o){return o=`${o}`.toLowerCase(),this.componentData.has(t)&&this.componentData.get(t).capabilities.includes(o)}getComponent(t){let o;return(o=this.componentData.get(t))==null?void 0:o.component}getComponents(t,o){if(t=`${t}`.toLowerCase(),t=this.capabilityToComponentIds.get(t),!t)return[];const c=[];if(o){const g=[];t.forEach(b=>{g.push(this.componentData.get(b))}),g.sort(function(b,M){return b.weight-M.weight}),g.forEach(function(b){c.push(b.component)})}else t.forEach(g=>{c.push(this.componentData.get(g).component)});return c}};zr.Capability=Qc;var tb=!1,nb=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
  /* Drag surface disables events to not block the toolbox, so we have to
   * reenable them here for the cursor values to work. */
  pointer-events: auto;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
  height: 100%;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}

.blocklyBlockDragSurface, .blocklyAnimationLayer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 80;
  pointer-events: none;
}
`,ib={};ib.inject=Je,ib.register=Ue;var At=class{constructor(t,o){this.x=t,this.y=o}clone(){return new At(this.x,this.y)}scale(t){return this.x*=t,this.y*=t,this}translate(t,o){return this.x+=t,this.y+=o,this}static equals(t,o){return t===o?!0:t&&o?t.x===o.x&&t.y===o.y:!1}static distance(t,o){const c=t.x-o.x;return t=t.y-o.y,Math.sqrt(c*c+t*t)}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static difference(t,o){return new At(t.x-o.x,t.y-o.y)}static sum(t,o){return new At(t.x+o.x,t.y+o.y)}},eT="http://www.w3.org/2000/svg",cc="http://www.w3.org/1999/xhtml",Wo="http://www.w3.org/1999/xlink",eu;(function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE"})(eu||(eu={}));var ml=null,rb=0,XE=null,rs={HTML_NS:cc};rs.NodeType=eu,rs.SVG_NS=eT,rs.XLINK_NS=Wo,rs.addClass=Me,rs.createSvgElement=ve,rs.getFastTextWidth=He,rs.getFastTextWidthWithSizeString=St,rs.getTextWidth=ft,rs.hasClass=ee,rs.insertAfter=ot,rs.measureFontMetrics=L,rs.removeClass=oe,rs.removeClasses=vt,rs.removeNode=W,rs.setCssTransform=je,rs.startTextWidthCache=Qe,rs.stopTextWidthCache=ht;var Xe=class{constructor(t){this.tagName=t}toString(){return this.tagName}};Xe.ANIMATE=new Xe("animate"),Xe.CIRCLE=new Xe("circle"),Xe.CLIPPATH=new Xe("clipPath"),Xe.DEFS=new Xe("defs"),Xe.FECOMPOSITE=new Xe("feComposite"),Xe.FECOMPONENTTRANSFER=new Xe("feComponentTransfer"),Xe.FEFLOOD=new Xe("feFlood"),Xe.FEFUNCA=new Xe("feFuncA"),Xe.FEGAUSSIANBLUR=new Xe("feGaussianBlur"),Xe.FEPOINTLIGHT=new Xe("fePointLight"),Xe.FESPECULARLIGHTING=new Xe("feSpecularLighting"),Xe.FILTER=new Xe("filter"),Xe.FOREIGNOBJECT=new Xe("foreignObject"),Xe.G=new Xe("g"),Xe.IMAGE=new Xe("image"),Xe.LINE=new Xe("line"),Xe.PATH=new Xe("path"),Xe.PATTERN=new Xe("pattern"),Xe.POLYGON=new Xe("polygon"),Xe.RECT=new Xe("rect"),Xe.SVG=new Xe("svg"),Xe.TEXT=new Xe("text"),Xe.TSPAN=new Xe("tspan");var Si=class{constructor(t,o,c,g){this.top=t,this.bottom=o,this.left=c,this.right=g}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(t,o){return t>=this.left&&t<=this.right&&o>=this.top&&o<=this.bottom}intersects(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)}},Kn=class{constructor(t,o){this.width=t,this.height=o}static equals(t,o){return t===o?!0:t&&o?t.width===o.width&&t.height===o.height:!1}static max(t,o){return new Kn(Math.max(t.width,o.width),Math.max(t.height,o.height))}static min(t,o){return new Kn(Math.min(t.width,o.width),Math.min(t.height,o.height))}},$I={getSizeInternal:he},yh={TEST_ONLY:$I};yh.getBorderBox=Le,yh.getComputedStyle=be,yh.getContainerOffsetToScrollInto=N,yh.getPageOffset=nt,yh.getSize=X,yh.getViewportPageOffset=Ee,yh.scrollIntoContainerView=Be;var bI=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,AI=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Q2={XY_REGEX:bI,XY_STYLE_REGEX:AI},cf={TEST_ONLY:Q2};cf.getDocumentScroll=Ke,cf.getInjectionDivXY=ge,cf.getRelativeXY=j,cf.getViewportBBox=xe,cf.screenToWsCoordinates=gt,cf.wsToScreenCoordinates=$t;var cr=class{constructor(t,o,c,g,b){this.workspace=t,this.horizontal=o,this.oldHostMetrics=null,this.ratio=1,this.origin=new At(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new At(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=c||!1,this.margin=b!==void 0?b:cr.DEFAULT_SCROLLBAR_MARGIN,t="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),g&&(t+=" "+g),this.outerSvg=ve(Xe.SVG,{class:t}),g=ve(Xe.G,{},this.outerSvg),this.svgBackground=ve(Xe.RECT,{class:"blocklyScrollbarBackground"},g),t=Math.floor((cr.scrollbarThickness-5)/2),this.svgHandle=ve(Xe.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},g),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),ot(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),o?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=Ye(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=Ye(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const t=cr.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(t)),this.outerSvg.setAttribute("height",String(t)),this.svgHandle.setAttribute("height",String(t-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(t)),this.outerSvg.setAttribute("width",String(t)),this.svgHandle.setAttribute("width",String(t-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),Q(this.onMouseDownBarWrapper_),Q(this.onMouseDownHandleWrapper_),W(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength)}setHandleLength(t){this.handleLength=t,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength-this.handleLength)}setHandlePosition(t){this.handlePosition=t,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(t){this.scrollbarLength=t,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(t,o){this.position.x=t,this.position.y=o,je(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(t){!t&&(t=this.workspace.getMetrics(),!t)||this.oldHostMetrics&&cr.metricsAreEquivalent(t,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(t):this.resizeVertical(t),this.oldHostMetrics=t,this.updateMetrics())}requiresViewResize(t){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==t.viewWidth||this.oldHostMetrics.viewHeight!==t.viewHeight||this.oldHostMetrics.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics.absoluteTop!==t.absoluteTop:!0}resizeHorizontal(t){this.requiresViewResize(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)}resizeViewHorizontal(t){var o=t.viewWidth-2*this.margin;this.pair&&(o-=cr.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),o=t.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(o+=cr.scrollbarThickness),this.setPosition(o,t.absoluteTop+t.viewHeight-cr.scrollbarThickness-this.margin),this.resizeContentHorizontal(t)}resizeContentHorizontal(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*t.viewWidth/t.scrollWidth;o=this.constrainHandleLength(o),this.setHandleLength(o),o=t.scrollWidth-t.viewWidth;var c=this.scrollbarLength-this.handleLength;t=(t.viewLeft-t.scrollLeft)/o*c,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=c/o}}resizeVertical(t){this.requiresViewResize(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)}resizeViewVertical(t){let o=t.viewHeight-2*this.margin;this.pair&&(o-=cr.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),this.setPosition(this.workspace.RTL?t.absoluteLeft+this.margin:t.absoluteLeft+t.viewWidth-cr.scrollbarThickness-this.margin,t.absoluteTop+this.margin),this.resizeContentVertical(t)}resizeContentVertical(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*t.viewHeight/t.scrollHeight;o=this.constrainHandleLength(o),this.setHandleLength(o),o=t.scrollHeight-t.viewHeight;var c=this.scrollbarLength-this.handleLength;t=(t.viewTop-t.scrollTop)/o*c,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=c/o}}isVisible(){return this.isHandleVisible}setContainerVisible(t){const o=t!==this.containerVisible;this.containerVisible=t,o&&this.updateDisplay_()}setVisible(t){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(t)}setVisibleInternal(t){const o=t!==this.isVisible();this.isHandleVisible=t,o&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(t){if(this.workspace.markFocused(),Ce(),this.cleanUp(),Oe(t))t.stopPropagation();else{var o=Ve(t,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());o=this.horizontal?o.x:o.y;var c=ge(this.svgHandle);c=this.horizontal?c.x:c.y;var g=this.handlePosition,b=.95*this.handleLength;o<=c?g-=b:o>=c+this.handleLength&&(g+=b),this.setHandlePosition(this.constrainHandlePosition(g)),this.updateMetrics(),t.stopPropagation(),t.preventDefault()}}onMouseDownHandle(t){this.workspace.markFocused(),this.cleanUp(),Oe(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?t.clientX:t.clientY,this.onMouseUpWrapper_=Ye(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=Ye(document,"pointermove",this,this.onMouseMoveHandle),t.stopPropagation(),t.preventDefault())}onMouseMoveHandle(t){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?t.clientX:t.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Ce(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(Q(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(Q(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let t=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(t)&&(t=0),t}updateMetrics(){const t=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:t}):this.workspace.setMetrics({y:t})}set(t,o){this.setHandlePosition(this.constrainHandlePosition(t*this.ratio)),(o||o===void 0)&&this.updateMetrics()}setOrigin(t,o){this.origin=new At(t,o)}static metricsAreEquivalent(t,o){return t.viewWidth===o.viewWidth&&t.viewHeight===o.viewHeight&&t.viewLeft===o.viewLeft&&t.viewTop===o.viewTop&&t.absoluteTop===o.absoluteTop&&t.absoluteLeft===o.absoluteLeft&&t.scrollWidth===o.scrollWidth&&t.scrollHeight===o.scrollHeight&&t.scrollLeft===o.scrollLeft&&t.scrollTop===o.scrollTop}};cr.scrollbarThickness=gi?25:15,cr.DEFAULT_SCROLLBAR_MARGIN=.5;var jE={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},sb={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:YE,DOMParser:tT,XMLSerializer:nT}=globalThis;tT&&(jE=new tT),nT&&(sb=new nT);var CI="https://developers.google.com/blockly/xml",eG=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,hm={NAME_SPACE:CI};hm.createElement=n.createElement$$module$build$src$core$utils$xml,hm.createTextNode=n.createTextNode$$module$build$src$core$utils$xml,hm.domToText=an,hm.injectDependencies=un,hm.textToDom=n.textToDom$$module$build$src$core$utils$xml;var ob="categoryToolbox",RI="flyoutToolbox",Cn;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"})(Cn||(Cn={}));var xI={hasCategoriesInternal:Ti},Sh={};Sh.Position=Cn,Sh.TEST_ONLY=xI,Sh.convertFlyoutDefToJsonArray=Ci,Sh.convertToolboxDefToJson=fi,Sh.hasCategories=_i,Sh.isCategoryCollapsible=nn,Sh.parseToolboxTree=B;var tu;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"})(tu||(tu={}));var dm;(function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"})(dm||(dm={}));var $h;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN"})($h||($h={}));var uf={};uf.bumpDirection=$h,uf.bumpPositionRect=pe,uf.getCornerOppositeToolbox=_e,uf.getStartPositionRect=le,uf.horizontalPosition=dm,uf.verticalPosition=tu;var eo={width:96,height:124,url:"sprites.png"},wI=class{constructor(t){this.workspace=t,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=ve(Xe.G,{});const t=String(Math.random()).substring(2);return this.createZoomOutSvg(t),this.createZoomInSvg(t),this.workspace.isMovable()&&this.createZoomResetSvg(t),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[zr.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&W(this.svgGroup);for(const t of this.boundEvents)Q(t);this.boundEvents.length=0}getBoundingRectangle(){let t=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(t+=this.LARGE_SPACING+this.HEIGHT),new Si(this.top,this.top+t,this.left,this.left+this.WIDTH)}position(t,o){if(this.initialized){var c=_e(this.workspace,t),g=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(g+=this.LARGE_SPACING+this.HEIGHT),t=le(c,new Kn(this.WIDTH,g),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,t,this.workspace),c=c.vertical,o=pe(t,this.MARGIN_VERTICAL,c===tu.TOP?$h.DOWN:$h.UP,o),c===tu.TOP){var b=this.SMALL_SPACING+this.HEIGHT,M;(M=this.zoomInGroup)==null||M.setAttribute("transform","translate(0, "+b+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(b+this.LARGE_SPACING+this.HEIGHT)+")")}else{M=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let $e;($e=this.zoomInGroup)==null||$e.setAttribute("transform","translate(0, "+M+")"),M=M+this.SMALL_SPACING+this.HEIGHT,(b=this.zoomOutGroup)==null||b.setAttribute("transform","translate(0, "+M+")")}this.top=o.top,this.left=o.left;var te;(te=this.svgGroup)==null||te.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(t){this.zoomOutGroup=ve(Xe.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const o=ve(Xe.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup);ve(Xe.RECT,{width:32,height:32},o),ve(Xe.IMAGE,{width:eo.width,height:eo.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup).setAttributeNS(Wo,"xlink:href",this.workspace.options.pathToMedia+eo.url),this.boundEvents.push(Ye(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(t){this.zoomInGroup=ve(Xe.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const o=ve(Xe.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup);ve(Xe.RECT,{width:32,height:32},o),ve(Xe.IMAGE,{width:eo.width,height:eo.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup).setAttributeNS(Wo,"xlink:href",this.workspace.options.pathToMedia+eo.url),this.boundEvents.push(Ye(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(t,o){this.workspace.markFocused(),this.workspace.zoomCenter(t),this.fireZoomEvent(),Ce(),o.stopPropagation(),o.preventDefault()}createZoomResetSvg(t){this.zoomResetGroup=ve(Xe.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const o=ve(Xe.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup);ve(Xe.RECT,{width:32,height:32},o),ve(Xe.IMAGE,{width:eo.width,height:eo.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup).setAttributeNS(Wo,"xlink:href",this.workspace.options.pathToMedia+eo.url),this.boundEvents.push(Ye(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(t){this.workspace.markFocused();const o=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(o),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Ce(),t.stopPropagation(),t.preventDefault()}fireZoomEvent(){const t=new(k(lr))(null,this.workspace.id,"zoom_controls");$(t)}};Ue(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var iT="_TEMP_COLLAPSED_INPUT",KE="_TEMP_COLLAPSED_FIELD",ba="MANUALLY_DISABLED",tG={COLLAPSED_FIELD_NAME:KE,COLLAPSED_INPUT_NAME:iT,MANUALLY_DISABLED:ba},wr=class{constructor(t){this.name=t}toString(){return this.name}equals(t){return this.name===t.toString()}};wr.MUTATOR=new wr("mutator"),wr.WARNING=new wr("warning"),wr.COMMENT=new wr("comment"),function(t){t[t.VALUE=1]="VALUE",t[t.STATEMENT=3]="STATEMENT",t[t.DUMMY=5]="DUMMY",t[t.CUSTOM=6]="CUSTOM",t[t.END_ROW=7]="END_ROW"}(n.inputTypes$$module$build$src$core$inputs$input_types||(n.inputTypes$$module$build$src$core$inputs$input_types={})),n.inputTypes$$module$build$src$core$inputs$input_types;var MI=function(t,o){window.alert(t),o&&o()},II=function(t,o){o(window.confirm(t))},OI=function(t,o,c){c(window.prompt(t,o))},LI={confirmInternal:at},hf={TEST_ONLY:LI};hf.alert=ye,hf.confirm=qe,hf.prompt=pt,hf.setAlert=Ze,hf.setConfirm=rt,hf.setPrompt=ke;var ab,NI;n.Msg$$module$build$src$core$msg=Object.create(null),ab=function(t){Object.keys(t).forEach(function(o){n.Msg$$module$build$src$core$msg[o]=t[o]})},NI={Msg:n.Msg$$module$build$src$core$msg,setLocale:ab};var rT=class extends dt{constructor(t){super(),this.isBlank=typeof t>"u",t&&(this.varId=t.getId(),this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return t.varId=this.varId,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new rT),o.varId=t.varId,o}},lb=class extends rT{constructor(t){super(t),this.type=ya,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new lb),o.varType=t.varType,o.varName=t.varName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?o.createVariable(this.varName,this.varType,this.varId):o.deleteVariableById(this.varId)}};r(yt.EVENT,ya,lb);var sT=class{constructor(t,o,c,g){this.workspace=t,this.name=o,this.type=c||"",this.id_=g||v()}getId(){return this.id_}static compareByName(t,o){return t.name.localeCompare(o.name,void 0,{sensitivity:"base"})}},cb="VARIABLE",ub="ijkmnopqrstuvwxyzabcdefgh",kI={generateUniqueNameInternal:Ot},_s={CATEGORY_NAME:cb,TEST_ONLY:kI,VAR_LETTER_OPTIONS:ub};_s.allDeveloperVariables=n.allDeveloperVariables$$module$build$src$core$variables,_s.allUsedVarModels=n.allUsedVarModels$$module$build$src$core$variables,_s.createVariableButtonHandler=Ft,_s.flyoutCategory=Ht,_s.flyoutCategoryBlocks=Zt,_s.generateUniqueName=jt,_s.generateUniqueNameFromOptions=qt,_s.generateVariableFieldDom=Rn,_s.getAddedVariables=zn,_s.getOrCreateVariablePackage=n.getOrCreateVariablePackage$$module$build$src$core$variables,_s.getVariable=n.getVariable$$module$build$src$core$variables,_s.nameUsedWithAnyType=sn,_s.nameUsedWithConflictingParam=$n,_s.promptName=ln,_s.renameVariable=n.renameVariable$$module$build$src$core$variables;var JE=new Set,hb=new WeakSet,db=new WeakMap,fm=null,fb=null,PI=0,ZE={};ZE.finishQueuedRenders=Kt,ZE.queueRender=In,ZE.triggerQueuedRenders=An;var qE=class{constructor(t,o){this.workspace=t,this.text="",this.size=new Kn(120,100),this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new At(0,0),this.disposing=this.disposed=!1,this.id=o&&!t.getCommentById(o)?o:v(),t.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){x()&&$(new(k(zo))(this))}fireDeleteEvent(){x()&&$(new(k(ac))(this))}fireChangeEvent(t,o){x()&&$(new(k(Th))(this,t,o))}fireCollapseEvent(t){x()&&$(new(k(vh))(this,t))}setText(t){const o=this.text;this.text=t,this.fireChangeEvent(o,t)}getText(){return this.text}setSize(t){this.size=t}getSize(){return this.size}setCollapsed(t){this.collapsed=t,this.fireCollapseEvent(t)}isCollapsed(){return this.collapsed}setEditable(t){this.editable=t}isEditable(){return this.isOwnEditable()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setMovable(t){this.movable=t}isMovable(){return this.isOwnMovable()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setDeletable(t){this.deletable=t}isDeletable(){return this.isOwnDeletable()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}moveTo(t,o){const c=new(k($a))(this);o&&c.setReason(o),this.location=t,c.recordNew(),x()&&$(c)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},pm=50,pb=100,DI=class{constructor(t){this.workspace=t,this.size=new Kn(120,100),this.collapsed=!1,this.editable=!0,this.location=new At(0,0),this.text="",this.textChangeListeners=[],this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=ve(Xe.G,{class:"blocklyComment blocklyEditable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteIcon:this.deleteIcon,foldoutIcon:this.foldoutIcon,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot,t),{foreignObject:this.foreignObject,textArea:this.textArea}=this.createTextArea(this.svgRoot),this.resizeHandle=this.createResizeHandle(this.svgRoot,t);let o;(o=t.getLayerManager())==null||o.append(this,pm),this.setSize(this.size),this.moveTo(new At(0,0))}createHighlightRect(t){return ve(Xe.RECT,{class:"blocklyCommentHighlight"},t)}createTopBar(t,o){t=ve(Xe.G,{class:"blocklyCommentTopbar"},t);const c=ve(Xe.RECT,{class:"blocklyCommentTopbarBackground"},t),g=ve(Xe.IMAGE,{class:"blocklyDeleteIcon",href:`${o.options.pathToMedia}delete-icon.svg`},t);o=ve(Xe.IMAGE,{class:"blocklyFoldoutIcon",href:`${o.options.pathToMedia}foldout-icon.svg`},t);const b=ve(Xe.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},t),M=document.createTextNode("");return b.appendChild(M),Ye(o,"pointerdown",this,this.onFoldoutDown),Ye(g,"pointerdown",this,this.onDeleteDown),{topBarGroup:t,topBarBackground:c,deleteIcon:g,foldoutIcon:o,textPreview:b,textPreviewNode:M}}createTextArea(t){t=ve(Xe.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"},t);const o=document.createElementNS(cc,"body");o.setAttribute("xmlns",cc),o.className="blocklyMinimalBody";const c=document.createElementNS(cc,"textarea");return Me(c,"blocklyCommentText"),Me(c,"blocklyTextarea"),Me(c,"blocklyText"),o.appendChild(c),t.appendChild(o),Ye(c,"change",this,this.onTextChange),{foreignObject:t,textArea:c}}createResizeHandle(t,o){return t=ve(Xe.IMAGE,{class:"blocklyResizeHandle",href:`${o.options.pathToMedia}resize-handle.svg`},t),Ye(t,"pointerdown",this,this.onResizePointerDown),t}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSize(t){const o=this.topBarBackground.getBBox(),c=this.deleteIcon.getBBox(),g=this.foldoutIcon.getBBox(),b=this.textPreview.getBBox(),M=this.resizeHandle.getBBox();t=Kn.max(t,this.calcMinSize(o,g,c));const te=this.size;this.size=t,this.svgRoot.setAttribute("height",`${t.height}`),this.svgRoot.setAttribute("width",`${t.width}`),this.updateHighlightRect(t),this.updateTopBarSize(t),this.updateTextAreaSize(t,o),this.updateDeleteIconPosition(t,o,c),this.updateFoldoutIconPosition(o,g),this.updateTextPreviewSize(t,o,b,c,M),this.updateResizeHandlePosition(t,M),this.onSizeChange(te,this.size)}calcMinSize(t,o,c){var g;this.updateTextPreview((g=this.textArea.value)!=null?g:""),g=ft(this.textPreview);const b=this.calcFoldoutMargin(t,o),M=this.calcDeleteMargin(t,c);let te=g;return this.foldoutIcon.checkVisibility()?te+=o.width+2*b:g&&(te+=4),this.deleteIcon.checkVisibility()?te+=c.width+2*M:g&&(te+=4),new Kn(te,t.height+20)}calcDeleteMargin(t,o){return(t.height-o.height)/2}calcFoldoutMargin(t,o){return(t.height-o.height)/2}updateHighlightRect(t){this.highlightRect.setAttribute("height",`${t.height}`),this.highlightRect.setAttribute("width",`${t.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-t.width}`)}updateTopBarSize(t){this.topBarBackground.setAttribute("width",`${t.width}`)}updateTextAreaSize(t,o){this.foreignObject.setAttribute("height",`${t.height-o.height}`),this.foreignObject.setAttribute("width",`${t.width}`),this.foreignObject.setAttribute("y",`${o.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-t.width}`)}updateDeleteIconPosition(t,o,c){o=this.calcDeleteMargin(o,c),this.deleteIcon.setAttribute("y",`${o}`),this.deleteIcon.setAttribute("x",`${t.width-c.width-o}`)}updateFoldoutIconPosition(t,o){t=this.calcFoldoutMargin(t,o),this.foldoutIcon.setAttribute("y",`${t}`),this.foldoutIcon.setAttribute("x",`${t}`)}updateTextPreviewSize(t,o,c,g,b){const M=(o.height-c.height)/2,te=this.calcDeleteMargin(o,g);o=this.calcFoldoutMargin(o,b),t=t.width-b.width-2*o-g.width-2*te,this.textPreview.setAttribute("x",`${b.width+2*o*(this.workspace.RTL?-1:1)}`),this.textPreview.setAttribute("y",`${M+c.height/2}`),this.textPreview.setAttribute("width",`${t}`)}updateResizeHandlePosition(t,o){this.resizeHandle.setAttribute("y",`${t.height-o.height}`),this.resizeHandle.setAttribute("x",`${t.width-o.width}`)}onSizeChange(t,o){for(let c=this.sizeChangeListeners.length-1;0<=c;c--)this.sizeChangeListeners[c](t,o)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}removeSizeChangeListener(t){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(t),1)}onResizePointerDown(t){this.isEditable()&&(this.bringToFront(),Oe(t)||(this.workspace.startDrag(t,new At(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=Ye(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=Ye(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation())}onResizePointerUp(t){Ce(),this.resizePointerUpListener&&(Q(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Q(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Kn(this.workspace.RTL?-t.x:t.x,t.y))}isCollapsed(){return this.collapsed}setCollapsed(t){(this.collapsed=t)?Me(this.svgRoot,"blocklyCollapsed"):oe(this.svgRoot,"blocklyCollapsed"),this.setSize(this.size),this.onCollapse()}onCollapse(){for(let t=this.collapseChangeListeners.length-1;0<=t;t--)this.collapseChangeListeners[t](this.collapsed)}addOnCollapseListener(t){this.collapseChangeListeners.push(t)}removeOnCollapseListener(t){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(t),1)}onFoldoutDown(t){this.bringToFront(),Oe(t)||(this.setCollapsed(!this.collapsed),this.workspace.hideChaff()),t.stopPropagation()}isEditable(){return this.editable}setEditable(t){(this.editable=t)?(Me(this.svgRoot,"blocklyEditable"),oe(this.svgRoot,"blocklyReadonly"),this.textArea.removeAttribute("readonly")):(oe(this.svgRoot,"blocklyEditable"),Me(this.svgRoot,"blocklyReadonly"),this.textArea.setAttribute("readonly","true"))}getRelativeToSurfaceXY(){return this.location}moveTo(t){this.location=t,this.svgRoot.setAttribute("transform",`translate(${t.x}, ${t.y})`)}getText(){return this.text}setText(t){this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}removeTextChangeListener(t){this.textChangeListeners.splice(this.textChangeListeners.indexOf(t),1)}onTextChange(){const t=this.text;this.text=this.textArea.value,this.updateTextPreview(this.text),this.setSize(this.size);for(let o=this.textChangeListeners.length-1;0<=o;o--)this.textChangeListeners[o](t,this.text)}updateTextPreview(t){this.textPreviewNode.textContent=this.truncateText(t)}truncateText(t){return 12<=t.length?`${t.substring(0,9)}...`:t}bringToFront(){const t=this.svgRoot.parentNode,o=t.childNodes;o[o.length-1]!==this.svgRoot&&t.appendChild(this.svgRoot)}onDeleteDown(t){Oe(t)||this.dispose(),t.stopPropagation()}dispose(){this.disposing=!0,W(this.svgRoot);for(let t=this.disposeListeners.length-1;0<=t;t--)this.disposeListeners[t]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(t){this.disposeListeners.push(t)}removeDisposeListener(t){this.disposeListeners.splice(this.disposeListeners.indexOf(t),1)}};Ue(`
.injectionDiv {
  --commentFillColour: #FFFCC7;
  --commentBorderColour: #F2E49B;
}

.blocklyComment .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 1px solid var(--commentBorderColour);
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}

.blocklyReadonly.blocklyComment .blocklyTextarea {
  cursor: inherit;
}

.blocklyDeleteIcon {
  width: 20px;
  height: 20px;
  display: none;
  cursor: pointer;
}

.blocklyFoldoutIcon {
  width: 20px;
  height: 20px;
  transform-origin: 12px 12px;
  cursor: pointer;
}
.blocklyResizeHandle {
  width: 12px;
  height: 12px;
  cursor: se-resize;
}
.blocklyReadonly.blocklyComment .blocklyResizeHandle {
  cursor: inherit;
}

.blocklyCommentTopbarBackground {
  cursor: grab;
  fill: var(--commentBorderColour);
  height: 24px;
}

.blocklyComment .blocklyCommentPreview.blocklyText {
  fill: #000;
  dominant-baseline: middle;
  visibility: hidden;
}

.blocklyCollapsed.blocklyComment .blocklyCommentPreview {
  visibility: visible;
}

.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,
.blocklyCollapsed.blocklyComment .blocklyResizeHandle {
  display: none;
}

.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {
  transform: rotate(-90deg);
}

.blocklyRTL .blocklyCommentTopbar {
  transform: scale(-1, 1);
}

.blocklyRTL .blocklyCommentForeignObject {
  direction: rtl;
}

.blocklyRTL .blocklyCommentPreview {
  /* Revert the scale and control RTL using direction instead. */
  transform: scale(-1, 1);
  direction: rtl;
}

.blocklyRTL .blocklyResizeHandle {
  transform: scale(-1, 1);
  cursor: sw-resize;
}

.blocklyCommentHighlight {
  fill: none;
}

.blocklySelected .blocklyCommentHighlight {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {
  stroke: none;
}

.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {
  stroke: #fc3;
  stroke-width: 3px;
}
`);var BI=class{constructor(t){this.comment=t,this.startLoc=null,this.workspace=t.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.workspace.options.readOnly}startDrag(){n.getGroup$$module$build$src$core$events$utils()||n.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(t){this.comment.moveDuringDrag(t)}endDrag(){this.fireMoveEvent();let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.comment,pm),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0),n.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var t=new(k($a))(this.comment);t.setReason(["drag"]),t.oldCoordinate_=this.startLoc,t.recordNew(),$(t)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},FI=100,UI=75,GI=50,HI=25,nG={BLOCKS:GI,PROCEDURES:UI,VARIABLES:FI,WORKSPACE_COMMENTS:HI},mb={};mb.register=hi,mb.unregister=Rs;var VI=class{constructor(){this.priority=HI}save(t){const o=[];for(const c of t.getTopComments())(t=dn(c,{addCoordinates:!0,saveIds:!0}))&&o.push(t);return o.length?o:null}load(t,o){for(const c of t)Pr(c,o,{recordUndo:y()})}clear(t){for(const o of t.getTopComments())o.dispose()}};hi("workspaceComments",new VI);var QE={};QE.WorkspaceCommentSerializer=VI,QE.append=Pr,QE.save=dn;var gb={};gb.register=jn,gb.unregister=ts;var ey=class{paste(t,o,c){t=t.commentState,c&&(t.x=c.x,t.y=c.y),n.disable$$module$build$src$core$events$utils();let g;try{g=Pr(t,o),Dr(g)}finally{n.enable$$module$build$src$core$events$utils()}return g?(x()&&$(new(k(zo))(g)),n.setSelected$$module$build$src$core$common(g),g):null}};ey.TYPE="workspace-comment",jn(ey.TYPE,new ey);var _b;_b=28,n.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:_b,connectingSnapRadius:_b,currentConnectionPreference:8,bumpDelay:250},n.config$$module$build$src$core$config;var iG="aria-",rG="role",gl;(function(t){t.GRID="grid",t.GRIDCELL="gridcell",t.GROUP="group",t.LISTBOX="listbox",t.MENU="menu",t.MENUITEM="menuitem",t.MENUITEMCHECKBOX="menuitemcheckbox",t.OPTION="option",t.PRESENTATION="presentation",t.ROW="row",t.TREE="tree",t.TREEITEM="treeitem"})(gl||(gl={}));var Wr;(function(t){t.ACTIVEDESCENDANT="activedescendant",t.COLCOUNT="colcount",t.DISABLED="disabled",t.EXPANDED="expanded",t.INVALID="invalid",t.LABEL="label",t.LABELLEDBY="labelledby",t.LEVEL="level",t.ORIENTATION="orientation",t.POSINSET="posinset",t.ROWCOUNT="rowcount",t.SELECTED="selected",t.SETSIZE="setsize",t.VALUEMAX="valuemax",t.VALUEMIN="valuemin"})(Wr||(Wr={}));var oT={};oT.Role=gl,oT.State=Wr,oT.setRole=rn,oT.setState=vi;var Tb=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(t){this.menuItems.push(t)}render(t){const o=document.createElement("div");o.className="blocklyMenu goog-menu blocklyNonSelectable",o.tabIndex=0,this.roleName&&rn(o,this.roleName),this.element=o;for(let c=0,g;g=this.menuItems[c];c++)o.appendChild(g.createDom());return this.mouseOverHandler=Ye(o,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=Ye(o,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=Ye(o,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=Ye(o,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=Ye(o,"keydown",this,this.handleKeyEvent),t.appendChild(o),o}getElement(){return this.element}focus(){const t=this.getElement();t&&(t.focus({preventScroll:!0}),Me(t,"blocklyFocused"))}blur(){const t=this.getElement();t&&(t.blur(),oe(t,"blocklyFocused"))}setRole(t){this.roleName=t}dispose(){this.mouseOverHandler&&(Q(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(Q(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(Q(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(Q(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(Q(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t=0,o;o=this.menuItems[t];t++)o.dispose();this.element=null}getMenuItem(t){const o=this.getElement();for(;t&&t!==o;){if(t.classList.contains("blocklyMenuItem")){for(let c=0,g;g=this.menuItems[c];c++)if(g.getElement()===t)return g}t=t.parentElement}return null}setHighlighted(t){var o=this.highlightedItem;o&&(o.setHighlighted(!1),this.highlightedItem=null),t&&(t.setHighlighted(!0),this.highlightedItem=t,o=this.getElement(),Be(t.getElement(),o),vi(o,Wr.ACTIVEDESCENDANT,t.getId()))}highlightNext(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(t,1)}highlightPrevious(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>t?this.menuItems.length:t,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(t,o){t+=o;let c;for(;c=this.menuItems[t];){if(c.isEnabled()){this.setHighlighted(c);break}t+=o}}handleMouseOver(t){(t=this.getMenuItem(t.target))&&(t.isEnabled()?this.highlightedItem!==t&&this.setHighlighted(t):this.setHighlighted(null))}handleClick(t){const o=this.openingCoords;if(this.openingCoords=null,o&&typeof t.clientX=="number"){const c=new At(t.clientX,t.clientY);if(1>At.distance(o,c))return}(t=this.getMenuItem(t.target))&&t.performAction()}handleMouseEnter(t){this.focus()}handleMouseLeave(t){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(t){if(this.menuItems.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var o=this.highlightedItem;switch(t.key){case"Enter":case" ":o&&o.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}t.preventDefault(),t.stopPropagation()}}getSize(){const t=this.getElement(),o=X(t);return o.height=t.scrollHeight,o}},vb=class{constructor(t,o){this.content=t,this.opt_value=o,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const t=document.createElement("div");t.id=m(),this.element=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const o=document.createElement("div");if(o.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var c=document.createElement("div");c.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",o.appendChild(c)}return c=this.content,typeof this.content=="string"&&(c=document.createTextNode(this.content)),o.appendChild(c),t.appendChild(o),this.roleName&&rn(t,this.roleName),vi(t,Wr.SELECTED,this.checkable&&this.checked||!1),vi(t,Wr.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let t;return(t=this.opt_value)!=null?t:null}setRightToLeft(t){this.rightToLeft=t}setRole(t){this.roleName=t}setCheckable(t){this.checkable=t}setChecked(t){this.checked=t}setHighlighted(t){this.highlight=t;const o=this.getElement();o&&this.isEnabled()&&(t?(Me(o,"blocklyMenuItemHighlight"),Me(o,"goog-menuitem-highlight")):(oe(o,"blocklyMenuItemHighlight"),oe(o,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(t,o){this.actionHandler=t.bind(o)}},mm=class extends Error{},zI=class extends mm{constructor(t){super("Expected to find a 'type' property, defining the block type"),this.state=t}},aT=class extends mm{constructor(t,o,c){super(`The block ${o.toDevString()} is missing a(n) ${t}
connection`),this.block=o,this.state=c}},WI=class extends mm{constructor(t,o,c,g){super(`The block ${c.toDevString()} could not connect its
${o} to its parent, because: ${t}`),this.childBlock=c,this.childState=g}},XI=class extends mm{constructor(t){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=t}},jI=class extends mm{constructor(t,o,c){super(`Cannot add an icon of type '${t}' to the block ${o.toDevString()}, because there is no icon registered with type '${t}'. Make sure that all of your icons have been registered.`),this.block=o,this.state=c}},df={};df.BadConnectionCheck=WI,df.DeserializationError=mm,df.MissingBlockType=zI,df.MissingConnection=aT,df.RealChildOfShadow=XI,df.UnregisteredIcon=jI;var YI=class{constructor(){this.priority=GI}save(t){const o=[];for(const c of t.getTopBlocks(!1))(t=zi(c,{addCoordinates:!0,doFullSerialization:!1}))&&o.push(t);return o.length?{languageVersion:0,blocks:o}:null}load(t,o){t=t.blocks;for(const c of t)Ii(c,o,{recordUndo:y()})}clear(t){for(const o of t.getTopBlocks(!1))o.dispose(!1)}};hi("blocks",new YI);var lT={};lT.BlockSerializer=YI,lT.append=Ii,lT.appendInternal=fo,lT.save=zi;var ff=class extends dt{constructor(t){super(),this.isBlank=!t,t&&(this.blockId=t.id,this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.blockId=this.blockId,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new ff),o.blockId=t.blockId,o}},pf=class extends ff{constructor(t,o,c,g,b){super(t),this.type=n.CHANGE$$module$build$src$core$events$utils,t&&(this.element=o,this.name=c||void 0,this.oldValue=g,this.newValue=b)}toJson(){const t=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return t.element=this.element,t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,this.disabledReason&&(t.disabledReason=this.disabledReason),t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new pf),o.element=t.element,o.name=t.name,o.oldValue=t.oldValue,o.newValue=t.newValue,t.disabledReason!==void 0&&(o.disabledReason=t.disabledReason),o}setDisabledReason(t){if(this.element!=="disabled")throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=t}isNull(){return this.oldValue===this.newValue}run(t){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(o=o.getBlockById(this.blockId),!o)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const c=o.getIcon(wr.MUTATOR);switch(c&&Te(c)&&c.bubbleIsVisible()&&c.setBubbleVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(o=o.getField(this.name))?o.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":o.setCommentText(t||null);break;case"collapsed":o.setCollapsed(!!t);break;case"disabled":var g;o.setDisabledReason(!!t,(g=this.disabledReason)!=null?g:ba);break;case"inline":o.setInputsInline(!!t);break;case"mutation":g=pf.getExtraBlockState_(o),o.loadExtraState?o.loadExtraState(JSON.parse(t||"{}")):o.domToMutation&&o.domToMutation(n.textToDom$$module$build$src$core$utils$xml(t||"<mutation/>")),$(new pf(o,"mutation",null,g,t));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(t){return t.saveExtraState?(t=t.saveExtraState(!0))?JSON.stringify(t):"":t.mutationToDom&&(t=t.mutationToDom())?Do(t):""}};r(yt.EVENT,n.CHANGE$$module$build$src$core$events$utils,pf);var ty={};ty.clamp=Et,ty.toDegrees=lt,ty.toRadians=Ne;var cT=16,Eb=1,KI=12,yb=16,ny=.25,Sb=null,mf=null,gm="",_m="",ii,Tm,gf,$b=null,bh=null,JI=null,bb={getBoundsInfo:function(){const t=nt($b),o=X($b);return{left:t.x,right:t.x+o.width,top:t.y,bottom:t.y+o.height,width:o.width,height:o.height}},getPositionMetrics:function(t,o,c,g){const b=bb.getBoundsInfo(),M=X(ii);return o+M.height<b.bottom?Bu(t,o,b,M):g-M.height>b.top?Up(c,g,b,M):o+M.height<document.documentElement.clientHeight?Bu(t,o,b,M):g-M.height>document.documentElement.clientTop?Up(c,g,b,M):yd(t,b,M)}},ks={ANIMATION_TIME:ny,ARROW_HORIZONTAL_PADDING:KI,ARROW_SIZE:cT,BORDER_SIZE:Eb,PADDING_Y:yb,TEST_ONLY:bb};ks.clearContent=li,ks.createDom=_n,ks.getContentDiv=yn,ks.getOwner=Qt,ks.getPositionX=Fu,ks.hide=Oc,ks.hideIfOwner=Uu,ks.hideWithoutAnimation=No,ks.isVisible=Gp,ks.repositionForWindowResize=Vp,ks.setBoundsElement=fn,ks.setColour=ci,ks.show=fa,ks.showPositionedByBlock=br,ks.showPositionedByField=hs;var uT=class{constructor(t){this.workspace=t,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(t,o){this.markers.has(t)&&this.unregisterMarker(t),o.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,o)),this.setMarkerSvg(o.getDrawer().createDom()),this.markers.set(t,o)}unregisterMarker(t){const o=this.markers.get(t);if(o)o.dispose(),this.markers.delete(t);else throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(t){return this.markers.get(t)||null}setCursor(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(t){t?(this.workspace.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null}setMarkerSvg(t){t?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(t)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const t=Object.keys(this.markers);for(let o=0,c;c=t[o];o++)this.unregisterMarker(c);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};uT.LOCAL_MARKER="local_marker_1";var vm={};vm.commonWordPrefix=zl,vm.commonWordSuffix=Wl,vm.isNumber=n.isNumber$$module$build$src$core$utils$string,vm.shortestStringLength=Lc,vm.wrap=n.wrap$$module$build$src$core$utils$string;var iy=void 0,hT=!1,Em=!1,ZI=50,qI=0,_f=0,Ab=0,Cb=0,Aa=null,dT=null,Rb=0,xb=10,QI=10,e1=750,ry=5,Mr=null,Xo={HOVER_MS:e1,LIMIT:ZI,MARGINS:ry,OFFSET_X:Rb,OFFSET_Y:xb,RADIUS_OK:QI};Xo.bindMouseEvents=Ar,Xo.block=Ad,Xo.createDom=bd,Xo.dispose=zp,Xo.getCustomTooltip=pa,Xo.getDiv=jl,Xo.getTooltipOfObject=kc,Xo.hide=ga,Xo.isVisible=ma,Xo.setCustomTooltip=Xl,Xo.unbindMouseEvents=ns,Xo.unblock=Cd;var wb=.45,Mb=.65,t1={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Ca={};Ca.blend=ko,Ca.getHsvSaturation=Dc,Ca.getHsvValue=Xp,Ca.hexToRgb=Yl,Ca.hsvToHex=ds,Ca.hueToHex=Kl,Ca.names=t1,Ca.parse=mo,Ca.rgbToHex=Vu,Ca.setHsvSaturation=Rd,Ca.setHsvValue=d_;var fT={};fT.checkMessageReferences=f_,fT.parseBlockColour=Jl,fT.replaceMessageReferences=Ei,fT.tokenizeInterpolation=xd;var $i=class{constructor(t,o,c){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Kn(0,0),t!==$i.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(t),o&&this.setValidator(o))}configure_(t){t.tooltip&&this.setTooltip(Ei(t.tooltip))}setSourceBlock(t){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=t}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=ve(Xe.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel(),this.applyColour())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=ve(Xe.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=ve(Xe.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const t=this.getClickTarget_();if(!t)throw Error("A click target has not been set.");Ar(t),this.mouseDownWrapper_=Ye(t,"pointerdown",this,this.onMouseDown_)}fromXml(t){this.setValue(t.textContent)}toXml(t){return t.textContent=this.getValue(),t}saveState(t){return t=this.saveLegacyState($i),t!==null?t:this.getValue()}loadState(t){this.loadLegacyState($i,t)||this.setValue(t)}saveLegacyState(t){return t.prototype.saveState===this.saveState&&t.prototype.toXml!==this.toXml?(t=n.createElement$$module$build$src$core$utils$xml("field"),t.setAttribute("name",this.name||""),an(this.toXml(t)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(t,o){return t.prototype.loadState===this.loadState&&t.prototype.fromXml!==this.fromXml?(this.fromXml(n.textToDom$$module$build$src$core$utils$xml(o)),!0):!1}dispose(){Uu(this),go(this);let t;(t=this.getSourceBlock())!=null&&t.isDeadOrDying()||W(this.fieldGroup_),this.disposed=!0}updateEditable(){const t=this.fieldGroup_,o=this.getSourceBlock();this.EDITABLE&&t&&o&&(this.enabled_&&o.isEditable()?(Me(t,"blocklyEditableText"),oe(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(Me(t,"blocklyNonEditableText"),oe(t,"blocklyEditableText"),t.style.cursor=""))}setEnabled(t){this.enabled_=t,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==$i.prototype.showEditor_}isClickableInFlyout(t){return!t}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t}isVisible(){return this.visible_}setVisible(t){if(this.visible_!==t){this.visible_=t;var o=this.fieldGroup_;o&&(o.style.display=t?"block":"none")}}setValidator(t){this.validator_=t}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(t){this.isClickable()&&this.showEditor_(t)}showEditor_(t){}repositionForWindowResize(){return!1}updateSize_(t){const o=this.getConstants();t=t!==void 0?t:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let c=2*t,g=o.FIELD_TEXT_HEIGHT,b=0;this.textElement_&&(b=He(this.textElement_,o.FIELD_TEXT_FONTSIZE,o.FIELD_TEXT_FONTWEIGHT,o.FIELD_TEXT_FONTFAMILY),c+=b),this.isFullBlockField()||(g=Math.max(g,o.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=g,this.size_.width=c,this.positionTextElement_(t,b),this.positionBorderRect_()}positionTextElement_(t,o){if(this.textElement_){var c=this.getConstants(),g=this.size_.height/2,b;this.textElement_.setAttribute("x",String((b=this.getSourceBlock())!=null&&b.RTL?this.size_.width-o-t:t)),this.textElement_.setAttribute("y",String(c.FIELD_TEXT_BASELINE_CENTER?g:g-c.FIELD_TEXT_HEIGHT/2+c.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Kn(0,0)}getScaledBBox(){let t;var o=this.getSourceBlock();if(!o)throw new ur;if(this.isFullBlockField()){var c=this.sourceBlock_.getHeightWidth();const g=o.workspace.scale;t=this.getAbsoluteXY_(),o=(c.width+1)*g,c=(c.height+1)*g,_I?(t.x+=1.5*g,t.y+=1.5*g):(t.x-=.5*g,t.y-=.5*g)}else c=this.borderRect_.getBoundingClientRect(),t=nt(this.borderRect_),o=c.width,c=c.height;return new Si(t.y,t.y+c,t.x,t.x+o)}onLocationChange(t){}getDisplayText_(){let t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+""),t=t.replace(/\s/g,$i.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+=""),t):$i.NBSP}getText(){const t=this.getText_();return String(t!==null?t:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(t,o=!0){if(t!==null){var c=this.doClassValidation_(t);if(t=this.processValidation_(t,c,o),!(t instanceof Error)){var g;c=(g=this.getValidator())==null?void 0:g.call(this,t),g=this.processValidation_(t,c,o),g instanceof Error||(t=this.sourceBlock_,t&&t.disposed||(c=this.getValue(),c===g?this.doValueUpdate_(g):(this.doValueUpdate_(g),o&&t&&x()&&$(new(k(n.CHANGE$$module$build$src$core$events$utils))(t,"field",this.name||null,c,g)),this.isDirty_&&this.forceRerender())))}}}processValidation_(t,o,c){return o===null?(this.doValueInvalid_(t,c),this.isDirty_&&this.forceRerender(),Error()):o===void 0?t:o}getValue(){return this.value_}doClassValidation_(t){return t??null}doValueUpdate_(t){this.value_=t,this.isDirty_=!0}doValueInvalid_(t,o){}onMouseDown_(t){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)}setTooltip(t){t||t===""||(t=this.sourceBlock_);const o=this.getClickTarget_();o?o.tooltip=t:this.tooltip_=t}getTooltip(){const t=this.getClickTarget_();return kc(t||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return nt(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;const o=this.getSourceBlock();if(!o)throw new ur;const c=o.inputList;for(let g=0;g<o.inputList.length;g++){const b=c[g],M=b.fieldRow;for(let te=0;te<M.length;te++)if(M[te]===this){t=b;break}}return t}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(t){return!1}setCursorSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.cursorSvg_=t}else this.cursorSvg_=null}setMarkerSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.markerSvg_=t}else this.markerSvg_=null}updateMarkers_(){var t=this.getSourceBlock();if(!t)throw new ur;t=t.workspace,t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(uT.LOCAL_MARKER).draw()}static fromJson(t){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};$i.NBSP="",$i.SKIP_SETUP=Symbol("SKIP_SETUP");var ur=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},ym=null,Ib=null,sy=null,oy="blocklyWidgetDiv",Sm="",$m="",_l,Tl={};Tl.createDom=Md,Tl.getDiv=mi,Tl.hide=tl,Tl.hideIfOwner=go,Tl.hideIfOwnerIsInWorkspace=wi,Tl.isVisible=Ms,Tl.positionWithAnchor=or,Tl.repositionForWindowResize=p_,Tl.show=zu,Tl.testOnly_setDiv=wd;var ay=null,n1={},ly=null,Tf={};Tf.callbackFactory=n.callbackFactory$$module$build$src$core$contextmenu,Tf.dispose=ju,Tf.getCurrentBlock=Ur,Tf.hide=ql,Tf.setCurrentBlock=Od,Tf.show=Bc;var wn=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(t){if(this.registry_.has(t.id))throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_.set(t.id,t)}unregister(t){if(!this.registry_.has(t))throw Error('Menu item with ID "'+t+'" not found.');this.registry_.delete(t)}getItem(t){let o;return(o=this.registry_.get(t))!=null?o:null}getContextMenuOptions(t,o){const c=[];for(const b of this.registry_.values())if(t===b.scopeType){var g=b.preconditionFn(o);g!=="hidden"&&(g={text:typeof b.displayText=="function"?b.displayText(o):b.displayText,enabled:g==="enabled",callback:b.callback,scope:o,weight:b.weight},c.push(g))}return c.sort(function(b,M){return b.weight-M.weight}),c}};(function(t){var o=t.ScopeType||(t.ScopeType={});o.BLOCK="block",o.WORKSPACE="workspace",o.COMMENT="comment",t.registry=new t})(wn||(wn={})),wn.ScopeType;var cy=class extends qE{constructor(t,o){super(t,o),this.dragStrategy=new BI(this),this.workspace=t,this.view=new DI(t),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.addModelUpdateBindings(),Ye(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),Ye(this.view.getSvgRoot(),"wheel",this,c=>{c.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((t,o)=>void super.setText(o)),this.view.addSizeChangeListener((t,o)=>void super.setSize(o)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(t){this.view.setText(t)}setSize(t){this.view.setSize(t)}setCollapsed(t){this.view.setCollapsed(t)}setEditable(t){super.setEditable(t),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY();var o,c;const g=(c=(o=this.view)==null?void 0:o.getSize())!=null?c:this.getSize();return this.workspace.RTL?(o=t.x-g.width,c=t.x):(o=t.x,c=t.x+g.width),new Si(t.y,t.y+g.height,o,c)}moveBy(t,o,c){const g=this.getRelativeToSurfaceXY();t=new At(g.x+t,g.y+o),this.moveTo(t,c)}moveTo(t,o){super.moveTo(t,o),this.view.moveTo(t)}moveDuringDrag(t){this.location=t,this.view.moveTo(t)}setDragging(t){t?Me(this.getSvgRoot(),"blocklyDragging"):oe(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0,this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(t){const o=this.workspace.getGesture(t);o&&(o.handleCommentStart(t,this),n.setSelected$$module$build$src$core$common(this))}setDeleteStyle(t){t?Me(this.getSvgRoot(),"blocklyDraggingDelete"):oe(this.getSvgRoot(),"blocklyDraggingDelete")}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(t){this.dragStrategy.drag(t)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){Me(this.getSvgRoot(),"blocklySelected")}unselect(){oe(this.getSvgRoot(),"blocklySelected")}toCopyData(){return{paster:ey.TYPE,commentState:dn(this,{addCoordinates:!0})}}showContextMenu(t){const o=wn.registry.getContextMenuOptions(wn.ScopeType.COMMENT,{comment:this});Bc(t,o,this.workspace.RTL,this.workspace)}snapToGrid(){if(!this.isDeadOrDying()){var t=this.workspace.getGrid();if(t!=null&&t.shouldSnap()){var o=this.getRelativeToSurfaceXY();t=t.alignXY(o),t!==o&&this.moveTo(t,["snap"])}}}},Ps={};Ps.appendDomToWorkspace=Ju,Ps.blockToDom=Ta,Ps.blockToDomWithXY=Ku,Ps.clearWorkspaceAndLoadFromXml=Nd,Ps.deleteNext=A_,Ps.domToBlock=n.domToBlock$$module$build$src$core$xml,Ps.domToBlockInternal=Ql,Ps.domToPrettyText=Ld,Ps.domToText=Do,Ps.domToVariables=Kp,Ps.domToWorkspace=n.domToWorkspace$$module$build$src$core$xml,Ps.loadWorkspaceComment=kd,Ps.saveWorkspaceComment=Yu,Ps.variablesToDom=Yp,Ps.workspaceToDom=m_;var Ob=class extends ff{constructor(t){super(t),this.type=n.CREATE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=Ku(t),this.ids=O(t),this.json=zi(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=Do(this.xml),t.ids=this.ids,t.json=this.json,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Ob),o.xml=n.textToDom$$module$build$src$core$utils$xml(t.xml),o.ids=t.ids,o.json=t.json,t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}run(t){const o=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!sG(o,this.ids))if(t)Ii(this.json,o);else for(t=0;t<this.ids.length;t++){const c=this.ids[t],g=o.getBlockById(c);g?g.dispose(!1):c===this.blockId&&console.warn("Can't uncreate non-existent block: "+c)}}},sG=function(t,o){return o.map(c=>t.getBlockById(c)).filter(c=>c&&c.isShadow()).length===o.length};r(yt.EVENT,n.CREATE$$module$build$src$core$events$utils,Ob);var Lb=class extends Rt{constructor(t,o){super(o),this.type=To,this.themeName=t}toJson(){const t=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return t.themeName=this.themeName,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Lb),o.themeName=t.themeName,o}};r(yt.EVENT,To,Lb);var Nb=class extends Rt{constructor(t,o,c,g,b){super(g),this.type=Vo,this.viewTop=t,this.viewLeft=o,this.scale=c,this.oldScale=b}toJson(){const t=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Nb),o.viewTop=t.viewTop,o.viewLeft=t.viewLeft,o.scale=t.scale,o.oldScale=t.oldScale,o}};r(yt.EVENT,Vo,Nb);var Bt;(function(t){t[t.INPUT_VALUE=1]="INPUT_VALUE",t[t.OUTPUT_VALUE=2]="OUTPUT_VALUE",t[t.NEXT_STATEMENT=3]="NEXT_STATEMENT",t[t.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Bt||(Bt={}));var bm=class{constructor(t){this.connectionChecker=t,this.connections=[]}addConnection(t,o){o=this.calculateIndexForYPos(o),this.connections.splice(o,0,t)}findIndexOfConnection(t,o){if(!this.connections.length)return-1;const c=this.calculateIndexForYPos(o);if(c>=this.connections.length)return-1;o=t.y;let g=c;for(;0<=g&&this.connections[g].y===o;){if(this.connections[g]===t)return g;g--}for(g=c;g<this.connections.length&&this.connections[g].y===o;){if(this.connections[g]===t)return g;g++}return-1}calculateIndexForYPos(t){if(!this.connections.length)return 0;let o=0,c=this.connections.length;for(;o<c;){const g=Math.floor((o+c)/2);if(this.connections[g].y<t)o=g+1;else if(this.connections[g].y>t)c=g;else{o=g;break}}return o}removeConnection(t,o){if(t=this.findIndexOfConnection(t,o),t===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(t,1)}getNeighbours(t,o){function c(Dt){const Ni=b-g[Dt].x,Mi=M-g[Dt].y;return Math.sqrt(Ni*Ni+Mi*Mi)<=o&&it.push(g[Dt]),Mi<o}const g=this.connections,b=t.x,M=t.y;t=0;let te=g.length-2,$e=te;for(;t<$e;)g[$e].y<M?t=$e:te=$e,$e=Math.floor((t+te)/2);const it=[];if(te=t=$e,g.length){for(;0<=t&&c(t);)t--;do te++;while(te<g.length&&c(te))}return it}isInYRange(t,o,c){return Math.abs(this.connections[t].y-o)<=c}searchForClosest(t,o,c){if(!this.connections.length)return{connection:null,radius:o};const g=t.y,b=t.x;t.x=b+c.x,t.y=g+c.y;var M=this.calculateIndexForYPos(t.y);c=null;let te=o,$e,it=M-1;for(;0<=it&&this.isInYRange(it,t.y,o);)$e=this.connections[it],this.connectionChecker.canConnect(t,$e,!0,te)&&(c=$e,te=$e.distanceFrom(t)),it--;for(;M<this.connections.length&&this.isInYRange(M,t.y,o);)$e=this.connections[M],this.connectionChecker.canConnect(t,$e,!0,te)&&(c=$e,te=$e.distanceFrom(t)),M++;return t.x=b,t.y=g,{connection:c,radius:te}}static init(t){const o=[];return o[Bt.INPUT_VALUE]=new bm(t),o[Bt.OUTPUT_VALUE]=new bm(t),o[Bt.NEXT_STATEMENT]=new bm(t),o[Bt.PREVIOUS_STATEMENT]=new bm(t),o}},uy=null,pT=null,mT={};mT.connectionUiEffect=Qp,mT.disconnectUiEffect=C_,mT.disconnectUiStop=ec,mT.disposeUiEffect=Pd;var i1=class{constructor(t){this.workspace=t,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new At(t.scrollX,t.scrollY)}dispose(){this.workspace=null}startDrag(){ue()&&ue().unselect()}endDrag(t){this.drag(t)}drag(t){if(t=At.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(t.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,t.y);else throw new TypeError("Invalid state.")}},oG=5,aG=6,nu=class{constructor(t,o){this.creatorWorkspace=o,this.mouseDownXY=new At(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=t,this.currentDragDeltaXY=new At(0,0)}dispose(){Ce(),Cd(),this.creatorWorkspace.clearGesture();for(const t of this.boundEvents)Q(t);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(t){const o=new At(t.clientX,t.clientY);this.updateDragDelta(o)&&(this.updateIsDragging(t),Ae()),this.mostRecentEvent=t}updateDragDelta(t){return this.currentDragDeltaXY=At.difference(t,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=At.magnitude(this.currentDragDeltaXY)>(this.flyout?n.config$$module$build$src$core$config.flyoutDragRadius:n.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let t;if(!this.targetBlock||(t=this.flyout)==null||!t.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),n.getGroup$$module$build$src$core$events$utils()||n.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),n.setSelected$$module$build$src$core$common(this.targetBlock),!0):!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new i1(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(t){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const o=ue();o&&nl(o)&&o.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(o,this.startWorkspace_),this.dragger.onDragStart(t),this.dragger.onDrag(t,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(t,o){return new(p(yt.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(t,o)}doStart(t){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,Ge(t)?this.cancel():(this.gestureHasStarted=!0,ec(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Qt(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=t,Ad(),Oe(t)?this.handleRightClick(t):(t.type.toLowerCase()==="pointerdown"&&t.pointerType!=="mouse"&&fe(t,this),this.mouseDownXY=new At(t.clientX,t.clientY),this.bindMouseEvents(t),this.isEnding_||this.handleTouchStart(t)))}bindMouseEvents(t){this.boundEvents.push(Ye(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(Ye(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(Ye(document,"pointerup",null,this.handleUp.bind(this),!0)),t.preventDefault(),t.stopPropagation()}handleStart(t){this.isDragging()||(this.handleTouchStart(t),this.isMultiTouch()&&Ae())}handleMove(t){this.isDragging()&&Ie(t)||!this.isMultiTouch()?(this.updateFromEvent(t),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),t.preventDefault(),t.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(t),Ae())}handleUp(t){if(this.isDragging()||this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()){if(!Ie(t))return;if(this.updateFromEvent(t),Ae(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.dragger?this.dragger.onDragEnd(t,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(t))}t.preventDefault(),t.stopPropagation(),this.dispose()}handleTouchStart(t){var o=We(t);this.cachedPoints.set(o,this.getTouchPoint(t));var c=Array.from(this.cachedPoints.keys());c.length===2&&(o=this.cachedPoints.get(c[0]),c=this.cachedPoints.get(c[1]),this.startDistance=At.distance(o,c),this.isMultiTouch_=!0,t.preventDefault())}handleTouchMove(t){const o=We(t);this.cachedPoints.set(o,this.getTouchPoint(t)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(t):this.handleMove(t)}handlePinch(t){var o=Array.from(this.cachedPoints.keys()),c=this.cachedPoints.get(o[0]);if(o=this.cachedPoints.get(o[1]),c=At.distance(c,o)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(o=c-this.previousScale,o=0<o?o*oG:o*aG,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const g=this.startWorkspace_,b=Ve(t,g.getParentSvg(),g.getInverseScreenCTM());g.zoom(b.x,b.y,o)}this.previousScale=c,t.preventDefault()}handleTouchEnd(t){t=We(t),this.cachedPoints.has(t)&&this.cachedPoints.delete(t),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(t){return this.startWorkspace_?new At(t.pageX,t.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(Ae(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(t){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(t)):this.startBubble?this.startBubble.showContextMenu(t):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(t)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()}handleWsStart(t,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(o),this.mostRecentEvent=t,this.startBlock||this.startBubble||this.startComment||n.setSelected$$module$build$src$core$common(null),this.doStart(t)}fireWorkspaceClick(t){$(new(k(lr))(null,t.id,"workspace"))}handleFlyoutStart(t,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(o),this.handleWsStart(t,o.getWorkspace())}handleBlockStart(t,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(o),this.mostRecentEvent=t}handleBubbleStart(t,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(o),this.mostRecentEvent=t}handleCommentStart(t,o){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(o),this.mostRecentEvent=t}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.targetBlock.isEnabled()){n.getGroup$$module$build$src$core$events$utils()||n.setGroup$$module$build$src$core$events$utils(!0);var t=this.flyout.createBlock(this.targetBlock);t.snapToGrid(),t.bumpNeighbours()}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");t=new(k(lr))(this.startBlock,this.startWorkspace_.id,"block"),$(t)}this.bringBlockToFront(),n.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(t){t=this.creatorWorkspace,ue()&&ue().unselect(),this.fireWorkspaceClick(this.startWorkspace_||t)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=t)}setStartIcon(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=t)}setStartBubble(t){this.startBubble||(this.startBubble=t)}setStartComment(t){this.startComment||(this.startComment=t)}setStartBlock(t){this.startBlock||this.startBubble||(this.startBlock=t,n.setSelected$$module$build$src$core$common(this.startBlock),t.isInFlyout&&t!==t.getRootBlock()?this.setTargetBlock(t.getRootBlock()):this.setTargetBlock(t))}setTargetBlock(t){t.isShadow()?this.setTargetBlock(t.getParent()):this.targetBlock=t}setStartWorkspace(t){this.startWorkspace_||(this.startWorkspace_=t)}setStartFlyout(t){this.flyout||(this.flyout=t)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const t=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&t}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let t,o;return(o=(t=this.workspaceDragger)!=null?t:this.dragger)!=null?o:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const t=ce();for(let o=0,c;c=t[o];o++)if(c.currentGesture_)return!0;return!1}},kb=class{constructor(t,o){this.pattern=t,this.scale=1;let c;this.spacing=(c=o.spacing)!=null?c:0;let g;this.length=(g=o.length)!=null?g:1,this.line2=(this.line1=t.firstChild)&&this.line1.nextSibling;let b;this.snapToGrid=(b=o.snap)!=null?b:!1}setSpacing(t){this.spacing=t,this.update(this.scale)}getSpacing(){return this.spacing}setLength(t){this.length=t,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(t){this.snapToGrid=t}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(t){this.scale=t;var o=this.spacing*t;this.pattern.setAttribute("width",`${o}`),this.pattern.setAttribute("height",`${o}`),o=Math.floor(this.spacing/2)+.5;let c=o-this.length/2,g=o+this.length/2;o*=t,c*=t,g*=t,this.setLineAttributes(this.line1,t,c,g,o,o),this.setLineAttributes(this.line2,t,o,o,c,g)}setLineAttributes(t,o,c,g,b,M){t&&(t.setAttribute("stroke-width",`${o}`),t.setAttribute("x1",`${c}`),t.setAttribute("y1",`${b}`),t.setAttribute("x2",`${g}`),t.setAttribute("y2",`${M}`))}moveTo(t,o){this.pattern.setAttribute("x",`${t}`),this.pattern.setAttribute("y",`${o}`)}alignXY(t){var o=this.getSpacing();const c=o/2,g=Math.round(Math.round((t.x-c)/o)*o+c);return o=Math.round(Math.round((t.y-c)/o)*o+c),g===t.x&&o===t.y?t:new At(g,o)}static createDom(t,o,c){t=ve(Xe.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},c);let g,b;if(0<((g=o.length)!=null?g:1)&&0<((b=o.spacing)!=null?b:0)){ve(Xe.LINE,{stroke:o.colour},t);let M;(M=o.length)!=null&&M&&ve(Xe.LINE,{stroke:o.colour},t)}else ve(Xe.LINE,{},t);return t}},r1={};r1.deepMerge=il;var vf=class{constructor(t,o,c,g){this.name=t,this.startHats=!1,this.blockStyles=o||Object.create(null),this.categoryStyles=c||Object.create(null),this.componentStyles=g||Object.create(null),this.fontStyle=Object.create(null),r(yt.THEME,t,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(t,o){this.blockStyles[t]=o}setCategoryStyle(t,o){this.categoryStyles[t]=o}getComponentStyle(t){if(t=this.componentStyles[t],!t)return null;if(typeof t=="string"){const o=this.getComponentStyle(t);if(o)return o}return`${t}`}setComponentStyle(t,o){this.componentStyles[t]=o}setFontStyle(t){this.fontStyle=t}setStartHats(t){this.startHats=t}static defineTheme(t,o){t=t.toLowerCase();const c=new vf(t);let g=o.base;if(g){if(typeof g=="string"){let b;g=(b=h(yt.THEME,g))!=null?b:void 0}g instanceof vf&&(il(c,g),c.name=t)}return il(c.blockStyles,o.blockStyles),il(c.categoryStyles,o.categoryStyles),il(c.componentStyles,o.componentStyles),il(c.fontStyle,o.fontStyle),o.startHats!==null&&(c.startHats=o.startHats),c}},lG={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},cG={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},hy=new vf("classic",lG,cG),Ra=class{constructor(t){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let o=null,c=!1;var g=!1,b=!1,M=!1,te=!1,$e=!1;const it=!!t.readOnly;if(!it){var Dt;o=fi((Dt=t.toolbox)!=null?Dt:null),c=_i(o),g=t.trashcan,g=g===void 0?c:g,b=t.collapse,b=b===void 0?c:b,M=t.comments,M=M===void 0?c:M,te=t.disable,te=te===void 0?c:te,$e=t.sounds,$e=$e===void 0?!0:$e}Dt=t.maxTrashcanContents,g?Dt===void 0&&(Dt=32):Dt=0;const Ni=!!t.rtl;let Mi=t.horizontalLayout;Mi===void 0&&(Mi=!1);var vo=t.toolboxPosition!=="end";vo=Mi?vo?Cn.TOP:Cn.BOTTOM:vo===Ni?Cn.RIGHT:Cn.LEFT;let Nm=t.css;Nm===void 0&&(Nm=!0);let xT="https://blockly-demo.appspot.com/static/media/";t.media&&(xT=t.media.endsWith("/")?t.media:t.media+"/");const cO=t.oneBasedIndex,HG=t.renderer||"geras",VG=t.plugins||{};let xA=t.modalInputs;xA===void 0&&(xA=!0),this.RTL=Ni,this.oneBasedIndex=cO===void 0?!0:cO,this.collapse=b,this.comments=M,this.disable=te,this.readOnly=it,this.maxBlocks=t.maxBlocks||1/0;let uO;this.maxInstances=(uO=t.maxInstances)!=null?uO:null,this.modalInputs=xA,this.pathToMedia=xT,this.hasCategories=c,this.moveOptions=Ra.parseMoveOptions_(t,c),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=g,this.maxTrashcanContents=Dt,this.hasSounds=$e,this.hasCss=Nm,this.horizontalLayout=Mi,this.languageTree=o,this.gridOptions=Ra.parseGridOptions_(t),this.zoomOptions=Ra.parseZoomOptions_(t),this.toolboxPosition=vo,this.theme=Ra.parseThemeOptions_(t),this.renderer=HG;let hO;this.rendererOverrides=(hO=t.rendererOverrides)!=null?hO:null;let dO;this.parentWorkspace=(dO=t.parentWorkspace)!=null?dO:null,this.plugins=VG}static parseMoveOptions_(t,o){const c=t.move||{},g={};return c.scrollbars===void 0&&t.scrollbars===void 0?g.scrollbars=o:typeof c.scrollbars=="object"?(g.scrollbars={horizontal:!!c.scrollbars.horizontal,vertical:!!c.scrollbars.vertical},g.scrollbars.horizontal&&g.scrollbars.vertical?g.scrollbars=!0:g.scrollbars.horizontal||g.scrollbars.vertical||(g.scrollbars=!1)):g.scrollbars=!!c.scrollbars||!!t.scrollbars,g.wheel=g.scrollbars&&c.wheel!==void 0?!!c.wheel:typeof g.scrollbars=="object",g.drag=g.scrollbars?c.drag===void 0?!0:!!c.drag:!1,g}static parseZoomOptions_(t){t=t.zoom||{};const o={};return o.controls=t.controls===void 0?!1:!!t.controls,o.wheel=t.wheel===void 0?!1:!!t.wheel,o.startScale=t.startScale===void 0?1:Number(t.startScale),o.maxScale=t.maxScale===void 0?3:Number(t.maxScale),o.minScale=t.minScale===void 0?.3:Number(t.minScale),o.scaleSpeed=t.scaleSpeed===void 0?1.2:Number(t.scaleSpeed),o.pinch=t.pinch===void 0?o.wheel||o.controls:!!t.pinch,o}static parseGridOptions_(t){t=t.grid||{};const o={};return o.spacing=Number(t.spacing)||0,o.colour=t.colour||"#888",o.length=t.length===void 0?1:Number(t.length),o.snap=0<o.spacing&&!!t.snap,o}static parseThemeOptions_(t){return t=t.theme||hy,typeof t=="string"?h(yt.THEME,t):t instanceof vf?t:vf.defineTheme(t.name||"builtin"+m(),t)}};n.Names$$module$build$src$core$names=class{constructor(t,o){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=o||"",this.reservedWords=new Set(t?t.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(t){this.variableMap=t}getNameForUserVariable(t){return this.variableMap?(t=this.variableMap.getVariableById(t))?t.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(t){t=n.allUsedVarModels$$module$build$src$core$variables(t);for(let o=0;o<t.length;o++)this.getName(t[o].getId(),n.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(t){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(t,o){let c=t;o===n.NameType$$module$build$src$core$names.VARIABLE&&(t=this.getNameForUserVariable(t))&&(c=t),t=c.toLowerCase();const g=o===n.NameType$$module$build$src$core$names.VARIABLE||o===n.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(o)||this.db.set(o,new Map);const b=this.db.get(o);return b.has(t)?g+b.get(t):(o=this.getDistinctName(c,o),b.set(t,o.substr(g.length)),o)}getUserNames(t){let o;return(t=(o=this.db.get(t))==null?void 0:o.keys())?Array.from(t):[]}getDistinctName(t,o){t=this.safeName(t);let c=null,g,b;for(;this.dbReverse.has(t+((g=c)!=null?g:""))||this.reservedWords.has(t+((b=c)!=null?b:""));)c=c?c+1:2;let M;return t+=(M=c)!=null?M:"",this.dbReverse.add(t),(o===n.NameType$$module$build$src$core$names.VARIABLE||o===n.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+t}safeName(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(t[0])&&(t="my_"+t)):t=n.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",t}static equals(t,o){return t.toLowerCase()===o.toLowerCase()}},function(t){t=t.NameType||(t.NameType={}),t.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",t.VARIABLE="VARIABLE",t.PROCEDURE="PROCEDURE"}(n.Names$$module$build$src$core$names||(n.Names$$module$build$src$core$names={})),n.NameType$$module$build$src$core$names=n.Names$$module$build$src$core$names.NameType,n.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=n.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,n.NameType$$module$build$src$core$names,n.Names$$module$build$src$core$names;var s1=class extends Map{constructor(){super()}set(t,o){return this.get(t)===o?this:(super.set(t,o),Dd(o)&&o.startPublishing(),this)}delete(t){const o=this.get(t);return t=super.delete(t),t&&(Dd(o)&&o.stopPublishing(),t)}clear(){if(this.size)for(const t of this.keys())this.delete(t)}add(t){return this.set(t.getId(),t)}getProcedures(){return[...this.values()]}},dy=class{constructor(t){this.sourceBlock=t,this.offsetInBlock=new At(0,0),this.workspaceLocation=new At(0,0),this.svgRoot=null,this.tooltip=t}getType(){throw Error("Icons must implement getType")}initView(t){if(!this.svgRoot){var o=this.sourceBlock;this.svgRoot=ve(Xe.G,{class:"blocklyIconGroup"}),o.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),Ye(this.svgRoot,"pointerdown",this,t),this.svgRoot.tooltip=this,Ar(this.svgRoot)}}dispose(){ns(this.svgRoot),W(this.svgRoot)}getWeight(){return-1}getSize(){return new Kn(0,0)}setTooltip(t){this.tooltip=t??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",Te(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(t){this.offsetInBlock=t,this.updateSvgRootOffset()}updateSvgRootOffset(){let t;(t=this.svgRoot)==null||t.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(t){this.workspaceLocation=At.sum(t,this.offsetInBlock)}onClick(){}isClickableInFlyout(t){return!0}},o1={fromJsonInternal:w_},fy={TEST_ONLY:o1};fy.fromJson=n.fromJson$$module$build$src$core$field_registry,fy.register=Bo,fy.unregister=x_;var uc=class extends $i{constructor(t,o,c){super($i.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,t!==$i.SKIP_SETUP&&(Array.isArray(t)?(Uc(t),t=Fo(t),this.menuGenerator_=t.options,this.prefixField=t.prefix||null,this.suffixField=t.suffix||null):this.menuGenerator_=t,this.selectedOption=this.getOptions(!1)[0],c&&this.configure_(c),this.setValue(this.selectedOption[1]),o&&this.setValidator(o))}fromXml(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)}loadState(t){this.loadLegacyState(uc,t)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=ve(Xe.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&Me(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let t;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((t=this.getSourceBlock())!=null&&t.isShadow())}createTextArrow_(){this.arrow=ve(Xe.TSPAN,{},this.textElement_);let t;this.arrow.appendChild(document.createTextNode((t=this.getSourceBlock())!=null&&t.RTL?uc.ARROW_CHAR+" ":" "+uc.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central");let o;(o=this.getSourceBlock())!=null&&o.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=ve(Xe.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Wo,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(t){var o=this.getSourceBlock();if(!o)throw new ur;this.dropdownCreate(),this.menu_.openingCoords=t&&typeof t.clientX=="number"?new At(t.clientX,t.clientY):null,li(),t=this.menu_.render(yn()),Me(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(o=o.getColour(),ci(o,this.sourceBlock_.style.colourTertiary)),hs(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Be(this.selectedMenuItem.getElement(),yn(),!0)),this.applyColour()}dropdownCreate(){const t=this.getSourceBlock();if(!t)throw new ur;const o=new Tb;o.setRole(gl.LISTBOX),this.menu_=o;const c=this.getOptions(!1);this.selectedMenuItem=null;for(let b=0;b<c.length;b++){const[M,te]=c[b];if(typeof M=="object"){var g=new Image(M.width,M.height);g.src=M.src,g.alt=M.alt||""}else g=M;g=new vb(g,te),g.setRole(gl.OPTION),g.setRightToLeft(t.RTL),g.setCheckable(!0),o.addChild(g),g.setChecked(te===this.value_),te===this.value_&&(this.selectedMenuItem=g),g.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(t){Uu(this,!0),this.onItemSelected_(this.menu_,t)}onItemSelected_(t,o){this.setValue(o.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(t){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:t&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),Uc(this.generatedOptions),this.generatedOptions)}doClassValidation_(t){return this.getOptions(!0).some(o=>o[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(t){super.doValueUpdate_(t),t=this.getOptions(!0);for(let o=0,c;c=t[o];o++)c[1]===this.value_&&(this.selectedOption=c)}applyColour(){const t=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",t.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",t.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=t.colourSecondary:this.arrow.style.fill=t.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const t=this.selectedOption&&this.selectedOption[0];t&&typeof t=="object"?this.renderSelectedImage(t):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(t){const o=this.getSourceBlock();if(!o)throw new ur;this.imageElement.style.display="",this.imageElement.setAttributeNS(Wo,"xlink:href",t.src),this.imageElement.setAttribute("height",String(t.height)),this.imageElement.setAttribute("width",String(t.width));const c=Number(t.height);t=Number(t.width);var g=!!this.borderRect_;const b=Math.max(g?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,c+hG);g=g?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let M;M=this.svgArrow?this.positionSVGArrow(t+g,b/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):He(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=t+M+2*g,this.size_.height=b;let te=0;o.RTL?this.imageElement.setAttribute("x",`${g+M}`):(te=t+M,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${g}`)),this.imageElement.setAttribute("y",String(b/2-c/2)),this.positionTextElement_(te+g,t+M)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var t=this.getTextElement();Me(t,"blocklyDropdownText"),t.setAttribute("text-anchor","start");var o=!!this.borderRect_;t=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const c=He(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let g=0;this.svgArrow&&(g=this.positionSVGArrow(c+o,t/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=c+g+2*o,this.size_.height=t,this.positionTextElement_(o,c)}positionSVGArrow(t,o){if(!this.svgArrow)return 0;const c=this.getSourceBlock();if(!c)throw new ur;const g=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,b=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,M=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(c.RTL?g:t+b)+","+o+")"),M+b}getText_(){if(!this.selectedOption)return null;const t=this.selectedOption[0];return typeof t=="object"?t.alt:t}static fromJson(t){if(!t.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(t.options,void 0,t)}};uc.CHECKMARK_OVERHANG=25,uc.MAX_MENU_HEIGHT_VH=.45,uc.ARROW_CHAR="";var uG=5,hG=2*uG;Bo("field_dropdown",uc);var a1=class{constructor(t,o){this.bubble=t,this.workspace=o,this.startLoc=null}isMovable(){return!0}startDrag(){n.getGroup$$module$build$src$core$events$utils()||n.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(t){this.bubble.moveDuringDrag(t)}endDrag(){this.workspace.setResizesEnabled(!0),n.setGroup$$module$build$src$core$events$utils(!1);let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.bubble,pb),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},jo,di=class{constructor(t,o,c){this.workspace=t,this.anchor=o,this.ownerRect=c,this.size=new Kn(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new a1(this,this.workspace),this.id=m(),this.svgRoot=ve(Xe.G,{class:"blocklyBubble"},t.getBubbleCanvas()),t=ve(Xe.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=ve(Xe.PATH,{class:"blocklyBubbleTail"},t),this.background=ve(Xe.RECT,{class:"blocklyDraggable",x:0,y:0,rx:jo.BORDER_WIDTH,ry:jo.BORDER_WIDTH},t),this.contentContainer=ve(Xe.G,{},this.svgRoot),Ye(this.background,"pointerdown",this,this.onMouseDown)}dispose(){W(this.svgRoot),this.disposed=!0}setAnchorLocation(t,o=!1){this.anchor=t,o?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(t,o){this.relativeLeft=t,this.relativeTop=o,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(t,o=!1){t.width=Math.max(t.width,jo.MIN_SIZE),t.height=Math.max(t.height,jo.MIN_SIZE),this.size=t,this.background.setAttribute("width",`${t.width}`),this.background.setAttribute("height",`${t.height}`),o?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(t){this.colour=t,this.tail.setAttribute("fill",t),this.background.setAttribute("fill",t)}onMouseDown(t){let o;(o=this.workspace.getGesture(t))==null||o.handleBubbleStart(t,this),n.setSelected$$module$build$src$core$common(this)}positionRelativeToAnchor(){let t=this.anchor.x;t=this.workspace.RTL?t-(this.relativeLeft+this.size.width):t+this.relativeLeft,this.moveTo(t,this.relativeTop+this.anchor.y)}moveTo(t,o){this.svgRoot.setAttribute("transform",`translate(${t}, ${o})`)}positionByRect(t=new Si(0,0,0,0)){var o=this.workspace.getMetricsManager().getViewMetrics(!0),c=this.getOptimalRelativeLeft(o),g=this.getOptimalRelativeTop(o);const b={x:c,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},M={x:-this.size.width-30,y:g};g={x:t.getWidth(),y:g};var te={x:c,y:t.getHeight()};c=t.getWidth()<t.getHeight()?g:te,t=t.getWidth()<t.getHeight()?te:g,g=this.getOverlap(b,o),te=this.getOverlap(M,o);const $e=this.getOverlap(c,o);o=this.getOverlap(t,o),o=Math.max(g,te,$e,o),g===o?(this.relativeLeft=b.x,this.relativeTop=b.y):te===o?(this.relativeLeft=M.x,this.relativeTop=M.y):$e===o?(this.relativeLeft=c.x,this.relativeTop=c.y):(this.relativeLeft=t.x,this.relativeTop=t.y),this.positionRelativeToAnchor()}getOverlap(t,o){var c=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x+this.anchor.x;return t=t.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(c+this.size.width,o.left+o.width)-Math.max(c,o.left))*(Math.min(t+this.size.height,o.top+o.height)-Math.max(t,o.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(t){let o=-this.size.width/4;if(this.size.width>t.width)return o;if(t=this.getWorkspaceViewRect(t),this.workspace.RTL){var c=this.anchor.x-o;c-this.size.width<t.left?o=-(t.left-this.anchor.x+this.size.width):c>t.right&&(o=-(t.right-this.anchor.x))}else{c=o+this.anchor.x;const g=c+this.size.width;c<t.left?o=t.left-this.anchor.x:g>t.right&&(o=t.right-this.anchor.x-this.size.width)}return o}getOptimalRelativeTop(t){let o=-this.size.height/4;if(this.size.height>t.height)return o;const c=this.anchor.y+o,g=c+this.size.height;return t=this.getWorkspaceViewRect(t),c<t.top?o=t.top-this.anchor.y:g>t.bottom&&(o=t.bottom-this.anchor.y-this.size.height),o}getWorkspaceViewRect(t){const o=t.top;let c=t.top+t.height,g=t.left;return t=t.left+t.width,c-=this.getScrollbarThickness(),this.workspace.RTL?g-=this.getScrollbarThickness():t-=this.getScrollbarThickness(),new Si(o,c,g,t)}getScrollbarThickness(){return cr.scrollbarThickness/this.workspace.scale}renderTail(){const t=[];var o=this.size.width/2,c=this.size.height/2,g=-this.relativeLeft,b=-this.relativeTop;if(o===g&&c===b)t.push("M "+o+","+c);else{b-=c,g-=o,this.workspace.RTL&&(g*=-1);var M=Math.sqrt(b*b+g*g),te=Math.acos(g/M);0>b&&(te=2*Math.PI-te);var $e=te+Math.PI/2;$e>2*Math.PI&&($e-=2*Math.PI);var it=Math.sin($e);const Ni=Math.cos($e);let Mi=(this.size.width+this.size.height)/jo.TAIL_THICKNESS;Mi=Math.min(Mi,this.size.width,this.size.height)/4,$e=1-jo.ANCHOR_RADIUS/M,g=o+$e*g,b=c+$e*b,$e=o+Mi*Ni;const vo=c+Mi*it;o-=Mi*Ni,c-=Mi*it,it=Ne(this.workspace.RTL?-jo.TAIL_ANGLE:jo.TAIL_ANGLE),it=te+it,it>2*Math.PI&&(it-=2*Math.PI),te=Math.sin(it)*M/jo.TAIL_BEND,M=Math.cos(it)*M/jo.TAIL_BEND,t.push("M"+$e+","+vo),t.push("C"+($e+M)+","+(vo+te)+" "+g+","+b+" "+g+","+b),t.push("C"+g+","+b+" "+(o+M)+","+(c+te)+" "+o+","+c)}t.push("z");let Dt;(Dt=this.tail)==null||Dt.setAttribute("d",t.join(" "))}bringToFront(){let t;const o=(t=this.svgRoot)==null?void 0:t.parentNode;return this.svgRoot&&(o==null?void 0:o.lastChild)!==this.svgRoot?(o==null||o.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new At(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(t){this.moveTo(t.x,t.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x-this.anchor.x,this.relativeTop=t.y-this.anchor.y,this.renderTail()}setDragging(t){}setDeleteStyle(t){}isDeletable(){return!1}showContextMenu(t){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(t){this.dragStrategy.drag(t)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){}unselect(){}};jo=di,di.BORDER_WIDTH=6,di.DOUBLE_BORDER=2*jo.BORDER_WIDTH,di.MIN_SIZE=jo.DOUBLE_BORDER,di.TAIL_THICKNESS=1,di.TAIL_ANGLE=20,di.TAIL_BEND=4,di.ANCHOR_RADIUS=8;var iu=class extends di{constructor(t,o,c,g){super(o,c,g),this.workspace=o,this.anchor=c,this.ownerRect=g,this.autoLayout=!0,o=new Ra(t),this.validateWorkspaceOptions(o),this.svgDialog=ve(Xe.SVG,{x:di.BORDER_WIDTH,y:di.BORDER_WIDTH},this.contentContainer),t.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Ra(t)),this.miniWorkspace.internalIsMutator=!0,t=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(t),o.languageTree&&(t.insertBefore(this.miniWorkspace.addFlyout(Xe.G),this.miniWorkspace.getCanvas()),t=this.miniWorkspace.getFlyout(),t==null||t.init(this.miniWorkspace),t==null||t.show(o.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let b,M;(b=this.miniWorkspace.getFlyout())==null||(M=b.getWorkspace())==null||M.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(t){this.miniWorkspace.addChangeListener(t)}validateWorkspaceOptions(t){if(t.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(t.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(t.zoomOptions.controls||t.zoomOptions.wheel||t.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(t.moveOptions.scrollbars||t.moveOptions.wheel||t.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(t.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const t of this.miniWorkspace.getTopBlocks(!1)){const o=t.getRelativeToSurfaceXY();if(20>o.y&&t.moveBy(0,20-o.y),t.RTL){let c=-20;const g=this.miniWorkspace.getFlyout();g&&(c-=g.getWidth()),o.x>c&&t.moveBy(c-o.x,0)}else 20>o.x&&t.moveBy(20-o.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var t=this.getSize(),o=this.calculateWorkspaceSize();Math.abs(t.width-o.width)<iu.MINIMUM_VIEW_CHANGE&&Math.abs(t.height-o.height)<iu.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${o.width}px`),this.svgDialog.setAttribute("height",`${o.height}px`),this.miniWorkspace.setCachedParentSvgSize(o.width,o.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${o.width}, 0)`),this.setSize(new Kn(o.width+di.DOUBLE_BORDER,o.height+di.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var t=this.miniWorkspace.getCanvas().getBBox();let o=t.width+iu.MARGIN;t=t.height+iu.MARGIN;const c=this.miniWorkspace.getFlyout();if(c){const g=c.getWorkspace().getMetricsManager().getScrollMetrics();t=Math.max(t,g.height+20),o+=c.getWidth()}return new Kn(o,t)}updateBlockStyles(){for(var t of this.miniWorkspace.getAllBlocks(!1))t.setStyle(t.getStyleName());let o;if(t=(o=this.miniWorkspace.getFlyout())==null?void 0:o.getWorkspace())for(const c of t.getAllBlocks(!1))c.setStyle(c.getStyleName())}moveDuringDrag(t){super.moveDuringDrag(t),this.autoLayout=!1}moveTo(t,o){super.moveTo(t,o),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(t){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};iu.MINIMUM_VIEW_CHANGE=10,iu.MARGIN=3*di.DOUBLE_BORDER;var py,my;py=17,my=16,n.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends dy{constructor(t,o){super(o),this.flyoutBlockTypes=t,this.sourceBlock=o,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return n.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(t){this.svgRoot||(super.initView(t),ve(Xe.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),ve(Xe.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),ve(Xe.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),Me(this.svgRoot,"blockly-icon-mutator"))}dispose(){super.dispose();let t;(t=this.miniWorkspaceBubble)==null||t.dispose()}getWeight(){return n.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Kn(py,py)}applyColour(){super.applyColour();let t;(t=this.miniWorkspaceBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary);let o;(o=this.miniWorkspaceBubble)==null||o.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(t){super.onLocationChange(t);let o;(o=this.miniWorkspaceBubble)==null||o.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){const o=this;return Tt.asyncExecutePromiseGeneratorFunction(function*(){if(o.bubbleIsVisible()!==t){if(yield Kt(),t){o.miniWorkspaceBubble=new iu(o.getMiniWorkspaceConfig(),o.sourceBlock.workspace,o.getAnchorLocation(),o.getBubbleOwnerRect()),o.applyColour(),o.createRootBlock(),o.addSaveConnectionsListener();let c;(c=o.miniWorkspaceBubble)==null||c.addWorkspaceChangeListener(o.createMiniWorkspaceChangeListener())}else{let c;(c=o.miniWorkspaceBubble)==null||c.dispose(),o.miniWorkspaceBubble=null,o.saveConnectionsListener&&o.sourceBlock.workspace.removeChangeListener(o.saveConnectionsListener),o.saveConnectionsListener=null}$(new(k(Sa))(o.sourceBlock,t,"mutator"))}})}getMiniWorkspaceConfig(){let t;const o={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(t=this.sourceBlock.workspace.options.rendererOverrides)!=null?t:void 0};return this.flyoutBlockTypes.length&&(o.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(c=>({kind:"block",type:c}))}),o}getAnchorLocation(){const t=py/2;return At.sum(this.workspaceLocation,new At(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Si(t.y,t.y+t.height,t.x,t.x+t.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var t of this.rootBlock.getDescendants(!1))t.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let o,c,g,b;t=(b=(o=this.miniWorkspaceBubble)==null||(c=o.getWorkspace())==null||(g=c.getFlyout())==null?void 0:g.getWidth())!=null?b:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(t+my):my,my)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return t=>{n.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(t)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(t){return t.isUiEvent||t.type===n.CREATE$$module$build$src$core$events$utils||t.type===n.CHANGE$$module$build$src$core$events$utils&&t.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var t=n.getGroup$$module$build$src$core$events$utils();t||n.setGroup$$module$build$src$core$events$utils(!0);var o=pf.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var c=pf.getExtraBlockState_(this.sourceBlock);o!==c&&$(new(k(n.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,o,c)),n.setGroup$$module$build$src$core$events$utils(t)}}getWorkspace(){let t;return(t=this.miniWorkspaceBubble)==null?void 0:t.getWorkspace()}},n.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=wr.MUTATOR,n.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,n.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Am=Object.create(null),dG={allExtensions:Am};n.register$$module$build$src$core$extensions("parent_tooltip_when_inline",P_);var vl={TEST_ONLY:dG};vl.apply=Gc,vl.buildTooltipForDropdown=n.buildTooltipForDropdown$$module$build$src$core$extensions,vl.buildTooltipWithFieldText=n.buildTooltipWithFieldText$$module$build$src$core$extensions,vl.isRegistered=Qu,vl.register=n.register$$module$build$src$core$extensions,vl.registerMixin=n.registerMixin$$module$build$src$core$extensions,vl.registerMutator=n.registerMutator$$module$build$src$core$extensions,vl.runAfterPageLoad=N_,vl.unregister=qu;var l1=new Set,c1={};c1.warn=sl;var On;(function(t){t[t.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",t[t.MAC_ENTER=3]="MAC_ENTER",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.NUM_CENTER=12]="NUM_CENTER",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.FF_SEMICOLON=59]="FF_SEMICOLON",t[t.FF_EQUALS=61]="FF_EQUALS",t[t.FF_DASH=173]="FF_DASH",t[t.FF_HASH=163]="FF_HASH",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.AT_SIGN=64]="AT_SIGN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META=91]="META",t[t.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUM_ZERO=96]="NUM_ZERO",t[t.NUM_ONE=97]="NUM_ONE",t[t.NUM_TWO=98]="NUM_TWO",t[t.NUM_THREE=99]="NUM_THREE",t[t.NUM_FOUR=100]="NUM_FOUR",t[t.NUM_FIVE=101]="NUM_FIVE",t[t.NUM_SIX=102]="NUM_SIX",t[t.NUM_SEVEN=103]="NUM_SEVEN",t[t.NUM_EIGHT=104]="NUM_EIGHT",t[t.NUM_NINE=105]="NUM_NINE",t[t.NUM_MULTIPLY=106]="NUM_MULTIPLY",t[t.NUM_PLUS=107]="NUM_PLUS",t[t.NUM_MINUS=109]="NUM_MINUS",t[t.NUM_PERIOD=110]="NUM_PERIOD",t[t.NUM_DIVISION=111]="NUM_DIVISION",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",t[t.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",t[t.SEMICOLON=186]="SEMICOLON",t[t.DASH=189]="DASH",t[t.EQUALS=187]="EQUALS",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.APOSTROPHE=192]="APOSTROPHE",t[t.TILDE=192]="TILDE",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE",t[t.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",t[t.WIN_KEY=224]="WIN_KEY",t[t.MAC_FF_META=224]="MAC_FF_META",t[t.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",t[t.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",t[t.WIN_IME=229]="WIN_IME",t[t.VK_NONAME=252]="VK_NONAME",t[t.PHANTOM=255]="PHANTOM"})(On||(On={}));var ru={};ru.arc=Di,ru.curve=ps,ru.line=ol,ru.lineOnAxis=Nt,ru.lineTo=Uo,ru.moveBy=yi,ru.moveTo=Ji,ru.point=Wt;var ji={};ji.Coordinate=At,ji.KeyCodes=On,ji.Rect=Si,ji.Size=Kn,ji.Svg=Xe,ji.aria=oT,ji.array=SI,ji.browserEvents=qc,ji.colour=Ca,ji.deprecation=c1,ji.dom=rs,ji.extensions=vl,ji.idGenerator=q_,ji.math=ty,ji.object=r1,ji.parsing=fT,ji.string=vm,ji.style=yh,ji.svgMath=cf,ji.svgPaths=ru,ji.toolbox=Sh,ji.userAgent=q2,ji.xml=hm;var Pb={};Pb.register=Bd,Pb.unregister=D_;var Db=class extends di{constructor(t,o,c,g){super(o,c,g),this.text=t,this.workspace=o,this.anchor=c,this.ownerRect=g,this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(t){this.text=t,W(this.paragraph),this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}stringToSvg(t,o){return o=this.createParagraph(o),t=this.createSpans(o,t),this.workspace.RTL&&this.rightAlignSpans(o.getBBox().width,t),o}createParagraph(t){return ve(Xe.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:di.BORDER_WIDTH},t)}createSpans(t,o){return o.split(`
`).map(c=>{const g=ve(Xe.TSPAN,{dy:"1em",x:di.BORDER_WIDTH},t);return c=document.createTextNode(c),g.appendChild(c),g})}rightAlignSpans(t,o){for(const c of o)c.setAttribute("text-anchor","end"),c.setAttribute("x",`${t+di.BORDER_WIDTH}`)}updateBubbleSize(){const t=this.paragraph.getBBox();this.setSize(new Kn(t.width+2*di.BORDER_WIDTH,t.height+2*di.BORDER_WIDTH),!0)}},u1=class extends di{constructor(t,o,c){super(t,o,c),this.workspace=t,this.anchor=o,this.ownerRect=c,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Kn(160+di.DOUBLE_BORDER,80+di.DOUBLE_BORDER),this.MIN_SIZE=new Kn(45+di.DOUBLE_BORDER,20+di.DOUBLE_BORDER),Me(this.svgRoot,"blocklyTextInputBubble"),{inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer),this.resizeGroup=this.createResizeHandle(this.svgRoot,t),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(t){this.text=t,this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}createEditor(t){t=ve(Xe.FOREIGNOBJECT,{x:di.BORDER_WIDTH,y:di.BORDER_WIDTH},t);const o=document.createElementNS(cc,"body");o.setAttribute("xmlns",cc),o.className="blocklyMinimalBody";const c=document.createElementNS(cc,"textarea");return c.className="blocklyTextarea blocklyText",c.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),o.appendChild(c),t.appendChild(o),this.bindTextAreaEvents(c),setTimeout(()=>{c.focus()},0),{inputRoot:t,textArea:c}}bindTextAreaEvents(t){Ye(t,"wheel",this,o=>{o.stopPropagation()}),Ye(t,"focus",this,this.onStartEdit,!0),Ye(t,"change",this,this.onTextChange)}createResizeHandle(t,o){return t=ve(Xe.IMAGE,{class:"blocklyResizeHandle",href:`${o.options.pathToMedia}resize-handle.svg`},t),Ye(t,"pointerdown",this,this.onResizePointerDown),t}setSize(t,o=!1){t.width=Math.max(t.width,this.MIN_SIZE.width),t.height=Math.max(t.height,this.MIN_SIZE.height);const c=t.width-di.DOUBLE_BORDER,g=t.height-di.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${c}`),this.inputRoot.setAttribute("height",`${g}`),this.resizeGroup.setAttribute("y",`${g}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-di.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${c}`),super.setSize(t,o),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(t){this.bringToFront(),Oe(t)||(this.workspace.startDrag(t,new At(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=Ye(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=Ye(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation()}onResizePointerUp(t){Ce(),this.resizePointerUpListener&&(Q(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Q(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Kn(this.workspace.RTL?-t.x:t.x,t.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const t of this.textChangeListeners)t()}onSizeChange(){for(const t of this.sizeChangeListeners)t()}};Ue(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}
`);var Bb=17,h1=160,d1=80,su=class extends dy{constructor(t){super(t),this.sourceBlock=t,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Kn(h1,d1),this.bubbleVisiblity=!1}getType(){return su.TYPE}initView(t){this.svgRoot||(super.initView(t),ve(Xe.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),ve(Xe.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),ve(Xe.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),Me(this.svgRoot,"blockly-icon-comment"))}dispose(){super.dispose();let t;(t=this.textInputBubble)==null||t.dispose();let o;(o=this.textBubble)==null||o.dispose()}getWeight(){return su.WEIGHT}getSize(){return new Kn(Bb,Bb)}applyColour(){super.applyColour();const t=this.sourceBlock.style.colourPrimary;let o;(o=this.textInputBubble)==null||o.setColour(t);let c;(c=this.textBubble)==null||c.setColour(t)}updateEditable(){const t=this,o=()=>super.updateEditable;return Tt.asyncExecutePromiseGeneratorFunction(function*(){o().call(t),t.bubbleIsVisible()&&(yield t.setBubbleVisible(!1),yield t.setBubbleVisible(!0))})}onLocationChange(t){super.onLocationChange(t),t=this.getAnchorLocation();let o;(o=this.textInputBubble)==null||o.setAnchorLocation(t);let c;(c=this.textBubble)==null||c.setAnchorLocation(t)}setText(t){const o=this.text;$(new(k(n.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,o,t)),this.text=t;let c;(c=this.textInputBubble)==null||c.setText(this.text);let g;(g=this.textBubble)==null||g.setText(this.text)}getText(){return this.text}setBubbleSize(t){this.bubbleSize=t;let o;(o=this.textInputBubble)==null||o.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(t){let o;this.text=(o=t.text)!=null?o:"";let c,g;this.bubbleSize=new Kn((c=t.width)!=null?c:h1,(g=t.height)!=null?g:d1);let b;this.bubbleVisiblity=(b=t.pinned)!=null?b:!1,this.setBubbleVisible(this.bubbleVisiblity)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var t=this.textInputBubble.getText();this.text!==t&&($(new(k(n.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,t)),this.text=t)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(t){const o=this;return Tt.asyncExecutePromiseGeneratorFunction(function*(){o.bubbleVisiblity!==t&&(o.bubbleVisiblity=t,yield Kt(),!o.sourceBlock.rendered||o.sourceBlock.isInFlyout||o.sourceBlock.isInsertionMarker()||(t?(o.sourceBlock.isEditable()?o.showEditableBubble():o.showNonEditableBubble(),o.applyColour()):o.hideBubble(),$(new(k(Sa))(o.sourceBlock,t,"comment"))))})}showEditableBubble(){this.textInputBubble=new u1(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.textBubble=new Db(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let t;(t=this.textInputBubble)==null||t.dispose(),this.textInputBubble=null;let o;(o=this.textBubble)==null||o.dispose(),this.textBubble=null}getAnchorLocation(){const t=Bb/2;return At.sum(this.workspaceLocation,new At(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Si(t.y,t.y+t.height,t.x,t.x+t.width)}};su.TYPE=wr.COMMENT,su.WEIGHT=3,Bd(su.TYPE,su);var Fb=17,ou=class extends dy{constructor(t){super(t),this.sourceBlock=t,this.textMap=new Map,this.textBubble=null}getType(){return ou.TYPE}initView(t){this.svgRoot||(super.initView(t),ve(Xe.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),ve(Xe.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),ve(Xe.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),Me(this.svgRoot,"blockly-icon-warning"))}dispose(){super.dispose();let t;(t=this.textBubble)==null||t.dispose()}getWeight(){return ou.WEIGHT}getSize(){return new Kn(Fb,Fb)}applyColour(){super.applyColour();let t;(t=this.textBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(t){super.onLocationChange(t);let o;(o=this.textBubble)==null||o.setAnchorLocation(this.getAnchorLocation())}addMessage(t,o){if(this.textMap.get(o)===t)return this;t?this.textMap.set(o,t):this.textMap.delete(o);let c;return(c=this.textBubble)==null||c.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){const o=this;return Tt.asyncExecutePromiseGeneratorFunction(function*(){if(o.bubbleIsVisible()!==t){if(yield Kt(),t)o.textBubble=new Db(o.getText(),o.sourceBlock.workspace,o.getAnchorLocation(),o.getBubbleOwnerRect()),o.applyColour();else{let c;(c=o.textBubble)==null||c.dispose(),o.textBubble=null}$(new(k(Sa))(o.sourceBlock,t,"warning"))}})}getAnchorLocation(){const t=Fb/2;return At.sum(this.workspaceLocation,new At(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new Si(t.y,t.y+t.height,t.x,t.x+t.width)}};ou.TYPE=wr.WARNING,ou.WEIGHT=2;var f1=class extends Error{constructor(t){super(`Tried to append an icon of type ${t.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=t}},p1={};p1.DuplicateIconType=f1;var Ah={};Ah.CommentIcon=su,Ah.Icon=dy,Ah.IconType=wr,Ah.MutatorIcon=n.MutatorIcon$$module$build$src$core$icons$mutator_icon,Ah.WarningIcon=ou,Ah.exceptions=p1,Ah.registry=Pb;var gy,to;gy="PROCEDURE",n.DEFAULT_ARG$$module$build$src$core$procedures="x",to={CATEGORY_NAME:gy,DEFAULT_ARG:n.DEFAULT_ARG$$module$build$src$core$procedures},to.ObservableProcedureMap=s1,to.allProcedures=Fd,to.findLegalName=n.findLegalName$$module$build$src$core$procedures,to.flyoutCategory=Gd,to.getCallers=nh,to.getDefinition=n.getDefinition$$module$build$src$core$procedures,to.isNameUsed=Ud,to.isProcedureBlock=rl,to.mutateCallers=n.mutateCallers$$module$build$src$core$procedures,to.mutatorOpenListener=F_,to.rename=n.rename$$module$build$src$core$procedures;var fG=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(t){return Object.prototype.hasOwnProperty.call(this,t)||(this[t]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[t]}isField(t){return t.type&this.FIELD}isHat(t){return t.type&this.HAT}isIcon(t){return t.type&this.ICON}isSpacer(t){return t.type&this.SPACER}isInRowSpacer(t){return t.type&this.IN_ROW_SPACER}isInput(t){return t.type&this.INPUT}isExternalInput(t){return t.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(t){return t.type&this.INLINE_INPUT}isStatementInput(t){return t.type&this.STATEMENT_INPUT}isPreviousConnection(t){return t.type&this.PREVIOUS_CONNECTION}isNextConnection(t){return t.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(t){return t.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(t){return t.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(t){return t.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(t){return t.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(t){return t.type&this.RIGHT_SQUARE_CORNER}isCorner(t){return t.type&this.CORNER}isJaggedEdge(t){return t.type&this.JAGGED_EDGE}isRow(t){return t.type&this.ROW}isBetweenRowSpacer(t){return t.type&this.BETWEEN_ROW_SPACER}isTopRow(t){return t.type&this.TOP_ROW}isBottomRow(t){return t.type&this.BOTTOM_ROW}isTopOrBottomRow(t){return t.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(t){return t.type&this.INPUT_ROW}},Pe=new fG,hc=class{constructor(t){this.centerline=this.xPos=this.height=this.width=0,this.constants_=t,this.type=Pe.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},gT=class{constructor(t){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=t,this.type=Pe.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let t=this.elements.length-1;0<=t;t--){const o=this.elements[t];if(Pe.isInput(o))return o}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let t=0;t<this.elements.length;t++){const o=this.elements[t];if(Pe.isSpacer(o))return o}return null}getLastSpacer(){for(let t=this.elements.length-1;0<=t;t--){const o=this.elements[t];if(Pe.isSpacer(o))return o}return null}},Ub=class extends gT{constructor(t){super(t),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=Pe.BOTTOM_ROW}hasLeftSquareCorner(t){return!!t.outputConnection||!!t.getNextBlock()}hasRightSquareCorner(t){return!0}measure(){let t=0,o=0,c=0;for(let g=0;g<this.elements.length;g++){const b=this.elements[g];o+=b.width,Pe.isSpacer(b)||(Pe.isNextConnection(b)?c=Math.max(c,b.height):t=Math.max(t,b.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,t)+c,this.descenderHeight=c,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},au=class extends hc{constructor(t,o){super(t),this.connectionModel=o,this.type|=Pe.CONNECTION,this.shape=this.constants_.shapeFor(o),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=o.isHighlighted()}},Ch=class extends au{constructor(t,o){super(t,o.connection),this.input=o,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=Pe.INPUT,this.align=o.align,(this.connectedBlock=o.connection&&o.connection.targetBlock()?o.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},_y=class extends Ch{constructor(t,o){super(t,o),this.height=0,this.type|=Pe.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Cm=class extends hc{constructor(t,o,c){super(t),this.field=o,this.parentInput=c,this.isEditable=o.EDITABLE,this.flipRtl=o.getFlipRtl(),this.type|=Pe.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width}},Gb=class extends hc{constructor(t){super(t),this.type|=Pe.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},m1=class extends hc{constructor(t,o){super(t),this.icon=o,this.flipRtl=!1,this.type|=Pe.ICON,t=o.getSize(),this.height=t.height,this.width=t.width}},Yo=class extends hc{constructor(t,o){super(t),this.type=this.type|Pe.SPACER|Pe.IN_ROW_SPACER,this.width=o,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},Hb=class extends Ch{constructor(t,o){super(t,o),this.type|=Pe.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},_T=class extends Ch{constructor(t,o){super(t,o),this.type|=Pe.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Vb=class extends gT{constructor(t){super(t),this.connectedBlockWidths=0,this.type|=Pe.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let o=0;o<this.elements.length;o++){const c=this.elements[o];this.width+=c.width,Pe.isInput(c)&&c instanceof Ch&&(Pe.isStatementInput(c)&&c instanceof _T?t+=c.connectedBlockWidth:Pe.isExternalInput(c)&&c instanceof _y&&c.connectedBlockWidth!==0&&(t+=c.connectedBlockWidth-c.connectionWidth)),Pe.isSpacer(c)||(this.height=Math.max(this.height,c.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},g1=class extends hc{constructor(t){super(t),this.type|=Pe.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},_1=class extends au{constructor(t,o){super(t,o),this.type|=Pe.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},T1=class extends au{constructor(t,o){super(t,o),this.connectionOffsetX=0,this.type|=Pe.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},v1=class extends au{constructor(t,o){super(t,o),this.type|=Pe.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},TT=class extends hc{constructor(t,o){super(t),this.type=(o&&o!=="left"?Pe.RIGHT_ROUND_CORNER:Pe.LEFT_ROUND_CORNER)|Pe.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},zb=class extends gT{constructor(t,o,c){super(t),this.height=o,this.width=c,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|Pe.SPACER|Pe.BETWEEN_ROW_SPACER,this.elements=[new Yo(this.constants_,c)]}measure(){}},vT=class extends hc{constructor(t,o){super(t),this.type=(o&&o!=="left"?Pe.RIGHT_SQUARE_CORNER:Pe.LEFT_SQUARE_CORNER)|Pe.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Wb=class extends gT{constructor(t){super(t),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=Pe.TOP_ROW}hasLeftSquareCorner(t){const o=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,c=t.getPreviousBlock();return!!t.outputConnection||o||(c?c.getNextBlock()===t:!1)}hasRightSquareCorner(t){return!0}measure(){let t=0,o=0,c=0;for(let g=0;g<this.elements.length;g++){const b=this.elements[g];o+=b.width,Pe.isSpacer(b)||(Pe.isHat(b)&&b instanceof Gb?c=Math.max(c,b.ascenderHeight):t=Math.max(t,b.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,t)+c,this.capline=this.ascenderHeight=c,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Ty=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=yi(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(t){this.blockStyles=Object.create(null);const o=t.blockStyles;for(const c in o)this.blockStyles[c]=this.validatedBlockStyle_(o[c]);this.setDynamicProperties_(t)}setDynamicProperties_(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=t.startHats!==void 0?t.startHats:this.ADD_START_HATS}setFontConstants_(t){t.fontStyle&&t.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=t.fontStyle.family),t.fontStyle&&t.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=t.fontStyle.weight),t.fontStyle&&t.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=t.fontStyle.size),t=L("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline}setComponentConstants_(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(t){const o="auto_"+t;return this.blockStyles[o]||(this.blockStyles[o]=this.createBlockStyle_(t)),{style:this.blockStyles[o],name:o}}getBlockStyle(t){return this.blockStyles[t||""]||(t&&t.startsWith("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(t){return this.validatedBlockStyle_({colourPrimary:t})}validatedBlockStyle_(t){const o={};return t&&Object.assign(o,t),t=Jl(o.colourPrimary||"#000"),o.colourPrimary=t.hex,o.colourSecondary=o.colourSecondary?Jl(o.colourSecondary).hex:this.generateSecondaryColour_(o.colourPrimary),o.colourTertiary=o.colourTertiary?Jl(o.colourTertiary).hex:this.generateTertiaryColour_(o.colourPrimary),o.hat=o.hat||"",o}generateSecondaryColour_(t){return ko("#fff",t,.6)||t}generateTertiaryColour_(t){return ko("#fff",t,.3)||t}dispose(){this.embossFilter&&W(this.embossFilter),this.disabledPattern&&W(this.disabledPattern),this.debugFilter&&W(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const t=this.JAGGED_TEETH_HEIGHT,o=this.JAGGED_TEETH_WIDTH,c=ol([Wt(o,t/4),Wt(2*-o,t/2),Wt(o,t/4)]);return{height:t,width:o,path:c}}makeStartHat(){const t=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH,c=ps("c",[Wt(30,-t),Wt(70,-t),Wt(o,0)]);return{height:t,width:o,path:c}}makePuzzleTab(){function t(M){M=M?-1:1;const te=-M;var $e=c/2;const it=$e+2.5,Dt=$e+.5,Ni=Wt(-o,M*$e);return $e=Wt(o,M*$e),ps("c",[Wt(0,M*it),Wt(-o,te*Dt),Ni])+ps("s",[Wt(o,2.5*te),$e])}const o=this.TAB_WIDTH,c=this.TAB_HEIGHT,g=t(!0),b=t(!1);return{type:this.SHAPES.PUZZLE,width:o,height:c,pathDown:b,pathUp:g}}makeNotch(){function t(te){return ol([Wt(te*g,c),Wt(3*te,0),Wt(te*g,-c)])}const o=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,g=(o-3)/2,b=t(1),M=t(-1);return{type:this.SHAPES.NOTCH,width:o,height:c,pathLeft:b,pathRight:M}}makeInsideCorners(){const t=this.CORNER_RADIUS,o=Di("a","0 0,0",t,Wt(-t,t)),c=Di("a","0 0,0",t,Wt(t,t));return{width:t,height:t,pathTop:o,pathBottom:c}}makeOutsideCorners(){const t=this.CORNER_RADIUS,o=yi(0,t)+Di("a","0 0,1",t,Wt(t,-t)),c=Di("a","0 0,1",t,Wt(t,t)),g=Di("a","0 0,1",t,Wt(-t,-t)),b=Di("a","0 0,1",t,Wt(-t,t));return{topLeft:o,topRight:c,bottomRight:b,bottomLeft:g,rightHeight:t}}shapeFor(t){switch(t.type){case Bt.INPUT_VALUE:case Bt.OUTPUT_VALUE:return this.PUZZLE_TAB;case Bt.PREVIOUS_STATEMENT:case Bt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(t,o,c){this.injectCSS_(o,c),this.defs=ve(Xe.DEFS,{},t),t=ve(Xe.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),ve(Xe.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},t),o=ve(Xe.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},t),ve(Xe.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),ve(Xe.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},t),ve(Xe.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},t),this.embossFilterId=t.id,this.embossFilter=t,t=ve(Xe.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),ve(Xe.RECT,{width:10,height:10,fill:"#aaa"},t),ve(Xe.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},t),this.disabledPatternId=t.id,this.disabledPattern=t,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const t=ve(Xe.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),o=ve(Xe.FECOMPONENTTRANSFER,{result:"outBlur"},t);ve(Xe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),ve(Xe.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),ve(Xe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter=t}}injectCSS_(t,o){o=this.getCSS_(o),t="blockly-renderer-style-"+t,this.cssNode=document.getElementById(t);const c=o.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=c:(o=document.createElement("style"),o.id=t,t=document.createTextNode(c),o.appendChild(t),document.head.insertBefore(o,document.head.firstChild),this.cssNode=o)}getCSS_(t){return[`${t} .blocklyText, `,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect,`,`${t} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text {`,"fill: #000;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${t} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${t} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${t} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${t} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${t} .blocklyReplaceable .blocklyPathLight,`,`${t} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},vy=class{constructor(t,o){this.inlinePath_=this.outlinePath_="",this.block_=t,this.info_=o,this.topLeft_=t.getRelativeToSurfaceXY(),this.constants_=o.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let t=1;t<this.info_.rows.length-1;t++){const o=this.info_.rows[t];o.hasJaggedEdge?this.drawJaggedEdge_(o):o.hasStatement?this.drawStatementInput_(o):o.hasExternalInput?this.drawValueInput_(o):this.drawRightSideRow_(o)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const t=this.info_.topRow,o=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=yi(t.xPos,this.info_.startY);for(let c=0,g;g=o[c];c++)Pe.isLeftRoundedCorner(g)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Pe.isRightRoundedCorner(g)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Pe.isPreviousConnection(g)&&g instanceof au?this.outlinePath_+=g.shape.pathLeft:Pe.isHat(g)?this.outlinePath_+=this.constants_.START_HAT.path:Pe.isSpacer(g)&&(this.outlinePath_+=Nt("h",g.width));this.outlinePath_+=Nt("v",t.height)}drawJaggedEdge_(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Nt("v",t.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(t){const o=t.getLastInput();this.positionExternalValueConnection_(t);const c=tm(o.shape)?o.shape.pathDown(o.height):o.shape.pathDown;this.outlinePath_+=Nt("H",o.xPos+o.width)+c+Nt("v",t.height-o.connectionHeight)}drawStatementInput_(t){var o=t.getLastInput();if(o){var c=o.xPos+o.notchOffset+o.shape.width;o=o.shape.pathRight+Nt("h",-(o.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var g=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Nt("H",c)+o+Nt("v",g)+this.constants_.INSIDE_CORNERS.pathBottom+Nt("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}}drawRightSideRow_(t){this.outlinePath_+=Nt("V",t.yPos+t.height)}drawBottom_(){const t=this.info_.bottomRow,o=t.elements;this.positionNextConnection_();let c=0,g="";for(let b=o.length-1,M;M=o[b];b--)Pe.isNextConnection(M)&&M instanceof au?g+=M.shape.pathRight:Pe.isLeftSquareCorner(M)?g+=Nt("H",t.xPos):Pe.isLeftRoundedCorner(M)?g+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Pe.isRightRoundedCorner(M)?(g+=this.constants_.OUTSIDE_CORNERS.bottomRight,c=this.constants_.OUTSIDE_CORNERS.rightHeight):Pe.isSpacer(M)&&(g+=Nt("h",-1*M.width));this.outlinePath_+=Nt("V",t.baseline-c),this.outlinePath_+=g}drawLeft_(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){const o=t.connectionOffsetY+t.height;t=tm(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=Nt("V",o)+t}this.outlinePath_+="z"}drawInternals_(){for(let t=0,o;o=this.info_.rows[t];t++)for(let c=0,g;g=o.elements[c];c++)Pe.isInlineInput(g)?this.drawInlineInput_(g):(Pe.isIcon(g)||Pe.isField(g))&&this.layoutField_(g)}layoutField_(t){const o=t.centerline-t.height/2;let c=t.xPos;var g="";this.info_.RTL&&(c=-(c+t.width),t.flipRtl&&(c+=t.width,g="scale(-1 1)")),Pe.isIcon(t)?(g=t.icon,g.setOffsetInBlock(new At(c,o)),this.info_.isInsertionMarker&&g.hideForInsertionMarker()):(t=t.field.getSvgRoot(),t.setAttribute("transform","translate("+c+","+o+")"+g),this.info_.isInsertionMarker&&t.setAttribute("display","none"))}drawInlineInput_(t){const o=t.width,c=t.height,g=t.connectionOffsetY,b=t.connectionHeight+g;this.inlinePath_+=Ji(t.xPos+t.connectionWidth,t.centerline-c/2)+Nt("v",g)+t.shape.pathDown+Nt("v",c-b)+Nt("h",o-t.connectionWidth)+Nt("v",-c)+"z",this.positionInlineInputConnection_(t)}positionInlineInputConnection_(t){const o=t.centerline-t.height/2;if(t.connectionModel){let c=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(c*=-1),t.connectionModel.setOffsetInBlock(c,o+t.connectionOffsetY)}}positionStatementInputConnection_(t){const o=t.getLastInput();if(o!=null&&o.connectionModel){let c=t.xPos+t.statementEdge+o.notchOffset;this.info_.RTL&&(c*=-1),o.connectionModel.setOffsetInBlock(c,t.yPos)}}positionExternalValueConnection_(t){const o=t.getLastInput();if(o&&o.connectionModel){let c=t.xPos+t.width;this.info_.RTL&&(c*=-1),o.connectionModel.setOffsetInBlock(c,t.yPos)}}positionPreviousConnection_(){const t=this.info_.topRow;if(t.connection){const o=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,0)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const o=t.connection,c=o.xPos;o.connectionModel.setOffsetInBlock(this.info_.RTL?-c:c,t.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const t of this.info_.rows)for(const o of t.elements)if(o instanceof au)if(o.highlighted)this.drawConnectionHighlightPath(o);else{let c,g;(g=(c=this.block_.pathObject).removeConnectionHighlight)==null||g.call(c,o.connectionModel)}}drawConnectionHighlightPath(t){const o=t.connectionModel;t=o.type===Bt.INPUT_VALUE||o.type===Bt.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(t):this.getStatementConnectionHighlightPath(t);const c=o.getSourceBlock();let g,b;(b=(g=c.pathObject).addConnectionHighlight)==null||b.call(g,o,t,o.getOffsetInBlock(),c.RTL)}getExpressionConnectionHighlightPath(t){let o="";return tm(t.shape)?o=t.shape.pathDown(t.height):kt(t.shape)&&(o=t.shape.pathDown),t=this.constants_.TAB_OFFSET_FROM_TOP,yi(0,-t)+Nt("v",t)+o+Nt("v",t)}getStatementConnectionHighlightPath(t){if(!Hd(t.shape))throw Error("Statement connections should have notch shapes");const o=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return yi(-o,0)+Nt("h",o)+t.shape.pathLeft+Nt("h",o)}};(function(t){t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(n.Align$$module$build$src$core$inputs$align||(n.Align$$module$build$src$core$inputs$align={})),n.Align$$module$build$src$core$inputs$align;var Ef=class extends $i{constructor(t,o,c){super($i.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,t!==$i.SKIP_SETUP&&(c?this.configure_(c):this.class=o||null,this.setValue(t))}configure_(t){super.configure_(t),t.class&&(this.class=t.class)}initView(){this.createTextElement_(),this.class&&Me(this.getTextElement(),this.class)}doClassValidation_(t){return t==null?null:`${t}`}setClass(t){this.textElement_&&(this.class&&oe(this.textElement_,this.class),t&&Me(this.textElement_,t)),this.class=t}static fromJson(t){return new this(Ei(t.text),void 0,t)}};Bo("field_label",Ef),Ef.prototype.DEFAULT_VALUE="";var Rm=class{constructor(t,o){this.name=t,this.sourceBlock=o,this.fieldRow=[],this.align=n.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=n.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(t,o){return this.insertFieldAt(this.fieldRow.length,t,o),this}insertFieldAt(t,o,c){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(o||o===""&&c)&&(typeof o=="string"&&(o=n.fromJson$$module$build$src$core$field_registry({type:"field_label",text:o})),o.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(o),o.name=c,o.setVisible(this.isVisible()),o.prefixField&&(t=this.insertFieldAt(t,o.prefixField)),this.fieldRow.splice(t,0,o),t++,o.suffixField&&(t=this.insertFieldAt(t,o.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),t}removeField(t,o){for(let c=0,g;g=this.fieldRow[c];c++)if(g.name===t)return g.dispose(),this.fieldRow.splice(c,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(o)return!1;throw Error('Field "'+t+'" not found.')}isVisible(){return this.visible}setVisible(t){let o=[];if(this.visible===t)return o;this.visible=t;for(let g=0,b;b=this.fieldRow[g];g++)b.setVisible(t);if(this.connection){var c=this.connection;t?o=c.startTrackingAll():c.stopTrackingAll(),(c=c.targetBlock())&&(c.getSvgRoot().style.display=t?"block":"none")}return o}markDirty(){for(let t=0,o;o=this.fieldRow[t];t++)o.markDirty()}setCheck(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this}setAlign(t){return this.align=t,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const t of this.fieldRow)t.init()}initModel(){for(const t of this.fieldRow)t.initModel()}initField(t){this.sourceBlock.rendered?t.init():t.initModel()}dispose(){for(let t=0,o;o=this.fieldRow[t];t++)o.dispose();this.connection&&this.connection.dispose()}makeConnection(t){return this.sourceBlock.makeConnection_(t)}},dc=class extends Rm{constructor(t,o){super(t,o),this.name=t,this.type=n.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},lu=class extends Rm{constructor(t,o){super(t,o),this.name=t,this.type=n.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},Ko=class extends Rm{constructor(t,o){if(!t)throw Error("Statement inputs must have a non-empty name");super(t,o),this.name=t,this.type=n.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Bt.NEXT_STATEMENT)}},E1;n.ValueInput$$module$build$src$core$inputs$value_input=class extends Rm{constructor(t,o){if(!t)throw Error("Value inputs must have a non-empty name");super(t,o),this.name=t,this.type=n.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Bt.INPUT_VALUE)}},E1={},E1.ValueInput=n.ValueInput$$module$build$src$core$inputs$value_input;var ET=class{constructor(t,o){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=t,this.block_=o,this.constants_=this.renderer_.getConstants(),this.outputConnection=o.outputConnection?new T1(this.constants_,o.outputConnection):null,this.isInline=o.getInputsInline()&&!o.isCollapsed(),this.isCollapsed=o.isCollapsed(),this.isInsertionMarker=o.isInsertionMarker(),this.RTL=o.RTL,this.topRow=new Wb(this.constants_),this.bottomRow=new Ub(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let t=new Vb(this.constants_);this.inputRows.push(t);var o=this.block_.getIcons();for(let c=0,g;g=o[c];c++){const b=new m1(this.constants_,g);this.isCollapsed&&!g.isShownWhenCollapsed()||t.elements.push(b)}o=void 0;for(let c=0,g;g=this.block_.inputList[c];c++)if(g.isVisible()){this.shouldStartNewRow_(g,o)&&(this.rows.push(t),t=new Vb(this.constants_),this.inputRows.push(t));for(let b=0,M;M=g.fieldRow[b];b++)t.elements.push(new Cm(this.constants_,M,g));this.addInput_(g,t),o=g}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new g1(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var t=!!this.block_.previousConnection;const o=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;let c=this.topRow.hasLeftSquareCorner(this.block_)?vT:TT;this.topRow.elements.push(new c(this.constants_)),o?(t=new Gb(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new v1(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof Ko&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,c=this.topRow.hasRightSquareCorner(this.block_)?vT:TT,this.topRow.elements.push(new c(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Ko?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new vT(this.constants_)):this.bottomRow.elements.push(new TT(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new _1(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new vT(this.constants_,"right")):this.bottomRow.elements.push(new TT(this.constants_,"right"))}addInput_(t,o){this.isInline&&t instanceof n.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new Hb(this.constants_,t)),o.hasInlineInput=!0):t instanceof Ko?(o.elements.push(new _T(this.constants_,t)),o.hasStatement=!0):t instanceof n.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new _y(this.constants_,t)),o.hasExternalInput=!0):(t instanceof dc||t instanceof lu)&&(o.minHeight=Math.max(o.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),o.align===null&&(o.align=t.align)}shouldStartNewRow_(t,o){return o?o instanceof lu||t instanceof Ko||o instanceof Ko?!0:t instanceof n.ValueInput$$module$build$src$core$inputs$value_input||t instanceof dc||o instanceof n.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let t=0,o;o=this.rows[t];t++){const c=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new Yo(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(let g=0;g<c.length-1;g++){o.elements.push(c[g]);const b=this.getInRowSpacing_(c[g],c[g+1]);o.elements.push(new Yo(this.constants_,b))}o.elements.push(c[c.length-1]),o.endsWithElemSpacer()&&o.elements.push(new Yo(this.constants_,this.getInRowSpacing_(c[c.length-1],null)))}}}getInRowSpacing_(t,o){if(!t&&o&&Pe.isStatementInput(o))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&Pe.isInput(t)&&!o){if(Pe.isExternalInput(t))return this.constants_.NO_PADDING;if(Pe.isInlineInput(t))return this.constants_.LARGE_PADDING;if(Pe.isStatementInput(t))return this.constants_.NO_PADDING}return t&&Pe.isLeftSquareCorner(t)&&o&&(Pe.isPreviousConnection(o)||Pe.isNextConnection(o))?o.notchOffset:t&&Pe.isLeftRoundedCorner(t)&&o&&(Pe.isPreviousConnection(o)||Pe.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let t=0,o=0,c=0;for(let b=0,M;M=this.rows[b];b++){if(M.measure(),o=Math.max(o,M.width),M.hasStatement){var g=M.getLastInput();let te,$e;g=M.width-(($e=(te=g)==null?void 0:te.width)!=null?$e:0),t=Math.max(t,g)}c=Math.max(c,M.widthWithConnectedBlocks)}this.statementEdge=t,this.width=o;for(let b=0,M;M=this.rows[b];b++)M.hasStatement&&(M.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(o,c),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let o=0,c;c=this.rows[o];o++)if(c.hasStatement)this.alignStatementRow_(c);else{var t=c.width;t=this.getDesiredRowWidth_(c)-t,0<t&&this.addAlignmentPadding_(c,t),Pe.isTopOrBottomRow(c)&&(c.widthWithConnectedBlocks=c.width)}}getDesiredRowWidth_(t){return this.width-this.startX}addAlignmentPadding_(t,o){const c=t.getFirstSpacer(),g=t.getLastSpacer();if((t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=o),t.align===n.Align$$module$build$src$core$inputs$align.LEFT&&g)g.width+=o;else if(t.align===n.Align$$module$build$src$core$inputs$align.CENTRE&&c&&g)c.width+=o/2,g.width+=o/2;else if(t.align===n.Align$$module$build$src$core$inputs$align.RIGHT&&c)c.width+=o;else if(g)g.width+=o;else return;t.width+=o}alignStatementRow_(t){const o=t.getLastInput();if(o){var c=t.width-o.width,g=this.statementEdge;c=g-c,0<c&&this.addAlignmentPadding_(t,c),c=t.width,g=this.getDesiredRowWidth_(t),o.width+=g-c,o.height=Math.max(o.height,t.height),t.width+=g-c,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)}}addRowSpacing_(){const t=this.rows;this.rows=[];for(let o=0;o<t.length;o++)this.rows.push(t[o]),o!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[o],t[o+1]))}makeSpacerRow_(t,o){var c=this.getSpacerRowHeight_(t,o);const g=this.getSpacerRowWidth_(t,o);return c=new zb(this.constants_,c,g),t.hasStatement&&(c.followsStatement=!0),o.hasStatement&&(c.precedesStatement=!0),c}getSpacerRowWidth_(t,o){return this.width-this.startX}getSpacerRowHeight_(t,o){return this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){return Pe.isSpacer(o)?t.yPos+o.height/2:Pe.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,Pe.isNextConnection(o)?t+o.height/2:t-o.height/2):Pe.isTopRow(t)?Pe.isHat(o)?t.capline-o.height/2:t.capline+o.height/2:t.yPos+t.height/2}recordElemPositions_(t){let o=t.xPos;for(let c=0,g;g=t.elements[c];c++)Pe.isSpacer(g)&&(g.height=t.height),g.xPos=o,g.centerline=this.getElemCenterline_(t,g),o+=g.width}finalize_(){let t=0,o=0;for(let c=0,g;g=this.rows[c];c++)g.yPos=o,g.xPos=this.startX,o+=g.height,t=Math.max(t,g.widthWithConnectedBlocks),this.recordElemPositions_(g);if(this.outputConnection&&this.block_.nextConnection){const c=this.block_.nextConnection.targetBlock();c&&(t=Math.max(t,c.getHeightWidth().width))}this.widthWithChildren=t+this.startX,this.height=o,this.startY=this.topRow.capline,this.bottomRow.baseline=o-this.bottomRow.descenderHeight}getMeasureableForConnection(t){let o;if(((o=this.outputConnection)==null?void 0:o.connectionModel)===t)return this.outputConnection;for(const c of this.rows)for(const g of c.elements)if(g instanceof au&&g.connectionModel===t)return g;return null}},Xb=class extends ff{constructor(t){if(super(t),this.type=n.DELETE$$module$build$src$core$events$utils,t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=Ku(t),this.ids=O(t),this.wasShadow=t.isShadow(),this.oldJson=zi(t,{addCoordinates:!0})}}toJson(){const t=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.oldXml=Do(this.oldXml),t.ids=this.ids,t.wasShadow=this.wasShadow,t.oldJson=this.oldJson,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Xb),o.oldXml=n.textToDom$$module$build$src$core$utils$xml(t.oldXml),o.ids=t.ids,o.wasShadow=t.wasShadow||o.oldXml.tagName.toLowerCase()==="shadow",o.oldJson=t.oldJson,t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}run(t){const o=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(t)for(t=0;t<this.ids.length;t++){const c=this.ids[t],g=o.getBlockById(c);g?g.dispose(!1):c===this.blockId&&console.warn("Can't delete non-existent block: "+c)}else Ii(this.oldJson,o)}};r(yt.EVENT,n.DELETE$$module$build$src$core$events$utils,Xb);var Jn=class{constructor(t,o){this.type=o,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=t}connect_(t){const o=Bt.INPUT_VALUE,c=this.getSourceBlock();var g=t.getSourceBlock();t.isConnected()&&t.disconnectInternal(!1);let b;if(this.isConnected()){const te=this.stashShadowState(),$e=this.targetBlock();$e.isShadow()?$e.dispose(!1):(this.disconnectInternal(),b=$e),this.applyShadowState(te)}let M;x()&&(M=new(k(n.MOVE$$module$build$src$core$events$utils))(g),M.setReason(["connect"])),nm(this,t),g.setParent(c),M&&(M.recordNew(),$(M)),b&&(t=this.type===o?b.outputConnection:b.previousConnection)&&((g=Jn.getConnectionForOrphanedConnection(g,t))?t.connect(g):t.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const t=this.targetBlock();t&&!t.isDeadOrDying()&&t.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Bt.INPUT_VALUE||this.type===Bt.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(t){}connect(t){if(this.targetConnection===t)return!0;if(this.getConnectionChecker().canConnect(this,t,!1)){const o=n.getGroup$$module$build$src$core$events$utils();o||n.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(t):t.connect_(this),n.setGroup$$module$build$src$core$events$utils(o)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(t=!0){const{parentConnection:o,childConnection:c}=this.getParentAndChildConnections();if(!o||!c)throw Error("Source connection not connected.");const g=n.getGroup$$module$build$src$core$events$utils();g||n.setGroup$$module$build$src$core$events$utils(!0);let b;x()&&(b=new(k(n.MOVE$$module$build$src$core$events$utils))(c.getSourceBlock()),b.setReason(["disconnect"]));const M=this.targetConnection;M&&(M.targetConnection=null),this.targetConnection=null,t&&c.getSourceBlock().setParent(null),b&&(b.recordNew(),$(b)),c.getSourceBlock().isShadow()||o.respawnShadow_(),n.setGroup$$module$build$src$core$events$utils(g)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(t,o){if(this.getSourceBlock().isDeadOrDying())return!1;var c;return o=(c=t.getInput(o))==null?void 0:c.connection,c=this.targetBlock(),c&&c!==t||!o||o.targetConnection===this?!1:(o.isConnected()&&o.disconnect(),o.connect(this),!0)}targetBlock(){if(this.isConnected()){let t,o;return(o=(t=this.targetConnection)==null?void 0:t.getSourceBlock())!=null?o:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return t?(Array.isArray(t)||(t=[t]),this.check=t,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(t){this.setShadowStateInternal({shadowDom:t})}getShadowDom(t){return t&&this.targetBlock().isShadow()?Ta(this.targetBlock()):this.shadowDom}setShadowState(t){this.setShadowStateInternal({shadowState:t})}getShadowState(t){return t&&this.targetBlock()&&this.targetBlock().isShadow()?zi(this.targetBlock()):this.shadowState}neighbours(t){return[]}getParentInput(){let t=null;const o=this.sourceBlock_.inputList;for(let c=0;c<o.length;c++)if(o[c].connection===this){t=o[c];break}return t}toString(){const t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection===this)var o="Output Connection of ";else if(t.previousConnection===this)o="Previous Connection of ";else if(t.nextConnection===this)o="Next Connection of ";else{o=null;for(let c=0,g;g=t.inputList[c];c++)if(g.connection===this){o=g;break}if(o)o='Input "'+o.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return o+t.toDevString()}stashShadowState(){const t=this.getShadowDom(!0),o=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:t,shadowState:o}}applyShadowState({shadowDom:t,shadowState:o}){this.shadowDom=t,this.shadowState=o}setShadowStateInternal({shadowDom:t=null,shadowState:o=null}={}){this.shadowDom=t,this.shadowState=o,this.getSourceBlock().isDeadOrDying()||((t=this.targetBlock())?t.isShadow()?(t.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(t=this.createShadowBlock(!1),this.serializeShadow(t),t&&t.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(t){var o=this.getSourceBlock();const c=this.getShadowState(),g=this.getShadowDom();if(o.isDeadOrDying()||!c&&!g)return null;if(c)return o=fo(c,o.workspace,{parentConnection:t?this:void 0,isShadow:!0,recordUndo:!1});if(g){if(o=Ql(g,o.workspace),t)if(this.type===Bt.INPUT_VALUE){if(!o.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(o.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Bt.NEXT_STATEMENT){if(!o.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(o.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return o}return null}serializeShadow(t){t&&(this.shadowDom=Ta(t),this.shadowState=zi(t))}static getConnectionForOrphanedConnection(t,o){if(o.type===Bt.OUTPUT_VALUE)return VE(t,o.getSourceBlock());t=t.lastConnectionInStack(!0);const c=o.getConnectionChecker();return t&&c.canConnect(o,t,!1)?t:null}};Jn.CAN_CONNECT=0,Jn.REASON_SELF_CONNECTION=1,Jn.REASON_WRONG_TYPE=2,Jn.REASON_TARGET_NULL=3,Jn.REASON_CHECKS_FAILED=4,Jn.REASON_DIFFERENT_WORKSPACES=5,Jn.REASON_SHADOW_PARENT=6,Jn.REASON_DRAG_CHECKS_FAILED=7,Jn.REASON_PREVIOUS_AND_OUTPUT=8;var yf=class{constructor(t,o,c){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=null,this.statementInputCount=0,this.workspace=t,this.id=c&&!t.getBlockById(c)?c:v(),t.setBlockById(this.id,this),this.xy_=new At(0,0),this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,o){if(this.type=o,c=Ns[o],!c||typeof c!="object")throw TypeError("Invalid block definition for type: "+o);Object.assign(this,c)}t.addTopBlock(this),t.addTypedBlock(this),new.target===yf&&this.doInit_()}doInit_(){const t=n.getGroup$$module$build$src$core$events$utils();t||n.setGroup$$module$build$src$core$events$utils(!0);const o=y();try{typeof this.init=="function"&&(n.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),n.setRecordUndo$$module$build$src$core$events$utils(o)),x()&&$(new(k(n.CREATE$$module$build$src$core$events$utils))(this))}finally{n.setGroup$$module$build$src$core$events$utils(t),n.setRecordUndo$$module$build$src$core$events$utils(o)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(t=!1){this.disposing=!0,this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),x()&&$(new(k(n.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(t=>t.disposeInternal()),this.inputList.forEach(t=>t.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(t=>t.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const t of this.inputList)t.initModel();this.initialized=!0}}unplug(t){this.outputConnection&&this.unplugFromRow_(t),this.previousConnection&&this.unplugFromStack_(t)}unplugFromRow_(t){let o=null,c;(c=this.outputConnection)!=null&&c.isConnected()&&(o=this.outputConnection.targetConnection,this.outputConnection.disconnect()),o&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&(t=t.targetConnection,t==null||t.disconnect(),this.workspace.connectionChecker.canConnect(t,o,!1)?o.connect(t):t==null||t.onFailedConnect(o))}getOnlyValueConnection_(){let t=null;for(let o=0;o<this.inputList.length;o++){const c=this.inputList[o].connection;if(c&&c.type===Bt.INPUT_VALUE&&c.targetConnection){if(t)return null;t=c}}return t}unplugFromStack_(t){let o=null;var c;if((c=this.previousConnection)!=null&&c.isConnected()&&(o=this.previousConnection.targetConnection,this.previousConnection.disconnect()),c=this.getNextBlock(),t&&c&&!c.isShadow()){let g,b;t=(b=(g=this.nextConnection)==null?void 0:g.targetConnection)!=null?b:null,t==null||t.disconnect(),o&&this.workspace.connectionChecker.canConnect(o,t,!1)&&o.connect(t)}}getConnections_(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(let o=0,c;c=this.inputList[o];o++)c.connection&&t.push(c.connection);return t}lastConnectionInStack(t){let o=this.nextConnection;for(;o;){const c=o.targetBlock();if(!c||t&&c.isShadow())return o;o=c.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(t){for(let o=0,c;c=this.inputList[o];o++)if(c.connection&&c.connection.targetBlock()===t)return c;return null}getSurroundParent(){let t=this,o;do if(o=t,t=t.getParent(),!t)return null;while(t.getNextBlock()===o);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let t,o=this;do t=o,o=t.parentBlock_;while(o);return t}getTopStackBlock(){let t=this,o;do o=t.getPreviousBlock();while(o&&o.getNextBlock()===t&&(t=o));return t}getChildren(t){if(!t)return this.childBlocks_;t=[];for(let c=0,g;g=this.inputList[c];c++)if(g.connection){var o=g.connection.targetBlock();o&&t.push(o)}return(o=this.getNextBlock())&&t.push(o),t}setParent(t){if(t!==this.parentBlock_){var o=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),c=!!o;if(c&&t&&o!==t)throw Error("Block connected to superior one that is not new parent.");if(!c&&t)throw Error("Block not connected to new parent.");if(c&&!t)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?tt(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(t){const o=[this],c=this.getChildren(t);for(let g,b=0;g=c[b];b++)o.push(...g.getDescendants(t));return o}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(t){this.movable_=t}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(K(this,!0)):!0}isShadow(){return this.isShadow_}setShadow(t){this.isShadow_=t}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(t){this.isInsertionMarker_=t}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(t){this.editable_=t;for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)b.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const t of this.inputList)if(t.connection||1<t.fieldRow.length)return!1;return!0}getMatchingConnection(t,o){const c=this.getConnections_(!0);if(t=t.getConnections_(!0),c.length!==t.length)throw Error("Connection lists did not match in length.");for(let g=0;g<t.length;g++)if(t[g]===o)return c[g];return null}setHelpUrl(t){this.helpUrl=t}setTooltip(t){this.tooltip=t}getTooltip(){return kc(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(t){t=Jl(t),this.hue_=t.hue,this.colour_=t.hex}setStyle(t){this.styleName_=t}setOnChange(t){if(t&&typeof t!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=t,this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(t){if(typeof t!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(t===void 0?"nothing":t+" of type "+typeof t)+" instead");for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)if(b.name===t)return b;return null}getVars(){const t=[];for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)b.referencesVariables()&&t.push(b.getValue());return t}getVarModels(){const t=[];for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)if(b.referencesVariables()){const M=this.workspace.getVariableById(b.getValue());M&&t.push(M)}return t}updateVarName(t){for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)b.referencesVariables()&&t.getId()===b.getValue()&&b.refreshVariableName()}renameVarById(t,o){for(let c=0,g;g=this.inputList[c];c++)for(let b=0,M;M=g.fieldRow[b];b++)M.referencesVariables()&&t===M.getValue()&&M.setValue(o)}getFieldValue(t){return(t=this.getField(t))?t.getValue():null}setFieldValue(t,o){const c=this.getField(o);if(!c)throw Error('Field "'+o+'" not found.');c.setValue(t)}setPreviousStatement(t,o){if(t)o===void 0&&(o=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Bt.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(o);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(t,o){if(t)o===void 0&&(o=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Bt.NEXT_STATEMENT)),this.nextConnection.setCheck(o);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(t,o){if(t)o===void 0&&(o=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Bt.OUTPUT_VALUE)),this.outputConnection.setCheck(o);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(t){this.inputsInline!==t&&($(new(k(n.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof dc&&this.inputList[t]instanceof dc)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof n.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[t]instanceof dc)return!0;for(t=0;t<this.inputList.length;t++)if(this.inputList[t]instanceof lu)return!0;return!1}setOutputShape(t){this.outputShape_=t}getOutputShape(){return this.outputShape_}isEnabled(){return this.disabledReasons.size===0}get disabled(){return sl("disabled","v11","v12","the isEnabled or hasDisabledReason methods of Block"),this.hasDisabledReason(ba)}set disabled(t){sl("disabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(t,ba)}setEnabled(t){sl("setEnabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(!t,ba)}setDisabledReason(t,o){this.disabledReasons.has(o)!==t&&(t?this.disabledReasons.add(o):this.disabledReasons.delete(o),t=new(k(n.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,!t,t),t.setDisabledReason(o),$(t))}getInheritedDisabled(){let t=this.getSurroundParent();for(;t;){if(!t.isEnabled())return!0;t=t.getSurroundParent()}return!1}hasDisabledReason(t){return this.disabledReasons.has(t)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(t){this.collapsed_!==t&&($(new(k(n.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)}toString(t,o){o=this.toTokens(o);for(let g=2;g<o.length;g++)o[g-2]==="("&&o[g]===")"&&(o[g-2]=o[g-1],o.splice(g-1,2));let c="";return o=o.reduce((g,b)=>(g=g+(c==="("||b===")"?"":" ")+b,c=b[b.length-1],g),""),o=o.trim()||"???",t&&o.length>t&&(o=o.substring(0,t-3)+"..."),o}toTokens(t="?"){const o=[];for(const g of this.inputList)if(g.name!=iT){for(const b of g.fieldRow)o.push(b.getText());if(g.connection){const b=g.connection.targetBlock();if(b){var c=g.connection;let M=c.getCheck();!M&&c.targetConnection&&(M=c.targetConnection.getCheck()),(c=!!M&&(M.includes("Boolean")||M.includes("Number")))&&o.push("("),o.push(...b.toTokens(t)),c&&o.push(")")}else o.push(t)}}return o}appendValueInput(t){return this.appendInput(new n.ValueInput$$module$build$src$core$inputs$value_input(t,this))}appendStatementInput(t){return this.statementInputCount++,this.appendInput(new Ko(t,this))}appendDummyInput(t=""){return this.appendInput(new dc(t,this))}appendEndRowInput(t=""){return this.appendInput(new lu(t,this))}appendInput(t){return this.inputList.push(t),t}appendInputFromRegistry(t,o){return(t=d(yt.INPUT,t,!1))?this.appendInput(new t(o,this)):null}jsonInit(t){var o=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(o+"Must not have both an output and a previousStatement.");for(var c=0;t["args"+c];){if(t["message"+c]===void 0)throw Error(o+`args${c} must have a corresponding message (message${c}).`);c++}if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(o+"Must not have both a colour and a style.");for(t.style?this.jsonInitStyle_(t,o):this.jsonInitColour_(t,o),c=0;t["message"+c]!==void 0;)this.interpolate_(t["message"+c],t["args"+c]||[],t["implicitAlign"+c]||t["lastDummyAlign"+c],o),c++;if(t.inputsInline!==void 0&&(n.disable$$module$build$src$core$events$utils(),this.setInputsInline(t.inputsInline),n.enable$$module$build$src$core$events$utils()),t.output!==void 0&&this.setOutput(!0,t.output),t.outputShape!==void 0&&this.setOutputShape(t.outputShape),t.previousStatement!==void 0&&this.setPreviousStatement(!0,t.previousStatement),t.nextStatement!==void 0&&this.setNextStatement(!0,t.nextStatement),t.tooltip!==void 0&&(c=Ei(t.tooltip),this.setTooltip(c)),t.enableContextMenu!==void 0&&(this.contextMenu=!!t.enableContextMenu),t.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!t.suppressPrefixSuffix),t.helpUrl!==void 0&&(c=Ei(t.helpUrl),this.setHelpUrl(c)),typeof t.extensions=="string"&&(console.warn(o+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),t.mutator!==void 0&&Gc(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(o=0;o<t.length;o++)Gc(t[o],this,!1)}jsonInitColour_(t,o){if("colour"in t)if(t.colour===void 0)console.warn(o+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch{console.warn(o+"Illegal colour value: ",t)}}}jsonInitStyle_(t,o){t=t.style;try{this.setStyle(t)}catch{console.warn(o+"Style does not exist: ",t)}}mixin(t,o){if(o!==void 0&&typeof o!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!o){o=[];for(const c in t)this[c]!==void 0&&o.push(c);if(o.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(o))}Object.assign(this,t)}interpolate_(t,o,c,g){t=xd(t),this.validateTokens_(t,o.length),o=this.interpolateArguments_(t,o,c),c=[];for(let b=0,M;M=o[b];b++)if(this.isInputKeyword_(M.type)){if(t=this.inputFromJson_(M,g)){for(let te=0,$e;$e=c[te];te++)t.appendField($e[0],$e[1]);c.length=0}}else(t=this.fieldFromJson_(M))&&c.push([t,M.name])}validateTokens_(t,o){const c=[];let g=0;for(let b=0;b<t.length;b++){const M=t[b];if(typeof M=="number"){if(1>M||M>o)throw Error('Block "'+this.type+'": Message index %'+M+" out of range.");if(c[M])throw Error('Block "'+this.type+'": Message index %'+M+" duplicated.");c[M]=!0,g++}}if(g!==o)throw Error('Block "'+this.type+'": Message does not reference all '+o+" arg(s).")}interpolateArguments_(t,o,c){const g=[];for(let M=0;M<t.length;M++){var b=t[M];if(typeof b=="number"&&(b=o[b-1]),typeof b=="string"){if(b===`
`)b={type:"input_end_row"},c&&(b.align=c);else if(b=this.stringToFieldJson_(b),!b)continue}g.push(b)}return(t=g.length)&&!this.isInputKeyword_(g[t-1].type)&&(t={type:"input_dummy"},c&&(t.align=c),g.push(t)),g}fieldFromJson_(t){const o=n.fromJson$$module$build$src$core$field_registry(t);return!o&&t.alt?typeof t.alt=="string"?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):o}inputFromJson_(t,o){var c={LEFT:n.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:n.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:n.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:n.Align$$module$build$src$core$inputs$align.CENTRE};let g;switch(t.type){case"input_value":g=this.appendValueInput(t.name);break;case"input_statement":g=this.appendStatementInput(t.name);break;case"input_dummy":g=this.appendDummyInput(t.name);break;case"input_end_row":g=this.appendEndRowInput(t.name);break;default:g=this.appendInputFromRegistry(t.type,t.name)}return g?(t.check&&g.setCheck(t.check),t.align&&(c=c[t.align.toUpperCase()],c===void 0?console.warn(o+"Illegal align value: ",t.align):g.setAlign(c)),g):null}isInputKeyword_(t){return t==="input_value"||t==="input_statement"||t==="input_dummy"||t==="input_end_row"||u(yt.INPUT,t)}stringToFieldJson_(t){return(t=t.trim())?{type:"field_label",text:t}:null}moveInputBefore(t,o){if(t!==o){var c=-1,g=o?-1:this.inputList.length;for(let b=0,M;M=this.inputList[b];b++)if(M.name===t){if(c=b,g!==-1)break}else if(o&&M.name===o&&(g=b,c!==-1))break;if(c===-1)throw Error('Named input "'+t+'" not found.');if(g===-1)throw Error('Reference input "'+o+'" not found.');this.moveNumberedInputBefore(c,g)}}moveNumberedInputBefore(t,o){if(t===o)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(o>this.inputList.length)throw RangeError("Reference input "+o+" out of bounds.");const c=this.inputList[t];this.inputList.splice(t,1),t<o&&o--,this.inputList.splice(o,0,c)}removeInput(t,o){for(let c=0,g;g=this.inputList[c];c++)if(g.name===t)return g instanceof Ko&&this.statementInputCount--,g.dispose(),this.inputList.splice(c,1),!0;if(o)return!1;throw Error("Input not found: "+t)}getInput(t){for(let o=0,c;c=this.inputList[o];o++)if(c.name===t)return c;return null}getInputTargetBlock(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()}getCommentText(){let t,o;return(o=(t=this.getIcon(wr.COMMENT))==null?void 0:t.getText())!=null?o:null}setCommentText(t){var o;let c;const g=(c=(o=this.getIcon(wr.COMMENT))==null?void 0:o.getText())!=null?c:null;if(g!==t){if(t!==null){if(o=this.getIcon(wr.COMMENT),!o){if(o=d(yt.ICON,wr.COMMENT.toString(),!1),!o)throw Error("No comment icon class is registered, so a comment cannot be set");if(o=new o(this),!ih(o))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");o=this.addIcon(o)}n.disable$$module$build$src$core$events$utils(),o.setText(t),n.enable$$module$build$src$core$events$utils()}else this.removeIcon(wr.COMMENT);$(new(k(n.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,g,t))}}setWarningText(t,o){}setMutator(t){}addIcon(t){if(this.hasIcon(t.getType()))throw new f1(t);return this.icons.push(t),this.icons.sort((o,c)=>o.getWeight()-c.getWeight()),t}removeIcon(t){if(!this.hasIcon(t))return!1;let o;return(o=this.getIcon(t))==null||o.dispose(),this.icons=this.icons.filter(c=>!c.getType().equals(t)),!0}hasIcon(t){return this.icons.some(o=>o.getType().equals(t))}getIcon(t){return t instanceof wr?this.icons.find(o=>o.getType().equals(t)):this.icons.find(o=>o.getType().toString()===t)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(t,o,c){if(this.parentBlock_)throw Error("Block has parent");const g=new(k(n.MOVE$$module$build$src$core$events$utils))(this);c&&g.setReason(c),this.xy_.translate(t,o),g.recordNew(),$(g)}makeConnection_(t){return new Jn(this,t)}allInputsFilled(t){if(t===void 0&&(t=!0),!t&&this.isShadow())return!1;for(let c=0,g;g=this.inputList[c];c++)if(g.connection){var o=g.connection.targetBlock();if(!o||!o.allInputsFilled(t))return!1}return(o=this.getNextBlock())?o.allInputsFilled(t):!0}toDevString(){let t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t}};yf.COLLAPSED_INPUT_NAME=iT,yf.COLLAPSED_FIELD_NAME=KE;var xa=class{constructor(t,o,c,g){this.workspace=t,this.targetWorkspace=o,this.isFlyoutLabel=g,this.onMouseUpWrapper=null,this.height=this.width=0,this.cursorSvg=this.svgText=this.svgGroup=null,this.text=c.text,this.position=new At(0,0),this.callbackKey=c.callbackKey||c.callbackkey,this.cssClass=c["web-class"]||null,this.info=c}createDom(){var t=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass&&(t+=" "+this.cssClass),this.svgGroup=ve(Xe.G,{class:t},this.workspace.getCanvas());let o;this.isFlyoutLabel||(o=ve(Xe.RECT,{class:"blocklyFlyoutButtonShadow",rx:xa.BORDER_RADIUS,ry:xa.BORDER_RADIUS,x:1,y:1},this.svgGroup)),t=ve(Xe.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:xa.BORDER_RADIUS,ry:xa.BORDER_RADIUS},this.svgGroup);const c=ve(Xe.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var g=Ei(this.text);this.workspace.RTL&&(g+=""),c.textContent=g,this.isFlyoutLabel&&(this.svgText=c,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const b=be(c,"fontSize"),M=be(c,"fontWeight"),te=be(c,"fontFamily");if(this.width=St(c,b,M,te),g=L(g,b,M,te),this.height=g.height,!this.isFlyoutLabel){this.width+=2*xa.TEXT_MARGIN_X,this.height+=2*xa.TEXT_MARGIN_Y;let $e;($e=o)==null||$e.setAttribute("width",String(this.width));let it;(it=o)==null||it.setAttribute("height",String(this.height))}return t.setAttribute("width",String(this.width)),t.setAttribute("height",String(this.height)),c.setAttribute("x",String(this.width/2)),c.setAttribute("y",String(this.height/2-g.height/2+g.baseline)),this.updateTransform(),this.onMouseUpWrapper=Ye(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(t,o){this.position.x=t,this.position.y=o,this.updateTransform()}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){this.onMouseUpWrapper&&Q(this.onMouseUpWrapper),this.svgGroup&&W(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(t){t?this.svgGroup&&(this.svgGroup.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(){throw Error("Attempted to set a marker on a button.")}onMouseUp(t){(t=this.targetWorkspace.getGesture(t))&&t.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(t=this.targetWorkspace.getButtonCallback(this.callbackKey))&&t(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};xa.TEXT_MARGIN_X=5,xa.TEXT_MARGIN_Y=2,xa.BORDER_RADIUS=4,Ue(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var _t=class{constructor(t,o,c){if(this.wsCoordinate=null,!o)throw Error("Cannot create a node without a location.");this.type=t,this.isConnectionLocation=_t.isConnectionType(t),this.location=o,this.processParams(c||null)}processParams(t){t&&t.wsCoordinate&&(this.wsCoordinate=t.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var t=this.location.getParentInput();const o=t.getSourceBlock();for(t=o.inputList.indexOf(t),t+=1;t<o.inputList.length;t++){const c=o.inputList[t],g=c.fieldRow;for(let b=0;b<g.length;b++){const M=g[b];if(M.isClickable()||_t.NAVIGATE_ALL_FIELDS)return _t.createFieldNode(M)}if(c.connection)return _t.createInputNode(c)}return null}findNextForField(){var t=this.location,o=t.getParentInput();const c=t.getSourceBlock();if(!c)throw Error("The current AST location is not associated with a block");var g=c.inputList.indexOf(o);for(t=o.fieldRow.indexOf(t)+1;g<c.inputList.length;g++){o=c.inputList[g];const b=o.fieldRow;for(;t<b.length;){if(b[t].isClickable()||_t.NAVIGATE_ALL_FIELDS)return _t.createFieldNode(b[t]);t++}if(t=0,o.connection)return _t.createInputNode(o)}return null}findPrevForInput(){const t=this.location.getParentInput(),o=t.getSourceBlock();for(var c=o.inputList.indexOf(t);0<=c;c--){var g=o.inputList[c];if(g.connection&&g!==t)return _t.createInputNode(g);g=g.fieldRow;for(let b=g.length-1;0<=b;b--){const M=g[b];if(M.isClickable()||_t.NAVIGATE_ALL_FIELDS)return _t.createFieldNode(M)}}return null}findPrevForField(){var t=this.location;const o=t.getParentInput(),c=t.getSourceBlock();if(!c)throw Error("The current AST location is not associated with a block");var g=c.inputList.indexOf(o);for(t=o.fieldRow.indexOf(t)-1;0<=g;g--){var b=c.inputList[g];if(b.connection&&b!==o)return _t.createInputNode(b);for(b=b.fieldRow;-1<t;){if(b[t].isClickable()||_t.NAVIGATE_ALL_FIELDS)return _t.createFieldNode(b[t]);t--}0<=g-1&&(t=c.inputList[g-1].fieldRow.length-1)}return null}navigateBetweenStacks(t){var o=this.getLocation();if(o.getSourceBlock){var c=o.getSourceBlock();c&&(o=c)}if(!o||o.isDeadOrDying())return null;if(o.workspace.isFlyout)return this.navigateFlyoutContents(t);c=o.getRootBlock(),o=c.workspace.getTopBlocks(!0);for(let g=0;g<o.length;g++)if(c.id===o[g].id)return t=g+(t?1:-1),t===-1||t===o.length?null:_t.createStackNode(o[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")}navigateFlyoutContents(t){let o;switch(this.getType()){case _t.types.STACK:o=this.getLocation();var c=o.workspace.targetWorkspace;break;case _t.types.BUTTON:o=this.getLocation(),c=o.getTargetWorkspace();break;default:return null}return c=c.getFlyout(),c&&(t=this.findNextLocationInFlyout(c.getContents(),o,t))?t.type==="button"&&t.button?_t.createButtonNode(t.button):t.type==="block"&&t.block?_t.createStackNode(t.block):null:null}findNextLocationInFlyout(t,o,c){const g=t.findIndex(b=>o instanceof yf&&b.block===o||o instanceof xa&&b.button===o);return 0>g?null:(c=c?g+1:g-1,c===-1||c===t.length?null:t[c])}findTopASTNodeForBlock(t){const o=Hc(t);return o?_t.createConnectionNode(o):_t.createBlockNode(t)}getOutAstNodeForBlock(t){if(!t)return null;t=t.getTopStackBlock();const o=Hc(t);return o&&o.targetConnection&&o.targetConnection.getParentInput()?_t.createInputNode(o.targetConnection.getParentInput()):_t.createStackNode(t)}findFirstFieldOrInput(t){t=t.inputList;for(let o=0;o<t.length;o++){const c=t[o],g=c.fieldRow;for(let b=0;b<g.length;b++){const M=g[b];if(M.isClickable()||_t.NAVIGATE_ALL_FIELDS)return _t.createFieldNode(M)}if(c.connection)return _t.createInputNode(c)}return null}getSourceBlock(){return this.getType()===_t.types.BLOCK?this.getLocation():this.getType()===_t.types.STACK?this.getLocation():this.getType()===_t.types.WORKSPACE||this.getType()===_t.types.BUTTON?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case _t.types.STACK:return this.navigateBetweenStacks(!0);case _t.types.OUTPUT:return _t.createBlockNode(this.location.getSourceBlock());case _t.types.FIELD:return this.findNextForField();case _t.types.INPUT:return this.findNextForInput();case _t.types.BLOCK:const t=this.location.nextConnection;if(!t)break;return _t.createConnectionNode(t);case _t.types.PREVIOUS:return _t.createBlockNode(this.location.getSourceBlock());case _t.types.NEXT:return _t.createConnectionNode(this.location.targetConnection);case _t.types.BUTTON:return this.navigateFlyoutContents(!0)}return null}in(){switch(this.type){case _t.types.WORKSPACE:const t=this.location.getTopBlocks(!0);if(0<t.length)return _t.createStackNode(t[0]);break;case _t.types.STACK:return this.findTopASTNodeForBlock(this.location);case _t.types.BLOCK:return this.findFirstFieldOrInput(this.location);case _t.types.INPUT:return _t.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case _t.types.STACK:return this.navigateBetweenStacks(!1);case _t.types.FIELD:return this.findPrevForField();case _t.types.INPUT:return this.findPrevForInput();case _t.types.BLOCK:var t=Hc(this.location);if(!t)break;return _t.createConnectionNode(t);case _t.types.PREVIOUS:if((t=this.location.targetConnection)&&!t.getParentInput())return _t.createConnectionNode(t);break;case _t.types.NEXT:return _t.createBlockNode(this.location.getSourceBlock());case _t.types.BUTTON:return this.navigateFlyoutContents(!1)}return null}out(){switch(this.type){case _t.types.STACK:var t=this.location,o=t.getRelativeToSurfaceXY();return o=new At(o.x,o.y+_t.DEFAULT_OFFSET_Y),_t.createWorkspaceNode(t.workspace,o);case _t.types.OUTPUT:return t=this.location,(o=t.targetConnection)?_t.createConnectionNode(o):_t.createStackNode(t.getSourceBlock());case _t.types.FIELD:if(t=this.location.getSourceBlock(),!t)throw Error("The current AST location is not associated with a block");return _t.createBlockNode(t);case _t.types.INPUT:return _t.createBlockNode(this.location.getSourceBlock());case _t.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case _t.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case _t.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(t){switch(t){case _t.types.PREVIOUS:case _t.types.NEXT:case _t.types.INPUT:case _t.types.OUTPUT:return!0}return!1}static createFieldNode(t){return t?new _t(_t.types.FIELD,t):null}static createConnectionNode(t){if(!t)return null;const o=t.type;return o===Bt.INPUT_VALUE||o===Bt.NEXT_STATEMENT&&t.getParentInput()?_t.createInputNode(t.getParentInput()):o===Bt.NEXT_STATEMENT?new _t(_t.types.NEXT,t):o===Bt.OUTPUT_VALUE?new _t(_t.types.OUTPUT,t):o===Bt.PREVIOUS_STATEMENT?new _t(_t.types.PREVIOUS,t):null}static createInputNode(t){return t&&t.connection?new _t(_t.types.INPUT,t.connection):null}static createBlockNode(t){return t?new _t(_t.types.BLOCK,t):null}static createStackNode(t){return t?new _t(_t.types.STACK,t):null}static createButtonNode(t){return t?new _t(_t.types.BUTTON,t):null}static createWorkspaceNode(t,o){return o&&t?new _t(_t.types.WORKSPACE,t,{wsCoordinate:o}):null}static createTopNode(t){const o=Hc(t);return o?_t.createConnectionNode(o):_t.createBlockNode(t)}};_t.NAVIGATE_ALL_FIELDS=!1,_t.DEFAULT_OFFSET_Y=-20,function(t){t=t.types||(t.types={}),t.FIELD="field",t.BLOCK="block",t.INPUT="input",t.OUTPUT="output",t.NEXT="next",t.PREVIOUS="previous",t.STACK="stack",t.WORKSPACE="workspace",t.BUTTON="button"}(_t||(_t={}));var jb=class extends Rt{constructor(t,o,c,g){let b=t?t.workspace.id:void 0;g&&g.getType()===_t.types.WORKSPACE&&(b=g.getLocation().id),super(b),this.type=oc,this.blockId=t==null?void 0:t.id,this.oldNode=c||void 0,this.newNode=g,this.isCursor=o}toJson(){const t=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new jb),o.isCursor=t.isCursor,o.blockId=t.blockId,o.oldNode=t.oldNode,o.newNode=t.newNode,o}};r(yt.EVENT,oc,jb);var pG="blocklyCursor",mG="blocklyMarker",gG=.75,Yb=class{constructor(t,o,c){this.workspace=t,this.marker=c,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=o,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=c.colour||t}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const t=this.isCursor()?pG:mG;return this.svgGroup_=ve(Xe.G,{class:t}),this.createDomInternal_(),this.svgGroup_}setParent_(t){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent=t}draw(t,o){if(o){this.constants_=this.workspace.getRenderer().getConstants();var c=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||c,this.applyColour_(o),this.showAtLocation_(o),this.fireMarkerEvent(t,o),t=this.currentMarkerSvg.childNodes[0],t!==void 0&&t.beginElement&&t.beginElement()}else this.hide()}showAtLocation_(t){const o=t.getLocation().type;t.getType()===_t.types.BLOCK?this.showWithBlock_(t):t.getType()===_t.types.OUTPUT?this.showWithOutput_(t):o===Bt.INPUT_VALUE?this.showWithInput_(t):o===Bt.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===_t.types.PREVIOUS?this.showWithPrevious_(t):t.getType()===_t.types.FIELD?this.showWithField_(t):t.getType()===_t.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===_t.types.STACK?this.showWithStack_(t):t.getType()===_t.types.BUTTON&&this.showWithButton_(t)}showWithBlockPrevOutput(t){t=t.getSourceBlock();const o=t.width;var c=t.height,g=c*gG;const b=this.constants_.CURSOR_BLOCK_PADDING;t.previousConnection?(c=this.constants_.shapeFor(t.previousConnection),this.positionPrevious_(o,b,g,c)):t.outputConnection?(g=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(o,c,g)):this.positionBlock_(o,b,g),this.setParent_(t),this.showCurrent_()}showWithBlock_(t){this.showWithBlockPrevOutput(t)}showWithPrevious_(t){this.showWithBlockPrevOutput(t)}showWithOutput_(t){this.showWithBlockPrevOutput(t)}showWithCoordinates_(t){var o=t.getWsCoordinate();t=o.x,o=o.y,this.workspace.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,o,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(t){t=t.getLocation();const o=t.getSize().width,c=t.getSize().height;this.positionRect_(0,0,o,c),this.setParent_(t),this.showCurrent_()}showWithInput_(t){t=t.getLocation();const o=t.getSourceBlock();this.positionInput_(t),this.setParent_(o),this.showCurrent_()}showWithNext_(t){var o=t.getLocation();t=o.getSourceBlock();let c=0;o=o.getOffsetInBlock().y;const g=t.getHeightWidth().width;this.workspace.RTL&&(c=-g),this.positionLine_(c,o,g),this.setParent_(t),this.showCurrent_()}showWithStack_(t){t=t.getLocation();var o=t.getHeightWidth();const c=o.width+this.constants_.CURSOR_STACK_PADDING;o=o.height+this.constants_.CURSOR_STACK_PADDING;const g=-this.constants_.CURSOR_STACK_PADDING/2,b=-this.constants_.CURSOR_STACK_PADDING/2;let M=g;this.workspace.RTL&&(M=-(c+g)),this.positionRect_(M,b,c,o),this.setParent_(t),this.showCurrent_()}showWithButton_(t){t=t.getLocation();const o=t.width+this.constants_.CURSOR_STACK_PADDING,c=t.height+this.constants_.CURSOR_STACK_PADDING,g=-this.constants_.CURSOR_STACK_PADDING/2,b=-this.constants_.CURSOR_STACK_PADDING/2;let M=g;this.workspace.RTL&&(M=-(o+g)),this.positionRect_(M,b,o,c),this.setParent_(t),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(t,o,c){if(t=yi(-o,c)+Nt("V",-o)+Nt("H",t+2*o)+Nt("V",c),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(t){const o=t.getOffsetInBlock().x,c=t.getOffsetInBlock().y;t=Ji(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+o+","+c+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(t,o,c){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${t}`),this.markerSvgLine_.setAttribute("y",`${o}`),this.markerSvgLine_.setAttribute("width",`${c}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(t,o,c){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");t=yi(t,0)+Nt("h",-(t-c.width))+Nt("v",this.constants_.TAB_OFFSET_FROM_TOP)+c.pathDown+Nt("V",o)+Nt("H",t),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(t,o,c,g){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");t=yi(-o,c)+Nt("V",-o)+Nt("H",this.constants_.NOTCH_OFFSET_LEFT)+g.pathLeft+Nt("H",t+2*o)+Nt("V",c),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(t,o,c,g){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${t}`),this.markerSvgRect_.setAttribute("y",`${o}`),this.markerSvgRect_.setAttribute("width",`${c}`),this.markerSvgRect_.setAttribute("height",`${g}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(t){t.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(t,o){const c=o.getSourceBlock();t=new(k(oc))(c,this.isCursor(),t,o),$(t)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=ve(Xe.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=ve(Xe.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=ve(Xe.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=ve(Xe.PATH,{transform:""},this.markerSvg_),this.markerBlock_=ve(Xe.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();ve(Xe.ANIMATE,t,this.markerSvgLine_),ve(Xe.ANIMATE,t,this.markerInput_),ve(Xe.ANIMATE,Object.assign({},t,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(t){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",t),this.markerInput_.firstElementChild.setAttribute("values",t),this.markerBlock_.firstElementChild.setAttribute("values",t))}dispose(){this.svgGroup_&&W(this.svgGroup_)}},Ey=class{constructor(t,o,c){this.markerSvg=this.cursorSvg=null,this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=c,this.style=o,this.svgRoot=t,this.svgPath=ve(Xe.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null}applyColour(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())}setStyle(t){this.style=t}setClass_(t,o){t&&(o?Me(this.svgRoot,t):oe(this.svgRoot,t))}updateHighlighted(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(t){this.setClass_("blocklySelected",t)}updateDraggingDelete(t){this.setClass_("blocklyDraggingDelete",t)}updateInsertionMarker(t){this.setClass_("blocklyInsertionMarker",t)}updateMovable(t){this.setClass_("blocklyDraggable",t)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t)}updateShapeForInputHighlight(t,o){}addConnectionHighlight(t,o,c,g){if(this.connectionHighlights.has(t)){if(this.currentHighlightMatchesNew(t,o,c))return;this.removeConnectionHighlight(t)}o=ve(Xe.PATH,{class:"blocklyHighlightedConnectionPath",d:o,transform:`translate(${c.x}, ${c.y})`+(g?" scale(-1 1)":"")},this.svgRoot),this.connectionHighlights.set(t,o)}currentHighlightMatchesNew(t,o,c){let g;const b=(g=this.connectionHighlights.get(t))==null?void 0:g.getAttribute("d");return t=this.highlightOffsets.get(t),b===o&&At.equals(t,c)}removeConnectionHighlight(t){const o=this.connectionHighlights.get(t);o&&(W(o),this.connectionHighlights.delete(t))}},wa=class{constructor(t){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,n.setSelected$$module$build$src$core$common(t),this.topBlock=t,this.workspace=t.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){n.disable$$module$build$src$core$events$utils(),this.hidePreview(),n.enable$$module$build$src$core$events$utils();var{local:t,closest:o}=this.activeCandidate;t.connect(o);var c=t.isSuperior()?o:t,g=this.topBlock.getRootBlock();Kt().then(()=>{Qp(c.getSourceBlock()),setTimeout(()=>{g.bringToFront()},0)})}}update(t,o){const c=this.getCandidate(t);((this.wouldDeleteBlock=this.shouldDelete(!!c,o))||this.shouldUpdatePreviews(c,t))&&(n.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(c),this.maybeShowPreview(c),n.enable$$module$build$src$core$events$utils())}createMarkerBlock(t){n.disable$$module$build$src$core$events$utils();let o;try{const c=zi(t,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!c)throw Error(`Failed to serialize source block. ${t.toDevString()}`);o=Ii(c,this.workspace);for(const g of o.getDescendants(!1))g.setInsertionMarker(!0);o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{n.enable$$module$build$src$core$events$utils()}return o}initAvailableConnections(){const t=this.topBlock.getConnections_(!1),o=this.topBlock.lastConnectionInStack(!0);return o&&o!==this.topBlock.nextConnection&&(t.push(o),this.lastOnStack=o),t}shouldUpdatePreviews(t,o){if(!t)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:c,closest:g}=this.activeCandidate;if(g===t.closest&&c===t.local)return!1;const b=c.x+o.x-g.x;return o=c.y+o.y-g.y,t.radius<Math.sqrt(b*b+o*o)-n.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(t){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let o=this.getStartRadius(),c=null;for(let g=0;g<this.availableConnections.length;g++){const b=this.availableConnections[g],M=b.closest(o,t);M.connection&&(c={closest:M.connection,local:b,radius:M.radius},o=M.radius)}return c}getStartRadius(){return this.activeCandidate?n.config$$module$build$src$core$config.connectingSnapRadius:n.config$$module$build$src$core$config.snapRadius}shouldDelete(t,o){return o&&this.workspace.getComponentManager().hasCapability(o.id,zr.Capability.DELETE_AREA)?o.wouldDelete(this.topBlock):!1}maybeShowPreview(t){if(!this.wouldDeleteBlock&&t){var o=t.closest,c;o===((c=this.activeCandidate)==null?void 0:c.closest)||o.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=t,this.showPreview(this.activeCandidate))}}showPreview(t){const o=this.workspace.getRenderer();switch(o.getConnectionPreviewMethod(t.closest,t.local,this.topBlock)){case wa.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(t);break;case wa.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(t);break;case wa.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(t)}o.shouldHighlightConnection(t.closest)&&t.closest.highlight()}maybeHidePreview(t){if(!t)this.hidePreview();else if(this.activeCandidate){const o=this.activeCandidate.local!==t.local;(this.activeCandidate.closest!==t.closest||o||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let t;const o=(t=this.activeCandidate)==null?void 0:t.closest;o&&o.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(o)&&o.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(t){const{local:o,closest:c}=t;let g=(t=this.lastOnStack&&o===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!g)throw Error("Cannot show the insertion marker because there is no insertion marker block");let b;try{b=g.getMatchingConnection(o.getSourceBlock(),o)}catch{if(t&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),g=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),g=this.firstMarker=this.createMarkerBlock(this.topBlock)),!g)throw Error("Cannot show the insertion marker because there is no insertion marker block");b=g.getMatchingConnection(o.getSourceBlock(),o)}if(!b)throw Error("Cannot show the insertion marker because there is no associated connection");if(b===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");g.queueRender(),An(),b.connect(c);const M={x:c.x-b.x,y:c.y-b.y},te=b.getOffsetInBlock().clone(),$e=b;Kt().then(()=>{let it;(it=g)==null||it.positionNearConnection($e,M,te);let Dt;(Dt=g)==null||Dt.getSvgRoot().setAttribute("visibility","visible")}),this.markerConnection=b}hideInsertionMarker(){if(this.markerConnection){var t=this.markerConnection,o=t.getSourceBlock(),c=o.outputConnection,g;if((g=o.previousConnection)!=null&&g.targetConnection||c!=null&&c.targetConnection)o.unplug(!0);else{let b;(b=t.targetBlock())==null||b.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=o.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(t){t=t.closest,this.highlightedBlock=t.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(t,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(t){if(this.fadedBlock=t.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const t=[];return this.firstMarker&&t.push(this.firstMarker),this.lastMarker&&t.push(this.lastMarker),t}disposeInsertionMarker(t){if(t){n.disable$$module$build$src$core$events$utils();try{t.dispose()}finally{n.enable$$module$build$src$core$events$utils()}}}};(function(t){t=t.PREVIEW_TYPE||(t.PREVIEW_TYPE={}),t[t.INSERTION_MARKER=0]="INSERTION_MARKER",t[t.INPUT_OUTLINE=1]="INPUT_OUTLINE",t[t.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(wa||(wa={})),wa.PREVIEW_TYPE;var yy=class{constructor(t){this.overrides=null,this.name=t}getClassName(){return this.name+"-renderer"}init(t,o){this.constants_=this.makeConstants_(),o&&(this.overrides=o,Object.assign(this.constants_,o)),this.constants_.setTheme(t),this.constants_.init()}createDom(t,o){this.constants_.createDom(t,this.name+"-"+o.name,"."+this.getClassName()+"."+o.getClassName())}refreshDom(t,o){const c=this.getConstants();c.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=c.randomIdentifier,this.constants_.setTheme(o),this.constants_.init(),this.createDom(t,o)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Ty}makeRenderInfo_(t){return new ET(this,t)}makeDrawer_(t,o){return new vy(t,o)}makeMarkerDrawer(t,o){return new Yb(t,this.getConstants(),o)}makePathObject(t,o){return new Ey(t,o,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(t){return!0}orphanCanConnectAtEnd(t,o,c){return!!Jn.getConnectionForOrphanedConnection(t,c===Bt.OUTPUT_VALUE?o.outputConnection:o.previousConnection)}getConnectionPreviewMethod(t,o,c){return sl("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),o.type===Bt.OUTPUT_VALUE||o.type===Bt.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(c,t.targetBlock(),o.type)?wa.PREVIEW_TYPE.INSERTION_MARKER:wa.PREVIEW_TYPE.REPLACEMENT_FADE:wa.PREVIEW_TYPE.INSERTION_MARKER}render(t){const o=this.makeRenderInfo_(t);o.measure(),this.makeDrawer_(t,o).draw()}},ui={};ui.BottomRow=Ub,ui.Connection=au,ui.ConstantProvider=Ty,ui.Drawer=vy,ui.ExternalValueInput=_y,ui.Field=Cm,ui.Hat=Gb,ui.Icon=m1,ui.InRowSpacer=Yo,ui.InlineInput=Hb,ui.InputConnection=Ch,ui.InputRow=Vb,ui.JaggedEdge=g1,ui.MarkerSvg=Yb,ui.Measurable=hc,ui.NextConnection=_1,ui.OutputConnection=T1,ui.PathObject=Ey,ui.PreviousConnection=v1,ui.RenderInfo=ET,ui.Renderer=yy,ui.RoundCorner=TT,ui.Row=gT,ui.SpacerRow=zb,ui.SquareCorner=vT,ui.StatementInput=_T,ui.TopRow=Wb,ui.Types=Pe,ui.init=im,ui.register=rh,ui.unregister=G_;var y1=class{constructor(t,o){this.workspace=t,this.theme=o,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(t){var o=this.theme;this.theme=t,(t=this.workspace.getInjectionDiv())&&(o&&(o=o.getClassName())&&oe(t,o),(o=this.theme.getClassName())&&Me(t,o));for(let c=0,g;g=this.subscribedWorkspaces_[c];c++)g.refreshTheme();for(const[c,g]of this.componentDB)for(const b of g){t=b.element,o=b.propertyName;const M=this.theme&&this.theme.getComponentStyle(c);t.style.setProperty(o,M||"")}for(const c of this.subscribedWorkspaces_)c.hideChaff()}subscribeWorkspace(t){this.subscribedWorkspaces_.push(t)}unsubscribeWorkspace(t){if(!tt(this.subscribedWorkspaces_,t))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(t,o,c){this.componentDB.has(o)||this.componentDB.set(o,[]),this.componentDB.get(o).push({element:t,propertyName:c}),o=this.theme&&this.theme.getComponentStyle(o),t.style.setProperty(c,o||"")}unsubscribe(t){if(t)for(const[o,c]of this.componentDB){for(let g=c.length-1;0<=g;g--)c[g].element===t&&c.splice(g,1);c.length||this.componentDB.delete(o)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},Kb="VARIABLE_DYNAMIC",Sf={CATEGORY_NAME:Kb};Sf.flyoutCategory=sh,Sf.flyoutCategoryBlocks=Vd,Sf.onCreateVariableButtonClick_Colour=om,Sf.onCreateVariableButtonClick_Number=sm,Sf.onCreateVariableButtonClick_String=rm;var S1=30,$f=[];$f[Bt.INPUT_VALUE]=Bt.OUTPUT_VALUE,$f[Bt.OUTPUT_VALUE]=Bt.INPUT_VALUE,$f[Bt.NEXT_STATEMENT]=Bt.PREVIOUS_STATEMENT,$f[Bt.PREVIOUS_STATEMENT]=Bt.NEXT_STATEMENT;var Jb="RENAME_VARIABLE_ID",Zb="DELETE_VARIABLE_ID",$1=class{canConnect(t,o,c,g){return this.canConnectWithReason(t,o,c,g)===Jn.CAN_CONNECT}canConnectWithReason(t,o,c,g){const b=this.doSafetyChecks(t,o);return b!==Jn.CAN_CONNECT?b:this.doTypeChecks(t,o)?c&&!this.doDragChecks(t,o,g||0)?Jn.REASON_DRAG_CHECKS_FAILED:Jn.CAN_CONNECT:Jn.REASON_CHECKS_FAILED}getErrorMessage(t,o,c){switch(t){case Jn.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Jn.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Jn.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Jn.REASON_TARGET_NULL:return"Target connection is null.";case Jn.REASON_CHECKS_FAILED:return"Connection checks failed. "+(o+" expected "+o.getCheck()+", found "+c.getCheck());case Jn.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Jn.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Jn.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(t,o){if(!t||!o)return Jn.REASON_TARGET_NULL;let c,g,b;return t.isSuperior()?(c=t.getSourceBlock(),g=o.getSourceBlock(),b=o):(g=t.getSourceBlock(),c=o.getSourceBlock(),b=t,t=o),c===g?Jn.REASON_SELF_CONNECTION:b.type!==$f[t.type]?Jn.REASON_WRONG_TYPE:c.workspace!==g.workspace?Jn.REASON_DIFFERENT_WORKSPACES:c.isShadow()&&!g.isShadow()?Jn.REASON_SHADOW_PARENT:b.type===Bt.OUTPUT_VALUE&&g.previousConnection&&g.previousConnection.isConnected()||b.type===Bt.PREVIOUS_STATEMENT&&g.outputConnection&&g.outputConnection.isConnected()?Jn.REASON_PREVIOUS_AND_OUTPUT:Jn.CAN_CONNECT}doTypeChecks(t,o){if(t=t.getCheck(),o=o.getCheck(),!t||!o)return!0;for(let c=0;c<t.length;c++)if(o.includes(t[c]))return!0;return!1}doDragChecks(t,o,c){if(t.distanceFrom(o)>c||o.getSourceBlock().isInsertionMarker())return!1;switch(o.type){case Bt.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,o);case Bt.OUTPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case Bt.INPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isMovable()&&!o.targetBlock().isShadow())return!1;break;case Bt.NEXT_STATEMENT:if(o.isConnected()&&!t.getSourceBlock().nextConnection&&!o.targetBlock().isShadow()&&o.targetBlock().nextConnection||o.targetBlock()&&!o.targetBlock().isMovable()&&!o.targetBlock().isShadow())return!1;break;default:return!1}return!H.includes(o)}canConnectToPrevious_(t,o){return t.targetConnection||H.includes(o)?!1:o.targetConnection?(t=o.targetBlock(),t.isInsertionMarker()?!t.getPreviousBlock():!1):!0}};r(yt.CONNECTION_CHECKER,_o,$1);var qb=class extends rT{constructor(t){super(t),this.type=Jc,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new qb),o.varType=t.varType,o.varName=t.varName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?o.deleteVariableById(this.varId):o.createVariable(this.varName,this.varType,this.varId)}};r(yt.EVENT,Jc,qb);var Qb=class extends rT{constructor(t,o){super(t),this.type=gh,t&&(this.oldName=t.name,this.newName=typeof o>"u"?"":o)}toJson(){const t=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return t.oldName=this.oldName,t.newName=this.newName,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new Qb),o.oldName=t.oldName,o.newName=t.newName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t?o.renameVariableById(this.varId,this.newName):o.renameVariableById(this.varId,this.oldName)}};r(yt.EVENT,gh,Qb);var eA=class{constructor(t){this.workspace=t,this.variableMap=new Map}clear(){for(const t of this.variableMap.values())for(;0<t.length;)this.deleteVariable(t[0]);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(t,o){if(t.name!==o){var c=this.getVariable(o,t.type),g=this.workspace.getAllBlocks(!1),b=n.getGroup$$module$build$src$core$events$utils();b||n.setGroup$$module$build$src$core$events$utils(!0);try{c&&c.getId()!==t.getId()?this.renameVariableWithConflict_(t,o,c,g):this.renameVariableAndUses_(t,o,g)}finally{n.setGroup$$module$build$src$core$events$utils(b)}}}renameVariableById(t,o){const c=this.getVariableById(t);if(!c)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(c,o)}renameVariableAndUses_(t,o,c){for($(new(k(gh))(t,o)),t.name=o,o=0;o<c.length;o++)c[o].updateVarName(t)}renameVariableWithConflict_(t,o,c,g){const b=t.type;for(o!==c.name&&this.renameVariableAndUses_(c,o,g),o=0;o<g.length;o++)g[o].renameVarById(t.getId(),c.getId());$(new(k(Jc))(t)),tt(this.variableMap.get(b),t)}createVariable(t,o,c){var g=this.getVariable(t,o);if(g){if(c&&g.getId()!==c)throw Error('Variable "'+t+'" is already in use and its id is "'+g.getId()+'" which conflicts with the passed in id, "'+c+'".');return g}if(c&&this.getVariableById(c))throw Error('Variable id, "'+c+'", is already in use.');return g=c||v(),o=o||"",g=new sT(this.workspace,t,o,g),t=this.variableMap.get(o)||[],t.push(g),this.variableMap.delete(o),this.variableMap.set(o,t),$(new(k(ya))(g)),g}deleteVariable(t){const o=t.getId(),c=this.variableMap.get(t.type);if(c){for(let g=0;g<c.length;g++)if(c[g].getId()===o){c.splice(g,1),$(new(k(Jc))(t)),c.length===0&&this.variableMap.delete(t.type);break}}}deleteVariableById(t){const o=this.getVariableById(t);if(o){var c=o.name;const g=this.getVariableUsesById(t);for(let b=0,M;M=g[b];b++)if(M.type==="procedures_defnoreturn"||M.type==="procedures_defreturn"){t=String(M.getFieldValue("NAME")),c=n.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",c).replace("%2",t),ye(c);return}1<g.length?(c=n.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(g.length)).replace("%2",c),qe(c,b=>{b&&o&&this.deleteVariableInternal(o,g)})):this.deleteVariableInternal(o,g)}else console.warn("Can't delete non-existent variable: "+t)}deleteVariableInternal(t,o){const c=n.getGroup$$module$build$src$core$events$utils();c||n.setGroup$$module$build$src$core$events$utils(!0);try{for(let g=0;g<o.length;g++)o[g].dispose(!0);this.deleteVariable(t)}finally{n.setGroup$$module$build$src$core$events$utils(c)}}getVariable(t,o){if(o=this.variableMap.get(o||"")){for(let c=0,g;g=o[c];c++)if(n.Names$$module$build$src$core$names.equals(g.name,t))return g}return null}getVariableById(t){for(const o of this.variableMap.values())for(const c of o)if(c.getId()===t)return c;return null}getVariablesOfType(t){return(t=this.variableMap.get(t||""))?t.slice():[]}getVariableTypes(t){const o=new Set(this.variableMap.keys());if(t&&t.getPotentialVariableMap())for(const c of t.getPotentialVariableMap().variableMap.keys())o.add(c);return o.has("")||o.add(""),Array.from(o.values())}getAllVariables(){let t=[];for(const o of this.variableMap.values())t=t.concat(o);return t}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(t=>t.name)}getVariableUsesById(t){const o=[],c=this.workspace.getAllBlocks(!1);for(let g=0;g<c.length;g++){const b=c[g].getVarModels();if(b)for(let M=0;M<b.length;M++)b[M].getId()===t&&o.push(c[g])}return o}},xm=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(t){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new s1,this.potentialVariableMap=null,this.id=v(),re(this),this.options=t||new Ra({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(p(yt.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new eA(this)}dispose(){this.listeners.length=0,this.clear(),ae(this)}sortObjects_(t,o){const c=Math.sin(Ne(xm.SCAN_ANGLE))*(this.RTL?-1:1);return t=t.getRelativeToSurfaceXY(),o=o.getRelativeToSurfaceXY(),t.y+c*t.x-(o.y+c*o.x)}addTopBlock(t){this.topBlocks.push(t)}removeTopBlock(t){if(!tt(this.topBlocks,t))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(t=!1){const o=[].concat(this.topBlocks);return t&&1<o.length&&o.sort(this.sortObjects_.bind(this)),o}addTypedBlock(t){this.typedBlocksDB.has(t.type)||this.typedBlocksDB.set(t.type,[]),this.typedBlocksDB.get(t.type).push(t)}removeTypedBlock(t){tt(this.typedBlocksDB.get(t.type),t),this.typedBlocksDB.get(t.type).length||this.typedBlocksDB.delete(t.type)}getBlocksByType(t,o=!1){return this.typedBlocksDB.has(t)?(t=this.typedBlocksDB.get(t).slice(0),o&&t&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t.filter(function(c){return!c.isInsertionMarker()})):[]}addTopComment(t){this.topComments.push(t),this.commentDB.has(t.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB.set(t.id,t)}removeTopComment(t){if(!tt(this.topComments,t))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(t.id)}getTopComments(t=!1){const o=[].concat(this.topComments);return t&&1<o.length&&o.sort(this.sortObjects_.bind(this)),o}getAllBlocks(t=!1){if(t){var o=this.getTopBlocks(!0);t=[];for(let c=0;c<o.length;c++)t.push(...o[c].getDescendants(!0))}else for(t=this.getTopBlocks(!1),o=0;o<t.length;o++)t.push(...t[o].getChildren(!1));return t.filter(function(c){return!c.isInsertionMarker()})}clear(){this.isClearing=!0;try{const t=n.getGroup$$module$build$src$core$events$utils();for(t||n.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();n.setGroup$$module$build$src$core$events$utils(t),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(t,o){this.variableMap.renameVariableById(t,o)}createVariable(t,o,c){return this.variableMap.createVariable(t,o,c)}getVariableUsesById(t){return this.variableMap.getVariableUsesById(t)}deleteVariableById(t){this.variableMap.deleteVariableById(t)}getVariable(t,o){return this.variableMap.getVariable(t,o)}getVariableById(t){return this.variableMap.getVariableById(t)}getVariablesOfType(t){return this.variableMap.getVariablesOfType(t)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(t,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(t){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(t){return this.options.maxInstances?(this.options.maxInstances[t]!==void 0?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0}isCapacityAvailable(t){if(!this.hasBlockLimits())return!0;let o=0;for(const c in t){if(t[c]>this.remainingCapacityOfType(c))return!1;o+=t[c]}return!(o>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(t){var o=t?this.redoStack_:this.undoStack_,c=t?this.undoStack_:this.redoStack_;const g=o.pop();if(g){for(var b=[g];o.length&&g.group&&g.group===o[o.length-1].group;){const M=o.pop();M&&b.push(M)}for(o=0;o<b.length;o++)c.push(b[o]);b=A(b,t),n.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(c=0;c<b.length;c++)b[c].run(t)}finally{n.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,C()}addChangeListener(t){return this.listeners.push(t),t}removeChangeListener(t){tt(this.listeners,t)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let o=0;o<this.listeners.length;o++)(0,this.listeners[o])(t)}getBlockById(t){return this.blockDB.get(t)||null}setBlockById(t,o){this.blockDB.set(t,o)}removeBlockById(t){this.blockDB.delete(t)}getCommentById(t){let o;return(o=this.commentDB.get(t))!=null?o:null}allInputsFilled(t){const o=this.getTopBlocks(!1);for(let c=0;c<o.length;c++)if(!o[c].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new eA(this)}getVariableMap(){return this.variableMap}setVariableMap(t){this.variableMap=t}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let t=null;const o=this.options.parentWorkspace;return this.isFlyout?o&&o.options&&(t=o.options.parentWorkspace):o&&(t=o),t}static getById(t){return U(t)}static getAll(){return ce()}};xm.SCAN_ANGLE=3;var _G=100,b1=class{constructor(t){this.parentWorkspace=t,this.sounds=new Map,this.lastSound_=null,this.muted=!1}dispose(){this.sounds.clear()}load(t,o){if(t.length){try{var c=new globalThis.Audio}catch{return}for(let b=0;b<t.length;b++){const M=t[b],te=M.match(/\.(\w+)$/);if(te&&c.canPlayType("audio/"+te[1])){var g=new globalThis.Audio(M);break}}g&&this.sounds.set(o,g)}}preload(){for(const t of this.sounds.values()){t.volume=.01;const o=t.play();if(o!==void 0?o.then(t.pause).catch(function(){}):t.pause(),Q_||TI)break}}play(t,o){if(!this.muted){var c=this.sounds.get(t);c?(t=new Date,this.lastSound_!==null&&t.getTime()-this.lastSound_.getTime()<_G||(this.lastSound_=t,c=Q_||Q$?c:c.cloneNode(),c.volume=o===void 0?1:o,c.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(t,o)}}setMuted(t){this.muted=t}getMuted(){return this.muted}},TG=class{constructor(t){this.workspace=t,this.layers=new Map,(t=t.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(t),this.animationLayer=this.createAnimationLayer(t)),t=this.createLayer(pm),Me(t,"blocklyBlockCanvas"),t=this.createLayer(pb),Me(t,"blocklyBubbleCanvas")}createDragLayer(t){const o=ve(Xe.SVG,{class:"blocklyBlockDragSurface",xmlns:eT,"xmlns:html":cc,"xmlns:xlink":Wo,version:"1.1"});return t.append(o),ve(Xe.G,{},o)}createAnimationLayer(t){const o=ve(Xe.SVG,{class:"blocklyAnimationLayer",xmlns:eT,"xmlns:html":cc,"xmlns:xlink":Wo,version:"1.1"});return t.append(o),ve(Xe.G,{},o)}appendToAnimationLayer(t){let o;const c=(o=this.dragLayer)==null?void 0:o.getAttribute("transform");if(c){let b;(b=this.animationLayer)==null||b.setAttribute("transform",c)}let g;(g=this.animationLayer)==null||g.appendChild(t.getSvgRoot())}translateLayers(t,o){t=`translate(${t.x}, ${t.y}) scale(${o})`;let c;(c=this.dragLayer)==null||c.setAttribute("transform",t);for(const[,g]of this.layers)g.setAttribute("transform",t)}moveToDragLayer(t){let o;(o=this.dragLayer)==null||o.appendChild(t.getSvgRoot())}moveOffDragLayer(t,o){this.append(t,o)}append(t,o){this.layers.has(o)||this.createLayer(o);let c;(c=this.layers.get(o))==null||c.appendChild(t.getSvgRoot())}createLayer(t){const o=this.workspace.getSvgGroup(),c=ve(Xe.G,{});let g=!1;const b=[...this.layers].sort((M,te)=>M[0]-te[0]);for(const[M,te]of b)if(t<M){o.insertBefore(c,te),g=!0;break}return g||o.appendChild(c),this.layers.set(t,c),c}hasLayer(t){return t===this.dragLayer||new Set(this.layers.values()).has(t)}getBlockLayer(){return this.layers.get(pm)}getBubbleLayer(){return this.layers.get(pb)}},vG=20,Ma=class extends xm{constructor(t){super(t),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(p(yt.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=t.setMetrics||Ma.setTopLevelWorkspaceMetrics_,this.componentManager=new zr,this.connectionDBList=bm.init(this.connectionChecker),this.audioManager=new b1(t.parentWorkspace),this.grid=this.options.gridPattern?new kb(this.options.gridPattern,t.gridOptions):null,this.markerManager=new uT(this),_s&&Ht&&this.registerToolboxCategoryCallback(cb,Ht),Sf&&sh&&this.registerToolboxCategoryCallback(Kb,sh),to&&Gd&&(this.registerToolboxCategoryCallback(gy,Gd),this.addChangeListener(F_)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new y1(this,this.options.theme||hy),this.themeManager_.subscribeWorkspace(this);let o;this.renderer=im(this.options.renderer||"geras",this.getTheme(),(o=this.options.rendererOverrides)!=null?o:void 0),this.cachedParentSvgSize=new Kn(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(t){this.metricsManager=t,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(t){this.markerManager.setCursorSvg(t)}setMarkerSvg(t){this.markerManager.setMarkerSvg(t)}getMarker(t){return this.markerManager?this.markerManager.getMarker(t):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(t){t||(t=hy),this.themeManager_.setTheme(t)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(o){return!!o.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const t=new(k(To))(this.getTheme().name,this.id);$(t)}updateBlockStyles_(t){for(let o=0,c;c=t[o];o++){const g=c.getStyleName();g&&c.setStyle(g)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM=t.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(t){let o=0,c=0,g=1;(this.getCanvas().contains(t)||this.getBubbleCanvas().contains(t))&&(g=this.scale);do{const b=j(t);(t===this.getCanvas()||t===this.getBubbleCanvas())&&(g=1),o+=b.x*g,c+=b.y*g,t=t.parentNode}while(t&&t!==this.getParentSvg()&&t!==this.getInjectionDiv());return new At(o,c)}getCachedParentSvgSize(){const t=this.cachedParentSvgSize;return new Kn(t.width,t.height)}getOriginOffsetInPixels(){return ge(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let t=this.svgGroup_;for(;t;){if((" "+(t.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=t;break}t=t.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(t){this.resizeHandlerWrapper=t}createDom(t,o){return this.injectionDiv||(this.injectionDiv=o??null),this.svgGroup_=ve(Xe.G,{class:"blocklyWorkspace"}),t&&(this.svgBackground_=ve(Xe.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),t==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new TG(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(Ye(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),Ye(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(p(yt.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(t=p(yt.CURSOR,this.options))&&this.markerManager.setCursor(new t),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&W(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const t=this.getParentSvg();t&&t.parentNode&&W(t.parentNode)}this.resizeHandlerWrapper&&(Q(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=Ma.newTrashcan(this);const t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.getCanvas())}static newTrashcan(t){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new wI(this);const t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)}addFlyout(t){const o=new Ra({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return o.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(p(yt.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(o):new(p(yt.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(o),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(t)}getFlyout(t){return this.flyout||t?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const t=this.componentManager.getComponents(zr.Capability.POSITIONABLE,!0),o=this.getMetricsManager().getUiMetrics(),c=[];for(let g=0,b;b=t[g];g++){b.position(o,c);const M=b.getBoundingRectangle();M&&c.push(M)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const t=Ke();At.equals(this.lastRecordedPageScroll,t)||(this.lastRecordedPageScroll=t,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(t,o){const c=this.getParentSvg();t!=null&&(this.cachedParentSvgSize.width=t,c.setAttribute("data-cached-width",`${t}`)),o!=null&&(this.cachedParentSvgSize.height=o,c.setAttribute("data-cached-height",`${o}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let t=this.svgGroup_;for(;t;){if(t.tagName==="svg"){this.cachedParentSvg=t;break}t=t.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(x()){var t=this.scale,o=-this.scrollY,c=-this.scrollX;if(!(t===this.oldScale&&1>Math.abs(o-this.oldTop)&&1>Math.abs(c-this.oldLeft))){var g=new(k(Vo))(o,c,t,this.id,this.oldScale);this.oldScale=t,this.oldTop=o,this.oldLeft=c,$(g)}}}translate(t,o){let c;(c=this.layerManager)==null||c.translateLayers(new At(t,o),this.scale);let g;(g=this.grid)==null||g.moveTo(t,o),this.maybeFireViewportChangeEvent()}getWidth(){const t=this.getMetrics();return t?t.viewWidth/this.scale:0}setVisible(t){this.isVisible_=t,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t||this.hideChaff(!0))}render(){const t=this.getAllBlocks(!1);for(let o=t.length-1;0<=o;o--)t[o].queueRender();this.getTopBlocks().flatMap(o=>o.getDescendants(!1)).filter(o=>o.isInsertionMarker()).forEach(o=>o.queueRender()),Kt().then(()=>void this.markerManager.updateMarkers())}highlightBlock(t,o){if(o===void 0){for(let c=0,g;g=this.highlightedBlocks[c];c++)g.setHighlighted(!1);this.highlightedBlocks.length=0}(t=t?this.getBlockById(t):null)&&((o=o===void 0||o)?this.highlightedBlocks.includes(t)||this.highlightedBlocks.push(t):tt(this.highlightedBlocks,t),t.setHighlighted(o))}refreshToolboxSelection(){const t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()}renameVariableById(t,o){super.renameVariableById(t,o),this.refreshToolboxSelection()}deleteVariableById(t){super.deleteVariableById(t),this.refreshToolboxSelection()}createVariable(t,o,c){return t=super.createVariable(t,o,c),this.refreshToolboxSelection(),t}recordDragTargets(){const t=this.componentManager.getComponents(zr.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let o=0,c;c=t[o];o++){const g=c.getClientRect();g&&this.dragTargetAreas.push({component:c,clientRect:g})}}newBlock(t,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(t){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(t){for(let o=0,c;c=this.dragTargetAreas[o];o++)if(c.clientRect.contains(t.clientX,t.clientY))return c.component;return null}onMouseDown_(t){const o=this.getGesture(t);o&&o.handleWsStart(t,this)}startDrag(t,o){t=Ve(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,this.dragDeltaXY=At.difference(o,t)}moveDrag(t){return t=Ve(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,At.sum(this.dragDeltaXY,t)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())}onMouseWheel_(t){if(nu.inProgress())t.preventDefault(),t.stopPropagation();else{var o=this.options.zoomOptions&&this.options.zoomOptions.wheel,c=this.options.moveOptions&&this.options.moveOptions.wheel;if(o||c){var g=Fe(t);if(eb)var b=t.metaKey;o&&(t.ctrlKey||b||!c)?(g=-g.y/50,o=Ve(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(o.x,o.y,g)):(o=this.scrollX-g.x,c=this.scrollY-g.y,t.shiftKey&&!g.x&&(o=this.scrollX-g.y,c=this.scrollY),this.scroll(o,c)),t.preventDefault()}}}getBlocksBoundingBox(){const t=this.getTopBoundedElements();if(!t.length)return new Si(0,0,0,0);const o=t[0].getBoundingRectangle();for(let g=1;g<t.length;g++){var c=t[g];c.isInsertionMarker&&c.isInsertionMarker()||(c=c.getBoundingRectangle(),c.top<o.top&&(o.top=c.top),c.bottom>o.bottom&&(o.bottom=c.bottom),c.left<o.left&&(o.left=c.left),c.right>o.right&&(o.right=c.right))}return o}cleanUp(){this.setResizesEnabled(!1),n.setGroup$$module$build$src$core$events$utils(!0);const t=this.getTopBlocks(!0);let o=0;for(let c=0,g;g=t[c];c++){if(!g.isMovable())continue;const b=g.getRelativeToSurfaceXY();g.moveBy(-b.x,o-b.y,["cleanup"]),g.snapToGrid(),o=g.getRelativeToSurfaceXY().y+g.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}n.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(t){if(!this.options.readOnly&&!this.isFlyout){var o=wn.registry.getContextMenuOptions(wn.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(o,t),Bc(t,o,this.RTL,this)}}updateToolbox(t){if(t=fi(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(_i(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(de(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(t,o,c){c=Math.pow(this.options.zoomOptions.scaleSpeed,c);const g=this.scale*c;if(this.scale!==g){g>this.options.zoomOptions.maxScale?c=this.options.zoomOptions.maxScale/this.scale:g<this.options.zoomOptions.minScale&&(c=this.options.zoomOptions.minScale/this.scale);var b=this.getCanvas().getCTM(),M=this.getParentSvg().createSVGPoint();M.x=t,M.y=o,M=M.matrixTransform(b.inverse()),t=M.x,o=M.y,b=b.translate(t*(1-c),o*(1-c)).scale(c),this.scrollX=b.e,this.scrollY=b.f,this.setScale(g)}}zoomCenter(t){var o=this.getMetrics();let c;this.flyout?(c=o.svgWidth?o.svgWidth/2:0,o=o.svgHeight?o.svgHeight/2:0):(c=o.viewWidth/2+o.absoluteLeft,o=o.viewHeight/2+o.absoluteTop),this.zoom(c,o,t)}zoomToFit(){if(this.isMovable()){var t=this.getMetrics(),o=t.viewWidth;t=t.viewHeight;var c=this.getBlocksBoundingBox(),g=2*vG,b=c.right-c.left+g;if(c=c.bottom-c.top+g,b){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),c+=this.flyout.getHeight()/this.scale):(o+=this.flyout.getWidth(),b+=this.flyout.getWidth()/this.scale)),o/=b,t/=c,n.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(o,t)),this.scrollCenter()}finally{n.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){Me(this.getCanvas(),"blocklyCanvasTransitioning"),Me(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){oe(this.getCanvas(),"blocklyCanvasTransitioning"),oe(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var t=this.getMetrics(),o=(t.scrollWidth-t.viewWidth)/2,c=(t.scrollHeight-t.viewHeight)/2;o=-o-t.scrollLeft,c=-c-t.scrollTop,this.scroll(o,c)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(t,o){if(this.isMovable()){var c=t?this.getBlockById(t):null;if(c){t=c.getRelativeToSurfaceXY(),c=o?{height:c.height,width:c.width}:c.getHeightWidth();var g=this.scale;o=(t.x+(this.RTL?-1:1)*c.width/2)*g,t=(t.y+c.height/2)*g,c=this.getMetrics(),this.scroll(-(o-c.viewWidth/2),-(t-c.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.hideChaff(!1),(t=this.getFlyout(!1))&&t.isVisible()&&(t.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(t,o){this.hideChaff(!0);const c=this.getMetrics();t=Math.min(t,-c.scrollLeft),o=Math.min(o,-c.scrollTop);const g=c.scrollTop+Math.max(0,c.scrollHeight-c.viewHeight);t=Math.max(t,-(c.scrollLeft+Math.max(0,c.scrollWidth-c.viewWidth))),o=Math.max(o,-g),this.scrollX=t,this.scrollY=o,this.scrollbar&&this.scrollbar.set(-(t+c.scrollLeft),-(o+c.scrollTop),!1),t+=c.absoluteLeft,o+=c.absoluteTop,this.translate(t,o)}getBlockById(t){return super.getBlockById(t)}getAllBlocks(t=!1){return super.getAllBlocks(t)}getTopBlocks(t=!1){return super.getTopBlocks(t)}addTopBlock(t){this.addTopBoundedElement(t),super.addTopBlock(t)}removeTopBlock(t){this.removeTopBoundedElement(t),super.removeTopBlock(t)}addTopComment(t){this.addTopBoundedElement(t),super.addTopComment(t)}removeTopComment(t){this.removeTopBoundedElement(t),super.removeTopComment(t)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(t){this.topBoundedElements.push(t)}removeTopBoundedElement(t){tt(this.topBoundedElements,t)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(t){const o=!this.resizesEnabled&&t;this.resizesEnabled=t,o&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(t,o){if(typeof o!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(t,o)}getButtonCallback(t){let o;return(o=this.flyoutButtonCallbacks.get(t))!=null?o:null}removeButtonCallback(t){this.flyoutButtonCallbacks.delete(t)}registerToolboxCategoryCallback(t,o){if(typeof o!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(t,o)}getToolboxCategoryCallback(t){return this.toolboxCategoryCallbacks.get(t)||null}removeToolboxCategoryCallback(t){this.toolboxCategoryCallbacks.delete(t)}getGesture(t){const o=t.type==="pointerdown",c=this.currentGesture_;return c?o&&c.hasStarted()?(console.warn("Tried to start the same gesture twice."),c.cancel(),null):c:o?this.currentGesture_=new nu(t,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(t=!1){ga(),wi(this),No(),this.hideComponents(t)}hideComponents(t=!1){this.getComponentManager().getComponents(zr.Capability.AUTOHIDEABLE,!0).forEach(o=>o.autoHide(t))}static setTopLevelWorkspaceMetrics_(t){const o=this.getMetrics();typeof t.x=="number"&&(this.scrollX=-(o.scrollLeft+(o.scrollWidth-o.viewWidth)*t.x)),typeof t.y=="number"&&(this.scrollY=-(o.scrollTop+(o.scrollHeight-o.viewHeight)*t.y)),this.translate(this.scrollX+o.absoluteLeft,this.scrollY+o.absoluteTop)}},tA=class extends Rt{constructor(t,o){super(o),this.type=Qs,this.isOpen=t}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new tA),o.isOpen=t.isOpen,o}};r(yt.EVENT,Qs,tA);var nA=class extends Rt{constructor(t,o,c){super(c),this.type=_h,this.oldElementId=t??void 0,this.newElementId=o??void 0}toJson(){const t=super.toJson();return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new nA),o.oldElementId=t.oldElementId,o.newElementId=t.newElementId,o}};r(yt.EVENT,_h,nA);var A1=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(t){this.drawer=t}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(t){const o=this.curNode;this.curNode=t,this.drawer&&this.drawer.draw(o,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},iA=class extends A1{constructor(){super(),this.type="cursor"}next(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()===_t.types.NEXT||t.getType()===_t.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t}in(){var t=this.getCurNode();if(!t)return null;(t.getType()===_t.types.PREVIOUS||t.getType()===_t.types.OUTPUT)&&(t=t.next());let o,c;return(t=(c=(o=t)==null?void 0:o.in())!=null?c:null)&&this.setCurNode(t),t}prev(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()===_t.types.NEXT||t.getType()===_t.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t}out(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()===_t.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null}};r(yt.CURSOR,_o,iA);var yT=class extends iA{constructor(){super()}next(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null}in(){return this.next()}prev(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null}out(){return this.prev()}getNextNode_(t,o){if(!t)return null;const c=t.in()||t.next();return o(c)?c:c?this.getNextNode_(c,o):(t=this.findSiblingOrParent(t.out()),o(t)?t:t?this.getNextNode_(t,o):null)}getPreviousNode_(t,o){if(!t)return null;let c=t.prev();return c=c?this.getRightMostChild(c):t.out(),o(c)?c:c?this.getPreviousNode_(c,o):null}validNode_(t){let o=!1;return t=t&&t.getType(),(t===_t.types.OUTPUT||t===_t.types.INPUT||t===_t.types.FIELD||t===_t.types.NEXT||t===_t.types.PREVIOUS||t===_t.types.WORKSPACE)&&(o=!0),o}findSiblingOrParent(t){if(!t)return null;const o=t.next();return o||this.findSiblingOrParent(t.out())}getRightMostChild(t){if(!t.in())return t;for(t=t.in();t&&t.next();)t=t.next();return this.getRightMostChild(t)}};yT.registrationName="basicCursor",r(yt.CURSOR,yT.registrationName,yT);var C1=class extends yT{validNode_(t){let o=!1;const c=t&&t.getType();return t&&(t=t.getLocation(),c===_t.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(o=!0)),o}},rA=10,no=class extends Jn{constructor(t,o){super(t,o),this.highlighted=!1,this.targetConnection=null,this.db=t.workspace.connectionDBList[o],this.dbOpposite=t.workspace.connectionDBList[$f[o]],this.offsetInBlock=new At(0,0),this.trackedState=no.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===no.TrackedState.TRACKED&&this.db.removeConnection(this,this.y);let t,o;(o=(t=this.sourceBlock_.pathObject).removeConnectionHighlight)==null||o.call(t,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(t){const o=this.x-t.x;return t=this.y-t.y,Math.sqrt(o*o+t*t)}bumpAwayFrom(t){if(!this.sourceBlock_.workspace.isDragging()){var o=this.sourceBlock_.getRootBlock();if(!o.isInFlyout){var c=!1;if(!o.isMovable()){if(o=t.getSourceBlock().getRootBlock(),!o.isMovable())return;t=this,c=!0}var g=ue()==o;g||o.addSelect();var b=t.x+n.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*rA)-this.x,M=t.y+n.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*rA)-this.y;c&&(M=-M),o.RTL&&(b=t.x-n.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*rA)-this.x),o.moveBy(b,M,["bump"]),g||o.removeSelect()}}}moveTo(t,o){let c=!1;return this.trackedState===no.TrackedState.WILL_TRACK?(this.db.addConnection(this,o),this.trackedState=no.TrackedState.TRACKED,c=!0):this.trackedState===no.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,o),c=!0),this.x=t,this.y=o,c}moveBy(t,o){return this.moveTo(this.x+t,this.y+o)}moveToOffset(t){return this.moveTo(t.x+this.offsetInBlock.x,t.y+this.offsetInBlock.y)}setOffsetInBlock(t,o){this.offsetInBlock.x=t,this.offsetInBlock.y=o}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var t=this.targetConnection;const o=this.targetBlock();t&&o&&(t=At.difference(this.offsetInBlock,t.offsetInBlock),o.translate(t.x,t.y))}closest(t,o){return this.dbOpposite.searchForClosest(this,t,o)}highlight(){this.highlighted=!0,this.getSourceBlock().queueRender()}unhighlight(){this.highlighted=!1,this.getSourceBlock().queueRender()}isHighlighted(){return this.highlighted}setTracking(t){t&&this.trackedState===no.TrackedState.TRACKED||!t&&this.trackedState===no.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db.addConnection(this,this.y),this.trackedState=no.TrackedState.TRACKED):(this.trackedState===no.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=no.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const t=this.targetBlock().getDescendants(!1);for(let o=0;o<t.length;o++){const c=t[o],g=c.getConnections_(!0);for(let b=0;b<g.length;b++)g[b].setTracking(!1);for(const b of c.getIcons())Te(b)&&b.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let t=[];if(this.type!==Bt.INPUT_VALUE&&this.type!==Bt.NEXT_STATEMENT)return t;const o=this.targetBlock();if(o){let c;o.isCollapsed()?(c=[],o.outputConnection&&c.push(o.outputConnection),o.nextConnection&&c.push(o.nextConnection),o.previousConnection&&c.push(o.previousConnection)):c=o.getConnections_(!0);for(let g=0;g<c.length;g++)t.push(...c[g].startTrackingAll());t.length||(t=[o])}return t}onFailedConnect(t){const o=this.getSourceBlock();if(y()){const c=n.getGroup$$module$build$src$core$events$utils();setTimeout((function(){o.isDisposed()||o.getParent()||(n.setGroup$$module$build$src$core$events$utils(c),this.bumpAwayFrom(t),n.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),n.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(t=!0){const{parentConnection:o,childConnection:c}=this.getParentAndChildConnections();if(o&&c){var g=n.getGroup$$module$build$src$core$events$utils();g||n.setGroup$$module$build$src$core$events$utils(!0);var b=o.getSourceBlock(),M=c.getSourceBlock();super.disconnectInternal(t),b.queueRender(),M.updateDisabled(),M.queueRender(),M.getSvgRoot().style.display="block",n.setGroup$$module$build$src$core$events$utils(g)}}respawnShadow_(){super.respawnShadow_();const t=this.targetBlock();t&&(t.initSvg(),t.queueRender())}neighbours(t){return this.dbOpposite.getNeighbours(this,t)}connect_(t){super.connect_(t);var o=this.getSourceBlock();t=t.getSourceBlock(),o.updateDisabled(),t.updateDisabled(),t.queueRender(),(o=o.getInputWithBlock(t))&&(o=o.isVisible(),t.getSvgRoot().style.display=o?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return super.setCheck(t),this.sourceBlock_.queueRender(),this}};(function(t){t=t.TrackedState||(t.TrackedState={}),t[t.WILL_TRACK=-1]="WILL_TRACK",t[t.UNTRACKED=0]="UNTRACKED",t[t.TRACKED=1]="TRACKED"})(no||(no={})),no.TrackedState;var ST=class{paste(t,o,c){if(!o.isCapacityAvailable(t.typeCounts))return null;c&&(t.blockState.x=c.x,t.blockState.y=c.y),c=c||new At(t.blockState.x||0,t.blockState.y||0),n.disable$$module$build$src$core$events$utils();let g;try{g=Ii(t.blockState,o),H_(g,c)}finally{n.enable$$module$build$src$core$events$utils()}return g&&(x()&&!g.isShadow()&&$(new(k(n.CREATE$$module$build$src$core$events$utils))(g)),n.setSelected$$module$build$src$core$common(g),g)}};ST.TYPE="block",jn(ST.TYPE,new ST);var Sy={};Sy.bumpIntoBounds=oh,Sy.bumpIntoBoundsHandler=V_,Sy.bumpTopObjectsIntoBounds=Wd;var R1=class{constructor(t){this.block=t,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new At(0,0),this.workspace=t.workspace}isMovable(){if(this.block.isShadow()){let t,o;return(o=(t=this.block.getParent())==null?void 0:t.isMovable())!=null?o:!1}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(t){if(this.block.isShadow())this.startDraggingShadow(t);else{this.dragging=!0,n.getGroup$$module$build$src$core$events$utils()||n.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(p(yt.CONNECTION_PREVIEWER,this.workspace.options))(this.block),Qe(),this.workspace.setResizesEnabled(!1),ec(),t=!!t&&(t.altKey||t.ctrlKey||t.metaKey),this.shouldDisconnect(t)&&this.disconnectBlock(t),this.block.setDragging(!0);var o;(o=this.workspace.getLayerManager())==null||o.moveToDragLayer(this.block)}}startDraggingShadow(t){const o=this.block.getParent();if(!o)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=At.difference(o.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),o.startDrag(t)}shouldDisconnect(t){return!!(this.block.getParent()||t&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(t){let o,c,g;if(this.startParentConn=(g=(o=this.block.outputConnection)==null?void 0:o.targetConnection)!=null?g:(c=this.block.previousConnection)==null?void 0:c.targetConnection,t){let b;this.startChildConn=(b=this.block.nextConnection)==null?void 0:b.targetConnection}this.block.unplug(t),C_(this.block)}fireDragStartEvent(){const t=new(k(sc))(this.block,!0,this.block.getDescendants(!1));$(t)}fireDragEndEvent(){const t=new(k(sc))(this.block,!1,this.block.getDescendants(!1));$(t)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var t=new(k(n.MOVE$$module$build$src$core$events$utils))(this.block);t.setReason(["drag"]),t.oldCoordinate=this.startLoc,t.recordNew(),$(t)}}drag(t){if(this.block.isShadow()){let o;(o=this.block.getParent())==null||o.drag(At.sum(t,this.dragOffset))}else this.block.moveDuringDrag(t),this.updateConnectionPreview(this.block,At.difference(t,this.startLoc))}updateConnectionPreview(t,o){var c=this.connectionCandidate;const g=this.getConnectionCandidate(t,o);if(g){this.connectionCandidate=o=c&&this.currCandidateIsBetter(c,o,g)?c:g;var{local:b,neighbour:M}=o;o=b.type===Bt.OUTPUT_VALUE||b.type===Bt.PREVIOUS_STATEMENT,c=M.isConnected()&&!M.targetBlock().isInsertionMarker(),o&&c&&!this.orphanCanConnectAtEnd(t,M.targetBlock(),b.type)?this.connectionPreviewer.previewReplacement(b,M,M.targetBlock()):this.connectionPreviewer.previewConnection(b,M)}else this.connectionPreviewer.hidePreview(),this.connectionCandidate=null}orphanCanConnectAtEnd(t,o,c){return!!Jn.getConnectionForOrphanedConnection(t,c===Bt.OUTPUT_VALUE?o.outputConnection:o.previousConnection)}currCandidateIsBetter(t,o,c){const{local:g,neighbour:b}=t;t=new At(g.x,g.y);const M=new At(b.x,b.y);return o=At.distance(At.sum(t,o),M),c.distance>o-n.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(t,o){t=this.getLocalConnections(t);let c=this.connectionCandidate?n.config$$module$build$src$core$config.connectingSnapRadius:n.config$$module$build$src$core$config.snapRadius,g=null;for(const b of t){const{connection:M,radius:te}=b.closest(c,o);M&&(g={local:b,neighbour:M,distance:te},c=te)}return g}getLocalConnections(t){const o=t.getConnections_(!1),c=t.lastConnectionInStack(!0);return c&&c!==t.nextConnection&&o.push(c),o}endDrag(t){if(this.block.isShadow()){let o;(o=this.block.getParent())==null||o.endDrag(t)}else{if(this.fireDragEndEvent(),this.fireMoveEvent(),ht(),ec(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let o;(o=this.workspace.getLayerManager())==null||o.moveOffDragLayer(this.block,pm),this.block.setDragging(!1)}this.connectionCandidate?this.applyConnections(this.connectionCandidate):this.block.queueRender(),this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0),n.setGroup$$module$build$src$core$events$utils(!1)}}applyConnections(t){const{local:o,neighbour:c}=t;o.connect(c);const g=o.isSuperior()?c:o,b=this.block.getRootBlock();Kt().then(()=>{Qp(g.getSourceBlock()),setTimeout(()=>{b.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let o;(o=this.block.getParent())==null||o.revertDrag()}else{var t;if((t=this.startChildConn)==null||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case Bt.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case Bt.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{this.block.moveTo(this.startLoc,["drag"]);let o;(o=this.workspace.getLayerManager())==null||o.moveOffDragLayer(this.block,pm),oh(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}},Ia=class extends yf{constructor(t,o,c){if(super(t,o,c),this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new At(0,0),this.dragStrategy=new R1(this),!t.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=t,this.svgGroup_=ve(Xe.G,{}),this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),t=this.pathObject.svgPath,t.tooltip=this,Ar(t),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.initialized){for(var t of this.inputList)t.init();for(const o of this.getIcons())o.initView(this.createIconPointerDownListener(o)),o.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),t=this.getSvgRoot(),!this.workspace.options.readOnly&&t&&Ye(t,"pointerdown",this,this.onMouseDown_),t.parentNode||this.workspace.getCanvas().appendChild(t),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()){let t;(t=this.getParent())==null||t.select()}else this.addSelect()}unselect(){if(this.isShadow()){let t;(t=this.getParent())==null||t.unselect()}else this.removeSelect()}setParent(t){const o=this.parentBlock_;if(t!==o){Qe(),super.setParent(t),ht();var c=this.getSvgRoot();if(!this.workspace.isClearing&&c){var g=this.getRelativeToSurfaceXY();t?t.getSvgRoot().appendChild(c):o&&((t=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(c,t):this.workspace.getCanvas().appendChild(c),this.translate(g.x,g.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const t=this.workspace.getLayerManager();if(!t)throw Error("Cannot calculate position because the workspace has not been appended");let o=0,c=0,g=this.getSvgRoot();if(g)do{const b=j(g);o+=b.x,c+=b.y,g=g.parentNode}while(g&&!t.hasLayer(g));return new At(o,c)}moveBy(t,o,c){if(this.parentBlock_)throw Error("Block has parent");const g=x();let b=null;g&&(b=new(k(n.MOVE$$module$build$src$core$events$utils))(this),c&&b.setReason(c)),t=new At(t,o),o=this.getRelativeToSurfaceXY(),t=At.sum(o,t),this.translate(t.x,t.y),this.updateComponentLocations(t),g&&b&&(b.recordNew(),$(b)),this.workspace.resizeContents()}translate(t,o){this.translation=`translate(${t}, ${o})`,this.relativeCoords=new At(t,o),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(t,o){const c=this.getRelativeToSurfaceXY();this.moveBy(t.x-c.x,t.y-c.y,o)}moveDuringDrag(t){this.translate(t.x,t.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(t)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t!=null&&t.shouldSnap()){var o=this.getRelativeToSurfaceXY();t=t.alignXY(o),t!==o&&this.moveTo(t,["snap"])}}}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY(),o=this.getHeightWidth();let c,g;return this.RTL?(c=t.x-o.width,g=t.x):(c=t.x,g=t.x+o.width),new Si(t.y,t.y+o.height,c,g)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t=0,o;o=this.inputList[t];t++)o.markDirty()}setCollapsed(t){this.collapsed_!==t&&(super.setCollapsed(t),this.updateCollapsed_())}updateCollapsed_(){var t=this.isCollapsed();const o=iT,c=KE;for(let b=0,M;M=this.inputList[b];b++)M.name!==o&&M.setVisible(!t);for(var g of this.getIcons())g.updateCollapsed();t?(t=this.toString(S1),(g=this.getField(c))?g.setValue(t):(this.getInput(o)||this.appendDummyInput(o)).appendField(new Ef(t),c)):(this.updateDisabled(),this.removeInput(o))}tab(t,o){const c=new C1;c.setCurNode(_t.createFieldNode(t)),t=c.getCurNode(),o?c.next():c.prev(),(o=c.getCurNode())&&o!==t&&(o.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(o))}onMouseDown_(t){const o=this.workspace.getGesture(t);o&&o.handleBlockStart(t,this)}showHelp(){const t=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;t&&window.open(t)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const t=wn.registry.getContextMenuOptions(wn.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t}showContextMenu(t){const o=this.generateContextMenu();o&&o.length&&(Bc(t,o,this.RTL,this.workspace),Od(this))}updateComponentLocations(t){this.dragging||this.updateConnectionLocations(t),this.updateIconLocations(t),this.updateFieldLocations(t);for(const o of this.getChildren(!1))o.updateComponentLocations(At.sum(t,o.relativeCoords))}updateConnectionLocations(t){for(const o of this.getConnections_(!1))o.moveToOffset(t)}updateIconLocations(t){for(const o of this.getIcons())o.onLocationChange(t)}updateFieldLocations(t){for(const o of this.inputList)for(const c of o.fieldRow)c.onLocationChange(t)}setDragging(t){(this.dragging=t)?(this.translation="",H.push(...this.getConnections_(!0)),Me(this.svgGroup_,"blocklyDragging")):(H.length=0,oe(this.svgGroup_,"blocklyDragging"));for(let o=0;o<this.childBlocks_.length;o++)this.childBlocks_[o].setDragging(t)}setMovable(t){super.setMovable(t),this.pathObject.updateMovable(t)}setEditable(t){super.setEditable(t),t=this.getIcons();for(let o=0;o<t.length;o++)t[o].updateEditable()}setShadow(t){super.setShadow(t),this.applyColour()}setInsertionMarker(t){this.isInsertionMarker_!==t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(t,o){this.disposing=!0,zp(),ql(),o&&(this.unplug(t),Pd(this)),super.dispose(!!t),W(this.svgGroup_)}disposeInternal(){this.disposing=!0,super.disposeInternal(),ue()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(t=>clearTimeout(t)),this.warningTextDb.clear(),this.getIcons().forEach(t=>t.dispose())}checkAndDelete(){this.workspace.isFlyout||(n.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),n.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:ST.TYPE,blockState:zi(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:K(this,!0)}}applyColour(){this.pathObject.applyColour(this);const t=this.getIcons();for(let o=0;o<t.length;o++)t[o].applyColour();for(let o=0,c;c=this.inputList[o];o++)for(let g=0,b;b=c.fieldRow[g];g++)b.applyColour()}updateDisabled(){const t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t){let o;(o=this.getNextBlock())==null||o.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=t;for(const o of this.getChildren(!1))o.updateDisabled()}}setWarningText(t,o=""){if(o)this.warningTextDb.has(o)&&(clearTimeout(this.warningTextDb.get(o)),this.warningTextDb.delete(o));else{for(var c of this.warningTextDb.values())clearTimeout(c);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(o,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(o),this.setWarningText(t,o))},100));else if(this.isInFlyout&&(t=null),c=this.getIcon(ou.TYPE),t){let g=this.getSurroundParent(),b=null;for(;g;)g.isCollapsed()&&(b=g),g=g.getSurroundParent();b&&b.setWarningText(n.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Ia.COLLAPSED_WARNING_ID),c?c.addMessage(t,o):this.addIcon(new ou(this).addMessage(t,o))}else c&&(o?(c.addMessage("",o),c.getText()||this.removeIcon(ou.TYPE)):this.removeIcon(ou.TYPE))}setMutator(t){this.removeIcon(n.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),t&&this.addIcon(t)}addIcon(t){return super.addIcon(t),t instanceof n.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=t),t.initView(this.createIconPointerDownListener(t)),t.applyColour(),t.updateEditable(),this.queueRender(),t}createIconPointerDownListener(t){return o=>{this.isDeadOrDying()||(o=this.workspace.getGesture(o))&&o.setStartIcon(t)}}removeIcon(t){const o=super.removeIcon(t);return t.equals(n.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),o}setEnabled(t){sl("setEnabled","v11","v12","the setDisabledReason method of BlockSvg");const o=this.isEnabled();super.setEnabled(t),this.isEnabled()===o||this.getInheritedDisabled()||this.updateDisabled()}setDisabledReason(t,o){const c=this.isEnabled();super.setDisabledReason(t,o),this.isEnabled()===c||this.getInheritedDisabled()||this.updateDisabled()}setHighlighted(t){this.pathObject.updateHighlighted(t)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(t){this.pathObject.updateDraggingDelete(t)}getColour(){return this.style.colourPrimary}setColour(t){super.setColour(t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()}setStyle(t){const o=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,o)this.hat=o.hat,this.pathObject.setStyle(o),this.colour_=o.colourPrimary,this.style=o,this.applyColour();else throw Error("Invalid style name: "+t)}bringToFront(t=!1){let o=this;if(!o.isDeadOrDying())do{const c=o.getSvgRoot(),g=c.parentNode,b=g.childNodes;if(b[b.length-1]!==c&&g.appendChild(c),t)break;o=o.getParent()}while(o)}setPreviousStatement(t,o){super.setPreviousStatement(t,o),this.queueRender()}setNextStatement(t,o){super.setNextStatement(t,o),this.queueRender()}setOutput(t,o){super.setOutput(t,o),this.queueRender()}setInputsInline(t){super.setInputsInline(t),this.queueRender()}removeInput(t,o){return t=super.removeInput(t,o),this.queueRender(),t}moveNumberedInputBefore(t,o){super.moveNumberedInputBefore(t,o),this.queueRender()}appendInput(t){return super.appendInput(t),this.queueRender(),t}setConnectionTracking(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var o=this.nextConnection.targetBlock();o&&o.setConnectionTracking(t)}if(!this.collapsed_)for(o=0;o<this.inputList.length;o++){var c=this.inputList[o].connection;c&&(c.setTracking(t),(c=c.targetBlock())&&c.setConnectionTracking(t))}}getConnections_(t){const o=[];if(this.outputConnection&&o.push(this.outputConnection),this.previousConnection&&o.push(this.previousConnection),this.nextConnection&&o.push(this.nextConnection),t||!this.collapsed_)for(let c=0,g;g=this.inputList[c];c++)g.connection&&o.push(g.connection);return o}lastConnectionInStack(t){return super.lastConnectionInStack(t)}getMatchingConnection(t,o){return super.getMatchingConnection(t,o)}makeConnection_(t){return new no(this,t)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const t=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||t.isInFlyout))for(const o of this.getConnections_(!1)){if(o.isSuperior()){let c;(c=o.targetBlock())==null||c.bumpNeighbours()}for(const c of o.neighbours(n.config$$module$build$src$core$config.snapRadius))c.getSourceBlock().getRootBlock()!==t&&(o.isConnected()&&c.isConnected()||(o.isSuperior()?c.bumpAwayFrom(o):o.bumpAwayFrom(c)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(t,o,c){if(t.type===Bt.NEXT_STATEMENT||t.type===Bt.INPUT_VALUE){let g=o.x;o=o.y,g+=c.x-t.getOffsetInBlock().x,o+=c.y-t.getOffsetInBlock().y,this.moveBy(g,o)}}getChildren(t){return super.getChildren(t)}queueRender(){return In(this)}render(){this.queueRender(),An()}renderEfficiently(){Qe(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),ht(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const t of this.inputList){const o=t.connection;o&&o.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(uT.LOCAL_MARKER).draw();for(const t of this.inputList)for(const o of t.fieldRow)o.updateMarkers_()}setCursorSvg(t){this.pathObject.setCursorSvg(t)}setMarkerSvg(t){this.pathObject.setMarkerSvg(t)}getHeightWidth(){let t=this.height,o=this.width;var c=this.getNextBlock();if(c){c=c.getHeightWidth();const g=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=c.height-g,o=Math.max(o,c.width)}return{height:t,width:o}}fadeForReplacement(t){this.pathObject.updateReplacementFade(t)}highlightShapeForInput(t,o){this.pathObject.updateShapeForInputHighlight(t,o)}setDragStrategy(t){this.dragStrategy=t}isMovable(){return this.dragStrategy.isMovable()}startDrag(t){this.dragStrategy.startDrag(t)}drag(t,o){this.dragStrategy.drag(t,o)}endDrag(t){this.dragStrategy.endDrag(t)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const t=Object.assign({},{kind:"BLOCK"},zi(this)),o=new Set(["id","height","width","pinned","enabled"]),c=function(g){for(const b in g)o.has(b)?delete g[b]:typeof g[b]=="object"&&c(g[b])};return c(t),[t]}};Ia.INLINE=-1,Ia.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var x1=class{constructor(){}onDragEnter(t){}onDragOver(t){}onDragExit(t){}onDrop(t){}getClientRect(){return null}shouldPreventMove(t){return!1}},$y=class extends x1{constructor(){super(),this.wouldDelete_=!1}wouldDelete(t){return t instanceof Ia?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t)):this.updateWouldDelete_(qs(t)&&t.isDeletable()),this.wouldDelete_}updateWouldDelete_(t){this.wouldDelete_=t}},w1=class extends $y{constructor(t){super(),this.workspace=t,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(t=new Ra({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(t.toolboxPosition=this.workspace.toolboxPosition===Cn.TOP?Cn.BOTTOM:Cn.TOP,this.flyout=new(p(yt.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(t)):(t.toolboxPosition=this.workspace.toolboxPosition===Cn.RIGHT?Cn.LEFT:Cn.RIGHT,this.flyout=new(p(yt.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(t)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=ve(Xe.G,{class:"blocklyTrash"});let t;const o=String(Math.random()).substring(2);t=ve(Xe.CLIPPATH,{id:"blocklyTrashBodyClipPath"+o},this.svgGroup),ve(Xe.RECT,{width:wm,height:by,y:Mm},t);const c=ve(Xe.IMAGE,{width:eo.width,x:-sA,height:eo.height,y:-oA,"clip-path":"url(#blocklyTrashBodyClipPath"+o+")"},this.svgGroup);return c.setAttributeNS(Wo,"xlink:href",this.workspace.options.pathToMedia+eo.url),t=ve(Xe.CLIPPATH,{id:"blocklyTrashLidClipPath"+o},this.svgGroup),ve(Xe.RECT,{width:wm,height:Mm},t),this.svgLid=ve(Xe.IMAGE,{width:eo.width,x:-sA,height:eo.height,y:-oA,"clip-path":"url(#blocklyTrashLidClipPath"+o+")"},this.svgGroup),this.svgLid.setAttributeNS(Wo,"xlink:href",this.workspace.options.pathToMedia+eo.url),we(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),we(this.svgGroup,"pointerup",this,this.click),we(c,"pointerover",this,this.mouseOver),we(c,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(ot(this.flyout.createDom(Xe.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[zr.Capability.AUTOHIDEABLE,zr.Capability.DELETE_AREA,zr.Capability.DRAG_TARGET,zr.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&W(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var t=this.contents.map(function(c){return JSON.parse(c)}),o=this.workspace.getParentSvg().style;o.cursor="wait",setTimeout(()=>{let c;(c=this.flyout)==null||c.show(t),o.cursor="";let g;(g=this.workspace.scrollbar)==null||g.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var t;(t=this.flyout)==null||t.hide();var o;(o=this.workspace.scrollbar)==null||o.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(t){!t&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(t,o){if(this.initialized){var c=_e(this.workspace,t);t=le(c,new Kn(wm,by+Mm),EG,M1,t,this.workspace),o=pe(t,M1,c.vertical===tu.TOP?$h.DOWN:$h.UP,o),this.top=o.top,this.left=o.left;var g;(g=this.svgGroup)==null||g.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new Si(this.top,this.top+by+Mm,this.left,this.left+wm)}getClientRect(){if(!this.svgGroup)return null;var t=this.svgGroup.getBoundingClientRect();const o=t.top+oA-Ay;return t=t.left+sA-Ay,new Si(o,o+Mm+by+2*Ay,t,t+wm+2*Ay)}onDragOver(t){this.setLidOpen(this.wouldDelete_)}onDragExit(t){this.setLidOpen(!1)}onDrop(t){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(t){this.isLidOpen!==t&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=t,this.animateLid())}animateLid(){const t=$G;var o=1/(t+1);this.lidOpen+=this.isLidOpen?o:-o,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*O1),o=I1+this.lidOpen*(bG-I1),this.svgGroup&&(this.svgGroup.style.opacity=`${o}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),SG/t))}setLidAngle(t){const o=this.workspace.toolboxPosition===Cn.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let c;(c=this.svgLid)==null||c.setAttribute("transform","rotate("+(o?-t:t)+","+(o?4:wm-4)+","+(Mm-2)+")")}setMinOpenness(t){this.minOpenness=t,this.isLidOpen||this.setLidAngle(t*O1)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(t){t=new(k(Qs))(t,this.workspace.id),$(t)}blockMouseDownWhenOpenable(t){!this.contentsIsOpen()&&this.hasContents()&&t.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(t){if(!(0>=this.workspace.options.maxTrashcanContents||t.type!==n.DELETE$$module$build$src$core$events$utils||t.type!==n.DELETE$$module$build$src$core$events$utils||t.wasShadow)){if(!t.oldJson)throw Error("Encountered a delete event without proper oldJson");if(t=JSON.stringify(this.cleanBlockJson(t.oldJson)),!this.contents.includes(t)){for(this.contents.unshift(t);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(yG)}}}cleanBlockJson(t){function o(c){if(c){if(delete c.id,delete c.x,delete c.y,delete c.enabled,delete c.disabledReasons,c.icons&&c.icons.comment){var g=c.icons.comment;delete g.height,delete g.width,delete g.pinned}g=c.inputs;for(var b in g){var M=g[b];const te=M.block;M=M.shadow,te&&o(te),M&&o(M)}c.next&&(b=c.next,c=b.block,b=b.shadow,c&&o(c),b&&o(b))}}return t=JSON.parse(JSON.stringify(t)),o(t),Object.assign({},{kind:"BLOCK"},t)}},wm=47,by=44,Mm=16,M1=20,EG=20,Ay=10,sA=0,oA=32,yG=.1,SG=80,$G=4,I1=.4,bG=.8,O1=45,ri=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(t,o){if(this.shortcuts.get(t.name)&&!o)throw Error(`Shortcut named "${t.name}" already exists.`);if(this.shortcuts.set(t.name,t),(o=t.keyCodes)&&0<o.length)for(let c=0;c<o.length;c++)this.addKeyMapping(o[c],t.name,!!t.allowCollision)}unregister(t){return this.shortcuts.get(t)?(this.removeAllKeyMappings(t),this.shortcuts.delete(t),!0):(console.warn(`Keyboard shortcut named "${t}" not found.`),!1)}addKeyMapping(t,o,c){t=`${t}`;const g=this.keyMap.get(t);if(g&&!c)throw Error(`Shortcut named "${o}" collides with shortcuts "${g}"`);g&&c?g.unshift(o):this.keyMap.set(t,[o])}removeKeyMapping(t,o,c){const g=this.keyMap.get(t);if(!g)return c||console.warn(`No keyboard shortcut named "${o}" registered with key code "${t}"`),!1;const b=g.indexOf(o);return-1<b?(g.splice(b,1),g.length===0&&this.keyMap.delete(t),!0):(c||console.warn(`No keyboard shortcut named "${o}" registered with key code "${t}"`),!1)}removeAllKeyMappings(t){for(const o of this.keyMap.keys())this.removeKeyMapping(o,t,!0)}setKeyMap(t){this.keyMap.clear();for(const o in t)this.keyMap.set(o,t[o])}getKeyMap(){const t=Object.create(null);for(const[o,c]of this.keyMap)t[o]=c;return t}getRegistry(){const t=Object.create(null);for(const[o,c]of this.shortcuts)t[o]=c;return il(Object.create(null),t)}onKeyDown(t,o){var c=this.serializeKeyEvent_(o);if(c=this.getShortcutNamesByKeyCode(c),!c)return!1;for(let g=0,b;b=c[g];g++){const M=this.shortcuts.get(b);let te,$e;if((te=M)==null||!te.preconditionFn||($e=M)!=null&&$e.preconditionFn(t)){let it,Dt;if((it=M)!=null&&it.callback&&((Dt=M)!=null&&Dt.callback(t,o,M)))return!0}}return!1}getShortcutNamesByKeyCode(t){return this.keyMap.get(t)||[]}getKeyCodesByShortcutName(t){const o=[];for(const[c,g]of this.keyMap)-1<g.indexOf(t)&&o.push(c);return o}serializeKeyEvent_(t){let o="";for(const c in ri.modifierKeys)t.getModifierState(c)&&(o!==""&&(o+="+"),o+=c);return o!==""&&t.keyCode?o+="+"+t.keyCode:t.keyCode&&(o=String(t.keyCode)),o}checkModifiers_(t){for(let o=0,c;c=t[o];o++)if(!(c in ri.modifierKeys))throw Error(c+" is not a valid modifier key.")}createSerializedKey(t,o){let c="";if(o){this.checkModifiers_(o);for(const g in ri.modifierKeys)o.includes(ri.modifierKeys[g])&&(c!==""&&(c+="+"),c+=g)}return c!==""&&t?c+="+"+t:t&&(c=`${t}`),c}};ri.registry=new ri,function(t){t=t.modifierKeys||(t.modifierKeys={}),t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta"}(ri||(ri={}));var aA=null,lA=null,AG={duplicateInternal:Xd,copyInternal:W_},$T={};$T.BlockPaster=ST,$T.TEST_ONLY=AG,$T.paste=Ho,$T.registry=gb;var fc;(function(t){t.ESCAPE="escape",t.DELETE="delete",t.COPY="copy",t.CUT="cut",t.PASTE="paste",t.UNDO="undo",t.REDO="redo"})(fc||(fc={}));var Rh=null,xh=null,Im=null;X_();var pc={};pc.names=fc,pc.registerCopy=jd,pc.registerCut=Yd,pc.registerDefaultShortcuts=X_,pc.registerDelete=Vc,pc.registerEscape=lh,pc.registerPaste=Kd,pc.registerRedo=Jd,pc.registerUndo=lm;var CG=class{constructor(t,o){this.procedureModelClass=t,this.parameterModelClass=o,this.priority=UI}save(t){return t=t.getProcedureMap().getProcedures().map(o=>ch(o)),t.length?t:null}load(t,o){const c=o.getProcedureMap();for(const g of t)c.add(Zd(this.procedureModelClass,this.parameterModelClass,g,o))}clear(t){t.getProcedureMap().clear()}},Cy={};Cy.ProcedureSerializer=CG,Cy.loadProcedure=Zd,Cy.saveProcedure=ch;var L1=class{constructor(){this.priority=FI}save(t){const o=[];for(const c of t.getAllVariables())t={name:c.name,id:c.getId()},c.type&&(t.type=c.type),o.push(t);return o.length?o:null}load(t,o){for(const c of t)o.createVariable(c.name,c.type,c.id)}clear(t){t.getVariableMap().clear()}};hi("variables",new L1);var N1={};N1.VariableSerializer=L1;var cA={};cA.load=xn,cA.save=Wi;var RG={blocks:lT,exceptions:df,priorities:nG,procedures:Cy,registry:mb,variables:N1,workspaceComments:QE,workspaces:cA},uA=class{constructor(t,o,c,g,b){this.workspace=t,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,o=o===void 0?!0:o,c=c===void 0?!0:c;const M=o&&c;o&&(this.hScroll=new cr(t,!0,M,g,b)),c&&(this.vScroll=new cr(t,!1,M,g,b)),M&&(this.corner_=ve(Xe.RECT,{height:cr.scrollbarThickness,width:cr.scrollbarThickness,class:"blocklyScrollbarBackground"}),ot(this.corner_,t.getBubbleCanvas()))}dispose(){W(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const t=this.workspace.getMetrics();if(t){var o=!1,c=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===t.viewWidth&&this.oldHostMetrics_.viewHeight===t.viewHeight&&this.oldHostMetrics_.absoluteTop===t.absoluteTop&&this.oldHostMetrics_.absoluteLeft===t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===t.scrollWidth&&this.oldHostMetrics_.viewLeft===t.viewLeft&&this.oldHostMetrics_.scrollLeft===t.scrollLeft||(o=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===t.scrollHeight&&this.oldHostMetrics_.viewTop===t.viewTop&&this.oldHostMetrics_.scrollTop===t.scrollTop||(c=!0)):c=o=!0,o||c){try{n.disable$$module$build$src$core$events$utils(),this.hScroll&&o&&this.hScroll.resize(t),this.vScroll&&c&&this.vScroll.resize(t)}finally{n.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft){let g;(g=this.corner_)==null||g.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteTop!==t.absoluteTop){let g;(g=this.corner_)==null||g.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=t}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(t,o){this.hScroll&&this.hScroll.setOrigin(t,o),this.vScroll&&this.vScroll.setOrigin(t,o)}set(t,o,c){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(o,!1),(c||c===void 0)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace.setMetrics(t))}setX(t){this.hScroll&&this.hScroll.set(t,!0)}setY(t){this.vScroll&&this.vScroll.set(t,!0)}setContainerVisible(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)}isVisible(){let t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t}setVisible(t){this.hScroll&&this.hScroll.setVisibleInternal(t),this.vScroll&&this.vScroll.setVisibleInternal(t)}resizeContent(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)}resizeView(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)}},hA=class{constructor(t){this.workspace_=t}getDimensionsPx_(t){let o=0,c=0;return t&&(o=t.getWidth(),c=t.getHeight()),new Kn(o,c)}getFlyoutMetrics(t){return t=this.getDimensionsPx_(this.workspace_.getFlyout(t)),{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let t=0,o=0;const c=this.getToolboxMetrics(),g=this.getFlyoutMetrics(),b=!!this.workspace_.getToolbox();var M;const te=!((M=this.workspace_.getFlyout())!=null&&M.autoClose);M=b?c.position:g.position;const $e=M===Cn.TOP;return M===Cn.LEFT&&(b&&(t+=c.width),te&&(t+=g.width)),$e&&(b&&(o+=c.height),te&&(o+=g.height)),{top:o,left:t}}getViewMetrics(t){t=t?this.workspace_.scale:1;const o=this.getSvgMetrics(),c=this.getToolboxMetrics(),g=this.getFlyoutMetrics(),b=!!this.workspace_.getToolbox();var M;const te=!((M=this.workspace_.getFlyout())!=null&&M.autoClose);M=b?c.position:g.position;const $e=M===Cn.LEFT||M===Cn.RIGHT;return(M===Cn.TOP||M===Cn.BOTTOM)&&(b&&(o.height-=c.height),te&&(o.height-=g.height)),$e&&(b&&(o.width-=c.width),te&&(o.width-=g.width)),{height:o.height/t,width:o.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}}getContentMetrics(t){t=t?1:this.workspace_.scale;const o=this.workspace_.getBlocksBoundingBox();return{height:(o.bottom-o.top)*t,width:(o.right-o.left)*t,top:o.top*t,left:o.left*t}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(t){if(!this.hasFixedEdges())return{};const o=this.workspace_.isMovableHorizontally(),c=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);const g={};return c||(g.top=t.top,g.bottom=t.top+t.height),o||(g.left=t.left,g.right=t.left+t.width),g}getPaddedContent_(t,o){const c=o.top+o.height,g=o.left+o.width,b=t.width;t=t.height;const M=b/2,te=t/2;return{top:Math.min(o.top-te,c-t),bottom:Math.max(c+te,o.top+t),left:Math.min(o.left-M,g-b),right:Math.max(g+M,o.left+b)}}getScrollMetrics(t,o,c){t=t?this.workspace_.scale:1,o=o||this.getViewMetrics(!1);var g=c||this.getContentMetrics();c=this.getComputedFixedEdges_(o),o=this.getPaddedContent_(o,g),g=c.top!==void 0?c.top:o.top;const b=c.left!==void 0?c.left:o.left;return{top:g/t,left:b/t,width:((c.right!==void 0?c.right:o.right)-b)/t,height:((c.bottom!==void 0?c.bottom:o.bottom)-g)/t}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const t=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),c=this.getSvgMetrics(),g=this.getAbsoluteMetrics(),b=this.getViewMetrics(),M=this.getContentMetrics(),te=this.getScrollMetrics(!1,b,M);return{contentHeight:M.height,contentWidth:M.width,contentTop:M.top,contentLeft:M.left,scrollHeight:te.height,scrollWidth:te.width,scrollTop:te.top,scrollLeft:te.left,viewHeight:b.height,viewWidth:b.width,viewTop:b.top,viewLeft:b.left,absoluteTop:g.top,absoluteLeft:g.left,svgHeight:c.height,svgWidth:c.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:o.width,flyoutHeight:o.height}}};r(yt.METRICS_MANAGER,_o,hA),"Blockly"in globalThis||(globalThis.Blockly={Msg:NI});var k1=class extends Ty{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(t){super.setFontConstants_(t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(t){super.setDynamicProperties_(t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const o=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=o&&!isNaN(o)?o:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&W(this.selectedGlowFilter),this.replacementGlowFilter&&W(this.replacementGlowFilter)}makeStartHat(){const t=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH,c=ps("c",[Wt(25,-t),Wt(71,-t),Wt(o,0)]);return{height:t,width:o,path:c}}makeHexagonal(){function t(c,g,b){var M=c/2;return M=M>o?o:M,b=b?-1:1,c=(g?-1:1)*c/2,Uo(-b*M,c)+Uo(b*M,c)}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(c){return c/=2,c>o?o:c},height(c){return c},connectionOffsetY(c){return c/2},connectionOffsetX(c){return-c},pathDown(c){return t(c,!1,!1)},pathUp(c){return t(c,!0,!1)},pathRightDown(c){return t(c,!1,!0)},pathRightUp(c){return t(c,!1,!0)}}}makeRounded(){function t(g,b,M){const te=g>c?g-c:0;g=(g>c?c:g)/2;const $e=M===b?"0":"1";return Di("a","0 0,"+$e,g,Wt((M?1:-1)*g,(b?-1:1)*g))+Nt("v",(b?-1:1)*te)+Di("a","0 0,"+$e,g,Wt((M?-1:1)*g,(b?-1:1)*g))}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=2*o;return{type:this.SHAPES.ROUND,isDynamic:!0,width(g){return g/=2,g>o?o:g},height(g){return g},connectionOffsetY(g){return g/2},connectionOffsetX(g){return-g},pathDown(g){return t(g,!1,!1)},pathUp(g){return t(g,!0,!1)},pathRightDown(g){return t(g,!1,!0)},pathRightUp(g){return t(g,!1,!0)}}}makeSquared(){function t(c,g,b){c-=2*o;const M=b===g?"0":"1";return Di("a","0 0,"+M,o,Wt((b?1:-1)*o,(g?-1:1)*o))+Nt("v",(g?-1:1)*c)+Di("a","0 0,"+M,o,Wt((b?-1:1)*o,(g?-1:1)*o))}const o=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(c){return o},height(c){return c},connectionOffsetY(c){return c/2},connectionOffsetX(c){return-c},pathDown(c){return t(c,!1,!1)},pathUp(c){return t(c,!0,!1)},pathRightDown(c){return t(c,!1,!0)},pathRightUp(c){return t(c,!1,!0)}}}shapeFor(t){let o=t.getCheck();switch(!o&&t.targetConnection&&(o=t.targetConnection.getCheck()),t.type){case Bt.INPUT_VALUE:case Bt.OUTPUT_VALUE:if(t=t.getSourceBlock().getOutputShape(),t!==null)switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return o&&o.includes("Boolean")?this.HEXAGONAL:o&&o.includes("Number")?this.ROUNDED:(o&&o.includes("String"),this.ROUNDED);case Bt.PREVIOUS_STATEMENT:case Bt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function t(Dt){return ps("c",[Wt(Dt*b/2,0),Wt(Dt*b*3/4,te/2),Wt(Dt*b,te)])+ol([Wt(Dt*b,M)])+ps("c",[Wt(Dt*b/4,te/2),Wt(Dt*b/2,te),Wt(Dt*b,te)])+Nt("h",Dt*g)+ps("c",[Wt(Dt*b/2,0),Wt(Dt*b*3/4,-(te/2)),Wt(Dt*b,-te)])+ol([Wt(Dt*b,-M)])+ps("c",[Wt(Dt*b/4,-(te/2)),Wt(Dt*b/2,-te),Wt(Dt*b,-te)])}const o=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,g=o/3,b=g/3,M=c/2,te=M/2,$e=t(1),it=t(-1);return{type:this.SHAPES.NOTCH,width:o,height:c,pathLeft:$e,pathRight:it}}makeInsideCorners(){const t=this.CORNER_RADIUS,o=Di("a","0 0,0",t,Wt(-t,t)),c=Di("a","0 0,1",t,Wt(-t,t)),g=Di("a","0 0,0",t,Wt(t,t)),b=Di("a","0 0,1",t,Wt(t,t));return{width:t,height:t,pathTop:o,pathBottom:g,rightWidth:t,rightHeight:t,pathTopRight:c,pathBottomRight:b}}generateSecondaryColour_(t){return ko("#000",t,.15)||t}generateTertiaryColour_(t){return ko("#000",t,.25)||t}createDom(t,o,c){super.createDom(t,o,c),t=ve(Xe.DEFS,{},t),o=ve(Xe.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),ve(Xe.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},o),c=ve(Xe.FECOMPONENTTRANSFER,{result:"outBlur"},o),ve(Xe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},c),ve(Xe.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},o),ve(Xe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},o),this.selectedGlowFilterId=o.id,this.selectedGlowFilter=o,t=ve(Xe.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),ve(Xe.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),o=ve(Xe.FECOMPONENTTRANSFER,{result:"outBlur"},t),ve(Xe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),ve(Xe.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),ve(Xe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),ve(Xe.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter=t}getCSS_(t){return[`${t} .blocklyText,`,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${t} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text,`,`${t} .blocklyNonEditableText>g>text,`,`${t} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${t} .blocklyDropdownText {`,"fill: #fff !important;","}",`${t}.blocklyWidgetDiv .goog-menuitem,`,`${t}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${t} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${t} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},P1=class extends vy{constructor(t,o){super(t,o)}draw(){const t=this.block_.pathObject;t.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),t.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(t){if(!(0>=t.height)){if(Pe.isSpacer(t)){const g=t.precedesStatement;var o=t.followsStatement;if(g||o){const b=this.constants_.INSIDE_CORNERS;var c=b.rightHeight;c=t.height-(g?c:0),o=o?b.pathBottomRight:"",t=0<c?Nt("V",t.yPos+c):"",this.outlinePath_+=o+t+(g?b.pathTopRight:"");return}}this.outlinePath_+=Nt("V",t.yPos+t.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=yi(t.xPos,this.info_.startY),this.outlinePath_+=Nt("h",t.width)}drawFlatBottom_(){const t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Nt("V",t.baseline),this.outlinePath_+=Nt("h",-t.width)}drawInlineInput_(t){this.positionInlineInputConnection_(t);const o=t.input.name;t.connectedBlock||this.info_.isInsertionMarker||(t=Ji(t.xPos+t.connectionWidth,t.centerline-t.height/2)+this.getInlineInputPath(t),this.block_.pathObject.setOutlinePath(o,t))}getInlineInputPath(t){const o=t.width-2*t.connectionWidth,c=t.height;return Nt("h",o)+t.shape.pathRightDown(c)+Nt("h",-o)+t.shape.pathUp(c)+"z"}drawStatementInput_(t){var o=t.getLastInput();const c=o.xPos+o.notchOffset+o.shape.width,g=this.constants_.INSIDE_CORNERS,b=o.shape.pathRight+Nt("h",-(o.notchOffset-g.width))+g.pathTop,M=t.height-2*g.height;o=g.pathBottom+Nt("h",o.notchOffset-g.width)+(o.connectedBottomNextConnection?"":o.shape.pathLeft),this.outlinePath_+=Nt("H",c)+b+Nt("v",M)+o+Nt("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}drawConnectionHighlightPath(t){const o=t.connectionModel;if(o.type===Bt.NEXT_STATEMENT||o.type===Bt.PREVIOUS_STATEMENT||o.type===Bt.OUTPUT_VALUE&&!t.isDynamicShape)super.drawConnectionHighlightPath(t);else{t=o.type===Bt.INPUT_VALUE?Ji(t.connectionWidth,-t.height/2)+this.getInlineInputPath(t):Ji(t.width,-t.height/2)+t.shape.pathDown(t.height);var c=o.getSourceBlock(),g,b;(b=(g=c.pathObject).addConnectionHighlight)==null||b.call(g,o,t,o.getOffsetInBlock(),c.RTL)}}},bf=class extends $i{constructor(t,o,c,g,b,M,te){if(super($i.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",c=Number(Ei(c)),o=Number(Ei(o)),isNaN(c)||isNaN(o))throw Error("Height and width values of an image field must cast to numbers.");if(0>=c||0>=o)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Kn(o,c+bf.Y_PADDING),this.imageHeight=c,typeof b=="function"&&(this.clickHandler=b),t!==$i.SKIP_SETUP&&(te?this.configure_(te):(this.flipRtl=!!M,this.altText=Ei(g)||""),this.setValue(Ei(t)))}configure_(t){super.configure_(t),t.flipRtl&&(this.flipRtl=t.flipRtl),t.alt&&(this.altText=Ei(t.alt))}initView(){this.imageElement=ve(Xe.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Wo,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(t){return typeof t!="string"?null:t}doValueUpdate_(t){this.value_=t,this.imageElement&&this.imageElement.setAttributeNS(Wo,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(t){t!==this.altText&&(this.altText=t||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(t){this.clickHandler=t}getText_(){return this.altText}static fromJson(t){if(!t.src||!t.width||!t.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(t.src,t.width,t.height,void 0,void 0,void 0,t)}};bf.Y_PADDING=1,Bo("field_image",bf),bf.prototype.DEFAULT_VALUE="";var Ry=class extends $i{constructor(t,o,c){super($i.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",t!==$i.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.spellcheck!==void 0&&(this.spellcheck_=t.spellcheck)}initView(){if(!this.getSourceBlock())throw new ur;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new ur;let o;return this.fullBlockClickTarget_=!((o=this.getConstants())==null||!o.FULL_BLOCK_FIELDS)&&t.isSimpleReporter()}doValueInvalid_(t,o=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,t=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&x()&&this.value_!==t&&o&&$(new(k(n.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,t,this.value_)))}doValueUpdate_(t){this.isTextValid_=this.isDirty_=!0,this.value_=t}applyColour(){const t=this.getSourceBlock();if(!t)throw new ur;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",t.style.colourTertiary)):(this.borderRect_.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let t;return(t=this.getConstants())!=null&&t.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var t=this.htmlInput_;this.isTextValid_?(oe(t,"blocklyInvalidInput"),vi(t,Wr.INVALID,!1)):(Me(t,"blocklyInvalidInput"),vi(t,Wr.INVALID,!0))}if(t=this.getSourceBlock(),!t)throw new ur;this.getConstants().FULL_BLOCK_FIELDS&&t.applyColour()}setSpellcheck(t){t!==this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(t,o=!1){this.workspace_=this.sourceBlock_.workspace,!o&&this.workspace_.options.modalInputs&&(vI||Q$||Q_)?this.showPromptEditor_():this.showInlineEditor_(o)}showPromptEditor_(){pt(n.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),t=>{t!==null&&this.setValue(this.getValueFromEditorText_(t)),this.onFinishEditing_(this.value_)})}showInlineEditor_(t){const o=this.getSourceBlock();if(!o)throw new ur;zu(this,o.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var t=this.getSourceBlock();if(!t)throw new ur;n.setGroup$$module$build$src$core$events$utils(!0);const o=mi();var c=this.getClickTarget_();if(!c)throw Error("A click target has not been set.");Me(c,"editing"),c=document.createElement("input"),c.className="blocklyHtmlInput",c.setAttribute("spellcheck",this.spellcheck_);const g=this.workspace_.getScale();var b=this.getConstants().FIELD_TEXT_FONTSIZE*g+"pt";return o.style.fontSize=b,c.style.fontSize=b,b=Ry.BORDERRADIUS*g+"px",this.isFullBlockField()&&(b=this.getScaledBBox(),b=(b.bottom-b.top)/2+"px",t=t.getParent()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,c.style.border=1*g+"px solid "+t,o.style.borderRadius=b,o.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(o.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*g+"px")),c.style.borderRadius=b,o.appendChild(c),c.value=c.defaultValue=this.getEditorText_(this.value_),c.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(c),c}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&x()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&($(new(k(n.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),n.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var t=mi().style;if(t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,t=this.getClickTarget_(),!t)throw Error("A click target has not been set.");oe(t,"editing")}onFinishEditing_(t){}bindInputEvents_(t){this.onKeyDownWrapper_=Ye(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=Ye(t,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(Q(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(Q(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(t){t.key==="Enter"?(go(this),No()):t.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),go(this),No()):t.key==="Tab"&&(go(this),No(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())}onHtmlInputChange_(t){t=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&x()&&this.value_!==t&&$(new(k(Kc))(this.sourceBlock_,this.name||null,t,this.value_))}setEditorValue_(t,o=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t,o)}resizeEditor_(){var t=this.getSourceBlock();if(!t)throw new ur;const o=mi(),c=this.getScaledBBox();o.style.width=c.right-c.left+"px",o.style.height=c.bottom-c.top+"px",t=new At(t.RTL?c.right-o.offsetWidth:c.left,c.top),o.style.left=t.x+"px",o.style.top=t.y+"px"}repositionForWindowResize(){const t=this.getSourceBlock();return t instanceof Ia?(oh(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0):!1}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(t){return`${t}`}getValueFromEditorText_(t){return t}};Ry.BORDERRADIUS=4;var xy=class extends Ry{constructor(t,o,c){super(t,o,c)}doClassValidation_(t){return t===void 0?null:`${t}`}static fromJson(t){return new this(Ei(t.text),void 0,t)}};Bo("field_input",xy),xy.prototype.DEFAULT_VALUE="";var D1=class extends Ub{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){return!!t.outputConnection}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},wy=class extends _T{constructor(t,o){if(super(t,o),this.connectedBottomNextConnection=!1,this.connectedBlock){for(t=this.connectedBlock;o=t.getNextBlock();)t=o;t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},B1=class extends hc{constructor(t){super(t),this.width=this.height=0,this.type|=Pe.getType("RIGHT_CONNECTION")}},F1=class extends Wb{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){const o=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||o}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},U1=class extends ET{constructor(t,o){super(t,o),this.isInline=!0,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.topRow=new F1(this.constants_),this.bottomRow=new D1(this.constants_),this.isMultiRow=!o.getInputsInline()||o.isCollapsed(),this.hasStatementInput=0<o.statementInputCount,this.rightSide=this.outputConnection?new B1(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(t,o){return o?o instanceof lu||t instanceof Ko||o instanceof Ko?!0:t instanceof n.ValueInput$$module$build$src$core$inputs$value_input||t instanceof dc||t instanceof lu?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(t)}getInRowSpacing_(t,o){return t&&o||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&o&&Pe.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&Pe.isLeftRoundedCorner(t)&&o&&(Pe.isPreviousConnection(o)||Pe.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:t&&Pe.isLeftSquareCorner(t)&&o&&Pe.isHat(o)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(t,o){if(Pe.isTopRow(t)&&Pe.isBottomRow(o))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const c=Pe.isInputRow(t)&&t.hasStatement,g=Pe.isInputRow(o)&&o.hasStatement;return g||c?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),g&&c?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):Pe.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Pe.isBottomRow(o)?this.outputConnection?!o.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(t,o){const c=this.width-this.startX;return Pe.isInputRow(t)&&t.hasStatement||Pe.isInputRow(o)&&o.hasStatement?Math.max(c,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):c}getElemCenterline_(t,o){if(t.hasStatement&&!Pe.isSpacer(o)&&!Pe.isStatementInput(o))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Pe.isInlineInput(o)&&o instanceof Ch){const c=o.connectedBlock;if(c&&c.outputConnection&&c.nextConnection)return t.yPos+c.height/2}return super.getElemCenterline_(t,o)}addInput_(t,o){if((t instanceof dc||t instanceof lu)&&o.hasDummyInput&&o.align===n.Align$$module$build$src$core$inputs$align.LEFT&&t.align===n.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(o,t);else if(t instanceof Ko){o.elements.push(new wy(this.constants_,t)),o.hasStatement=!0,o.align===null&&(o.align=t.align);return}super.addInput_(t,o)}addAlignmentPadding_(t,o){if(this.rightAlignedDummyInputs.get(t)){let c;for(let g=0;g<t.elements.length;g++){const b=t.elements[g];if(Pe.isSpacer(b)&&(c=b),Pe.isField(b)&&b instanceof Cm&&b.parentInput===this.rightAlignedDummyInputs.get(t))break}if(c){c.width+=o,t.width+=o;return}}super.addAlignmentPadding_(t,o)}adjustXPosition_(){const t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let o=t;for(let b=2;b<this.rows.length-1;b+=2){var c=this.rows[b-1];const M=this.rows[b];var g=this.rows[b+1];if(c=b===2?!!this.topRow.hasPreviousConnection:!!c.followsStatement,g=b+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!g.precedesStatement,Pe.isInputRow(M)&&M.hasStatement){M.measure();let te,$e;o=M.width-(($e=(te=M.getLastInput())==null?void 0:te.width)!=null?$e:0)+t}else if(c&&(b===2||g)&&Pe.isInputRow(M)&&!M.hasStatement){g=M.xPos,c=null;for(let te=0;te<M.elements.length;te++){const $e=M.elements[te];Pe.isSpacer($e)&&(c=$e),c&&(Pe.isField($e)||Pe.isInput($e))&&g<o&&!(Pe.isField($e)&&$e instanceof Cm&&($e.field instanceof Ef||$e.field instanceof bf))&&(c.width+=o-g),g+=$e.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var t=this.outputConnection.shape;if("isDynamic"in t&&t.isDynamic){for(var o=0,c=0;c<this.rows.length;c++){const g=this.rows[c];g.yPos=o,o+=g.height}this.height=o,c=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,o=t.height(c),c=t.width(c),this.outputConnection.height=o,this.outputConnection.width=c,this.outputConnection.startX=c,this.outputConnection.connectionOffsetY=t.connectionOffsetY(o),this.outputConnection.connectionOffsetX=t.connectionOffsetX(c),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=c,this.rightSide.height=o,this.rightSide.width=t,this.rightSide.centerline=o/2,this.rightSide.xPos=this.width+t),this.startX=c,this.width+=c+t,this.widthWithChildren+=c+t}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t=0,o=0;o<this.rows.length;o++){var c=this.rows[o];if(!Pe.isInputRow(c))continue;t=c.elements[c.elements.length-2];let g=this.getNegativeSpacing_(c.elements[1]),b=this.getNegativeSpacing_(t);t=g+b;const M=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-t<M&&(t=this.width-M,g=t/2,b=t/2),c.elements.unshift(new Yo(this.constants_,-g)),c.elements.push(new Yo(this.constants_,-b))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,o=0;o<this.rows.length;o++)c=this.rows[o],Pe.isTopOrBottomRow(c)&&(c.elements[1].width-=t),c.width-=t,c.widthWithConnectedBlocks-=t}}getNegativeSpacing_(t){if(!t||!this.outputConnection)return 0;const o=this.outputConnection.width;var c=this.outputConnection.shape.type;const g=this.constants_;if(1<this.inputRows.length)switch(c){case g.SHAPES.ROUND:return c=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=this.height/2>c?c:this.height/2,o-c*(1-Math.sin(Math.acos((c-this.constants_.SMALL_PADDING)/c)));default:return 0}if(Pe.isInlineInput(t)&&t instanceof Ch){const b=t.connectedBlock;return t=b?b.pathObject.outputShapeType:t.shape.type,t==null||b&&b.outputConnection&&(b.statementInputCount||b.nextConnection)||c===g.SHAPES.HEXAGONAL&&c!==t?0:o-this.constants_.SHAPE_IN_SHAPE_PADDING[c][t]}return Pe.isField(t)&&t instanceof Cm?c===g.SHAPES.ROUND&&t.field instanceof xy?o-2.75*g.GRID_UNIT:o-this.constants_.SHAPE_IN_SHAPE_PADDING[c][0]:Pe.isIcon(t)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let g=2;g<this.rows.length-1;g+=2){const b=this.rows[g-1],M=this.rows[g],te=this.rows[g+1];var t=g===2,o=g+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!te.precedesStatement;if(t?this.topRow.hasPreviousConnection:b.followsStatement){var c=M.elements[1];if(c=M.elements.length===3&&c instanceof Cm&&(c.field instanceof Ef||c.field instanceof bf),!t&&c)b.height-=this.constants_.SMALL_PADDING,te.height-=this.constants_.SMALL_PADDING,M.height-=this.constants_.MEDIUM_PADDING;else if(!t&&!o)b.height+=this.constants_.SMALL_PADDING;else if(o){for(t=!1,o=0;o<M.elements.length;o++)if(c=M.elements[o],c instanceof Ch&&Pe.isInlineInput(c)&&c.connectedBlock&&!c.connectedBlock.isShadow()&&40<=c.connectedBlock.getHeightWidth().height){t=!0;break}t&&(b.height-=this.constants_.SMALL_PADDING,te.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},G1=class extends Yb{constructor(t,o,c){super(t,o,c),this.markerCircle=null}showWithInputOutput(t){const o=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle(t.x,t.y),this.setParent_(o),this.showCurrent_()}showWithOutput_(t){this.showWithInputOutput(t)}showWithInput_(t){this.showWithInputOutput(t)}showWithBlock_(t){t=t.getLocation();const o=t.getHeightWidth();this.positionRect_(0,0,o.width,o.height),this.setParent_(t),this.showCurrent_()}positionCircle(t,o){let c;(c=this.markerCircle)==null||c.setAttribute("cx",`${t}`);let g;(g=this.markerCircle)==null||g.setAttribute("cy",`${o}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=ve(Xe.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();ve(Xe.ANIMATE,t,this.markerCircle)}return this.markerSvg_}applyColour_(t){super.applyColour_(t);let o;(o=this.markerCircle)==null||o.setAttribute("fill",this.colour_);let c;if((c=this.markerCircle)==null||c.setAttribute("stroke",this.colour_),this.isCursor()){t=this.colour_+";transparent;transparent;";let g;(g=this.markerCircle)==null||g.firstElementChild.setAttribute("values",t)}}},H1=class extends Ey{constructor(t,o,c){super(t,o,c),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=c}setPath(t){super.setPath(t),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",t)}applyColour(t){super.applyColour(t);const o=t.getParent();t.isShadow()&&o&&this.svgPath.setAttribute("stroke",o.style.colourTertiary);for(const c of this.outlines.values())c.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const t of this.outlines.values())t.setAttribute("transform","scale(-1 1)")}updateSelected(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(t,o){t=t.getParentInput().name,(t=this.getOutlinePath(t))&&(o?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const t of this.outlines.keys())this.remainingOutlines.add(t)}endDrawing(){if(this.remainingOutlines.size)for(const t of this.remainingOutlines)this.removeOutlinePath(t);this.remainingOutlines.clear()}setOutlinePath(t,o){t=this.getOutlinePath(t),t.setAttribute("d",o),t.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(t){return this.outlines.has(t)||this.outlines.set(t,ve(Xe.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(t),this.outlines.get(t)}removeOutlinePath(t){let o,c;(o=this.outlines.get(t))==null||(c=o.parentNode)==null||c.removeChild(this.outlines.get(t)),this.outlines.delete(t)}},dA=class extends yy{constructor(t){super(t)}makeConstants_(){return new k1}makeRenderInfo_(t){return new U1(this,t)}makeDrawer_(t,o){return new P1(t,o)}makeMarkerDrawer(t,o){return new G1(t,this.getConstants(),o)}makePathObject(t,o){return new H1(t,o,this.getConstants())}getConstants(){return this.constants_}getConnectionPreviewMethod(t,o,c){return sl("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),o.type===Bt.OUTPUT_VALUE?t.isConnected()?wa.PREVIEW_TYPE.REPLACEMENT_FADE:wa.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(t,o,c)}};rh("zelos",dA);var V1=class{constructor(t){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=t.workspace}previewReplacement(t,o,c){n.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=c,c.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(o)&&(o.highlight(),this.staticConn=o)}finally{n.enable$$module$build$src$core$events$utils()}}previewConnection(t,o){if(t!==this.draggedConn||o!==this.staticConn){n.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(t,o)&&(this.markerConn=this.previewMarker(t,o)),this.workspace.getRenderer().shouldHighlightConnection(o)&&o.highlight(),this.draggedConn=t,this.staticConn=o}finally{n.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(t,o){return o.type===Bt.PREVIOUS_STATEMENT||o.type===Bt.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof dA)}previewMarker(t,o){const c=t.getSourceBlock(),g=this.createInsertionMarker(c),b=this.getMatchingConnection(c,g,t);if(!b)return null;g.queueRender(),An(),b.connect(o);const M={x:o.x-b.x,y:o.y-b.y},te=b.getOffsetInBlock().clone();return Kt().then(()=>{if(!g.isDeadOrDying()){n.disable$$module$build$src$core$events$utils();try{g==null||g.positionNearConnection(b,M,te),g==null||g.getSvgRoot().setAttribute("visibility","visible")}finally{n.enable$$module$build$src$core$events$utils()}}}),b}createInsertionMarker(t){const o=zi(t,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!o)throw Error(`Failed to serialize source block. ${t.toDevString()}`);t=Ii(o,this.workspace);for(const c of t.getDescendants(!1))c.setInsertionMarker(!0);return t.initSvg(),t.getSvgRoot().setAttribute("visibility","hidden"),t}getMatchingConnection(t,o,c){if(t=t.getConnections_(!0),o=o.getConnections_(!0),t.length!==o.length)return null;for(let g=0;g<t.length;g++)if(t[g]===c)return o[g];return null}hidePreview(){n.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{n.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(t){const o=t.getSourceBlock(),c=o.outputConnection;let g;if((g=o.previousConnection)!=null&&g.targetConnection||c!=null&&c.targetConnection)o.unplug(!0);else{let b;(b=t.targetBlock())==null||b.unplug(!1)}o.dispose()}dispose(){this.hidePreview()}};r(yt.CONNECTION_PREVIEWER,_o,V1);var wh={};wh.Align=n.Align$$module$build$src$core$inputs$align,wh.DummyInput=dc,wh.EndRowInput=lu,wh.Input=Rm,wh.StatementInput=Ko,wh.ValueInput=n.ValueInput$$module$build$src$core$inputs$value_input,wh.inputTypes=n.inputTypes$$module$build$src$core$inputs$input_types;var z1=!1,W1;n.CodeGenerator$$module$build$src$core$generator=class{constructor(t){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=ne());var o=[];this.init(t),t=t.getTopBlocks(!0);for(let c=0,g;g=t[c];c++){let b=this.blockToCode(g);Array.isArray(b)&&(b=b[0]),b&&(g.outputConnection&&(b=this.scrubNakedValue(b),this.STATEMENT_PREFIX&&!g.suppressPrefixSuffix&&(b=this.injectId(this.STATEMENT_PREFIX,g)+b),this.STATEMENT_SUFFIX&&!g.suppressPrefixSuffix&&(b+=this.injectId(this.STATEMENT_SUFFIX,g))),o.push(b))}return o=o.join(`
`),o=this.finish(o),o=o.replace(/^\s+\n/,""),o=o.replace(/\n\s+$/,`
`),o=o.replace(/[ \t]+\n/g,`
`)}prefixLines(t,o){return o+t.replace(/(?!\n$)\n/g,`
`+o)}allNestedComments(t){const o=[];t=t.getDescendants(!0);for(let c=0;c<t.length;c++){const g=t[c].getCommentText();g&&o.push(g)}return o.length&&o.push(""),o.join(`
`)}blockToCode(t,o){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return o?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return o?"":this.blockToCode(t.getChildren(!1)[0]);var c=this.forBlock[t.type];if(typeof c!="function")throw Error(`${this.name_} generator does not know how to generate code for block type "${t.type}".`);if(c=c.call(t,t,this),Array.isArray(c)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,c[0],o),c[1]]}if(typeof c=="string")return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,t)+c),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,c,o);if(c===null)return"";throw SyntaxError("Invalid code generated: "+c)}valueToCode(t,o,c){if(isNaN(c))throw TypeError("Expecting valid order from block: "+t.type);var g=t.getInputTargetBlock(o);if(!g&&!t.getInput(o))throw ReferenceError(`Input "${o}" doesn't exist on "${t.type}"`);if(!g||(o=this.blockToCode(g),o===""))return"";if(!Array.isArray(o))throw TypeError(`Expecting tuple from value block: ${g.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(t=o[0],o=o[1],isNaN(o))throw TypeError("Expecting valid order from value block: "+g.type);if(!t)return"";g=!1;var b=Math.floor(c);const M=Math.floor(o);if(b<=M&&(b!==M||b!==0&&b!==99)){for(g=!0,b=0;b<this.ORDER_OVERRIDES.length;b++)if(this.ORDER_OVERRIDES[b][0]===c&&this.ORDER_OVERRIDES[b][1]===o){g=!1;break}}return g&&(t="("+t+")"),t}statementToCode(t,o){const c=t.getInputTargetBlock(o);if(!c&&!t.getInput(o))throw ReferenceError(`Input "${o}" doesn't exist on "${t.type}"`);if(t=this.blockToCode(c),typeof t!="string")throw TypeError("Expecting code from statement block: "+(c&&c.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(t,o){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,o),this.INDENT)+t),this.STATEMENT_SUFFIX&&!o.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,o),this.INDENT)+t),this.STATEMENT_PREFIX&&!o.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,o),this.INDENT)),t}injectId(t,o){return o=o.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+o+"'")}addReservedWords(t){this.RESERVED_WORDS_+=t+","}provideFunction_(t,o){if(!this.definitions_[t]){const c=this.nameDB_.getDistinctName(t,n.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=c,Array.isArray(o)&&(o=o.join(`
`)),o=o.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,c);let g;for(;g!==o;)g=o,o=o.replace(/^(( {2})*) {2}/gm,"$1\0");o=o.replace(/\0/g,this.INDENT),this.definitions_[t]=o}return this.functionNames_[t]}getVariableName(t){return this.getName(t,n.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(t){return this.getName(t,n.NameType$$module$build$src$core$names.PROCEDURE)}getName(t,o){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(t,o)}init(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(t,o,c){return o}finish(t){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),t}scrubNakedValue(t){return t}},W1={},W1.CodeGenerator=n.CodeGenerator$$module$build$src$core$generator;var X1=class extends hA{constructor(t,o){super(t),this.flyout_=o}getBoundingBox_(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch{t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(t){const o=this.getBoundingBox_();return t=t?1:this.workspace_.scale,{height:o.height*t,width:o.width*t,top:o.y*t,left:o.x*t}}getScrollMetrics(t,o,c){return o=c||this.getContentMetrics(),c=this.flyout_.MARGIN*this.workspace_.scale,t=t?this.workspace_.scale:1,{height:(o.height+2*c)/t,width:(o.width+o.left+c)/t,top:0,left:0}}},Om;(function(t){t.BLOCK="block",t.BUTTON="button"})(Om||(Om={}));var xG="WORKSPACE_AT_BLOCK_CAPACITY",My=class extends $y{constructor(t){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.contents=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ma(t),this.workspace_.setMetricsManager(new X1(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=v(),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(t){return this.svgGroup_=ve(t,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=ve(Xe.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new uA(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(Ye(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(Ye(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[zr.Capability.AUTOHIDEABLE,zr.Capability.DELETE_AREA,zr.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const t of this.boundEvents)Q(t);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&W(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(t){this.autoClose=t,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(t){!t&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.isVisible_}setVisible(t){const o=t!==this.isVisible();this.isVisible_=t,o&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(t){const o=t!==this.containerVisible;this.containerVisible=t,o&&this.updateDisplay()}getContents(){return this.contents}setContents(t){this.contents=t}updateDisplay(){let t;t=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none");let o;(o=this.workspace_.scrollbar)==null||o.setContainerVisible(t)}positionAt_(t,o,c,g){let b;(b=this.svgGroup_)==null||b.setAttribute("width",`${t}`);let M;(M=this.svgGroup_)==null||M.setAttribute("height",`${o}`),this.workspace_.setCachedParentSvgSize(t,o),this.svgGroup_&&je(this.svgGroup_,"translate("+c+"px,"+g+"px)"),(t=this.workspace_.scrollbar)&&(t.setOrigin(c,g),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const t of this.listeners)Q(t);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof t=="string"&&(t=this.getDynamicCategoryContents(t)),this.setVisible(!0),t=Ci(t),t=this.createFlyoutInfo(t),An(this.workspace_),this.setContents(t.contents),this.layout_(t.contents,t.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(t){const o=[],c=[];this.permanentlyDisabled.length=0;const g=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const b of t){if("custom"in b){t=this.getDynamicCategoryContents(b.custom),t=Ci(t);const{contents:M,gaps:te}=this.createFlyoutInfo(t);o.push(...M),c.push(...te)}switch(b.kind.toUpperCase()){case"BLOCK":t=b;const M=this.createFlyoutBlock(t);o.push({type:Om.BLOCK,block:M}),this.addBlockGap(t,c,g);break;case"SEP":this.addSeparatorGap(b,c,g);break;case"LABEL":t=this.createButton(b,!0),o.push({type:Om.BUTTON,button:t}),c.push(g);break;case"BUTTON":t=this.createButton(b,!1),o.push({type:Om.BUTTON,button:t}),c.push(g)}}return{contents:o,gaps:c}}getDynamicCategoryContents(t){if(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t),typeof t!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return t(this.workspace_.targetWorkspace)}createButton(t,o){return new xa(this.workspace_,this.targetWorkspace,t,o)}createFlyoutBlock(t){let o;return t.blockxml?(t=typeof t.blockxml=="string"?n.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,(o=this.getRecycledBlock(t.getAttribute("type")))||(o=Ql(t,this.workspace_))):(o=this.getRecycledBlock(t.type),o||(t.enabled===void 0&&(t.enabled=t.disabled!=="true"&&t.disabled!==!0),t.disabledReasons===void 0&&t.enabled===!1&&(t.disabledReasons=[ba]),o=fo(t,this.workspace_))),o.isEnabled()||this.permanentlyDisabled.push(o),o}getRecycledBlock(t){let o=-1;for(let c=0;c<this.recycledBlocks.length;c++)if(this.recycledBlocks[c].type===t){o=c;break}return o===-1?void 0:this.recycledBlocks.splice(o,1)[0]}addBlockGap(t,o,c){let g;t.gap?g=parseInt(String(t.gap)):t.blockxml&&(t=typeof t.blockxml=="string"?n.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,g=parseInt(t.getAttribute("gap"))),o.push(!g||isNaN(g)?c:g)}addSeparatorGap(t,o,c){t=parseInt(String(t.gap)),!isNaN(t)&&0<o.length?o[o.length-1]=t:o.push(c)}clearOldBlocks(){var t=this.workspace_.getTopBlocks(!1);for(let c=0,g;g=t[c];c++)this.blockIsRecyclable_(g)?this.recycleBlock(g):g.dispose(!1,!1);for(t=0;t<this.mats.length;t++){const c=this.mats[t];c&&(ns(c),W(c))}this.mats.length=0;for(let c=0,g;g=this.buttons_[c];c++)g.dispose();this.buttons_.length=0;let o;(o=this.workspace_.getPotentialVariableMap())==null||o.clear()}emptyRecycledBlocks(){for(let t=0;t<this.recycledBlocks.length;t++)this.recycledBlocks[t].dispose();this.recycledBlocks=[]}blockIsRecyclable_(t){return!1}recycleBlock(t){const o=t.getRelativeToSurfaceXY();t.moveBy(-o.x,-o.y),this.recycledBlocks.push(t)}addBlockListeners_(t,o,c){this.listeners.push(Ye(t,"pointerdown",null,this.blockMouseDown(o))),this.listeners.push(Ye(c,"pointerdown",null,this.blockMouseDown(o))),this.listeners.push(we(t,"pointerenter",o,()=>{this.targetWorkspace.isDragging()||o.addSelect()})),this.listeners.push(we(t,"pointerleave",o,()=>{this.targetWorkspace.isDragging()||o.removeSelect()})),this.listeners.push(we(c,"pointerenter",o,()=>{this.targetWorkspace.isDragging()||o.addSelect()})),this.listeners.push(we(c,"pointerleave",o,()=>{this.targetWorkspace.isDragging()||o.removeSelect()}))}blockMouseDown(t){return o=>{const c=this.targetWorkspace.getGesture(o);c&&(c.setStartBlock(t),c.handleFlyoutStart(o,this))}}onMouseDown(t){const o=this.targetWorkspace.getGesture(t);o&&o.handleFlyoutStart(t,this)}isBlockCreatable(t){return t.isEnabled()}createBlock(t){let o=null;n.disable$$module$build$src$core$events$utils();var c=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{o=this.placeNewBlock(t)}finally{n.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),t=zn(this.targetWorkspace,c),x()){for(n.setGroup$$module$build$src$core$events$utils(!0),c=0;c<t.length;c++){const g=t[c];$(new(k(ya))(g))}$(new(k(n.CREATE$$module$build$src$core$events$utils))(o))}return this.autoClose?this.hide():this.filterForCapacity(),o}initFlyoutButton_(t,o,c){const g=t.createDom();t.moveTo(o,c),t.show(),this.listeners.push(Ye(g,"pointerdown",this,this.onMouseDown)),this.buttons_.push(t)}createRect_(t,o,c,g,b){return o=ve(Xe.RECT,{"fill-opacity":0,x:o,y:c,height:g.height,width:g.width}),o.tooltip=t,Ar(o),this.workspace_.getCanvas().insertBefore(o,t.getSvgRoot()),this.rectMap_.set(t,o),this.mats[b]=o}moveRectToBlock_(t,o){const c=o.getHeightWidth();t.setAttribute("width",String(c.width)),t.setAttribute("height",String(c.height)),o=o.getRelativeToSurfaceXY(),t.setAttribute("y",String(o.y)),t.setAttribute("x",String(this.RTL?o.x-c.width:o.x))}filterForCapacity(){const t=this.workspace_.getTopBlocks(!1);for(let o=0,c;c=t[o];o++)if(!this.permanentlyDisabled.includes(c)){const g=this.targetWorkspace.isCapacityAvailable(K(c));for(;c;)c.setDisabledReason(!g,xG),c=c.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(t){var o=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered");const c=this.serializeBlock(t);return o.setResizesEnabled(!1),o=Ii(c,o),this.positionNewBlock(t,o),o}serializeBlock(t){return zi(t)}positionNewBlock(t,o){const c=this.targetWorkspace;var g=c.getOriginOffsetInPixels(),b=this.workspace_.getOriginOffsetInPixels();t=t.getRelativeToSurfaceXY(),t.scale(this.workspace_.scale),b=At.sum(b,t),g=At.difference(b,g),g.scale(1/c.scale),o.moveTo(new At(g.x,g.y))}};My.FlyoutItemType=Om;var fA=class extends My{constructor(t){super(t)}setMetrics_(t){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),c=o.getScrollMetrics(),g=o.getViewMetrics();o=o.getAbsoluteMetrics(),typeof t.y=="number"&&(this.workspace_.scrollY=-(c.top+(c.height-g.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const o=t.getAbsoluteMetrics(),c=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Cn.LEFT?t.width:c.width-this.width_:this.toolboxPosition_===Cn.LEFT?0:c.width:this.toolboxPosition_===Cn.LEFT?0:c.width+o.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var o=this.getY();this.positionAt_(this.width_,this.height_,t,o)}}setBackgroundPath(t,o){const c=this.toolboxPosition_===Cn.RIGHT;var g=t+this.CORNER_RADIUS;g=["M "+(c?g:0)+",0"],g.push("h",c?-t:t),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("v",Math.max(0,o)),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("h",c?t:-t),g.push("z"),this.svgBackground_.setAttribute("d",g.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setY(0)}wheel_(t){var o=Fe(t);if(o.y){const c=this.workspace_.getMetricsManager(),g=c.getScrollMetrics();o=c.getViewMetrics().top-g.top+o.y;let b;(b=this.workspace_.scrollbar)==null||b.setY(o),wi(this.workspace_),No()}t.preventDefault(),t.stopPropagation()}layout_(t,o){this.workspace_.scale=this.targetWorkspace.scale;var c=this.MARGIN;const g=this.RTL?c:c+this.tabWidth_;for(let $e=0,it;it=t[$e];$e++)if(it.type==="block"){var b=it.block;if(!b)continue;var M=b.getDescendants(!1);for(let Ni=0,Mi;Mi=M[Ni];Ni++)Mi.isInFlyout=!0;M=b.getSvgRoot();const Dt=b.getHeightWidth();var te=b.outputConnection?g-this.tabWidth_:g;b.moveBy(te,c),te=this.createRect_(b,this.RTL?te-Dt.width:te,c,Dt,$e),this.addBlockListeners_(M,b,te),c+=Dt.height+o[$e]}else it.type==="button"&&(b=it.button,this.initFlyoutButton_(b,g,c),c+=b.height+o[$e])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const o=this.dragAngleRange_;return t<o&&t>-o||t<-180+o||t>180-o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),o=t.left;return this.toolboxPosition_===Cn.LEFT?new Si(-1e9,1e9,-1e9,o+t.width):new Si(-1e9,1e9,o,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;var o=this.workspace_.getTopBlocks(!1);for(let g=0,b;b=o[g];g++){var c=b.getHeightWidth().width;b.outputConnection&&(c-=this.tabWidth_),t=Math.max(t,c)}for(let g=0,b;b=this.buttons_[g];g++)t=Math.max(t,b.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,t+=cr.scrollbarThickness,this.width_!==t){for(let g=0,b;b=o[g];g++){if(this.RTL){c=b.getRelativeToSurfaceXY().x;let M=t/this.workspace_.scale-this.MARGIN;b.outputConnection||(M-=this.tabWidth_),b.moveBy(M-c,0)}this.rectMap_.has(b)&&this.moveRectToBlock_(this.rectMap_.get(b),b)}if(this.RTL)for(let g=0,b;b=this.buttons_[g];g++)o=b.getPosition().y,b.moveTo(t/this.workspace_.scale-b.width-this.MARGIN-this.tabWidth_,o);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Cn.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};fA.registryName="verticalFlyout",r(yt.FLYOUTS_VERTICAL_TOOLBOX,_o,fA);var j1=class extends My{constructor(t){super(t),this.horizontalLayout=!0}setMetrics_(t){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),c=o.getScrollMetrics(),g=o.getViewMetrics();o=o.getAbsoluteMetrics(),typeof t.x=="number"&&(this.workspace_.scrollX=-(c.left+(c.width-g.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const o=t.getAbsoluteMetrics(),c=t.getViewMetrics();t=t.getToolboxMetrics();const g=this.toolboxPosition_===Cn.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?g?t.height:c.height-this.height_:g?0:c.height:g?0:c.height+o.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var o=this.getY();this.positionAt_(this.width_,this.height_,t,o)}}setBackgroundPath(t,o){const c=this.toolboxPosition_===Cn.TOP,g=["M 0,"+(c?0:this.CORNER_RADIUS)];c?(g.push("h",t+2*this.CORNER_RADIUS),g.push("v",o),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("h",-t),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),g.push("h",t),g.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),g.push("v",o),g.push("h",-t-2*this.CORNER_RADIUS)),g.push("z"),this.svgBackground_.setAttribute("d",g.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setX(this.RTL?1/0:0)}wheel_(t){var o=Fe(t);if(o=o.x||o.y){const c=this.workspace_.getMetricsManager(),g=c.getScrollMetrics();o=c.getViewMetrics().left-g.left+o;let b;(b=this.workspace_.scrollbar)==null||b.setX(o),wi(this.workspace_),No()}t.preventDefault(),t.stopPropagation()}layout_(t,o){this.workspace_.scale=this.targetWorkspace.scale;const c=this.MARGIN;let g=c+this.tabWidth_;this.RTL&&(t=t.reverse());for(let $e=0,it;it=t[$e];$e++)if(it.type==="block"){var b=it.block;if(b==null)continue;var M=b.getDescendants(!1);for(let Ni=0,Mi;Mi=M[Ni];Ni++)Mi.isInFlyout=!0;M=b.getSvgRoot();const Dt=b.getHeightWidth();var te=b.outputConnection?this.tabWidth_:0;te=this.RTL?g+Dt.width:g-te,b.moveBy(te,c),te=this.createRect_(b,te,c,Dt,$e),g+=Dt.width+o[$e],this.addBlockListeners_(M,b,te)}else it.type==="button"&&(b=it.button,this.initFlyoutButton_(b,g,c),g+=b.width+o[$e])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const o=this.dragAngleRange_;return t<90+o&&t>90-o||t>-90-o&&t<-90+o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),o=t.top;return this.toolboxPosition_===Cn.TOP?new Si(-1e9,o+t.height,-1e9,1e9):new Si(o,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;const o=this.workspace_.getTopBlocks(!1);for(let g=0,b;b=o[g];g++)t=Math.max(t,b.getHeightWidth().height);const c=this.buttons_;for(let g=0,b;b=c[g];g++)t=Math.max(t,b.height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=cr.scrollbarThickness,this.height_!==t){for(let g=0,b;b=o[g];g++)this.rectMap_.has(b)&&this.moveRectToBlock_(this.rectMap_.get(b),b);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Cn.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};r(yt.FLYOUTS_HORIZONTAL_TOOLBOX,_o,j1);var bT=class extends uc{constructor(t,o,c,g,b){super($i.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=bT.dropdownCreate,this.defaultVariableName=typeof t=="string"?t:"",this.size_=new Kn(0,0),t!==$i.SKIP_SETUP&&(b?this.configure_(b):this.setTypes(c,g),o&&this.setValidator(o))}configure_(t){super.configure_(t),this.setTypes(t.variableTypes,t.defaultType)}initModel(){var t=this.getSourceBlock();if(!t)throw new ur;this.variable||(t=n.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(t.getId()))}shouldAddBorderRect_(){const t=this.getSourceBlock();if(!t)throw new ur;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||t.type!=="variables_get")}fromXml(t){var o=this.getSourceBlock();if(!o)throw new ur;const c=t.getAttribute("id"),g=t.textContent,b=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(o=n.getOrCreateVariablePackage$$module$build$src$core$variables(o.workspace,c,g,b),b!==null&&b!==o.type)throw Error("Serialized variable type with id '"+o.getId()+"' had type "+o.type+", and does not match variable field that references it: "+Do(t)+".");this.setValue(o.getId())}toXml(t){return this.initModel(),t.id=this.variable.getId(),t.textContent=this.variable.name,this.variable.type&&t.setAttribute("variabletype",this.variable.type),t}saveState(t){var o=this.saveLegacyState(bT);return o!==null||(this.initModel(),o={id:this.variable.getId()},t&&(o.name=this.variable.name,o.type=this.variable.type)),o}loadState(t){const o=this.getSourceBlock();if(!o)throw new ur;this.loadLegacyState(bT,t)||(t=n.getOrCreateVariablePackage$$module$build$src$core$variables(o.workspace,t.id||null,t.name,t.type||""),this.setValue(t.getId()))}setSourceBlock(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(t)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(t){if(t===null)return null;var o=this.getSourceBlock();if(!o)throw new ur;return o=n.getVariable$$module$build$src$core$variables(o.workspace,t),o?(o=o.type,this.typeIsAllowed(o)?t:(console.warn("Variable type doesn't match this field!  Type was "+o),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)}doValueUpdate_(t){const o=this.getSourceBlock();if(!o)throw new ur;this.variable=n.getVariable$$module$build$src$core$variables(o.workspace,t),super.doValueUpdate_(t)}typeIsAllowed(t){const o=this.getVariableTypes();if(!o)return!0;for(let c=0;c<o.length;c++)if(t===o[c])return!0;return!1}getVariableTypes(){var t=this.variableTypes;if(t===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(t=t||[""],t.length===0)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t}setTypes(t=null,o=""){if(Array.isArray(t)){let c=!1;for(let g=0;g<t.length;g++)t[g]===o&&(c=!0);if(!c)throw Error("Invalid default type '"+o+"' in the definition of a FieldVariable")}else if(t!==null)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=o,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(t,o){if(t=o.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t===Jb){n.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(t===Zb){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(t)}referencesVariables(){return!0}static fromJson(t){return new this(Ei(t.variable),void 0,void 0,void 0,t)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const t=this.getText();let o=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var c=this.getVariableTypes(),g=0;g<c.length;g++){const b=this.sourceBlock_.workspace.getVariablesOfType(c[g]);o=o.concat(b)}for(o.sort(sT.compareByName),c=[],g=0;g<o.length;g++)c[g]=[o[g].name,o[g].getId()];return c.push([n.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Jb]),n.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&c.push([n.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",t),Zb]),c}};Bo("field_variable",bT);var pA=class extends Ry{constructor(t,o,c,g,b,M){super($i.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,t!==$i.SKIP_SETUP&&(M?this.configure_(M):this.setConstraints(o,c,g),this.setValue(t),b&&this.setValidator(b))}configure_(t){super.configure_(t),this.setMinInternal(t.min),this.setMaxInternal(t.max),this.setPrecisionInternal(t.precision)}setConstraints(t,o,c){this.setMinInternal(t),this.setMaxInternal(o),this.setPrecisionInternal(c),this.setValue(this.getValue())}setMin(t){this.setMinInternal(t),this.setValue(this.getValue())}setMinInternal(t){t==null?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))}getMin(){return this.min_}setMax(t){this.setMaxInternal(t),this.setValue(this.getValue())}setMaxInternal(t){t==null?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))}getMax(){return this.max_}setPrecision(t){this.setPrecisionInternal(t),this.setValue(this.getValue())}setPrecisionInternal(t){this.precision_=Number(t)||0;let o=String(this.precision_);o.includes("e")&&(o=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const c=o.indexOf(".");this.decimalPlaces=c===-1?t?0:null:o.length-c-1}getPrecision(){return this.precision_}doClassValidation_(t){return t===null||(t=`${t}`.replace(/O/gi,"0"),t=t.replace(/,/g,""),t=t.replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),this.decimalPlaces!==null&&(t=Number(t.toFixed(this.decimalPlaces))),t)}widgetCreate_(){const t=super.widgetCreate_();return-1/0<this.min_&&(t.min=`${this.min_}`,vi(t,Wr.VALUEMIN,this.min_)),1/0>this.max_&&(t.max=`${this.max_}`,vi(t,Wr.VALUEMAX,this.max_)),t}static fromJson(t){return new this(t.value,void 0,void 0,void 0,void 0,t)}};Bo("field_number",pA),pA.prototype.DEFAULT_VALUE=0;var Y1=class extends Ef{constructor(t,o,c){super(String(t??""),o,c),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(t){return new this(Ei(t.text),void 0,t)}};Bo("field_label_serializable",Y1);var Af=class extends $i{constructor(t,o,c){super($i.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=Af.CHECK_CHAR,t!==$i.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.checkCharacter&&(this.checkChar=t.checkCharacter)}saveState(){const t=this.saveLegacyState(Af);return t!==null?t:this.getValueBoolean()}initView(){super.initView();const t=this.getTextElement();Me(t,"blocklyCheckbox"),t.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(t){this.checkChar=t||Af.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(t){return t===!0||t==="TRUE"?"TRUE":t===!1||t==="FALSE"?"FALSE":null}doValueUpdate_(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(t){return typeof t=="string"?t==="TRUE":!!t}static fromJson(t){return new this(t.checked,void 0,t)}};Af.CHECK_CHAR="",Bo("field_checkbox",Af),Af.prototype.DEFAULT_VALUE=!1;var K1=class{constructor(t,o){this.draggable=t,this.workspace=o,this.dragTarget=null,this.startLoc=t.getRelativeToSurfaceXY()}onDragStart(t){this.draggable.startDrag(t)}onDrag(t,o){this.moveDraggable(t,o),o=this.getRoot(this.draggable),qs(o)&&o.setDeleteStyle(this.wouldDeleteDraggable(t,o)),this.updateDragTarget(t)}updateDragTarget(t){t=this.workspace.getDragTarget(t);const o=this.getRoot(this.draggable);if(this.dragTarget!==t){let c;(c=this.dragTarget)==null||c.onDragExit(o),t==null||t.onDragEnter(o)}t==null||t.onDragOver(o),this.dragTarget=t}moveDraggable(t,o){o=this.pixelsToWorkspaceUnits(o),o=At.sum(this.startLoc,o),this.draggable.drag(o,t)}wouldDeleteDraggable(t,o){return(t=this.workspace.getDragTarget(t))&&this.workspace.getComponentManager().hasCapability(t.id,zr.Capability.DELETE_AREA)?t.wouldDelete(o):!1}onDragEnd(t){const o=n.getGroup$$module$build$src$core$events$utils();var c=this.workspace.getDragTarget(t);const g=this.getRoot(this.draggable);if(c){let b;(b=this.dragTarget)==null||b.onDrop(g)}this.shouldReturnToStart(t,g)&&this.draggable.revertDrag(),(c=qs(g)&&this.wouldDeleteDraggable(t,g))&&this.draggable instanceof Ia&&Pd(this.draggable.getRootBlock()),this.draggable.endDrag(t),c&&qs(g)&&(t=n.getGroup$$module$build$src$core$events$utils(),n.setGroup$$module$build$src$core$events$utils(o),g.dispose(),n.setGroup$$module$build$src$core$events$utils(t))}getRoot(t){return t instanceof Ia?t.getRootBlock():t}shouldReturnToStart(t,o){return(t=this.workspace.getDragTarget(t))?t.shouldPreventMove(o):!1}pixelsToWorkspaceUnits(t){return t=new At(t.x/this.workspace.scale,t.y/this.workspace.scale),this.workspace.isMutator&&t.scale(1/this.workspace.options.parentWorkspace.scale),t}};r(yt.BLOCK_DRAGGER,_o,K1);var AT={};AT.BlockDragStrategy=R1,AT.BubbleDragStrategy=a1,AT.CommentDragStrategy=BI,AT.Dragger=K1;var mA=class extends Rt{constructor(t,o,c){super(t?t.workspace.id:void 0),this.type=sc,t&&(this.blockId=t.id,this.isStart=o,this.blocks=c)}toJson(){const t=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new mA),o.isStart=t.isStart,o.blockId=t.blockId,o.blocks=t.blocks,o}};r(yt.EVENT,sc,mA);var gA=class extends ff{constructor(t,o,c,g){super(t),this.type=Kc,this.recordUndo=!1,t&&(this.name=o,this.oldValue=c,this.newValue=g)}toJson(){const t=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new gA),o.name=t.name,o.oldValue=t.oldValue,o.newValue=t.newValue,o}isNull(){return this.oldValue===this.newValue}run(t){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(o=o.getBlockById(this.blockId),!o)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");t=t?this.newValue:this.oldValue,(o=o.getField(this.name))?o.setValue(t):console.warn("Can't set non-existent field: "+this.name)}};r(yt.EVENT,Kc,gA);var _A=class extends ff{constructor(t){super(t),this.type=n.MOVE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)}toJson(){const t=super.toJson();return t.oldParentId=this.oldParentId,t.oldInputName=this.oldInputName,this.oldCoordinate&&(t.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),t.newParentId=this.newParentId,t.newInputName=this.newInputName,this.newCoordinate&&(t.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(t.reason=this.reason),this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new _A),o.oldParentId=t.oldParentId,o.oldInputName=t.oldInputName,t.oldCoordinate&&(c=t.oldCoordinate.split(","),o.oldCoordinate=new At(Number(c[0]),Number(c[1]))),o.newParentId=t.newParentId,o.newInputName=t.newInputName,t.newCoordinate&&(c=t.newCoordinate.split(","),o.newCoordinate=new At(Number(c[0]),Number(c[1]))),t.reason!==void 0&&(o.reason=t.reason),t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}recordNew(){const t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate}setReason(t){this.reason=t}currentLocation_(){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var o=t.getBlockById(this.blockId);if(!o)throw Error("The block associated with the block move event could not be found");t={};const c=o.getParent();return c?(t.parentId=c.id,(o=c.getInputWithBlock(o))&&(t.inputName=o.name)):t.coordinate=o.getRelativeToSurfaceXY(),t}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&At.equals(this.oldCoordinate,this.newCoordinate)}run(t){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var c=o.getBlockById(this.blockId);if(c){var g=t?this.newParentId:this.oldParentId,b=t?this.newInputName:this.oldInputName;if(t=t?this.newCoordinate:this.oldCoordinate,g){var M=o.getBlockById(g);if(!M){console.warn("Can't connect to non-existent block: "+g);return}}if(c.getParent()&&c.unplug(),t)b=c.getRelativeToSurfaceXY(),c.moveBy(t.x-b.x,t.y-b.y,this.reason);else{o=c.outputConnection,(!o||c.previousConnection&&c.previousConnection.isConnected())&&(o=c.previousConnection);let te,$e;c=($e=o)==null?void 0:$e.type,b?(c=M.getInput(b))&&(te=c.connection):c===Bt.PREVIOUS_STATEMENT&&(te=M.nextConnection),te&&o?o.connect(te):console.warn("Can't connect to non-existent input: "+b)}}else console.warn("Can't move non-existent block: "+this.blockId)}};r(yt.EVENT,n.MOVE$$module$build$src$core$events$utils,_A);var TA=class extends Rt{constructor(t,o,c){super(t?t.workspace.id:void 0),this.type=Sa,t&&(this.blockId=t.id,this.isOpen=o,this.bubbleType=c)}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId||"",t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new TA),o.isOpen=t.isOpen,o.bubbleType=t.bubbleType,o.blockId=t.blockId,o}},vA;(function(t){t.MUTATOR="mutator",t.COMMENT="comment",t.WARNING="warning"})(vA||(vA={})),r(yt.EVENT,Sa,TA);var cu=class extends dt{constructor(t){super(),this.isBlank=!t,t&&(this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=n.getGroup$$module$build$src$core$events$utils(),this.recordUndo=y())}toJson(){const t=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return t.commentId=this.commentId,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new cu),o.commentId=t.commentId,o}static CommentCreateDeleteHelper(t,o){const c=t.getEventWorkspace_();if(o){if(!t.json)throw Error("Encountered a comment event without proper json");Pr(t.json,c)}else{if(!t.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(o=c.getCommentById(t.commentId))?o.dispose():console.warn("Can't delete non-existent comment: "+t.commentId)}}},EA=class extends cu{constructor(t,o,c){super(t),this.type=Th,t&&(this.oldContents_=typeof o>"u"?"":o,this.newContents_=typeof c>"u"?"":c)}toJson(){const t=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new EA),o.oldContents_=t.oldContents,o.newContents_=t.newContents,o}isNull(){return this.oldContents_===this.newContents_}run(t){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){var c=t?this.newContents_:this.oldContents_;if(c===void 0)throw Error(t?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");o.setText(c)}else console.warn("Can't change non-existent comment: "+this.commentId)}};r(yt.EVENT,Th,EA);var yA=class extends cu{constructor(t){super(t),this.type=zo,t&&(this.xml=Yu(t),this.json=dn(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=Do(this.xml),t.json=this.json,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new yA),o.xml=n.textToDom$$module$build$src$core$utils$xml(t.xml),o.json=t.json,o}run(t){cu.CommentCreateDeleteHelper(this,t)}};r(yt.EVENT,zo,yA);var SA=class extends cu{constructor(t){super(t),this.type=ac,t&&(this.xml=Yu(t),this.json=dn(t,{addCoordinates:!0}))}run(t){cu.CommentCreateDeleteHelper(this,!t)}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=Do(this.xml),t.json=this.json,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new SA),o.xml=n.textToDom$$module$build$src$core$utils$xml(t.xml),o.json=t.json,o}};r(yt.EVENT,ac,SA);var $A=class extends cu{constructor(t){super(t),this.type=$a,t&&(this.comment_=t,this.oldCoordinate_=t.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(t){this.reason=t}setOldCoordinate(t){this.oldCoordinate_=t}toJson(){const t=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return t.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new $A),c=t.oldCoordinate.split(","),o.oldCoordinate_=new At(Number(c[0]),Number(c[1])),c=t.newCoordinate.split(","),o.newCoordinate_=new At(Number(c[0]),Number(c[1])),o}isNull(){return At.equals(this.oldCoordinate_,this.newCoordinate_)}run(t){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){if(t=t?this.newCoordinate_:this.oldCoordinate_,!t)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");o.moveTo(t)}else console.warn("Can't move non-existent comment: "+this.commentId)}};r(yt.EVENT,$a,$A);var bA=class extends cu{constructor(t,o){super(t),this.newCollapsed=o,this.type=vh}toJson(){const t=super.toJson();if(this.newCollapsed===void 0)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return t.newCollapsed=this.newCollapsed,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new bA),o.newCollapsed=t.newCollapsed,o}run(t){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(o=o.getCommentById(this.commentId))?o.setCollapsed(t?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};r(yt.EVENT,vh,bA);var AA=class extends Rt{constructor(t,o,c){super(c),this.type=fl,this.oldItem=t??void 0,this.newItem=o??void 0}toJson(){const t=super.toJson();return t.oldItem=this.oldItem,t.newItem=this.newItem,t}static fromJson(t,o,c){return o=super.fromJson(t,o,c??new AA),o.oldItem=t.oldItem,o.newItem=t.newItem,o}};r(yt.EVENT,fl,AA);var J1=class extends dt{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.type=lc,this.isBlank=!!t,t&&(this.workspaceId=t.id)}};r(yt.EVENT,lc,J1),n.CHANGE$$module$build$src$core$events$utils,n.CREATE$$module$build$src$core$events$utils,n.DELETE$$module$build$src$core$events$utils,n.MOVE$$module$build$src$core$events$utils,n.CHANGE$$module$build$src$core$events$utils,n.CREATE$$module$build$src$core$events$utils,n.DELETE$$module$build$src$core$events$utils,n.MOVE$$module$build$src$core$events$utils,n.disable$$module$build$src$core$events$utils,n.enable$$module$build$src$core$events$utils,n.getGroup$$module$build$src$core$events$utils,n.setGroup$$module$build$src$core$events$utils,n.setRecordUndo$$module$build$src$core$events$utils;var Ut={};Ut.Abstract=dt,Ut.BLOCK_CHANGE=n.CHANGE$$module$build$src$core$events$utils,Ut.BLOCK_CREATE=n.CREATE$$module$build$src$core$events$utils,Ut.BLOCK_DELETE=n.DELETE$$module$build$src$core$events$utils,Ut.BLOCK_DRAG=sc,Ut.BLOCK_FIELD_INTERMEDIATE_CHANGE=Kc,Ut.BLOCK_MOVE=n.MOVE$$module$build$src$core$events$utils,Ut.BUBBLE_OPEN=Sa,Ut.BUMP_EVENTS=Eh,Ut.BlockBase=ff,Ut.BlockChange=pf,Ut.BlockCreate=Ob,Ut.BlockDelete=Xb,Ut.BlockDrag=mA,Ut.BlockFieldIntermediateChange=gA,Ut.BlockMove=_A,Ut.BubbleOpen=TA,Ut.BubbleType=vA,Ut.CHANGE=n.CHANGE$$module$build$src$core$events$utils,Ut.CLICK=lr,Ut.COMMENT_CHANGE=Th,Ut.COMMENT_CREATE=zo,Ut.COMMENT_DELETE=ac,Ut.COMMENT_MOVE=$a,Ut.CREATE=n.CREATE$$module$build$src$core$events$utils,Ut.Click=Gt,Ut.ClickTarget=En,Ut.CommentBase=cu,Ut.CommentChange=EA,Ut.CommentCollapse=bA,Ut.CommentCreate=yA,Ut.CommentDelete=SA,Ut.CommentMove=$A,Ut.DELETE=n.DELETE$$module$build$src$core$events$utils,Ut.FINISHED_LOADING=lc,Ut.FinishedLoading=J1,Ut.MARKER_MOVE=oc,Ut.MOVE=n.MOVE$$module$build$src$core$events$utils,Ut.MarkerMove=jb,Ut.SELECTED=_h,Ut.Selected=nA,Ut.THEME_CHANGE=To,Ut.TOOLBOX_ITEM_SELECT=fl,Ut.TRASHCAN_OPEN=Qs,Ut.ThemeChange=Lb,Ut.ToolboxItemSelect=AA,Ut.TrashcanOpen=tA,Ut.UI=af,Ut.UiBase=Rt,Ut.VAR_CREATE=ya,Ut.VAR_DELETE=Jc,Ut.VAR_RENAME=gh,Ut.VIEWPORT_CHANGE=Vo,Ut.VarBase=rT,Ut.VarCreate=lb,Ut.VarDelete=qb,Ut.VarRename=Qb,Ut.ViewportChange=Nb,Ut.clearPendingUndo=C,Ut.disable=n.disable$$module$build$src$core$events$utils,Ut.disableOrphans=D,Ut.enable=n.enable$$module$build$src$core$events$utils,Ut.filter=A,Ut.fire=$,Ut.fromJson=F,Ut.get=k,Ut.getDescendantIds=O,Ut.getGroup=n.getGroup$$module$build$src$core$events$utils,Ut.getRecordUndo=y,Ut.isEnabled=x,Ut.setGroup=n.setGroup$$module$build$src$core$events$utils,Ut.setRecordUndo=n.setRecordUndo$$module$build$src$core$events$utils;var El={};El.BottomRow=D1,El.ConstantProvider=k1,El.Drawer=P1,El.MarkerSvg=G1,El.PathObject=H1,El.RenderInfo=U1,El.Renderer=dA,El.RightConnectionShape=B1,El.StatementInput=wy,El.TopRow=F1,sf();var Xr={};Xr.registerCleanup=qd,Xr.registerCollapse=is,Xr.registerCollapseExpandBlock=Xc,Xr.registerComment=va,Xr.registerCommentCreate=Os,Xr.registerCommentDelete=Hr,Xr.registerCommentDuplicate=Ea,Xr.registerCommentOptions=j_,Xr.registerDefaultOptions=sf,Xr.registerDelete=ph,Xr.registerDeleteAll=tf,Xr.registerDisable=nf,Xr.registerDuplicate=dh,Xr.registerExpand=Qd,Xr.registerHelp=mh,Xr.registerInline=fh,Xr.registerRedo=hh,Xr.registerUndo=ic;var Iy={};Iy.CommentView=DI,Iy.RenderedWorkspaceComment=cy,Iy.WorkspaceComment=qE;var CT={};CT.Bubble=di,CT.MiniWorkspaceBubble=iu,CT.TextBubble=Db,CT.TextInputBubble=u1;var Z1=class extends Ty{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(t){return super.getCSS_(t).concat([`${t} .blocklyInsertionMarker>.blocklyPathLight,`,`${t} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},q1=class{constructor(t){this.inlineSteps_=this.steps_="",this.info_=t,this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(t){this.steps_+=yi(t.xPos,this.info_.startY);for(let o=0,c;c=t.elements[o];o++)Pe.isLeftSquareCorner(c)?this.steps_+=this.highlightConstants_.START_POINT:Pe.isLeftRoundedCorner(c)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Pe.isPreviousConnection(c)?this.steps_+=this.notchPaths_.pathLeft:Pe.isHat(c)?this.steps_+=this.startPaths_.path(this.RTL_):Pe.isSpacer(c)&&c.width!==0&&(this.steps_+=Nt("H",c.xPos+c.width-this.highlightOffset));this.steps_+=Nt("H",t.xPos+t.width-this.highlightOffset)}drawJaggedEdge_(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Nt("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(t){const o=t.getLastInput();if(this.RTL_){const c=t.height-o.connectionHeight;this.steps_+=Ji(o.xPos+o.width-this.highlightOffset,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Nt("v",c)}else this.steps_+=Ji(o.xPos+o.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(t){const o=t.getLastInput();if(o)if(this.RTL_){const c=t.height-2*this.insideCornerPaths_.height;this.steps_+=Ji(o.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Nt("v",c)+this.insideCornerPaths_.pathBottom(this.RTL_)+Uo(t.width-o.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Ji(o.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Uo(t.width-o.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(t){const o=t.xPos+t.width-this.highlightOffset;t instanceof zb&&t.followsStatement&&(this.steps_+=Nt("H",o)),this.RTL_&&(this.steps_+=Nt("H",o),t.height>this.highlightOffset&&(this.steps_+=Nt("V",t.yPos+t.height-this.highlightOffset)))}drawBottomRow(t){if(this.RTL_)this.steps_+=Nt("V",t.baseline-this.highlightOffset);else{const o=this.info_.bottomRow.elements[0];Pe.isLeftSquareCorner(o)?this.steps_+=Ji(t.xPos+this.highlightOffset,t.baseline-this.highlightOffset):Pe.isLeftRoundedCorner(o)&&(this.steps_+=Ji(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=Ji(this.info_.startX,t):(this.steps_+=Ji(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=Nt("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,Pe.isLeftRoundedCorner(t.elements[0])?this.steps_+=Nt("V",this.outsideCornerPaths_.height):this.steps_+=Nt("V",t.capline+this.highlightOffset))}drawInlineInput(t){const o=this.highlightOffset,c=t.xPos+t.connectionWidth;var g=t.centerline-t.height/2;const b=t.width-t.connectionWidth,M=g+o;this.RTL_?(g=t.connectionOffsetY-o,t=t.height-(t.connectionOffsetY+t.connectionHeight)+o,this.inlineSteps_+=Ji(c-o,M)+Nt("v",g)+this.puzzleTabPaths_.pathDown(this.RTL_)+Nt("v",t)+Nt("h",b)):this.inlineSteps_+=Ji(t.xPos+t.width+o,M)+Nt("v",t.height)+Nt("h",-b)+Ji(c,g+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Q1=class extends vy{constructor(t,o){super(t,o),this.highlighter_=new q1(o)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const t=this.block_.pathObject;t.setPath(this.outlinePath_+`
`+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(t){this.highlighter_.drawJaggedEdge_(t),super.drawJaggedEdge_(t)}drawValueInput_(t){this.highlighter_.drawValueInput(t),super.drawValueInput_(t)}drawStatementInput_(t){this.highlighter_.drawStatementInput(t),super.drawStatementInput_(t)}drawRightSideRow_(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=Nt("H",t.xPos+t.width)+Nt("V",t.yPos+t.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(t){this.highlighter_.drawInlineInput(t),super.drawInlineInput_(t)}positionInlineInputConnection_(t){const o=t.centerline-t.height/2;if(t.connectionModel){let c=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),t.connectionModel.setOffsetInBlock(c,o+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(t){const o=t.getLastInput();if(o!=null&&o.connectionModel){let c=t.xPos+t.statementEdge+o.notchOffset;c=this.info_.RTL?-1*c:c+this.constants_.DARK_PATH_OFFSET,o.connectionModel.setOffsetInBlock(c,t.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(t){const o=t.getLastInput();if(o&&o.connectionModel){let c=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),o.connectionModel.setOffsetInBlock(c,t.yPos)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const o=t.connection,c=o.xPos;o.connectionModel.setOffsetInBlock((this.info_.RTL?-c:c)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}}},eO=class{constructor(t){this.OFFSET=.5,this.constantProvider=t,this.START_POINT=yi(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const t=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,c=(1-Math.SQRT1_2)*(t+o)-o,g=yi(c,c)+Di("a","0 0,0",t,Wt(-c-o,t-c)),b=Di("a","0 0,0",t+o,Wt(t+o,t+o)),M=yi(c,-c)+Di("a","0 0,0",t+o,Wt(t-c,c+o));return{width:t+o,height:t,pathTop(te){return te?g:""},pathBottom(te){return te?b:M}}}makeOutsideCorner(){const t=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,c=(1-Math.SQRT1_2)*(t-o)+o,g=yi(c,c)+Di("a","0 0,1",t-o,Wt(t-c,-c+o)),b=yi(o,t)+Di("a","0 0,1",t-o,Wt(t,-t+o)),M=-c,te=yi(c,M)+Di("a","0 0,1",t-o,Wt(-c+o,-M-t));return{height:t,topLeft($e){return $e?g:b},bottomLeft(){return te}}}makePuzzleTab(){const t=this.constantProvider.TAB_WIDTH,o=this.constantProvider.TAB_HEIGHT,c=yi(-2,-o+3.4)+Uo(-.45*t,-2.1),g=Nt("v",2.5)+yi(.97*-t,2.5)+ps("q",[Wt(.05*-t,10),Wt(.3*t,9.5)])+yi(.67*t,-1.9)+Nt("v",2.5),b=Nt("v",-1.5)+yi(-.92*t,-.5)+ps("q",[Wt(-.19*t,-5.5),Wt(0,-11)])+yi(.92*t,1),M=yi(-5,o-.7)+Uo(.46*t,-2.1);return{width:t,height:o,pathUp(te){return te?c:b},pathDown(te){return te?g:M}}}makeNotch(){return{pathLeft:Nt("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Uo(5.1,2.6)+yi(-10.2,6.8)+Uo(5.1,2.6),height:12,width:10.2}}makeStartHat(){const t=this.constantProvider.START_HAT.height,o=yi(25,-8.7)+ps("c",[Wt(29.7,-6.2),Wt(57.2,-.5),Wt(75,8.7)]),c=ps("c",[Wt(17.8,-9.2),Wt(45.3,-14.9),Wt(75,-8.7)])+Ji(100.5,t+.5);return{path(g){return g?o:c}}}},tO=class extends Hb{constructor(t,o){super(t,o),this.constants_=t,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},nO=class extends _T{constructor(t,o){super(t,o),this.constants_=t,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},iO=class extends ET{constructor(t,o){super(t,o),this.renderer_=t}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Ko||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(t,o){this.isInline&&t instanceof n.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new tO(this.constants_,t)),o.hasInlineInput=!0):t instanceof Ko?(o.elements.push(new nO(this.constants_,t)),o.hasStatement=!0):t instanceof n.ValueInput$$module$build$src$core$inputs$value_input?(o.elements.push(new _y(this.constants_,t)),o.hasExternalInput=!0):(t instanceof dc||t instanceof lu)&&(o.minHeight=Math.max(o.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),this.isInline||o.align!==null||(o.align=t.align)}addElemSpacing_(){let t=!1;for(let c=0,g;g=this.rows[c];c++)g.hasExternalInput&&(t=!0);for(let c=0,g;g=this.rows[c];c++){var o=g.elements;if(g.elements=[],g.startsWithElemSpacer()&&g.elements.push(new Yo(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(let b=0;b<o.length-1;b++){g.elements.push(o[b]);const M=this.getInRowSpacing_(o[b],o[b+1]);g.elements.push(new Yo(this.constants_,M))}g.elements.push(o[o.length-1]),g.endsWithElemSpacer()&&(o=this.getInRowSpacing_(o[o.length-1],null),t&&g.hasDummyInput&&(o+=this.constants_.TAB_WIDTH),g.elements.push(new Yo(this.constants_,o)))}}}getInRowSpacing_(t,o){if(!t)return o&&Pe.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&Pe.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&Pe.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Pe.isInput(t)&&(!o||Pe.isStatementInput(o)))return Pe.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:Pe.isIcon(t)?2*this.constants_.LARGE_PADDING+1:Pe.isHat(t)?this.constants_.NO_PADDING:Pe.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:Pe.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:Pe.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Pe.isInput(t)&&!o){if(Pe.isExternalInput(t))return this.constants_.NO_PADDING;if(Pe.isInlineInput(t))return this.constants_.LARGE_PADDING;if(Pe.isStatementInput(t))return this.constants_.NO_PADDING}if(!Pe.isInput(t)&&o&&Pe.isInput(o)){if(Pe.isField(t)&&t.isEditable){if(Pe.isInlineInput(o)||Pe.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(Pe.isInlineInput(o)||Pe.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(Pe.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Pe.isIcon(t)&&o&&!Pe.isInput(o))return this.constants_.LARGE_PADDING;if(Pe.isInlineInput(t)&&o&&Pe.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Pe.isLeftSquareCorner(t)&&o){if(Pe.isHat(o))return this.constants_.NO_PADDING;if(Pe.isPreviousConnection(o))return o.notchOffset;if(Pe.isNextConnection(o))return o.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Pe.isLeftRoundedCorner(t)&&o){if(Pe.isPreviousConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS;if(Pe.isNextConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Pe.isField(t)&&o&&Pe.isField(o)&&t.isEditable===o.isEditable||o&&Pe.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,o){return Pe.isTopRow(t)&&Pe.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Pe.isTopRow(t)||Pe.isBottomRow(o)?this.constants_.NO_PADDING:t.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&o.hasStatement||!t.hasStatement&&o.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){if(Pe.isSpacer(o))return t.yPos+o.height/2;if(Pe.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,Pe.isNextConnection(o)?t+o.height/2:t-o.height/2;if(Pe.isTopRow(t))return Pe.isHat(o)?t.capline-o.height/2:t.capline+o.height/2;let c=t.yPos;return Pe.isField(o)||Pe.isIcon(o)?(c+=o.height/2,(t.hasInlineInput||t.hasStatement)&&o.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(c+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):c=Pe.isInlineInput(o)?c+o.height/2:c+t.height/2,c}alignRowElements_(){if(this.isInline){var t=0,o=new WeakMap,c=null;for(let g=this.rows.length-1,b;b=this.rows[g];g--)o.set(b,t),Pe.isInputRow(b)&&(b.hasStatement&&this.alignStatementRow_(b),c&&c.hasStatement&&b.width<c.width?o.set(b,c.width):t=b.hasStatement?b.width:Math.max(t,b.width),c=b);t=0;for(let g=0,b;b=this.rows[g];g++)b.hasStatement?t=this.getDesiredRowWidth_(b):Pe.isSpacer(b)?b.width=Math.max(t,o.get(b)):(c=b.width,t=Math.max(t,o.get(b))-c,0<t&&this.addAlignmentPadding_(b,t),t=b.width)}else super.alignRowElements_()}getDesiredRowWidth_(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(t)}finalize_(){let t=0,o=0;for(let g=0,b;b=this.rows[g];g++){b.yPos=o,b.xPos=this.startX,o+=b.height,t=Math.max(t,b.widthWithConnectedBlocks);var c=o-this.topRow.ascenderHeight;b===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,o+=c),this.recordElemPositions_(b)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,c.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=o+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},rO=class extends Ey{constructor(t,o,c){super(t,o,c),this.constants=c,this.colourDark="#000000",this.svgPathDark=ve(Xe.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=ve(Xe.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)}setHighlightPath(t){this.svgPathLight.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(t){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(t),this.svgPath.setAttribute("stroke","none")}setStyle(t){this.style=t,this.colourDark=ko("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(t){if(t){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(t){super.updateDisabled_(t),t&&this.svgPath.setAttribute("stroke","none")}},sO=class extends yy{constructor(t){super(t),this.highlightConstants=null}init(t,o){super.init(t,o),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(t,o){super.refreshDom(t,o),this.getHighlightConstants().init()}makeConstants_(){return new Z1}makeRenderInfo_(t){return new iO(this,t)}makeDrawer_(t,o){return new Q1(t,o)}makePathObject(t,o){return new rO(t,o,this.getConstants())}makeHighlightConstants_(){return new eO(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};rh("geras",sO);var mc={};mc.ConstantProvider=Z1,mc.Drawer=Q1,mc.HighlightConstantProvider=eO,mc.Highlighter=q1,mc.InlineInput=tO,mc.PathObject=rO,mc.RenderInfo=iO,mc.Renderer=sO,mc.StatementInput=nO;var oO=class extends ET{constructor(t,o){super(t,o)}getRenderer(){return this.renderer_}addElemSpacing_(){let t=!1;for(var o=0;o<this.rows.length;o++)if(this.rows[o].hasExternalInput){t=!0;break}for(o=0;o<this.rows.length;o++){const g=this.rows[o];var c=g.elements;if(g.elements=[],g.startsWithElemSpacer()&&g.elements.push(new Yo(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(let b=0;b<c.length-1;b++){g.elements.push(c[b]);const M=this.getInRowSpacing_(c[b],c[b+1]);g.elements.push(new Yo(this.constants_,M))}g.elements.push(c[c.length-1]),g.endsWithElemSpacer()&&(c=this.getInRowSpacing_(c[c.length-1],null),t&&g.hasDummyInput&&(c+=this.constants_.TAB_WIDTH),g.elements.push(new Yo(this.constants_,c)))}}}getInRowSpacing_(t,o){if(!t)return o&&Pe.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&Pe.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&Pe.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Pe.isInput(t)&&!o)return Pe.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:Pe.isIcon(t)?2*this.constants_.LARGE_PADDING+1:Pe.isHat(t)?this.constants_.NO_PADDING:Pe.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:Pe.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:Pe.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Pe.isInput(t)&&!o){if(Pe.isExternalInput(t))return this.constants_.NO_PADDING;if(Pe.isInlineInput(t))return this.constants_.LARGE_PADDING;if(Pe.isStatementInput(t))return this.constants_.NO_PADDING}if(!Pe.isInput(t)&&o&&Pe.isInput(o)){if(Pe.isField(t)&&t.isEditable){if(Pe.isInlineInput(o)||Pe.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(Pe.isInlineInput(o)||Pe.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(Pe.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Pe.isIcon(t)&&o&&!Pe.isInput(o))return this.constants_.LARGE_PADDING;if(Pe.isInlineInput(t)&&o&&Pe.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Pe.isLeftSquareCorner(t)&&o){if(Pe.isHat(o))return this.constants_.NO_PADDING;if(Pe.isPreviousConnection(o)||Pe.isNextConnection(o))return o.notchOffset}return Pe.isLeftRoundedCorner(t)&&o?o.notchOffset-this.constants_.CORNER_RADIUS:Pe.isField(t)&&o&&Pe.isField(o)&&t.isEditable===o.isEditable||o&&Pe.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,o){return Pe.isTopRow(t)&&Pe.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Pe.isTopRow(t)||Pe.isBottomRow(o)?this.constants_.NO_PADDING:t.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&o.hasStatement||t.hasDummyInput||o.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){if(Pe.isSpacer(o))return t.yPos+o.height/2;if(Pe.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,Pe.isNextConnection(o)?t+o.height/2:t-o.height/2;if(Pe.isTopRow(t))return Pe.isHat(o)?t.capline-o.height/2:t.capline+o.height/2;let c=t.yPos;return c=Pe.isField(o)&&t.hasStatement?c+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+o.height/2):c+t.height/2}finalize_(){let t=0,o=0;for(var c=0;c<this.rows.length;c++){const b=this.rows[c];b.yPos=o,b.xPos=this.startX,o+=b.height,t=Math.max(t,b.widthWithConnectedBlocks);var g=o-this.topRow.ascenderHeight;b===this.bottomRow&&g<this.constants_.MIN_BLOCK_HEIGHT&&(g=this.constants_.MIN_BLOCK_HEIGHT-g,this.bottomRow.height+=g,o+=g),this.recordElemPositions_(b)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,c.getHeightWidth().width)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=o,this.startY=this.topRow.capline}},aO=class extends yy{constructor(t){super(t)}makeRenderInfo_(t){return new oO(this,t)}};rh("thrasos",aO);var CA={};CA.RenderInfo=oO,CA.Renderer=aO;var wG={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},MG={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},IG=new vf("zelos",wG,MG),OG={Classic:hy,Zelos:IG},RA=class{constructor(t,o,c){this.id_=t.toolboxitemid||m(),this.level_=(this.parent_=c||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=o,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(t){}},yl=class extends RA{constructor(t,o,c){super(t,o,c),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let o=0;o<t.length;o++){const c=t[o];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(c)}}parseCategoryDef_(t){this.name_="name"in t?Ei(t.name):"",this.colour_=this.getColour_(t),Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),rn(this.htmlDiv_,gl.TREEITEM),vi(this.htmlDiv_,Wr.SELECTED,!1),vi(this.htmlDiv_,Wr.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),rn(this.iconDom_,gl.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const t=this.labelDom_.getAttribute("id");return t&&vi(this.htmlDiv_,Wr.LABELLEDBY,t),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const t=document.createElement("div"),o=this.cssConfig_.container;return o&&Me(t,o),t}createRowContainer_(){const t=document.createElement("div");var o=this.cssConfig_.row;return o&&Me(t,o),o=`${yl.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?t.style.paddingRight=o:t.style.paddingLeft=o,t}createRowContentsContainer_(){const t=document.createElement("div"),o=this.cssConfig_.rowcontentcontainer;return o&&Me(t,o),t}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&Me(t,o)}return t.style.display="inline-block",t}createLabelDom_(t){const o=document.createElement("span");return o.setAttribute("id",this.getId()+".label"),o.textContent=t,(t=this.cssConfig_.label)&&Me(o,t),o}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(t){t&&(t=yl.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)}getColour_(t){const o=t.categorystyle||t.categoryStyle;if((t=t.colour)&&o)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(o)return this.getColourfromStyle_(o);if(t)return this.parseColour_(t)}return""}getColourfromStyle_(t){var o=this.workspace_.getTheme();if(t&&o){if((o=o.categoryStyles[t])&&o.colour)return this.parseColour_(o.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(t){if(t=Ei(t),t==null||t==="")return"";var o=Number(t);return isNaN(o)?(o=mo(t))?o:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):Kl(o)}openIcon_(t){if(t){var o=this.cssConfig_.closedicon;o&&vt(t,o),(o=this.cssConfig_.openicon)&&Me(t,o)}}closeIcon_(t){if(t){var o=this.cssConfig_.openicon;o&&vt(t,o),(o=this.cssConfig_.closedicon)&&Me(t,o)}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let t=this;for(;t.getParent();)if(t=t.getParent(),!t.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(t){}setSelected(t){if(this.rowDiv_){var o=this.cssConfig_.selected;if(t){const c=this.parseColour_(yl.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||c,o&&Me(this.rowDiv_,o)}else this.rowDiv_.style.backgroundColor="",o&&oe(this.rowDiv_,o);vi(this.htmlDiv_,Wr.SELECTED,t)}}setDisabled(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",`${t}`),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(t){this.flyoutItems_=[],this.toolboxItemDef_=typeof t=="string"?{kind:this.toolboxItemDef_.kind,custom:t,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Ci(t),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){W(this.htmlDiv_)}};yl.registrationName="category",yl.nestedPadding=19,yl.borderWidth=8,yl.defaultBackgroundColour="#57e",Ue(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),r(yt.TOOLBOX_ITEM,yl.registrationName,yl);var RT=class extends RA{constructor(t,o){super(t,o),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}init(){this.createDom_()}createDom_(){const t=document.createElement("div"),o=this.cssConfig_.container;return o&&Me(t,o),this.htmlDiv_=t}getDiv(){return this.htmlDiv_}dispose(){W(this.htmlDiv_)}};RT.registrationName="sep",Ue(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),r(yt.TOOLBOX_ITEM,RT.registrationName,RT);var Lm=class extends yl{constructor(t,o,c){super(t,o,c),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const t=super.makeDefaultCssConfig_();return t.contents="blocklyToolboxContents",t}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{const o=t.contents;if(o){this.flyoutItems_=[],t=!0;for(let c=0;c<o.length;c++){const g=o[c];!u(yt.TOOLBOX_ITEM,g.kind)||g.kind.toLowerCase()===RT.registrationName&&t?(this.flyoutItems_.push(g),t=!0):(this.createToolboxItem_(g),t=!1)}}}}createToolboxItem_(t){let o=t.kind;o.toUpperCase()==="CATEGORY"&&nn(t)&&(o=Lm.registrationName),t=new(d(yt.TOOLBOX_ITEM,o))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),rn(this.subcategoriesDiv_,gl.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),vi(this.htmlDiv_,Wr.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&Me(t,o),t.style.visibility="visible"}return t.style.display="inline-block",t}createSubCategoriesDom_(t){const o=document.createElement("div");o.style.display="none";var c=this.cssConfig_.contents;for(c&&Me(o,c),c=0;c<t.length;c++){const g=t[c];g.init();const b=g.getDiv();if(o.appendChild(b),g.getClickTarget){let M;(M=g.getClickTarget())==null||M.setAttribute("id",g.getId())}}return o}setExpanded(t){if(this.expanded_!==t){if(this.expanded_=t)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let o;(o=this.parentToolbox_.getFlyout())==null||o.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}vi(this.htmlDiv_,Wr.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";const o=this.getChildToolboxItems();for(let c=0;c<o.length;c++)o[c].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(t){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Lm.registrationName="collapsibleCategory",r(yt.TOOLBOX_ITEM,Lm.registrationName,Lm);var lO=class extends $y{constructor(t){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.RTL=t.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition}onShortcut(t){return!1}init(){var t=this.workspace_;const o=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),ot(this.flyout_.createDom("svg"),o),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),t=t.getThemeManager(),t.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[zr.Capability.AUTOHIDEABLE,zr.Capability.DELETE_AREA,zr.Capability.DRAG_TARGET]})}createDom_(t){t=t.getParentSvg();const o=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,rn(this.contentsDiv_,gl.TREE),o.appendChild(this.contentsDiv_),t.parentNode.insertBefore(o,t),this.attachEvents_(o,this.contentsDiv_),o}createContainer_(){const t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),Me(t,"blocklyToolboxDiv"),Me(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t}createContentsContainer_(){const t=document.createElement("div");return Me(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t}attachEvents_(t,o){t=Ye(t,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(t),o=Ye(o,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(o)}onClick_(t){if(Oe(t)||t.target===this.HtmlDiv)ne().hideChaff(!1);else{var o=t.target.getAttribute("id");o&&(o=this.getToolboxItemById(o),o.isSelectable()&&(this.setSelectedItem(o),o.onClick(t))),ne().hideChaff(!0)}Ce()}onKeyDown_(t){let o=!1;switch(t.key){case"ArrowDown":o=this.selectNext_();break;case"ArrowUp":o=this.selectPrevious_();break;case"ArrowLeft":o=this.selectParent_();break;case"ArrowRight":o=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),o=!0);break;default:o=!1}!o&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(o=this.selectedItem_.onKeyDown(t)),o&&t.preventDefault()}createFlyout_(){const t=this.workspace_,o=new Ra({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return o.toolboxPosition=t.options.toolboxPosition,new(t.horizontalLayout?p(yt.FLYOUTS_HORIZONTAL_TOOLBOX,t.options,!0):p(yt.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(o)}render(t){this.toolboxDef_=t;for(let o=0;o<this.contents_.length;o++){const c=this.contents_[o];c&&c.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){const o=document.createDocumentFragment();for(let c=0;c<t.length;c++)this.createToolboxItem_(t[c],o);this.contentsDiv_.appendChild(o)}createToolboxItem_(t,o){var c=t.kind;c.toUpperCase()==="CATEGORY"&&nn(t)&&(c=Lm.registrationName),(c=d(yt.TOOLBOX_ITEM,c.toLowerCase()))&&(t=new c(t,this),t.init(),this.addToolboxItem_(t),(c=t.getDiv())&&o.appendChild(c),t.getClickTarget()&&t.getClickTarget().setAttribute("id",t.getId()))}addToolboxItem_(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible()){t=t.getChildToolboxItems();for(let o=0;o<t.length;o++)this.addToolboxItem_(t[o])}}getToolboxItems(){return this.contents_}addStyle(t){t&&this.HtmlDiv&&Me(this.HtmlDiv,t)}removeStyle(t){t&&this.HtmlDiv&&oe(this.HtmlDiv,t)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect();const o=t.top,c=o+t.height,g=t.left;return t=g+t.width,this.toolboxPosition===Cn.TOP?new Si(-1e7,c,-1e7,1e7):this.toolboxPosition===Cn.BOTTOM?new Si(o,1e7,-1e7,1e7):this.toolboxPosition===Cn.LEFT?new Si(-1e7,1e7,-1e7,t):new Si(-1e7,1e7,g,1e7)}wouldDelete(t){return t instanceof Ia?this.updateWouldDelete_(!t.getParent()&&t.isDeletable()):this.updateWouldDelete_(qs(t)&&t.isDeletable()),this.wouldDelete_}onDragEnter(t){this.updateCursorDeleteStyle_(!0)}onDragExit(t){this.updateCursorDeleteStyle_(!1)}onDrop(t){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(t){const o=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(o):this.removeStyle(o)}getToolboxItemById(t){return this.contentMap_[t]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const t=this.workspace_.getMetrics(),o=this.HtmlDiv;o&&(this.horizontalLayout_?(o.style.left="0",o.style.height="auto",o.style.width="100%",this.height_=o.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition===Cn.TOP?o.style.top="0":o.style.bottom="0"):(this.toolboxPosition===Cn.RIGHT?o.style.right="0":o.style.left="0",o.style.height="100%",this.width_=o.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const t=this.workspace_,o=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition===Cn.LEFT?t.scrollX+o.width:t.scrollX,this.toolboxPosition===Cn.TOP?t.scrollY+o.height:t.scrollY),Z(t)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let t=0;t<this.contents_.length;t++){const o=this.contents_[t];o.refreshTheme&&o.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())}autoHide(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(t){const o=this.selectedItem_;!t&&!o||t&&!Y_(t)||(this.shouldDeselectItem_(o,t)&&o!==null&&this.deselectItem_(o),this.shouldSelectItem_(o,t)&&t!==null&&this.selectItem_(o,t),this.updateFlyout_(o,t),this.fireSelectEvent_(o,t))}shouldDeselectItem_(t,o){return t!==null&&(!t.isCollapsible()||t!==o)}shouldSelectItem_(t,o){return o!==null&&o!==t}deselectItem_(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),vi(this.contentsDiv_,Wr.ACTIVEDESCENDANT,"")}selectItem_(t,o){this.selectedItem_=o,this.previouslySelectedItem_=t,o.setSelected(!0),vi(this.contentsDiv_,Wr.ACTIVEDESCENDANT,o.getId())}selectItemByPosition(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t],t.isSelectable()&&this.setSelectedItem(t))}updateFlyout_(t,o){o&&(t!==o||o.isCollapsible())&&o.getContents().length?(this.flyout_.show(o.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(t,o){const c=t&&t.getName();let g=o&&o.getName();t===o&&(g=null),t=new(k(fl))(c,g,this.workspace_.id),$(t)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){let o=this.contents_[t];for(;o&&!o.isSelectable();)o=this.contents_[++t];if(o&&o.isSelectable())return this.setSelectedItem(o),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){let o=this.contents_[t];for(;o&&!o.isSelectable();)o=this.contents_[--t];if(o&&o.isSelectable())return this.setSelectedItem(o),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)Q(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),W(this.HtmlDiv))}};Ue(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),r(yt.TOOLBOX,_o,lO);var LG="11.1.1",NG=Bt.INPUT_VALUE,kG=Bt.OUTPUT_VALUE,PG=Bt.NEXT_STATEMENT,DG=Bt.PREVIOUS_STATEMENT,BG=Cn.TOP,FG=Cn.BOTTOM,UG=Cn.LEFT,GG=Cn.RIGHT;xm.prototype.newBlock=function(t,o){return new yf(this,t,o)},Ma.prototype.newBlock=function(t,o){return new Ia(this,t,o)},xm.prototype.newComment=function(t){return new qE(this,t)},Ma.prototype.newComment=function(t){return new cy(this,t)},Ma.newTrashcan=function(t){return new w1(t)},iu.prototype.newWorkspaceSvg=function(t){return new Ma(t)},n.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=Fd(t),t=t[0].concat(t[1]);for(let o=0;o<t.length;o++)this.getName(t[o][0],n.Names$$module$build$src$core$names.NameType.PROCEDURE)};var st={};return st.ASTNode=_t,st.BasicCursor=yT,st.Block=yf,st.BlockSvg=Ia,st.Blocks=Ns,st.COLLAPSED_FIELD_NAME=KE,st.COLLAPSED_INPUT_NAME=iT,st.COLLAPSE_CHARS=S1,st.CodeGenerator=n.CodeGenerator$$module$build$src$core$generator,st.CollapsibleToolboxCategory=Lm,st.ComponentManager=zr,st.Connection=Jn,st.ConnectionChecker=$1,st.ConnectionDB=bm,st.ConnectionType=Bt,st.ContextMenu=Tf,st.ContextMenuItems=Xr,st.ContextMenuRegistry=wn,st.Css=ib,st.Cursor=iA,st.DELETE_VARIABLE_ID=Zb,st.DeleteArea=$y,st.DragTarget=x1,st.DropDownDiv=ks,st.Events=Ut,st.Extensions=vl,st.Field=$i,st.FieldCheckbox=Af,st.FieldDropdown=uc,st.FieldImage=bf,st.FieldLabel=Ef,st.FieldLabelSerializable=Y1,st.FieldNumber=pA,st.FieldTextInput=xy,st.FieldVariable=bT,st.Flyout=My,st.FlyoutButton=xa,st.FlyoutMetricsManager=X1,st.Generator=n.CodeGenerator$$module$build$src$core$generator,st.Gesture=nu,st.Grid=kb,st.HorizontalFlyout=j1,st.INPUT_VALUE=NG,st.Input=Rm,st.InsertionMarkerManager=wa,st.InsertionMarkerPreviewer=V1,st.Marker=A1,st.MarkerManager=uT,st.Menu=Tb,st.MenuItem=vb,st.MetricsManager=hA,st.Msg=n.Msg$$module$build$src$core$msg,st.NEXT_STATEMENT=PG,st.Names=n.Names$$module$build$src$core$names,st.OPPOSITE_TYPE=$f,st.OUTPUT_VALUE=kG,st.Options=Ra,st.PREVIOUS_STATEMENT=DG,st.PROCEDURE_CATEGORY_NAME=gy,st.Procedures=to,st.RENAME_VARIABLE_ID=Jb,st.RenderedConnection=no,st.Scrollbar=cr,st.ScrollbarPair=uA,st.ShortcutItems=pc,st.ShortcutRegistry=ri,st.TOOLBOX_AT_BOTTOM=FG,st.TOOLBOX_AT_LEFT=UG,st.TOOLBOX_AT_RIGHT=GG,st.TOOLBOX_AT_TOP=BG,st.TabNavigateCursor=C1,st.Theme=vf,st.ThemeManager=y1,st.Themes=OG,st.Toolbox=lO,st.ToolboxCategory=yl,st.ToolboxItem=RA,st.ToolboxSeparator=RT,st.Tooltip=Xo,st.Touch=et,st.Trashcan=w1,st.UnattachedFieldError=ur,st.VARIABLE_CATEGORY_NAME=cb,st.VARIABLE_DYNAMIC_CATEGORY_NAME=Kb,st.VERSION=LG,st.VariableMap=eA,st.VariableModel=sT,st.Variables=_s,st.VariablesDynamic=Sf,st.VerticalFlyout=fA,st.WidgetDiv=Tl,st.Workspace=xm,st.WorkspaceAudio=b1,st.WorkspaceDragger=i1,st.WorkspaceSvg=Ma,st.Xml=Ps,st.ZoomControls=wI,st.blockAnimations=mT,st.blockRendering=ui,st.browserEvents=qc,st.bubbles=CT,st.bumpObjects=Sy,st.clipboard=$T,st.comments=Iy,st.common=De,st.config=n.config$$module$build$src$core$config,st.constants=tG,st.defineBlocksWithJsonArray=Y,st.dialog=hf,st.dragging=AT,st.fieldRegistry=fy,st.geras=mc,st.getMainWorkspace=ne,st.getSelected=ue,st.hasBubble=Te,st.hideChaff=K_,st.icons=Ah,st.inject=Zi,st.inputs=wh,st.isCopyable=nc,st.isDeletable=qs,st.isDraggable=nl,st.isIcon=al,st.isObservable=Dd,st.isPaster=cm,st.isRenderedElement=zE,st.isSelectable=ul,st.isSerializable=us,st.isVariableBackedParameterModel=It,st.procedures=to,st.registry=hl,st.renderManagement=ZE,st.serialization=RG,st.setLocale=ab,st.setParentContainer=G,st.svgResize=Z,st.thrasos=CA,st.uiPosition=uf,st.utils=ji,st.zelos=El,st.__namespace__=n,st})}(sR)),sR.exports}(function(i,e){(function(n,r){i.exports=r(cI())})(tp,function(n){var r=n.__namespace__,s=function(N,j){return["[]",W.ATOMIC]},a=function(N,j){const ge=Array(N.itemCount_);for(let xe=0;xe<N.itemCount_;xe++)ge[xe]=j.valueToCode(N,"ADD"+xe,W.NONE)||"null";return["["+ge.join(", ")+"]",W.ATOMIC]},l=function(N,j){const ge=j.provideFunction_("listsRepeat",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),xe=j.valueToCode(N,"ITEM",W.NONE)||"null";return N=j.valueToCode(N,"NUM",W.NONE)||"0",[ge+"("+xe+", "+N+")",W.FUNCTION_CALL]},u=function(N,j){return[(j.valueToCode(N,"VALUE",W.MEMBER)||"[]")+".length",W.MEMBER]},d=function(N,j){return["!"+(j.valueToCode(N,"VALUE",W.MEMBER)||"[]")+".length",W.LOGICAL_NOT]},h=function(N,j){const ge=N.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",xe=j.valueToCode(N,"FIND",W.NONE)||"''";return j=(j.valueToCode(N,"VALUE",W.MEMBER)||"[]")+"."+ge+"("+xe+")",N.workspace.options.oneBasedIndex?[j+" + 1",W.ADDITION]:[j,W.FUNCTION_CALL]},f=function(N,j){const ge=N.getFieldValue("MODE")||"GET",xe=N.getFieldValue("WHERE")||"FROM_START";var Ke=j.valueToCode(N,"VALUE",xe==="RANDOM"?W.NONE:W.MEMBER)||"[]";switch(xe){case"FIRST":if(ge==="GET")return[Ke+"[0]",W.MEMBER];if(ge==="GET_REMOVE")return[Ke+".shift()",W.MEMBER];if(ge==="REMOVE")return Ke+`.shift();
`;break;case"LAST":if(ge==="GET")return[Ke+".slice(-1)[0]",W.MEMBER];if(ge==="GET_REMOVE")return[Ke+".pop()",W.MEMBER];if(ge==="REMOVE")return Ke+`.pop();
`;break;case"FROM_START":if(N=j.getAdjusted(N,"AT"),ge==="GET")return[Ke+"["+N+"]",W.MEMBER];if(ge==="GET_REMOVE")return[Ke+".splice("+N+", 1)[0]",W.FUNCTION_CALL];if(ge==="REMOVE")return Ke+".splice("+N+`, 1);
`;break;case"FROM_END":if(N=j.getAdjusted(N,"AT",1,!0),ge==="GET")return[Ke+".slice("+N+")[0]",W.FUNCTION_CALL];if(ge==="GET_REMOVE")return[Ke+".splice("+N+", 1)[0]",W.FUNCTION_CALL];if(ge==="REMOVE")return Ke+".splice("+N+", 1);";break;case"RANDOM":if(Ke=j.provideFunction_("listsGetRandomItem",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+Ke+", "+(ge!=="GET")+")",ge==="GET"||ge==="GET_REMOVE")return[Ke,W.FUNCTION_CALL];if(ge==="REMOVE")return Ke+`;
`}throw Error("Unhandled combination (lists_getIndex).")},p=function(N,j){function ge(){if(xe.match(/^\w+$/))return"";const un=j.nameDB_.getDistinctName("tmpList",r.NameType$$module$build$src$core$names.VARIABLE),an="var "+un+" = "+xe+`;
`;return xe=un,an}let xe=j.valueToCode(N,"LIST",W.MEMBER)||"[]";const Ke=N.getFieldValue("MODE")||"GET";var gt=N.getFieldValue("WHERE")||"FROM_START";const $t=j.valueToCode(N,"TO",W.ASSIGNMENT)||"null";switch(gt){case"FIRST":if(Ke==="SET")return xe+"[0] = "+$t+`;
`;if(Ke==="INSERT")return xe+".unshift("+$t+`);
`;break;case"LAST":if(Ke==="SET")return ge()+(xe+"["+xe+".length - 1] = "+$t+`;
`);if(Ke==="INSERT")return xe+".push("+$t+`);
`;break;case"FROM_START":if(N=j.getAdjusted(N,"AT"),Ke==="SET")return xe+"["+N+"] = "+$t+`;
`;if(Ke==="INSERT")return xe+".splice("+N+", 0, "+$t+`);
`;break;case"FROM_END":if(N=j.getAdjusted(N,"AT",1,!1,W.SUBTRACTION),gt=ge(),Ke==="SET")return gt+(xe+"["+xe+".length - "+N+"] = "+$t+`;
`);if(Ke==="INSERT")return gt+(xe+".splice("+xe+".length - "+N+", 0, "+$t+`);
`);break;case"RANDOM":if(N=ge(),gt=j.nameDB_.getDistinctName("tmpX",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+gt+" = Math.floor(Math.random() * "+xe+`.length);
`,Ke==="SET")return N+(xe+"["+gt+"] = "+$t+`;
`);if(Ke==="INSERT")return N+(xe+".splice("+gt+", 0, "+$t+`);
`)}throw Error("Unhandled combination (lists_setIndex).")},m=function(N,j){var ge={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},xe=j.valueToCode(N,"LIST",W.MEMBER)||"[]";const Ke=N.getFieldValue("WHERE1"),gt=N.getFieldValue("WHERE2");if(Ke==="FIRST"&&gt==="LAST")xe+=".slice(0)";else if(xe.match(/^\w+$/)||Ke!=="FROM_END"&&gt==="FROM_START"){switch(Ke){case"FROM_START":ge=j.getAdjusted(N,"AT1");break;case"FROM_END":ge=j.getAdjusted(N,"AT1",1,!1,W.SUBTRACTION),ge=xe+".length - "+ge;break;case"FIRST":ge="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(gt){case"FROM_START":j=j.getAdjusted(N,"AT2",1);break;case"FROM_END":j=j.getAdjusted(N,"AT2",0,!1,W.SUBTRACTION),j=xe+".length - "+j;break;case"LAST":j=xe+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}xe=xe+".slice("+ge+", "+j+")"}else{const $t=j.getAdjusted(N,"AT1");N=j.getAdjusted(N,"AT2"),xe=j.provideFunction_("subsequence"+ge[Ke]+ge[gt],`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(sequence${Ke==="FROM_END"||Ke==="FROM_START"?", at1":""}${gt==="FROM_END"||gt==="FROM_START"?", at2":""}) {
  var start = ${je("sequence",Ke,"at1")};
  var end = ${je("sequence",gt,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+xe+(Ke==="FROM_END"||Ke==="FROM_START"?", "+$t:"")+(gt==="FROM_END"||gt==="FROM_START"?", "+N:"")+")"}return[xe,W.FUNCTION_CALL]},v=function(N,j){const ge=j.valueToCode(N,"LIST",W.FUNCTION_CALL)||"[]",xe=N.getFieldValue("DIRECTION")==="1"?1:-1;return N=N.getFieldValue("TYPE"),j=j.provideFunction_("listsGetSortCompare",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return String(a) > String(b) ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `),[ge+".slice().sort("+j+'("'+N+'", '+xe+"))",W.FUNCTION_CALL]},y=function(N,j){let ge=j.valueToCode(N,"INPUT",W.MEMBER);if(j=j.valueToCode(N,"DELIM",W.NONE)||"''",N=N.getFieldValue("MODE"),N==="SPLIT")ge||(ge="''"),N="split";else if(N==="JOIN")ge||(ge="[]"),N="join";else throw Error("Unknown mode: "+N);return[ge+"."+N+"("+j+")",W.FUNCTION_CALL]},$=function(N,j){return[(j.valueToCode(N,"LIST",W.FUNCTION_CALL)||"[]")+".slice().reverse()",W.FUNCTION_CALL]},E=function(N,j){var ge=0;let xe="";j.STATEMENT_PREFIX&&(xe+=j.injectId(j.STATEMENT_PREFIX,N));do{const Ke=j.valueToCode(N,"IF"+ge,W.NONE)||"false";let gt=j.statementToCode(N,"DO"+ge);j.STATEMENT_SUFFIX&&(gt=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,N),j.INDENT)+gt),xe+=(0<ge?" else ":"")+"if ("+Ke+`) {
`+gt+"}",ge++}while(N.getInput("IF"+ge));return(N.getInput("ELSE")||j.STATEMENT_SUFFIX)&&(ge=j.statementToCode(N,"ELSE"),j.STATEMENT_SUFFIX&&(ge=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,N),j.INDENT)+ge),xe+=` else {
`+ge+"}"),xe+`
`},S=function(N,j){const ge={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[N.getFieldValue("OP")],xe=ge==="=="||ge==="!="?W.EQUALITY:W.RELATIONAL,Ke=j.valueToCode(N,"A",xe)||"0";return N=j.valueToCode(N,"B",xe)||"0",[Ke+" "+ge+" "+N,xe]},A=function(N,j){const ge=N.getFieldValue("OP")==="AND"?"&&":"||",xe=ge==="&&"?W.LOGICAL_AND:W.LOGICAL_OR;let Ke=j.valueToCode(N,"A",xe);return N=j.valueToCode(N,"B",xe),Ke||N?(j=ge==="&&"?"true":"false",Ke||(Ke=j),N||(N=j)):N=Ke="false",[Ke+" "+ge+" "+N,xe]},C=function(N,j){const ge=W.LOGICAL_NOT;return["!"+(j.valueToCode(N,"BOOL",ge)||"true"),ge]},x=function(N,j){return[N.getFieldValue("BOOL")==="TRUE"?"true":"false",W.ATOMIC]},I=function(N,j){return["null",W.ATOMIC]},O=function(N,j){const ge=j.valueToCode(N,"IF",W.CONDITIONAL)||"false",xe=j.valueToCode(N,"THEN",W.CONDITIONAL)||"null";return N=j.valueToCode(N,"ELSE",W.CONDITIONAL)||"null",[ge+" ? "+xe+" : "+N,W.CONDITIONAL]},F=function(N,j){let ge;ge=N.getField("TIMES")?String(Number(N.getFieldValue("TIMES"))):j.valueToCode(N,"TIMES",W.ASSIGNMENT)||"0";let xe=j.statementToCode(N,"DO");xe=j.addLoopTrap(xe,N),N="";const Ke=j.nameDB_.getDistinctName("count",r.NameType$$module$build$src$core$names.VARIABLE);let gt=ge;return ge.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(ge)||(gt=j.nameDB_.getDistinctName("repeat_end",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+gt+" = "+ge+`;
`),N+("for (var "+Ke+" = 0; "+Ke+" < "+gt+"; "+Ke+`++) {
`+xe+`}
`)},k=function(N,j){const ge=N.getFieldValue("MODE")==="UNTIL";let xe=j.valueToCode(N,"BOOL",ge?W.LOGICAL_NOT:W.NONE)||"false",Ke=j.statementToCode(N,"DO");return Ke=j.addLoopTrap(Ke,N),ge&&(xe="!"+xe),"while ("+xe+`) {
`+Ke+`}
`},D=function(N,j){var ge=j.getVariableName(N.getFieldValue("VAR")),xe=j.valueToCode(N,"FROM",W.ASSIGNMENT)||"0",Ke=j.valueToCode(N,"TO",W.ASSIGNMENT)||"0";const gt=j.valueToCode(N,"BY",W.ASSIGNMENT)||"1";let $t=j.statementToCode(N,"DO");if($t=j.addLoopTrap($t,N),r.isNumber$$module$build$src$core$utils$string(xe)&&r.isNumber$$module$build$src$core$utils$string(Ke)&&r.isNumber$$module$build$src$core$utils$string(gt))j=Number(xe)<=Number(Ke),N="for ("+ge+" = "+xe+"; "+ge+(j?" <= ":" >= ")+Ke+"; "+ge,ge=Math.abs(Number(gt)),N=ge===1?N+(j?"++":"--"):N+((j?" += ":" -= ")+ge),N+=`) {
`+$t+`}
`;else{N="";let un=xe;xe.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(xe)||(un=j.nameDB_.getDistinctName(ge+"_start",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+un+" = "+xe+`;
`),xe=Ke,Ke.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(Ke)||(xe=j.nameDB_.getDistinctName(ge+"_end",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+xe+" = "+Ke+`;
`),Ke=j.nameDB_.getDistinctName(ge+"_inc",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+Ke+" = ",N=r.isNumber$$module$build$src$core$utils$string(gt)?N+(Math.abs(Number(gt))+`;
`):N+("Math.abs("+gt+`);
`),N+="if ("+un+" > "+xe+`) {
`,N+=j.INDENT+Ke+" = -"+Ke+`;
`,N=N+`}
for (`+(ge+" = "+un+"; "+Ke+" >= 0 ? "+ge+" <= "+xe+" : "+ge+" >= "+xe+"; "+ge+" += "+Ke+`) {
`+$t+`}
`)}return N},U=function(N,j){const ge=j.getVariableName(N.getFieldValue("VAR"));var xe=j.valueToCode(N,"LIST",W.ASSIGNMENT)||"[]";let Ke=j.statementToCode(N,"DO");Ke=j.addLoopTrap(Ke,N),N="";let gt=xe;return xe.match(/^\w+$/)||(gt=j.nameDB_.getDistinctName(ge+"_list",r.NameType$$module$build$src$core$names.VARIABLE),N+="var "+gt+" = "+xe+`;
`),xe=j.nameDB_.getDistinctName(ge+"_index",r.NameType$$module$build$src$core$names.VARIABLE),Ke=j.INDENT+ge+" = "+gt+"["+xe+`];
`+Ke,N+("for (var "+xe+" in "+gt+`) {
`+Ke+`}
`)},ce=function(N,j){let ge="";if(j.STATEMENT_PREFIX&&(ge+=j.injectId(j.STATEMENT_PREFIX,N)),j.STATEMENT_SUFFIX&&(ge+=j.injectId(j.STATEMENT_SUFFIX,N)),j.STATEMENT_PREFIX){const xe=N.getSurroundLoop();xe&&!xe.suppressPrefixSuffix&&(ge+=j.injectId(j.STATEMENT_PREFIX,xe))}switch(N.getFieldValue("FLOW")){case"BREAK":return ge+`break;
`;case"CONTINUE":return ge+`continue;
`}throw Error("Unknown flow statement.")},re=function(N,j){return N=Number(N.getFieldValue("NUM")),[String(N),0<=N?W.ATOMIC:W.UNARY_NEGATION]},ae=function(N,j){var ge={ADD:[" + ",W.ADDITION],MINUS:[" - ",W.SUBTRACTION],MULTIPLY:[" * ",W.MULTIPLICATION],DIVIDE:[" / ",W.DIVISION],POWER:[null,W.NONE]}[N.getFieldValue("OP")];const xe=ge[0];ge=ge[1];const Ke=j.valueToCode(N,"A",ge)||"0";return N=j.valueToCode(N,"B",ge)||"0",xe?[Ke+xe+N,ge]:["Math.pow("+Ke+", "+N+")",W.FUNCTION_CALL]},ne=function(N,j){const ge=N.getFieldValue("OP");let xe;if(ge==="NEG")return N=j.valueToCode(N,"NUM",W.UNARY_NEGATION)||"0",N[0]==="-"&&(N=" "+N),["-"+N,W.UNARY_NEGATION];switch(N=ge==="SIN"||ge==="COS"||ge==="TAN"?j.valueToCode(N,"NUM",W.DIVISION)||"0":j.valueToCode(N,"NUM",W.NONE)||"0",ge){case"ABS":xe="Math.abs("+N+")";break;case"ROOT":xe="Math.sqrt("+N+")";break;case"LN":xe="Math.log("+N+")";break;case"EXP":xe="Math.exp("+N+")";break;case"POW10":xe="Math.pow(10,"+N+")";break;case"ROUND":xe="Math.round("+N+")";break;case"ROUNDUP":xe="Math.ceil("+N+")";break;case"ROUNDDOWN":xe="Math.floor("+N+")";break;case"SIN":xe="Math.sin("+N+" / 180 * Math.PI)";break;case"COS":xe="Math.cos("+N+" / 180 * Math.PI)";break;case"TAN":xe="Math.tan("+N+" / 180 * Math.PI)"}if(xe)return[xe,W.FUNCTION_CALL];switch(ge){case"LOG10":xe="Math.log("+N+") / Math.log(10)";break;case"ASIN":xe="Math.asin("+N+") / Math.PI * 180";break;case"ACOS":xe="Math.acos("+N+") / Math.PI * 180";break;case"ATAN":xe="Math.atan("+N+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+ge)}return[xe,W.DIVISION]},de=function(N,j){return{PI:["Math.PI",W.MEMBER],E:["Math.E",W.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",W.DIVISION],SQRT2:["Math.SQRT2",W.MEMBER],SQRT1_2:["Math.SQRT1_2",W.MEMBER],INFINITY:["Infinity",W.ATOMIC]}[N.getFieldValue("CONSTANT")]},ue=function(N,j){var ge={EVEN:[" % 2 === 0",W.MODULUS,W.EQUALITY],ODD:[" % 2 === 1",W.MODULUS,W.EQUALITY],WHOLE:[" % 1 === 0",W.MODULUS,W.EQUALITY],POSITIVE:[" > 0",W.RELATIONAL,W.RELATIONAL],NEGATIVE:[" < 0",W.RELATIONAL,W.RELATIONAL],DIVISIBLE_BY:[null,W.MODULUS,W.EQUALITY],PRIME:[null,W.NONE,W.FUNCTION_CALL]};const xe=N.getFieldValue("PROPERTY"),[Ke,gt,$t]=ge[xe];return ge=j.valueToCode(N,"NUMBER_TO_CHECK",gt)||"0",xe==="PRIME"?N=j.provideFunction_("mathIsPrime",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+ge+")":xe==="DIVISIBLE_BY"?(N=j.valueToCode(N,"DIVISOR",W.MODULUS)||"0",N=ge+" % "+N+" === 0"):N=ge+Ke,[N,$t]},Re=function(N,j){const ge=j.valueToCode(N,"DELTA",W.ADDITION)||"0";return N=j.getVariableName(N.getFieldValue("VAR")),N+" = (typeof "+N+" === 'number' ? "+N+" : 0) + "+ge+`;
`},G=function(N,j){var ge=N.getFieldValue("OP");switch(ge){case"SUM":N=j.valueToCode(N,"LIST",W.MEMBER)||"[]",N+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":N=j.valueToCode(N,"LIST",W.NONE)||"[]",N="Math.min.apply(null, "+N+")";break;case"MAX":N=j.valueToCode(N,"LIST",W.NONE)||"[]",N="Math.max.apply(null, "+N+")";break;case"AVERAGE":ge=j.provideFunction_("mathMean",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),N=j.valueToCode(N,"LIST",W.NONE)||"[]",N=ge+"("+N+")";break;case"MEDIAN":ge=j.provideFunction_("mathMedian",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),N=j.valueToCode(N,"LIST",W.NONE)||"[]",N=ge+"("+N+")";break;case"MODE":ge=j.provideFunction_("mathModes",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
      modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),N=j.valueToCode(N,"LIST",W.NONE)||"[]",N=ge+"("+N+")";break;case"STD_DEV":ge=j.provideFunction_("mathStandardDeviation",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance /= n;
  return Math.sqrt(variance);
}
`),N=j.valueToCode(N,"LIST",W.NONE)||"[]",N=ge+"("+N+")";break;case"RANDOM":ge=j.provideFunction_("mathRandomList",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),N=j.valueToCode(N,"LIST",W.NONE)||"[]",N=ge+"("+N+")";break;default:throw Error("Unknown operator: "+ge)}return[N,W.FUNCTION_CALL]},Z=function(N,j){const ge=j.valueToCode(N,"DIVIDEND",W.MODULUS)||"0";return N=j.valueToCode(N,"DIVISOR",W.MODULUS)||"0",[ge+" % "+N,W.MODULUS]},K=function(N,j){const ge=j.valueToCode(N,"VALUE",W.NONE)||"0",xe=j.valueToCode(N,"LOW",W.NONE)||"0";return N=j.valueToCode(N,"HIGH",W.NONE)||"Infinity",["Math.min(Math.max("+ge+", "+xe+"), "+N+")",W.FUNCTION_CALL]},se=function(N,j){const ge=j.valueToCode(N,"FROM",W.NONE)||"0";return N=j.valueToCode(N,"TO",W.NONE)||"0",[j.provideFunction_("mathRandomInt",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+ge+", "+N+")",W.FUNCTION_CALL]},Y=function(N,j){return["Math.random()",W.FUNCTION_CALL]},me=function(N,j){const ge=j.valueToCode(N,"X",W.NONE)||"0";return["Math.atan2("+(j.valueToCode(N,"Y",W.NONE)||"0")+", "+ge+") / Math.PI * 180",W.DIVISION]},fe=function(N,j){const ge=j.getProcedureName(N.getFieldValue("NAME"));var xe="";j.STATEMENT_PREFIX&&(xe+=j.injectId(j.STATEMENT_PREFIX,N)),j.STATEMENT_SUFFIX&&(xe+=j.injectId(j.STATEMENT_SUFFIX,N)),xe&&(xe=j.prefixLines(xe,j.INDENT));let Ke="";j.INFINITE_LOOP_TRAP&&(Ke=j.prefixLines(j.injectId(j.INFINITE_LOOP_TRAP,N),j.INDENT));let gt="";N.getInput("STACK")&&(gt=j.statementToCode(N,"STACK"));let $t="";N.getInput("RETURN")&&($t=j.valueToCode(N,"RETURN",W.NONE)||"");let un="";gt&&$t&&(un=xe),$t&&($t=j.INDENT+"return "+$t+`;
`);const an=[],ei=N.getVars();for(let fi=0;fi<ei.length;fi++)an[fi]=j.getVariableName(ei[fi]);return xe="function "+ge+"("+an.join(", ")+`) {
`+xe+Ke+gt+un+$t+"}",xe=j.scrub_(N,xe),j.definitions_["%"+ge]=xe,null},Ae=function(N,j){const ge=j.getProcedureName(N.getFieldValue("NAME")),xe=[],Ke=N.getVars();for(let gt=0;gt<Ke.length;gt++)xe[gt]=j.valueToCode(N,"ARG"+gt,W.NONE)||"null";return[ge+"("+xe.join(", ")+")",W.FUNCTION_CALL]},Ce=function(N,j){return j.forBlock.procedures_callreturn(N,j)[0]+`;
`},Ie=function(N,j){let ge="if ("+(j.valueToCode(N,"CONDITION",W.NONE)||"false")+`) {
`;return j.STATEMENT_SUFFIX&&(ge+=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,N),j.INDENT)),N.hasReturnValue_?(N=j.valueToCode(N,"VALUE",W.NONE)||"null",ge+=j.INDENT+"return "+N+`;
`):ge+=j.INDENT+`return;
`,ge+`}
`},We=function(N,j){return[j.quote_(N.getFieldValue("TEXT")),W.ATOMIC]},ut=function(N,j){switch(N.itemCount_){case 0:return["''",W.ATOMIC];case 1:return N=j.valueToCode(N,"ADD0",W.NONE)||"''",X(N);case 2:var ge=j.valueToCode(N,"ADD0",W.NONE)||"''";return N=j.valueToCode(N,"ADD1",W.NONE)||"''",[X(ge)[0]+" + "+X(N)[0],W.ADDITION];default:ge=Array(N.itemCount_);for(let xe=0;xe<N.itemCount_;xe++)ge[xe]=j.valueToCode(N,"ADD"+xe,W.NONE)||"''";return["["+ge.join(",")+"].join('')",W.FUNCTION_CALL]}},Ye=function(N,j){const ge=j.getVariableName(N.getFieldValue("VAR"));return N=j.valueToCode(N,"TEXT",W.NONE)||"''",ge+" += "+X(N)[0]+`;
`},we=function(N,j){return[(j.valueToCode(N,"VALUE",W.MEMBER)||"''")+".length",W.MEMBER]},Q=function(N,j){return["!"+(j.valueToCode(N,"VALUE",W.MEMBER)||"''")+".length",W.LOGICAL_NOT]},Ge=function(N,j){const ge=N.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",xe=j.valueToCode(N,"FIND",W.NONE)||"''";return j=(j.valueToCode(N,"VALUE",W.MEMBER)||"''")+"."+ge+"("+xe+")",N.workspace.options.oneBasedIndex?[j+" + 1",W.ADDITION]:[j,W.FUNCTION_CALL]},Oe=function(N,j){const ge=N.getFieldValue("WHERE")||"FROM_START",xe=j.valueToCode(N,"VALUE",ge==="RANDOM"?W.NONE:W.MEMBER)||"''";switch(ge){case"FIRST":return[xe+".charAt(0)",W.FUNCTION_CALL];case"LAST":return[xe+".slice(-1)",W.FUNCTION_CALL];case"FROM_START":return N=j.getAdjusted(N,"AT"),[xe+".charAt("+N+")",W.FUNCTION_CALL];case"FROM_END":return N=j.getAdjusted(N,"AT",1,!0),[xe+".slice("+N+").charAt(0)",W.FUNCTION_CALL];case"RANDOM":return[j.provideFunction_("textRandomLetter",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+xe+")",W.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},Ve=function(N,j){var ge={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const xe=N.getFieldValue("WHERE1"),Ke=N.getFieldValue("WHERE2");var gt=xe!=="FROM_END"&&xe!=="LAST"&&Ke!=="FROM_END"&&Ke!=="LAST",$t=j.valueToCode(N,"STRING",gt?W.MEMBER:W.NONE)||"''";if(xe==="FIRST"&&Ke==="LAST")return[$t,W.NONE];if($t.match(/^'?\w+'?$/)||gt){switch(xe){case"FROM_START":ge=j.getAdjusted(N,"AT1");break;case"FROM_END":ge=j.getAdjusted(N,"AT1",1,!1,W.SUBTRACTION),ge=$t+".length - "+ge;break;case"FIRST":ge="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(Ke){case"FROM_START":j=j.getAdjusted(N,"AT2",1);break;case"FROM_END":j=j.getAdjusted(N,"AT2",0,!1,W.SUBTRACTION),j=$t+".length - "+j;break;case"LAST":j=$t+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}$t=$t+".slice("+ge+", "+j+")"}else gt=j.getAdjusted(N,"AT1"),N=j.getAdjusted(N,"AT2"),$t=j.provideFunction_("subsequence"+ge[xe]+ge[Ke],`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(sequence${xe==="FROM_END"||xe==="FROM_START"?", at1":""}${Ke==="FROM_END"||Ke==="FROM_START"?", at2":""}) {
  var start = ${he("sequence",xe,"at1")};
  var end = ${he("sequence",Ke,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+$t+(xe==="FROM_END"||xe==="FROM_START"?", "+gt:"")+(Ke==="FROM_END"||Ke==="FROM_START"?", "+N:"")+")";return[$t,W.FUNCTION_CALL]},Fe=function(N,j){const ge={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[N.getFieldValue("CASE")];return N=j.valueToCode(N,"TEXT",ge?W.MEMBER:W.NONE)||"''",[ge?N+ge:j.provideFunction_("textToTitleCase",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+N+")",W.FUNCTION_CALL]},tt=function(N,j){const ge={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[N.getFieldValue("MODE")];return[(j.valueToCode(N,"TEXT",W.MEMBER)||"''")+ge,W.FUNCTION_CALL]},Ue=function(N,j){return"window.alert("+(j.valueToCode(N,"TEXT",W.NONE)||"''")+`);
`},Je=function(N,j){return j="window.prompt("+(N.getField("TEXT")?j.quote_(N.getFieldValue("TEXT")):j.valueToCode(N,"TEXT",W.NONE)||"''")+")",N.getFieldValue("TYPE")==="NUMBER"&&(j="Number("+j+")"),[j,W.FUNCTION_CALL]},ve=function(N,j){const ge=j.valueToCode(N,"TEXT",W.NONE)||"''";return N=j.valueToCode(N,"SUB",W.NONE)||"''",[j.provideFunction_("textCount",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+ge+", "+N+")",W.FUNCTION_CALL]},Me=function(N,j){const ge=j.valueToCode(N,"TEXT",W.NONE)||"''",xe=j.valueToCode(N,"FROM",W.NONE)||"''";return N=j.valueToCode(N,"TO",W.NONE)||"''",[j.provideFunction_("textReplace",`
function ${j.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+ge+", "+xe+", "+N+")",W.FUNCTION_CALL]},vt=function(N,j){return[(j.valueToCode(N,"TEXT",W.MEMBER)||"''")+".split('').reverse().join('')",W.FUNCTION_CALL]},oe=function(N,j){return[j.getVariableName(N.getFieldValue("VAR")),W.ATOMIC]},ee=function(N,j){const ge=j.valueToCode(N,"VALUE",W.ASSIGNMENT)||"0";return j.getVariableName(N.getFieldValue("VAR"))+" = "+ge+`;
`},W;(function(N){N[N.ATOMIC=0]="ATOMIC",N[N.NEW=1.1]="NEW",N[N.MEMBER=1.2]="MEMBER",N[N.FUNCTION_CALL=2]="FUNCTION_CALL",N[N.INCREMENT=3]="INCREMENT",N[N.DECREMENT=3]="DECREMENT",N[N.BITWISE_NOT=4.1]="BITWISE_NOT",N[N.UNARY_PLUS=4.2]="UNARY_PLUS",N[N.UNARY_NEGATION=4.3]="UNARY_NEGATION",N[N.LOGICAL_NOT=4.4]="LOGICAL_NOT",N[N.TYPEOF=4.5]="TYPEOF",N[N.VOID=4.6]="VOID",N[N.DELETE=4.7]="DELETE",N[N.AWAIT=4.8]="AWAIT",N[N.EXPONENTIATION=5]="EXPONENTIATION",N[N.MULTIPLICATION=5.1]="MULTIPLICATION",N[N.DIVISION=5.2]="DIVISION",N[N.MODULUS=5.3]="MODULUS",N[N.SUBTRACTION=6.1]="SUBTRACTION",N[N.ADDITION=6.2]="ADDITION",N[N.BITWISE_SHIFT=7]="BITWISE_SHIFT",N[N.RELATIONAL=8]="RELATIONAL",N[N.IN=8]="IN",N[N.INSTANCEOF=8]="INSTANCEOF",N[N.EQUALITY=9]="EQUALITY",N[N.BITWISE_AND=10]="BITWISE_AND",N[N.BITWISE_XOR=11]="BITWISE_XOR",N[N.BITWISE_OR=12]="BITWISE_OR",N[N.LOGICAL_AND=13]="LOGICAL_AND",N[N.LOGICAL_OR=14]="LOGICAL_OR",N[N.CONDITIONAL=15]="CONDITIONAL",N[N.ASSIGNMENT=16]="ASSIGNMENT",N[N.YIELD=17]="YIELD",N[N.COMMA=18]="COMMA",N[N.NONE=99]="NONE"})(W||(W={}));var ot=class extends r.CodeGenerator$$module$build$src$core$generator{constructor(N="JavaScript"){super(N),this.ORDER_OVERRIDES=[[W.FUNCTION_CALL,W.MEMBER],[W.FUNCTION_CALL,W.FUNCTION_CALL],[W.MEMBER,W.MEMBER],[W.MEMBER,W.FUNCTION_CALL],[W.LOGICAL_NOT,W.LOGICAL_NOT],[W.MULTIPLICATION,W.MULTIPLICATION],[W.ADDITION,W.ADDITION],[W.LOGICAL_AND,W.LOGICAL_AND],[W.LOGICAL_OR,W.LOGICAL_OR]],this.isInitialized=!1;for(const j in W)N=W[j],typeof N!="string"&&(this["ORDER_"+j]=N);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(N){super.init(N),this.nameDB_?this.nameDB_.reset():this.nameDB_=new r.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(N.getVariableMap()),this.nameDB_.populateVariables(N),this.nameDB_.populateProcedures(N);const j=[];var ge=r.allDeveloperVariables$$module$build$src$core$variables(N);for(let xe=0;xe<ge.length;xe++)j.push(this.nameDB_.getName(ge[xe],r.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(N=r.allUsedVarModels$$module$build$src$core$variables(N),ge=0;ge<N.length;ge++)j.push(this.nameDB_.getName(N[ge].getId(),r.NameType$$module$build$src$core$names.VARIABLE));j.length&&(this.definitions_.variables="var "+j.join(", ")+";"),this.isInitialized=!0}finish(N){const j=Object.values(this.definitions_);return super.finish(N),this.isInitialized=!1,this.nameDB_.reset(),j.join(`

`)+`


`+N}scrubNakedValue(N){return N+`;
`}quote_(N){return N=N.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+N+"'"}multiline_quote_(N){return N.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)}scrub_(N,j,ge=!1){let xe="";if(!N.outputConnection||!N.outputConnection.targetConnection){var Ke=N.getCommentText();Ke&&(Ke=r.wrap$$module$build$src$core$utils$string(Ke,this.COMMENT_WRAP-3),xe+=this.prefixLines(Ke+`
`,"// "));for(let gt=0;gt<N.inputList.length;gt++)N.inputList[gt].type===r.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(Ke=N.inputList[gt].connection.targetBlock())&&(Ke=this.allNestedComments(Ke))&&(xe+=this.prefixLines(Ke,"// "))}return N=N.nextConnection&&N.nextConnection.targetBlock(),ge=ge?"":this.blockToCode(N),xe+j+ge}getAdjusted(N,j,ge=0,xe=!1,Ke=W.NONE){N.workspace.options.oneBasedIndex&&ge--;const gt=N.workspace.options.oneBasedIndex?"1":"0";let $t=Ke;return 0<ge?$t=W.ADDITION:0>ge?$t=W.SUBTRACTION:xe&&($t=W.UNARY_NEGATION),N=this.valueToCode(N,j,$t)||gt,ge===0&&!xe?N:r.isNumber$$module$build$src$core$utils$string(N)?(N=String(Number(N)+ge),xe&&(N=String(-Number(N))),N):(0<ge?N=`${N} + ${ge}`:0>ge&&(N=`${N} - ${-ge}`),xe&&(N=ge?`-(${N})`:`-${N}`),Math.floor(Ke)>=Math.floor($t)&&(N=`(${N})`),N)}},je=function(N,j,ge){return j==="FIRST"?"0":j==="FROM_END"?N+".length - 1 - "+ge:j==="LAST"?N+".length - 1":ge},Qe={};Qe.lists_create_empty=s,Qe.lists_create_with=a,Qe.lists_getIndex=f,Qe.lists_getSublist=m,Qe.lists_indexOf=h,Qe.lists_isEmpty=d,Qe.lists_length=u,Qe.lists_repeat=l,Qe.lists_reverse=$,Qe.lists_setIndex=p,Qe.lists_sort=v,Qe.lists_split=y;var ht={};ht.controls_if=E,ht.controls_ifelse=E,ht.logic_boolean=x,ht.logic_compare=S,ht.logic_negate=C,ht.logic_null=I,ht.logic_operation=A,ht.logic_ternary=O;var ft={};ft.controls_flow_statements=ce,ft.controls_for=D,ft.controls_forEach=U,ft.controls_repeat=F,ft.controls_repeat_ext=F,ft.controls_whileUntil=k;var He={};He.math_arithmetic=ae,He.math_atan2=me,He.math_change=Re,He.math_constant=de,He.math_constrain=K,He.math_modulo=Z,He.math_number=re,He.math_number_property=ue,He.math_on_list=G,He.math_random_float=Y,He.math_random_int=se,He.math_round=ne,He.math_single=ne,He.math_trig=ne;var St={};St.procedures_callnoreturn=Ce,St.procedures_callreturn=Ae,St.procedures_defnoreturn=fe,St.procedures_defreturn=fe,St.procedures_ifreturn=Ie;var L=/^\s*'([^']|\\')*'\s*$/,X=function(N){return L.test(N)?[N,W.ATOMIC]:["String("+N+")",W.FUNCTION_CALL]},he=function(N,j,ge){return j==="FIRST"?"0":j==="FROM_END"?N+".length - 1 - "+ge:j==="LAST"?N+".length - 1":ge},z={};z.text=We,z.text_append=Ye,z.text_changeCase=Fe,z.text_charAt=Oe,z.text_count=ve,z.text_getSubstring=Ve,z.text_indexOf=Ge,z.text_isEmpty=Q,z.text_join=ut,z.text_length=we,z.text_print=Ue,z.text_prompt=Je,z.text_prompt_ext=Je,z.text_replace=Me,z.text_reverse=vt,z.text_trim=tt;var be={};be.variables_get=oe,be.variables_set=ee;var nt={};nt.variables_get_dynamic=oe,nt.variables_set_dynamic=ee;var Ee=new ot,Le=Object.assign({},Qe,ht,ft,He,St,z,be,nt);for(const N in Le)Ee.forBlock[N]=Le[N];var Be={};return Be.JavascriptGenerator=ot,Be.Order=W,Be.javascriptGenerator=Ee,Be.__namespace__=r,Be})})(C2);var rJ=C2.exports;const sJ=pd(rJ),{JavascriptGenerator:mue,Order:gue,javascriptGenerator:Pn}=sJ;var oJ=cI();const aJ=pd(oJ),{ASTNode:lJ,BasicCursor:cJ,Block:uJ,BlockSvg:hJ,Blocks:dJ,COLLAPSED_FIELD_NAME:fJ,COLLAPSED_INPUT_NAME:pJ,COLLAPSE_CHARS:mJ,CodeGenerator:gJ,CollapsibleToolboxCategory:_J,ComponentManager:TJ,Connection:vJ,ConnectionChecker:EJ,ConnectionDB:yJ,ConnectionType:SJ,ContextMenu:$J,ContextMenuItems:bJ,ContextMenuRegistry:AJ,Css:CJ,Cursor:RJ,DELETE_VARIABLE_ID:xJ,DeleteArea:wJ,DragTarget:MJ,DropDownDiv:IJ,Events:OJ,Extensions:LJ,Field:NJ,FieldCheckbox:kJ,FieldDropdown:PJ,FieldImage:DJ,FieldLabel:BJ,FieldLabelSerializable:FJ,FieldNumber:UJ,FieldTextInput:GJ,FieldVariable:HJ,Flyout:VJ,FlyoutButton:zJ,FlyoutMetricsManager:WJ,Generator:XJ,Gesture:jJ,Grid:YJ,HorizontalFlyout:KJ,INPUT_VALUE:JJ,Input:ZJ,InsertionMarkerManager:qJ,InsertionMarkerPreviewer:QJ,Marker:eZ,MarkerManager:tZ,Menu:nZ,MenuItem:iZ,MetricsManager:rZ,Msg:sZ,NEXT_STATEMENT:oZ,Names:aZ,OPPOSITE_TYPE:lZ,OUTPUT_VALUE:cZ,Options:uZ,PREVIOUS_STATEMENT:hZ,PROCEDURE_CATEGORY_NAME:dZ,Procedures:fZ,RENAME_VARIABLE_ID:pZ,RenderedConnection:mZ,Scrollbar:gZ,ScrollbarPair:_Z,ShortcutItems:TZ,ShortcutRegistry:vZ,TOOLBOX_AT_BOTTOM:EZ,TOOLBOX_AT_LEFT:yZ,TOOLBOX_AT_RIGHT:SZ,TOOLBOX_AT_TOP:$Z,TabNavigateCursor:bZ,Theme:R2,ThemeManager:AZ,Themes:x2,Toolbox:CZ,ToolboxCategory:RZ,ToolboxItem:xZ,ToolboxSeparator:wZ,Tooltip:MZ,Touch:IZ,Trashcan:OZ,UnattachedFieldError:LZ,VARIABLE_CATEGORY_NAME:NZ,VARIABLE_DYNAMIC_CATEGORY_NAME:kZ,VERSION:PZ,VariableMap:DZ,VariableModel:BZ,Variables:FZ,VariablesDynamic:UZ,VerticalFlyout:GZ,WidgetDiv:HZ,Workspace:VZ,WorkspaceAudio:zZ,WorkspaceDragger:WZ,WorkspaceSvg:XZ,Xml:jZ,ZoomControls:YZ,blockAnimations:KZ,blockRendering:JZ,browserEvents:ZZ,bubbles:qZ,bumpObjects:QZ,clipboard:eq,comments:tq,common:nq,config:iq,constants:rq,defineBlocksWithJsonArray:sq,dialog:oq,dragging:aq,fieldRegistry:lq,geras:cq,getMainWorkspace:cg,getSelected:uq,hasBubble:hq,hideChaff:dq,icons:fq,inject:w2,inputs:pq,isCopyable:mq,isDeletable:gq,isDraggable:_q,isIcon:Tq,isObservable:vq,isPaster:Eq,isRenderedElement:yq,isSelectable:Sq,isSerializable:$q,isVariableBackedParameterModel:bq,procedures:Aq,registry:Cq,renderManagement:Rq,serialization:xq,setLocale:M2,setParentContainer:wq,svgResize:Mq,thrasos:Iq,uiPosition:Oq,utils:Lq,zelos:Nq}=aJ,kq=Object.freeze(Object.defineProperty({__proto__:null,ASTNode:lJ,BasicCursor:cJ,Block:uJ,BlockSvg:hJ,Blocks:dJ,COLLAPSED_FIELD_NAME:fJ,COLLAPSED_INPUT_NAME:pJ,COLLAPSE_CHARS:mJ,CodeGenerator:gJ,CollapsibleToolboxCategory:_J,ComponentManager:TJ,Connection:vJ,ConnectionChecker:EJ,ConnectionDB:yJ,ConnectionType:SJ,ContextMenu:$J,ContextMenuItems:bJ,ContextMenuRegistry:AJ,Css:CJ,Cursor:RJ,DELETE_VARIABLE_ID:xJ,DeleteArea:wJ,DragTarget:MJ,DropDownDiv:IJ,Events:OJ,Extensions:LJ,Field:NJ,FieldCheckbox:kJ,FieldDropdown:PJ,FieldImage:DJ,FieldLabel:BJ,FieldLabelSerializable:FJ,FieldNumber:UJ,FieldTextInput:GJ,FieldVariable:HJ,Flyout:VJ,FlyoutButton:zJ,FlyoutMetricsManager:WJ,Generator:XJ,Gesture:jJ,Grid:YJ,HorizontalFlyout:KJ,INPUT_VALUE:JJ,Input:ZJ,InsertionMarkerManager:qJ,InsertionMarkerPreviewer:QJ,Marker:eZ,MarkerManager:tZ,Menu:nZ,MenuItem:iZ,MetricsManager:rZ,Msg:sZ,NEXT_STATEMENT:oZ,Names:aZ,OPPOSITE_TYPE:lZ,OUTPUT_VALUE:cZ,Options:uZ,PREVIOUS_STATEMENT:hZ,PROCEDURE_CATEGORY_NAME:dZ,Procedures:fZ,RENAME_VARIABLE_ID:pZ,RenderedConnection:mZ,Scrollbar:gZ,ScrollbarPair:_Z,ShortcutItems:TZ,ShortcutRegistry:vZ,TOOLBOX_AT_BOTTOM:EZ,TOOLBOX_AT_LEFT:yZ,TOOLBOX_AT_RIGHT:SZ,TOOLBOX_AT_TOP:$Z,TabNavigateCursor:bZ,Theme:R2,ThemeManager:AZ,Themes:x2,Toolbox:CZ,ToolboxCategory:RZ,ToolboxItem:xZ,ToolboxSeparator:wZ,Tooltip:MZ,Touch:IZ,Trashcan:OZ,UnattachedFieldError:LZ,VARIABLE_CATEGORY_NAME:NZ,VARIABLE_DYNAMIC_CATEGORY_NAME:kZ,VERSION:PZ,VariableMap:DZ,VariableModel:BZ,Variables:FZ,VariablesDynamic:UZ,VerticalFlyout:GZ,WidgetDiv:HZ,Workspace:VZ,WorkspaceAudio:zZ,WorkspaceDragger:WZ,WorkspaceSvg:XZ,Xml:jZ,ZoomControls:YZ,blockAnimations:KZ,blockRendering:JZ,browserEvents:ZZ,bubbles:qZ,bumpObjects:QZ,clipboard:eq,comments:tq,common:nq,config:iq,constants:rq,defineBlocksWithJsonArray:sq,dialog:oq,dragging:aq,fieldRegistry:lq,geras:cq,getMainWorkspace:cg,getSelected:uq,hasBubble:hq,hideChaff:dq,icons:fq,inject:w2,inputs:pq,isCopyable:mq,isDeletable:gq,isDraggable:_q,isIcon:Tq,isObservable:vq,isPaster:Eq,isRenderedElement:yq,isSelectable:Sq,isSerializable:$q,isVariableBackedParameterModel:bq,procedures:Aq,registry:Cq,renderManagement:Rq,serialization:xq,setLocale:M2,setParentContainer:wq,svgResize:Mq,thrasos:Iq,uiPosition:Oq,utils:Lq,zelos:Nq},Symbol.toStringTag,{value:"Module"}));var I2={exports:{}};(function(i,e){(function(n,r){i.exports=r()})(tp,function(){var n=n||{Msg:Object.create(null)};return n.Msg.ADD_COMMENT="Add Comment",n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",n.Msg.CHANGE_VALUE_TITLE="Change value:",n.Msg.CLEAN_UP="Clean up Blocks",n.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",n.Msg.COLLAPSE_ALL="Collapse Blocks",n.Msg.COLLAPSE_BLOCK="Collapse Block",n.Msg.COLOUR_BLEND_COLOUR1="colour 1",n.Msg.COLOUR_BLEND_COLOUR2="colour 2",n.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",n.Msg.COLOUR_BLEND_RATIO="ratio",n.Msg.COLOUR_BLEND_TITLE="blend",n.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",n.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",n.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",n.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",n.Msg.COLOUR_RANDOM_TITLE="random colour",n.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",n.Msg.COLOUR_RGB_BLUE="blue",n.Msg.COLOUR_RGB_GREEN="green",n.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",n.Msg.COLOUR_RGB_RED="red",n.Msg.COLOUR_RGB_TITLE="colour with",n.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",n.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",n.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",n.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",n.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",n.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",n.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",n.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",n.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",n.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",n.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",n.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",n.Msg.CONTROLS_IF_MSG_ELSE="else",n.Msg.CONTROLS_IF_MSG_ELSEIF="else if",n.Msg.CONTROLS_IF_MSG_IF="if",n.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",n.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",n.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",n.Msg.CONTROLS_REPEAT_INPUT_DO="do",n.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",n.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",n.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",n.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",n.Msg.DELETE_BLOCK="Delete Block",n.Msg.DELETE_VARIABLE="Delete the '%1' variable",n.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",n.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",n.Msg.DIALOG_CANCEL="Cancel",n.Msg.DIALOG_OK="OK",n.Msg.DISABLE_BLOCK="Disable Block",n.Msg.DUPLICATE_BLOCK="Duplicate",n.Msg.DUPLICATE_COMMENT="Duplicate Comment",n.Msg.ENABLE_BLOCK="Enable Block",n.Msg.EXPAND_ALL="Expand Blocks",n.Msg.EXPAND_BLOCK="Expand Block",n.Msg.EXTERNAL_INPUTS="External Inputs",n.Msg.HELP="Help",n.Msg.INLINE_INPUTS="Inline Inputs",n.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",n.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",n.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",n.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",n.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",n.Msg.LISTS_GET_INDEX_FIRST="first",n.Msg.LISTS_GET_INDEX_FROM_END="# from end",n.Msg.LISTS_GET_INDEX_FROM_START="#",n.Msg.LISTS_GET_INDEX_GET="get",n.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",n.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",n.Msg.LISTS_GET_INDEX_LAST="last",n.Msg.LISTS_GET_INDEX_RANDOM="random",n.Msg.LISTS_GET_INDEX_REMOVE="remove",n.Msg.LISTS_GET_INDEX_TAIL="",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",n.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",n.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",n.Msg.LISTS_GET_SUBLIST_END_LAST="to last",n.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",n.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",n.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",n.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",n.Msg.LISTS_GET_SUBLIST_TAIL="",n.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",n.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",n.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",n.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",n.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",n.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",n.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",n.Msg.LISTS_INLIST="in list",n.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",n.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",n.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",n.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",n.Msg.LISTS_LENGTH_TITLE="length of %1",n.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",n.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",n.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",n.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",n.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",n.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",n.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",n.Msg.LISTS_SET_INDEX_INPUT_TO="as",n.Msg.LISTS_SET_INDEX_INSERT="insert at",n.Msg.LISTS_SET_INDEX_SET="set",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",n.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",n.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",n.Msg.LISTS_SORT_ORDER_DESCENDING="descending",n.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",n.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",n.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",n.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",n.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",n.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",n.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",n.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",n.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",n.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",n.Msg.LOGIC_BOOLEAN_FALSE="false",n.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",n.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",n.Msg.LOGIC_BOOLEAN_TRUE="true",n.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",n.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",n.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",n.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",n.Msg.LOGIC_NEGATE_TITLE="not %1",n.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",n.Msg.LOGIC_NULL="null",n.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",n.Msg.LOGIC_NULL_TOOLTIP="Returns null.",n.Msg.LOGIC_OPERATION_AND="and",n.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",n.Msg.LOGIC_OPERATION_OR="or",n.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",n.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",n.Msg.LOGIC_TERNARY_CONDITION="test",n.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",n.Msg.LOGIC_TERNARY_IF_FALSE="if false",n.Msg.LOGIC_TERNARY_IF_TRUE="if true",n.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",n.Msg.MATH_ADDITION_SYMBOL="+",n.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",n.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",n.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",n.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",n.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",n.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",n.Msg.MATH_CHANGE_TITLE="change %1 by %2",n.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",n.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",n.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",n.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",n.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",n.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",n.Msg.MATH_DIVISION_SYMBOL="",n.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",n.Msg.MATH_IS_EVEN="is even",n.Msg.MATH_IS_NEGATIVE="is negative",n.Msg.MATH_IS_ODD="is odd",n.Msg.MATH_IS_POSITIVE="is positive",n.Msg.MATH_IS_PRIME="is prime",n.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",n.Msg.MATH_IS_WHOLE="is whole",n.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",n.Msg.MATH_MODULO_TITLE="remainder of %1  %2",n.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",n.Msg.MATH_MULTIPLICATION_SYMBOL="",n.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",n.Msg.MATH_NUMBER_TOOLTIP="A number.",n.Msg.MATH_ONLIST_HELPURL="",n.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",n.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",n.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",n.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",n.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",n.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",n.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",n.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",n.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",n.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",n.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",n.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",n.Msg.MATH_POWER_SYMBOL="^",n.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",n.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",n.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",n.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",n.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",n.Msg.MATH_ROUND_OPERATOR_ROUND="round",n.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",n.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",n.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",n.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",n.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",n.Msg.MATH_SINGLE_OP_ROOT="square root",n.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",n.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",n.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",n.Msg.MATH_SUBTRACTION_SYMBOL="-",n.Msg.MATH_TRIG_ACOS="acos",n.Msg.MATH_TRIG_ASIN="asin",n.Msg.MATH_TRIG_ATAN="atan",n.Msg.MATH_TRIG_COS="cos",n.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",n.Msg.MATH_TRIG_SIN="sin",n.Msg.MATH_TRIG_TAN="tan",n.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",n.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",n.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",n.Msg.NEW_NUMBER_VARIABLE="Create number variable...",n.Msg.NEW_STRING_VARIABLE="Create string variable...",n.Msg.NEW_VARIABLE="Create variable...",n.Msg.NEW_VARIABLE_TITLE="New variable name:",n.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",n.Msg.ORDINAL_NUMBER_SUFFIX="",n.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",n.Msg.PROCEDURES_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",n.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",n.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",n.Msg.PROCEDURES_CREATE_DO="Create '%1'",n.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",n.Msg.PROCEDURES_DEFNORETURN_DO="",n.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",n.Msg.PROCEDURES_DEFNORETURN_TITLE="to",n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",n.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFRETURN_RETURN="return",n.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",n.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",n.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",n.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",n.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",n.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",n.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",n.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",n.Msg.REDO="Redo",n.Msg.REMOVE_COMMENT="Remove Comment",n.Msg.RENAME_VARIABLE="Rename variable...",n.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",n.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_APPEND_TITLE="to %1 append text %2",n.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",n.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",n.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",n.Msg.TEXT_CHARAT_FIRST="get first letter",n.Msg.TEXT_CHARAT_FROM_END="get letter # from end",n.Msg.TEXT_CHARAT_FROM_START="get letter #",n.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",n.Msg.TEXT_CHARAT_LAST="get last letter",n.Msg.TEXT_CHARAT_RANDOM="get random letter",n.Msg.TEXT_CHARAT_TAIL="",n.Msg.TEXT_CHARAT_TITLE="in text %1 %2",n.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",n.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",n.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",n.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",n.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",n.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",n.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",n.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",n.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",n.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",n.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",n.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",n.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",n.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",n.Msg.TEXT_GET_SUBSTRING_TAIL="",n.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",n.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",n.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",n.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",n.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",n.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",n.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",n.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",n.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",n.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",n.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",n.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",n.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_LENGTH_TITLE="length of %1",n.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",n.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",n.Msg.TEXT_PRINT_TITLE="print %1",n.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",n.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",n.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",n.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",n.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",n.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",n.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",n.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",n.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",n.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",n.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",n.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",n.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",n.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",n.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",n.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",n.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",n.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",n.Msg.TODAY="Today",n.Msg.UNDO="Undo",n.Msg.UNNAMED_KEY="unnamed",n.Msg.VARIABLES_DEFAULT_NAME="item",n.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",n.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",n.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",n.Msg.VARIABLES_SET="set %1 to %2",n.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",n.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",n.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",n.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",n.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",n.Msg.CONTROLS_FOREACH_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_FOR_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=n.Msg.CONTROLS_IF_MSG_ELSEIF,n.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=n.Msg.CONTROLS_IF_MSG_ELSE,n.Msg.CONTROLS_IF_IF_TITLE_IF=n.Msg.CONTROLS_IF_MSG_IF,n.Msg.CONTROLS_IF_MSG_THEN=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.LISTS_CREATE_WITH_ITEM_TITLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.MATH_CHANGE_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.PROCEDURES_DEFRETURN_COMMENT=n.Msg.PROCEDURES_DEFNORETURN_COMMENT,n.Msg.PROCEDURES_DEFRETURN_DO=n.Msg.PROCEDURES_DEFNORETURN_DO,n.Msg.PROCEDURES_DEFRETURN_PROCEDURE=n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,n.Msg.PROCEDURES_DEFRETURN_TITLE=n.Msg.PROCEDURES_DEFNORETURN_TITLE,n.Msg.TEXT_APPEND_VARIABLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.COLOUR_HUE="20",n.Msg.LISTS_HUE="260",n.Msg.LOGIC_HUE="210",n.Msg.LOOPS_HUE="120",n.Msg.MATH_HUE="230",n.Msg.PROCEDURES_HUE="290",n.Msg.TEXTS_HUE="160",n.Msg.VARIABLES_DYNAMIC_HUE="310",n.Msg.VARIABLES_HUE="330",n.Msg})})(I2);var Pq=I2.exports;const Dq=pd(Pq),{LOGIC_HUE:Bq,LOOPS_HUE:Fq,MATH_HUE:Uq,TEXTS_HUE:Gq,LISTS_HUE:Hq,COLOUR_HUE:Vq,VARIABLES_HUE:zq,VARIABLES_DYNAMIC_HUE:Wq,PROCEDURES_HUE:Xq,VARIABLES_DEFAULT_NAME:jq,UNNAMED_KEY:Yq,TODAY:Kq,DUPLICATE_BLOCK:Jq,ADD_COMMENT:Zq,REMOVE_COMMENT:qq,DUPLICATE_COMMENT:Qq,EXTERNAL_INPUTS:eQ,INLINE_INPUTS:tQ,DELETE_BLOCK:nQ,DELETE_X_BLOCKS:iQ,DELETE_ALL_BLOCKS:rQ,CLEAN_UP:sQ,COLLAPSE_BLOCK:oQ,COLLAPSE_ALL:aQ,EXPAND_BLOCK:lQ,EXPAND_ALL:cQ,DISABLE_BLOCK:uQ,ENABLE_BLOCK:hQ,HELP:dQ,UNDO:fQ,REDO:pQ,CHANGE_VALUE_TITLE:mQ,RENAME_VARIABLE:gQ,RENAME_VARIABLE_TITLE:_Q,NEW_VARIABLE:TQ,NEW_STRING_VARIABLE:vQ,NEW_NUMBER_VARIABLE:EQ,NEW_COLOUR_VARIABLE:yQ,NEW_VARIABLE_TYPE_TITLE:SQ,NEW_VARIABLE_TITLE:$Q,VARIABLE_ALREADY_EXISTS:bQ,VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE:AQ,VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER:CQ,DELETE_VARIABLE_CONFIRMATION:RQ,CANNOT_DELETE_VARIABLE_PROCEDURE:xQ,DELETE_VARIABLE:wQ,COLOUR_PICKER_HELPURL:MQ,COLOUR_PICKER_TOOLTIP:IQ,COLOUR_RANDOM_HELPURL:OQ,COLOUR_RANDOM_TITLE:LQ,COLOUR_RANDOM_TOOLTIP:NQ,COLOUR_RGB_HELPURL:kQ,COLOUR_RGB_TITLE:PQ,COLOUR_RGB_RED:DQ,COLOUR_RGB_GREEN:BQ,COLOUR_RGB_BLUE:FQ,COLOUR_RGB_TOOLTIP:UQ,COLOUR_BLEND_HELPURL:GQ,COLOUR_BLEND_TITLE:HQ,COLOUR_BLEND_COLOUR1:VQ,COLOUR_BLEND_COLOUR2:zQ,COLOUR_BLEND_RATIO:WQ,COLOUR_BLEND_TOOLTIP:XQ,CONTROLS_REPEAT_HELPURL:jQ,CONTROLS_REPEAT_TITLE:YQ,CONTROLS_REPEAT_INPUT_DO:KQ,CONTROLS_REPEAT_TOOLTIP:JQ,CONTROLS_WHILEUNTIL_HELPURL:ZQ,CONTROLS_WHILEUNTIL_INPUT_DO:qQ,CONTROLS_WHILEUNTIL_OPERATOR_WHILE:QQ,CONTROLS_WHILEUNTIL_OPERATOR_UNTIL:eee,CONTROLS_WHILEUNTIL_TOOLTIP_WHILE:tee,CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL:nee,CONTROLS_FOR_HELPURL:iee,CONTROLS_FOR_TOOLTIP:ree,CONTROLS_FOR_TITLE:see,CONTROLS_FOR_INPUT_DO:oee,CONTROLS_FOREACH_HELPURL:aee,CONTROLS_FOREACH_TITLE:lee,CONTROLS_FOREACH_INPUT_DO:cee,CONTROLS_FOREACH_TOOLTIP:uee,CONTROLS_FLOW_STATEMENTS_HELPURL:hee,CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK:dee,CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE:fee,CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK:pee,CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE:mee,CONTROLS_FLOW_STATEMENTS_WARNING:gee,CONTROLS_IF_HELPURL:_ee,CONTROLS_IF_TOOLTIP_1:Tee,CONTROLS_IF_TOOLTIP_2:vee,CONTROLS_IF_TOOLTIP_3:Eee,CONTROLS_IF_TOOLTIP_4:yee,CONTROLS_IF_MSG_IF:See,CONTROLS_IF_MSG_ELSEIF:$ee,CONTROLS_IF_MSG_ELSE:bee,CONTROLS_IF_MSG_THEN:Aee,CONTROLS_IF_IF_TITLE_IF:Cee,CONTROLS_IF_IF_TOOLTIP:Ree,CONTROLS_IF_ELSEIF_TITLE_ELSEIF:xee,CONTROLS_IF_ELSEIF_TOOLTIP:wee,CONTROLS_IF_ELSE_TITLE_ELSE:Mee,CONTROLS_IF_ELSE_TOOLTIP:Iee,LOGIC_COMPARE_HELPURL:Oee,LOGIC_COMPARE_TOOLTIP_EQ:Lee,LOGIC_COMPARE_TOOLTIP_NEQ:Nee,LOGIC_COMPARE_TOOLTIP_LT:kee,LOGIC_COMPARE_TOOLTIP_LTE:Pee,LOGIC_COMPARE_TOOLTIP_GT:Dee,LOGIC_COMPARE_TOOLTIP_GTE:Bee,LOGIC_OPERATION_HELPURL:Fee,LOGIC_OPERATION_TOOLTIP_AND:Uee,LOGIC_OPERATION_AND:Gee,LOGIC_OPERATION_TOOLTIP_OR:Hee,LOGIC_OPERATION_OR:Vee,LOGIC_NEGATE_HELPURL:zee,LOGIC_NEGATE_TITLE:Wee,LOGIC_NEGATE_TOOLTIP:Xee,LOGIC_BOOLEAN_HELPURL:jee,LOGIC_BOOLEAN_TRUE:Yee,LOGIC_BOOLEAN_FALSE:Kee,LOGIC_BOOLEAN_TOOLTIP:Jee,LOGIC_NULL_HELPURL:Zee,LOGIC_NULL:qee,LOGIC_NULL_TOOLTIP:Qee,LOGIC_TERNARY_HELPURL:ete,LOGIC_TERNARY_CONDITION:tte,LOGIC_TERNARY_IF_TRUE:nte,LOGIC_TERNARY_IF_FALSE:ite,LOGIC_TERNARY_TOOLTIP:rte,MATH_NUMBER_HELPURL:ste,MATH_NUMBER_TOOLTIP:ote,MATH_ADDITION_SYMBOL:ate,MATH_SUBTRACTION_SYMBOL:lte,MATH_DIVISION_SYMBOL:cte,MATH_MULTIPLICATION_SYMBOL:ute,MATH_POWER_SYMBOL:hte,MATH_TRIG_SIN:dte,MATH_TRIG_COS:fte,MATH_TRIG_TAN:pte,MATH_TRIG_ASIN:mte,MATH_TRIG_ACOS:gte,MATH_TRIG_ATAN:_te,MATH_ARITHMETIC_HELPURL:Tte,MATH_ARITHMETIC_TOOLTIP_ADD:vte,MATH_ARITHMETIC_TOOLTIP_MINUS:Ete,MATH_ARITHMETIC_TOOLTIP_MULTIPLY:yte,MATH_ARITHMETIC_TOOLTIP_DIVIDE:Ste,MATH_ARITHMETIC_TOOLTIP_POWER:$te,MATH_SINGLE_HELPURL:bte,MATH_SINGLE_OP_ROOT:Ate,MATH_SINGLE_TOOLTIP_ROOT:Cte,MATH_SINGLE_OP_ABSOLUTE:Rte,MATH_SINGLE_TOOLTIP_ABS:xte,MATH_SINGLE_TOOLTIP_NEG:wte,MATH_SINGLE_TOOLTIP_LN:Mte,MATH_SINGLE_TOOLTIP_LOG10:Ite,MATH_SINGLE_TOOLTIP_EXP:Ote,MATH_SINGLE_TOOLTIP_POW10:Lte,MATH_TRIG_HELPURL:Nte,MATH_TRIG_TOOLTIP_SIN:kte,MATH_TRIG_TOOLTIP_COS:Pte,MATH_TRIG_TOOLTIP_TAN:Dte,MATH_TRIG_TOOLTIP_ASIN:Bte,MATH_TRIG_TOOLTIP_ACOS:Fte,MATH_TRIG_TOOLTIP_ATAN:Ute,MATH_CONSTANT_HELPURL:Gte,MATH_CONSTANT_TOOLTIP:Hte,MATH_IS_EVEN:Vte,MATH_IS_ODD:zte,MATH_IS_PRIME:Wte,MATH_IS_WHOLE:Xte,MATH_IS_POSITIVE:jte,MATH_IS_NEGATIVE:Yte,MATH_IS_DIVISIBLE_BY:Kte,MATH_IS_TOOLTIP:Jte,MATH_CHANGE_HELPURL:Zte,MATH_CHANGE_TITLE:qte,MATH_CHANGE_TITLE_ITEM:Qte,MATH_CHANGE_TOOLTIP:ene,MATH_ROUND_HELPURL:tne,MATH_ROUND_TOOLTIP:nne,MATH_ROUND_OPERATOR_ROUND:ine,MATH_ROUND_OPERATOR_ROUNDUP:rne,MATH_ROUND_OPERATOR_ROUNDDOWN:sne,MATH_ONLIST_HELPURL:one,MATH_ONLIST_OPERATOR_SUM:ane,MATH_ONLIST_TOOLTIP_SUM:lne,MATH_ONLIST_OPERATOR_MIN:cne,MATH_ONLIST_TOOLTIP_MIN:une,MATH_ONLIST_OPERATOR_MAX:hne,MATH_ONLIST_TOOLTIP_MAX:dne,MATH_ONLIST_OPERATOR_AVERAGE:fne,MATH_ONLIST_TOOLTIP_AVERAGE:pne,MATH_ONLIST_OPERATOR_MEDIAN:mne,MATH_ONLIST_TOOLTIP_MEDIAN:gne,MATH_ONLIST_OPERATOR_MODE:_ne,MATH_ONLIST_TOOLTIP_MODE:Tne,MATH_ONLIST_OPERATOR_STD_DEV:vne,MATH_ONLIST_TOOLTIP_STD_DEV:Ene,MATH_ONLIST_OPERATOR_RANDOM:yne,MATH_ONLIST_TOOLTIP_RANDOM:Sne,MATH_MODULO_HELPURL:$ne,MATH_MODULO_TITLE:bne,MATH_MODULO_TOOLTIP:Ane,MATH_CONSTRAIN_HELPURL:Cne,MATH_CONSTRAIN_TITLE:Rne,MATH_CONSTRAIN_TOOLTIP:xne,MATH_RANDOM_INT_HELPURL:wne,MATH_RANDOM_INT_TITLE:Mne,MATH_RANDOM_INT_TOOLTIP:Ine,MATH_RANDOM_FLOAT_HELPURL:One,MATH_RANDOM_FLOAT_TITLE_RANDOM:Lne,MATH_RANDOM_FLOAT_TOOLTIP:Nne,MATH_ATAN2_HELPURL:kne,MATH_ATAN2_TITLE:Pne,MATH_ATAN2_TOOLTIP:Dne,TEXT_TEXT_HELPURL:Bne,TEXT_TEXT_TOOLTIP:Fne,TEXT_JOIN_HELPURL:Une,TEXT_JOIN_TITLE_CREATEWITH:Gne,TEXT_JOIN_TOOLTIP:Hne,TEXT_CREATE_JOIN_TITLE_JOIN:Vne,TEXT_CREATE_JOIN_TOOLTIP:zne,TEXT_CREATE_JOIN_ITEM_TITLE_ITEM:Wne,TEXT_CREATE_JOIN_ITEM_TOOLTIP:Xne,TEXT_APPEND_HELPURL:jne,TEXT_APPEND_TITLE:Yne,TEXT_APPEND_VARIABLE:Kne,TEXT_APPEND_TOOLTIP:Jne,TEXT_LENGTH_HELPURL:Zne,TEXT_LENGTH_TITLE:qne,TEXT_LENGTH_TOOLTIP:Qne,TEXT_ISEMPTY_HELPURL:eie,TEXT_ISEMPTY_TITLE:tie,TEXT_ISEMPTY_TOOLTIP:nie,TEXT_INDEXOF_HELPURL:iie,TEXT_INDEXOF_TOOLTIP:rie,TEXT_INDEXOF_TITLE:sie,TEXT_INDEXOF_OPERATOR_FIRST:oie,TEXT_INDEXOF_OPERATOR_LAST:aie,TEXT_CHARAT_HELPURL:lie,TEXT_CHARAT_TITLE:cie,TEXT_CHARAT_FROM_START:uie,TEXT_CHARAT_FROM_END:hie,TEXT_CHARAT_FIRST:die,TEXT_CHARAT_LAST:fie,TEXT_CHARAT_RANDOM:pie,TEXT_CHARAT_TAIL:mie,TEXT_CHARAT_TOOLTIP:gie,TEXT_GET_SUBSTRING_TOOLTIP:_ie,TEXT_GET_SUBSTRING_HELPURL:Tie,TEXT_GET_SUBSTRING_INPUT_IN_TEXT:vie,TEXT_GET_SUBSTRING_START_FROM_START:Eie,TEXT_GET_SUBSTRING_START_FROM_END:yie,TEXT_GET_SUBSTRING_START_FIRST:Sie,TEXT_GET_SUBSTRING_END_FROM_START:$ie,TEXT_GET_SUBSTRING_END_FROM_END:bie,TEXT_GET_SUBSTRING_END_LAST:Aie,TEXT_GET_SUBSTRING_TAIL:Cie,TEXT_CHANGECASE_HELPURL:Rie,TEXT_CHANGECASE_TOOLTIP:xie,TEXT_CHANGECASE_OPERATOR_UPPERCASE:wie,TEXT_CHANGECASE_OPERATOR_LOWERCASE:Mie,TEXT_CHANGECASE_OPERATOR_TITLECASE:Iie,TEXT_TRIM_HELPURL:Oie,TEXT_TRIM_TOOLTIP:Lie,TEXT_TRIM_OPERATOR_BOTH:Nie,TEXT_TRIM_OPERATOR_LEFT:kie,TEXT_TRIM_OPERATOR_RIGHT:Pie,TEXT_PRINT_HELPURL:Die,TEXT_PRINT_TITLE:Bie,TEXT_PRINT_TOOLTIP:Fie,TEXT_PROMPT_HELPURL:Uie,TEXT_PROMPT_TYPE_TEXT:Gie,TEXT_PROMPT_TYPE_NUMBER:Hie,TEXT_PROMPT_TOOLTIP_NUMBER:Vie,TEXT_PROMPT_TOOLTIP_TEXT:zie,TEXT_COUNT_MESSAGE0:Wie,TEXT_COUNT_HELPURL:Xie,TEXT_COUNT_TOOLTIP:jie,TEXT_REPLACE_MESSAGE0:Yie,TEXT_REPLACE_HELPURL:Kie,TEXT_REPLACE_TOOLTIP:Jie,TEXT_REVERSE_MESSAGE0:Zie,TEXT_REVERSE_HELPURL:qie,TEXT_REVERSE_TOOLTIP:Qie,LISTS_CREATE_EMPTY_HELPURL:ere,LISTS_CREATE_EMPTY_TITLE:tre,LISTS_CREATE_EMPTY_TOOLTIP:nre,LISTS_CREATE_WITH_HELPURL:ire,LISTS_CREATE_WITH_TOOLTIP:rre,LISTS_CREATE_WITH_INPUT_WITH:sre,LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:ore,LISTS_CREATE_WITH_CONTAINER_TOOLTIP:are,LISTS_CREATE_WITH_ITEM_TITLE:lre,LISTS_CREATE_WITH_ITEM_TOOLTIP:cre,LISTS_REPEAT_HELPURL:ure,LISTS_REPEAT_TOOLTIP:hre,LISTS_REPEAT_TITLE:dre,LISTS_LENGTH_HELPURL:fre,LISTS_LENGTH_TITLE:pre,LISTS_LENGTH_TOOLTIP:mre,LISTS_ISEMPTY_HELPURL:gre,LISTS_ISEMPTY_TITLE:_re,LISTS_ISEMPTY_TOOLTIP:Tre,LISTS_INLIST:vre,LISTS_INDEX_OF_HELPURL:Ere,LISTS_INDEX_OF_INPUT_IN_LIST:yre,LISTS_INDEX_OF_FIRST:Sre,LISTS_INDEX_OF_LAST:$re,LISTS_INDEX_OF_TOOLTIP:bre,LISTS_GET_INDEX_HELPURL:Are,LISTS_GET_INDEX_GET:Cre,LISTS_GET_INDEX_GET_REMOVE:Rre,LISTS_GET_INDEX_REMOVE:xre,LISTS_GET_INDEX_FROM_START:wre,LISTS_GET_INDEX_FROM_END:Mre,LISTS_GET_INDEX_FIRST:Ire,LISTS_GET_INDEX_LAST:Ore,LISTS_GET_INDEX_RANDOM:Lre,LISTS_GET_INDEX_TAIL:Nre,LISTS_GET_INDEX_INPUT_IN_LIST:kre,LISTS_INDEX_FROM_START_TOOLTIP:Pre,LISTS_INDEX_FROM_END_TOOLTIP:Dre,LISTS_GET_INDEX_TOOLTIP_GET_FROM:Bre,LISTS_GET_INDEX_TOOLTIP_GET_FIRST:Fre,LISTS_GET_INDEX_TOOLTIP_GET_LAST:Ure,LISTS_GET_INDEX_TOOLTIP_GET_RANDOM:Gre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM:Hre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST:Vre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST:zre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM:Wre,LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM:Xre,LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST:jre,LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST:Yre,LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM:Kre,LISTS_SET_INDEX_HELPURL:Jre,LISTS_SET_INDEX_INPUT_IN_LIST:Zre,LISTS_SET_INDEX_SET:qre,LISTS_SET_INDEX_INSERT:Qre,LISTS_SET_INDEX_INPUT_TO:ese,LISTS_SET_INDEX_TOOLTIP_SET_FROM:tse,LISTS_SET_INDEX_TOOLTIP_SET_FIRST:nse,LISTS_SET_INDEX_TOOLTIP_SET_LAST:ise,LISTS_SET_INDEX_TOOLTIP_SET_RANDOM:rse,LISTS_SET_INDEX_TOOLTIP_INSERT_FROM:sse,LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST:ose,LISTS_SET_INDEX_TOOLTIP_INSERT_LAST:ase,LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM:lse,LISTS_GET_SUBLIST_HELPURL:cse,LISTS_GET_SUBLIST_INPUT_IN_LIST:use,LISTS_GET_SUBLIST_START_FROM_START:hse,LISTS_GET_SUBLIST_START_FROM_END:dse,LISTS_GET_SUBLIST_START_FIRST:fse,LISTS_GET_SUBLIST_END_FROM_START:pse,LISTS_GET_SUBLIST_END_FROM_END:mse,LISTS_GET_SUBLIST_END_LAST:gse,LISTS_GET_SUBLIST_TAIL:_se,LISTS_GET_SUBLIST_TOOLTIP:Tse,LISTS_SORT_HELPURL:vse,LISTS_SORT_TITLE:Ese,LISTS_SORT_TOOLTIP:yse,LISTS_SORT_ORDER_ASCENDING:Sse,LISTS_SORT_ORDER_DESCENDING:$se,LISTS_SORT_TYPE_NUMERIC:bse,LISTS_SORT_TYPE_TEXT:Ase,LISTS_SORT_TYPE_IGNORECASE:Cse,LISTS_SPLIT_HELPURL:Rse,LISTS_SPLIT_LIST_FROM_TEXT:xse,LISTS_SPLIT_TEXT_FROM_LIST:wse,LISTS_SPLIT_WITH_DELIMITER:Mse,LISTS_SPLIT_TOOLTIP_SPLIT:Ise,LISTS_SPLIT_TOOLTIP_JOIN:Ose,LISTS_REVERSE_HELPURL:Lse,LISTS_REVERSE_MESSAGE0:Nse,LISTS_REVERSE_TOOLTIP:kse,ORDINAL_NUMBER_SUFFIX:Pse,VARIABLES_GET_HELPURL:Dse,VARIABLES_GET_TOOLTIP:Bse,VARIABLES_GET_CREATE_SET:Fse,VARIABLES_SET_HELPURL:Use,VARIABLES_SET:Gse,VARIABLES_SET_TOOLTIP:Hse,VARIABLES_SET_CREATE_GET:Vse,PROCEDURES_DEFNORETURN_HELPURL:zse,PROCEDURES_DEFNORETURN_TITLE:Wse,PROCEDURES_DEFNORETURN_PROCEDURE:Xse,PROCEDURES_BEFORE_PARAMS:jse,PROCEDURES_CALL_BEFORE_PARAMS:Yse,PROCEDURES_CALL_DISABLED_DEF_WARNING:Kse,PROCEDURES_DEFNORETURN_DO:Jse,PROCEDURES_DEFNORETURN_TOOLTIP:Zse,PROCEDURES_DEFNORETURN_COMMENT:qse,PROCEDURES_DEFRETURN_HELPURL:Qse,PROCEDURES_DEFRETURN_TITLE:eoe,PROCEDURES_DEFRETURN_PROCEDURE:toe,PROCEDURES_DEFRETURN_DO:noe,PROCEDURES_DEFRETURN_COMMENT:ioe,PROCEDURES_DEFRETURN_RETURN:roe,PROCEDURES_DEFRETURN_TOOLTIP:soe,PROCEDURES_ALLOW_STATEMENTS:ooe,PROCEDURES_DEF_DUPLICATE_WARNING:aoe,PROCEDURES_CALLNORETURN_HELPURL:loe,PROCEDURES_CALLNORETURN_TOOLTIP:coe,PROCEDURES_CALLRETURN_HELPURL:uoe,PROCEDURES_CALLRETURN_TOOLTIP:hoe,PROCEDURES_MUTATORCONTAINER_TITLE:doe,PROCEDURES_MUTATORCONTAINER_TOOLTIP:foe,PROCEDURES_MUTATORARG_TITLE:poe,PROCEDURES_MUTATORARG_TOOLTIP:moe,PROCEDURES_HIGHLIGHT_DEF:goe,PROCEDURES_CREATE_DO:_oe,PROCEDURES_IFRETURN_TOOLTIP:Toe,PROCEDURES_IFRETURN_HELPURL:voe,PROCEDURES_IFRETURN_WARNING:Eoe,WORKSPACE_COMMENT_DEFAULT_TEXT:yoe,WORKSPACE_ARIA_LABEL:Soe,COLLAPSED_WARNINGS_WARNING:$oe,DIALOG_OK:boe,DIALOG_CANCEL:Aoe}=Dq,Coe=Object.freeze(Object.defineProperty({__proto__:null,ADD_COMMENT:Zq,CANNOT_DELETE_VARIABLE_PROCEDURE:xQ,CHANGE_VALUE_TITLE:mQ,CLEAN_UP:sQ,COLLAPSED_WARNINGS_WARNING:$oe,COLLAPSE_ALL:aQ,COLLAPSE_BLOCK:oQ,COLOUR_BLEND_COLOUR1:VQ,COLOUR_BLEND_COLOUR2:zQ,COLOUR_BLEND_HELPURL:GQ,COLOUR_BLEND_RATIO:WQ,COLOUR_BLEND_TITLE:HQ,COLOUR_BLEND_TOOLTIP:XQ,COLOUR_HUE:Vq,COLOUR_PICKER_HELPURL:MQ,COLOUR_PICKER_TOOLTIP:IQ,COLOUR_RANDOM_HELPURL:OQ,COLOUR_RANDOM_TITLE:LQ,COLOUR_RANDOM_TOOLTIP:NQ,COLOUR_RGB_BLUE:FQ,COLOUR_RGB_GREEN:BQ,COLOUR_RGB_HELPURL:kQ,COLOUR_RGB_RED:DQ,COLOUR_RGB_TITLE:PQ,COLOUR_RGB_TOOLTIP:UQ,CONTROLS_FLOW_STATEMENTS_HELPURL:hee,CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK:dee,CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE:fee,CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK:pee,CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE:mee,CONTROLS_FLOW_STATEMENTS_WARNING:gee,CONTROLS_FOREACH_HELPURL:aee,CONTROLS_FOREACH_INPUT_DO:cee,CONTROLS_FOREACH_TITLE:lee,CONTROLS_FOREACH_TOOLTIP:uee,CONTROLS_FOR_HELPURL:iee,CONTROLS_FOR_INPUT_DO:oee,CONTROLS_FOR_TITLE:see,CONTROLS_FOR_TOOLTIP:ree,CONTROLS_IF_ELSEIF_TITLE_ELSEIF:xee,CONTROLS_IF_ELSEIF_TOOLTIP:wee,CONTROLS_IF_ELSE_TITLE_ELSE:Mee,CONTROLS_IF_ELSE_TOOLTIP:Iee,CONTROLS_IF_HELPURL:_ee,CONTROLS_IF_IF_TITLE_IF:Cee,CONTROLS_IF_IF_TOOLTIP:Ree,CONTROLS_IF_MSG_ELSE:bee,CONTROLS_IF_MSG_ELSEIF:$ee,CONTROLS_IF_MSG_IF:See,CONTROLS_IF_MSG_THEN:Aee,CONTROLS_IF_TOOLTIP_1:Tee,CONTROLS_IF_TOOLTIP_2:vee,CONTROLS_IF_TOOLTIP_3:Eee,CONTROLS_IF_TOOLTIP_4:yee,CONTROLS_REPEAT_HELPURL:jQ,CONTROLS_REPEAT_INPUT_DO:KQ,CONTROLS_REPEAT_TITLE:YQ,CONTROLS_REPEAT_TOOLTIP:JQ,CONTROLS_WHILEUNTIL_HELPURL:ZQ,CONTROLS_WHILEUNTIL_INPUT_DO:qQ,CONTROLS_WHILEUNTIL_OPERATOR_UNTIL:eee,CONTROLS_WHILEUNTIL_OPERATOR_WHILE:QQ,CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL:nee,CONTROLS_WHILEUNTIL_TOOLTIP_WHILE:tee,DELETE_ALL_BLOCKS:rQ,DELETE_BLOCK:nQ,DELETE_VARIABLE:wQ,DELETE_VARIABLE_CONFIRMATION:RQ,DELETE_X_BLOCKS:iQ,DIALOG_CANCEL:Aoe,DIALOG_OK:boe,DISABLE_BLOCK:uQ,DUPLICATE_BLOCK:Jq,DUPLICATE_COMMENT:Qq,ENABLE_BLOCK:hQ,EXPAND_ALL:cQ,EXPAND_BLOCK:lQ,EXTERNAL_INPUTS:eQ,HELP:dQ,INLINE_INPUTS:tQ,LISTS_CREATE_EMPTY_HELPURL:ere,LISTS_CREATE_EMPTY_TITLE:tre,LISTS_CREATE_EMPTY_TOOLTIP:nre,LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:ore,LISTS_CREATE_WITH_CONTAINER_TOOLTIP:are,LISTS_CREATE_WITH_HELPURL:ire,LISTS_CREATE_WITH_INPUT_WITH:sre,LISTS_CREATE_WITH_ITEM_TITLE:lre,LISTS_CREATE_WITH_ITEM_TOOLTIP:cre,LISTS_CREATE_WITH_TOOLTIP:rre,LISTS_GET_INDEX_FIRST:Ire,LISTS_GET_INDEX_FROM_END:Mre,LISTS_GET_INDEX_FROM_START:wre,LISTS_GET_INDEX_GET:Cre,LISTS_GET_INDEX_GET_REMOVE:Rre,LISTS_GET_INDEX_HELPURL:Are,LISTS_GET_INDEX_INPUT_IN_LIST:kre,LISTS_GET_INDEX_LAST:Ore,LISTS_GET_INDEX_RANDOM:Lre,LISTS_GET_INDEX_REMOVE:xre,LISTS_GET_INDEX_TAIL:Nre,LISTS_GET_INDEX_TOOLTIP_GET_FIRST:Fre,LISTS_GET_INDEX_TOOLTIP_GET_FROM:Bre,LISTS_GET_INDEX_TOOLTIP_GET_LAST:Ure,LISTS_GET_INDEX_TOOLTIP_GET_RANDOM:Gre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST:Vre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM:Hre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST:zre,LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM:Wre,LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST:jre,LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM:Xre,LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST:Yre,LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM:Kre,LISTS_GET_SUBLIST_END_FROM_END:mse,LISTS_GET_SUBLIST_END_FROM_START:pse,LISTS_GET_SUBLIST_END_LAST:gse,LISTS_GET_SUBLIST_HELPURL:cse,LISTS_GET_SUBLIST_INPUT_IN_LIST:use,LISTS_GET_SUBLIST_START_FIRST:fse,LISTS_GET_SUBLIST_START_FROM_END:dse,LISTS_GET_SUBLIST_START_FROM_START:hse,LISTS_GET_SUBLIST_TAIL:_se,LISTS_GET_SUBLIST_TOOLTIP:Tse,LISTS_HUE:Hq,LISTS_INDEX_FROM_END_TOOLTIP:Dre,LISTS_INDEX_FROM_START_TOOLTIP:Pre,LISTS_INDEX_OF_FIRST:Sre,LISTS_INDEX_OF_HELPURL:Ere,LISTS_INDEX_OF_INPUT_IN_LIST:yre,LISTS_INDEX_OF_LAST:$re,LISTS_INDEX_OF_TOOLTIP:bre,LISTS_INLIST:vre,LISTS_ISEMPTY_HELPURL:gre,LISTS_ISEMPTY_TITLE:_re,LISTS_ISEMPTY_TOOLTIP:Tre,LISTS_LENGTH_HELPURL:fre,LISTS_LENGTH_TITLE:pre,LISTS_LENGTH_TOOLTIP:mre,LISTS_REPEAT_HELPURL:ure,LISTS_REPEAT_TITLE:dre,LISTS_REPEAT_TOOLTIP:hre,LISTS_REVERSE_HELPURL:Lse,LISTS_REVERSE_MESSAGE0:Nse,LISTS_REVERSE_TOOLTIP:kse,LISTS_SET_INDEX_HELPURL:Jre,LISTS_SET_INDEX_INPUT_IN_LIST:Zre,LISTS_SET_INDEX_INPUT_TO:ese,LISTS_SET_INDEX_INSERT:Qre,LISTS_SET_INDEX_SET:qre,LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST:ose,LISTS_SET_INDEX_TOOLTIP_INSERT_FROM:sse,LISTS_SET_INDEX_TOOLTIP_INSERT_LAST:ase,LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM:lse,LISTS_SET_INDEX_TOOLTIP_SET_FIRST:nse,LISTS_SET_INDEX_TOOLTIP_SET_FROM:tse,LISTS_SET_INDEX_TOOLTIP_SET_LAST:ise,LISTS_SET_INDEX_TOOLTIP_SET_RANDOM:rse,LISTS_SORT_HELPURL:vse,LISTS_SORT_ORDER_ASCENDING:Sse,LISTS_SORT_ORDER_DESCENDING:$se,LISTS_SORT_TITLE:Ese,LISTS_SORT_TOOLTIP:yse,LISTS_SORT_TYPE_IGNORECASE:Cse,LISTS_SORT_TYPE_NUMERIC:bse,LISTS_SORT_TYPE_TEXT:Ase,LISTS_SPLIT_HELPURL:Rse,LISTS_SPLIT_LIST_FROM_TEXT:xse,LISTS_SPLIT_TEXT_FROM_LIST:wse,LISTS_SPLIT_TOOLTIP_JOIN:Ose,LISTS_SPLIT_TOOLTIP_SPLIT:Ise,LISTS_SPLIT_WITH_DELIMITER:Mse,LOGIC_BOOLEAN_FALSE:Kee,LOGIC_BOOLEAN_HELPURL:jee,LOGIC_BOOLEAN_TOOLTIP:Jee,LOGIC_BOOLEAN_TRUE:Yee,LOGIC_COMPARE_HELPURL:Oee,LOGIC_COMPARE_TOOLTIP_EQ:Lee,LOGIC_COMPARE_TOOLTIP_GT:Dee,LOGIC_COMPARE_TOOLTIP_GTE:Bee,LOGIC_COMPARE_TOOLTIP_LT:kee,LOGIC_COMPARE_TOOLTIP_LTE:Pee,LOGIC_COMPARE_TOOLTIP_NEQ:Nee,LOGIC_HUE:Bq,LOGIC_NEGATE_HELPURL:zee,LOGIC_NEGATE_TITLE:Wee,LOGIC_NEGATE_TOOLTIP:Xee,LOGIC_NULL:qee,LOGIC_NULL_HELPURL:Zee,LOGIC_NULL_TOOLTIP:Qee,LOGIC_OPERATION_AND:Gee,LOGIC_OPERATION_HELPURL:Fee,LOGIC_OPERATION_OR:Vee,LOGIC_OPERATION_TOOLTIP_AND:Uee,LOGIC_OPERATION_TOOLTIP_OR:Hee,LOGIC_TERNARY_CONDITION:tte,LOGIC_TERNARY_HELPURL:ete,LOGIC_TERNARY_IF_FALSE:ite,LOGIC_TERNARY_IF_TRUE:nte,LOGIC_TERNARY_TOOLTIP:rte,LOOPS_HUE:Fq,MATH_ADDITION_SYMBOL:ate,MATH_ARITHMETIC_HELPURL:Tte,MATH_ARITHMETIC_TOOLTIP_ADD:vte,MATH_ARITHMETIC_TOOLTIP_DIVIDE:Ste,MATH_ARITHMETIC_TOOLTIP_MINUS:Ete,MATH_ARITHMETIC_TOOLTIP_MULTIPLY:yte,MATH_ARITHMETIC_TOOLTIP_POWER:$te,MATH_ATAN2_HELPURL:kne,MATH_ATAN2_TITLE:Pne,MATH_ATAN2_TOOLTIP:Dne,MATH_CHANGE_HELPURL:Zte,MATH_CHANGE_TITLE:qte,MATH_CHANGE_TITLE_ITEM:Qte,MATH_CHANGE_TOOLTIP:ene,MATH_CONSTANT_HELPURL:Gte,MATH_CONSTANT_TOOLTIP:Hte,MATH_CONSTRAIN_HELPURL:Cne,MATH_CONSTRAIN_TITLE:Rne,MATH_CONSTRAIN_TOOLTIP:xne,MATH_DIVISION_SYMBOL:cte,MATH_HUE:Uq,MATH_IS_DIVISIBLE_BY:Kte,MATH_IS_EVEN:Vte,MATH_IS_NEGATIVE:Yte,MATH_IS_ODD:zte,MATH_IS_POSITIVE:jte,MATH_IS_PRIME:Wte,MATH_IS_TOOLTIP:Jte,MATH_IS_WHOLE:Xte,MATH_MODULO_HELPURL:$ne,MATH_MODULO_TITLE:bne,MATH_MODULO_TOOLTIP:Ane,MATH_MULTIPLICATION_SYMBOL:ute,MATH_NUMBER_HELPURL:ste,MATH_NUMBER_TOOLTIP:ote,MATH_ONLIST_HELPURL:one,MATH_ONLIST_OPERATOR_AVERAGE:fne,MATH_ONLIST_OPERATOR_MAX:hne,MATH_ONLIST_OPERATOR_MEDIAN:mne,MATH_ONLIST_OPERATOR_MIN:cne,MATH_ONLIST_OPERATOR_MODE:_ne,MATH_ONLIST_OPERATOR_RANDOM:yne,MATH_ONLIST_OPERATOR_STD_DEV:vne,MATH_ONLIST_OPERATOR_SUM:ane,MATH_ONLIST_TOOLTIP_AVERAGE:pne,MATH_ONLIST_TOOLTIP_MAX:dne,MATH_ONLIST_TOOLTIP_MEDIAN:gne,MATH_ONLIST_TOOLTIP_MIN:une,MATH_ONLIST_TOOLTIP_MODE:Tne,MATH_ONLIST_TOOLTIP_RANDOM:Sne,MATH_ONLIST_TOOLTIP_STD_DEV:Ene,MATH_ONLIST_TOOLTIP_SUM:lne,MATH_POWER_SYMBOL:hte,MATH_RANDOM_FLOAT_HELPURL:One,MATH_RANDOM_FLOAT_TITLE_RANDOM:Lne,MATH_RANDOM_FLOAT_TOOLTIP:Nne,MATH_RANDOM_INT_HELPURL:wne,MATH_RANDOM_INT_TITLE:Mne,MATH_RANDOM_INT_TOOLTIP:Ine,MATH_ROUND_HELPURL:tne,MATH_ROUND_OPERATOR_ROUND:ine,MATH_ROUND_OPERATOR_ROUNDDOWN:sne,MATH_ROUND_OPERATOR_ROUNDUP:rne,MATH_ROUND_TOOLTIP:nne,MATH_SINGLE_HELPURL:bte,MATH_SINGLE_OP_ABSOLUTE:Rte,MATH_SINGLE_OP_ROOT:Ate,MATH_SINGLE_TOOLTIP_ABS:xte,MATH_SINGLE_TOOLTIP_EXP:Ote,MATH_SINGLE_TOOLTIP_LN:Mte,MATH_SINGLE_TOOLTIP_LOG10:Ite,MATH_SINGLE_TOOLTIP_NEG:wte,MATH_SINGLE_TOOLTIP_POW10:Lte,MATH_SINGLE_TOOLTIP_ROOT:Cte,MATH_SUBTRACTION_SYMBOL:lte,MATH_TRIG_ACOS:gte,MATH_TRIG_ASIN:mte,MATH_TRIG_ATAN:_te,MATH_TRIG_COS:fte,MATH_TRIG_HELPURL:Nte,MATH_TRIG_SIN:dte,MATH_TRIG_TAN:pte,MATH_TRIG_TOOLTIP_ACOS:Fte,MATH_TRIG_TOOLTIP_ASIN:Bte,MATH_TRIG_TOOLTIP_ATAN:Ute,MATH_TRIG_TOOLTIP_COS:Pte,MATH_TRIG_TOOLTIP_SIN:kte,MATH_TRIG_TOOLTIP_TAN:Dte,NEW_COLOUR_VARIABLE:yQ,NEW_NUMBER_VARIABLE:EQ,NEW_STRING_VARIABLE:vQ,NEW_VARIABLE:TQ,NEW_VARIABLE_TITLE:$Q,NEW_VARIABLE_TYPE_TITLE:SQ,ORDINAL_NUMBER_SUFFIX:Pse,PROCEDURES_ALLOW_STATEMENTS:ooe,PROCEDURES_BEFORE_PARAMS:jse,PROCEDURES_CALLNORETURN_HELPURL:loe,PROCEDURES_CALLNORETURN_TOOLTIP:coe,PROCEDURES_CALLRETURN_HELPURL:uoe,PROCEDURES_CALLRETURN_TOOLTIP:hoe,PROCEDURES_CALL_BEFORE_PARAMS:Yse,PROCEDURES_CALL_DISABLED_DEF_WARNING:Kse,PROCEDURES_CREATE_DO:_oe,PROCEDURES_DEFNORETURN_COMMENT:qse,PROCEDURES_DEFNORETURN_DO:Jse,PROCEDURES_DEFNORETURN_HELPURL:zse,PROCEDURES_DEFNORETURN_PROCEDURE:Xse,PROCEDURES_DEFNORETURN_TITLE:Wse,PROCEDURES_DEFNORETURN_TOOLTIP:Zse,PROCEDURES_DEFRETURN_COMMENT:ioe,PROCEDURES_DEFRETURN_DO:noe,PROCEDURES_DEFRETURN_HELPURL:Qse,PROCEDURES_DEFRETURN_PROCEDURE:toe,PROCEDURES_DEFRETURN_RETURN:roe,PROCEDURES_DEFRETURN_TITLE:eoe,PROCEDURES_DEFRETURN_TOOLTIP:soe,PROCEDURES_DEF_DUPLICATE_WARNING:aoe,PROCEDURES_HIGHLIGHT_DEF:goe,PROCEDURES_HUE:Xq,PROCEDURES_IFRETURN_HELPURL:voe,PROCEDURES_IFRETURN_TOOLTIP:Toe,PROCEDURES_IFRETURN_WARNING:Eoe,PROCEDURES_MUTATORARG_TITLE:poe,PROCEDURES_MUTATORARG_TOOLTIP:moe,PROCEDURES_MUTATORCONTAINER_TITLE:doe,PROCEDURES_MUTATORCONTAINER_TOOLTIP:foe,REDO:pQ,REMOVE_COMMENT:qq,RENAME_VARIABLE:gQ,RENAME_VARIABLE_TITLE:_Q,TEXTS_HUE:Gq,TEXT_APPEND_HELPURL:jne,TEXT_APPEND_TITLE:Yne,TEXT_APPEND_TOOLTIP:Jne,TEXT_APPEND_VARIABLE:Kne,TEXT_CHANGECASE_HELPURL:Rie,TEXT_CHANGECASE_OPERATOR_LOWERCASE:Mie,TEXT_CHANGECASE_OPERATOR_TITLECASE:Iie,TEXT_CHANGECASE_OPERATOR_UPPERCASE:wie,TEXT_CHANGECASE_TOOLTIP:xie,TEXT_CHARAT_FIRST:die,TEXT_CHARAT_FROM_END:hie,TEXT_CHARAT_FROM_START:uie,TEXT_CHARAT_HELPURL:lie,TEXT_CHARAT_LAST:fie,TEXT_CHARAT_RANDOM:pie,TEXT_CHARAT_TAIL:mie,TEXT_CHARAT_TITLE:cie,TEXT_CHARAT_TOOLTIP:gie,TEXT_COUNT_HELPURL:Xie,TEXT_COUNT_MESSAGE0:Wie,TEXT_COUNT_TOOLTIP:jie,TEXT_CREATE_JOIN_ITEM_TITLE_ITEM:Wne,TEXT_CREATE_JOIN_ITEM_TOOLTIP:Xne,TEXT_CREATE_JOIN_TITLE_JOIN:Vne,TEXT_CREATE_JOIN_TOOLTIP:zne,TEXT_GET_SUBSTRING_END_FROM_END:bie,TEXT_GET_SUBSTRING_END_FROM_START:$ie,TEXT_GET_SUBSTRING_END_LAST:Aie,TEXT_GET_SUBSTRING_HELPURL:Tie,TEXT_GET_SUBSTRING_INPUT_IN_TEXT:vie,TEXT_GET_SUBSTRING_START_FIRST:Sie,TEXT_GET_SUBSTRING_START_FROM_END:yie,TEXT_GET_SUBSTRING_START_FROM_START:Eie,TEXT_GET_SUBSTRING_TAIL:Cie,TEXT_GET_SUBSTRING_TOOLTIP:_ie,TEXT_INDEXOF_HELPURL:iie,TEXT_INDEXOF_OPERATOR_FIRST:oie,TEXT_INDEXOF_OPERATOR_LAST:aie,TEXT_INDEXOF_TITLE:sie,TEXT_INDEXOF_TOOLTIP:rie,TEXT_ISEMPTY_HELPURL:eie,TEXT_ISEMPTY_TITLE:tie,TEXT_ISEMPTY_TOOLTIP:nie,TEXT_JOIN_HELPURL:Une,TEXT_JOIN_TITLE_CREATEWITH:Gne,TEXT_JOIN_TOOLTIP:Hne,TEXT_LENGTH_HELPURL:Zne,TEXT_LENGTH_TITLE:qne,TEXT_LENGTH_TOOLTIP:Qne,TEXT_PRINT_HELPURL:Die,TEXT_PRINT_TITLE:Bie,TEXT_PRINT_TOOLTIP:Fie,TEXT_PROMPT_HELPURL:Uie,TEXT_PROMPT_TOOLTIP_NUMBER:Vie,TEXT_PROMPT_TOOLTIP_TEXT:zie,TEXT_PROMPT_TYPE_NUMBER:Hie,TEXT_PROMPT_TYPE_TEXT:Gie,TEXT_REPLACE_HELPURL:Kie,TEXT_REPLACE_MESSAGE0:Yie,TEXT_REPLACE_TOOLTIP:Jie,TEXT_REVERSE_HELPURL:qie,TEXT_REVERSE_MESSAGE0:Zie,TEXT_REVERSE_TOOLTIP:Qie,TEXT_TEXT_HELPURL:Bne,TEXT_TEXT_TOOLTIP:Fne,TEXT_TRIM_HELPURL:Oie,TEXT_TRIM_OPERATOR_BOTH:Nie,TEXT_TRIM_OPERATOR_LEFT:kie,TEXT_TRIM_OPERATOR_RIGHT:Pie,TEXT_TRIM_TOOLTIP:Lie,TODAY:Kq,UNDO:fQ,UNNAMED_KEY:Yq,VARIABLES_DEFAULT_NAME:jq,VARIABLES_DYNAMIC_HUE:Wq,VARIABLES_GET_CREATE_SET:Fse,VARIABLES_GET_HELPURL:Dse,VARIABLES_GET_TOOLTIP:Bse,VARIABLES_HUE:zq,VARIABLES_SET:Gse,VARIABLES_SET_CREATE_GET:Vse,VARIABLES_SET_HELPURL:Use,VARIABLES_SET_TOOLTIP:Hse,VARIABLE_ALREADY_EXISTS:bQ,VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE:AQ,VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER:CQ,WORKSPACE_ARIA_LABEL:Soe,WORKSPACE_COMMENT_DEFAULT_TEXT:yoe},Symbol.toStringTag,{value:"Module"}));var Roe={exports:{}};(function(i,e){(function(n,r){i.exports=r(cI())})(tp,function(n){var r=n.__namespace__,s=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),a={customContextMenu:function(L){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(he={text:r.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:l(this)},z=this.getField("VAR").getText(),z={text:r.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",z),enabled:!0,callback:u(this)},L.unshift(he),L.unshift(z));else{if(this.type==="variables_get_dynamic")var X="variables_set_dynamic",he=r.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else X="variables_get_dynamic",he=r.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var z=this.getField("VAR");X={type:X,fields:{VAR:z.saveState(!0)}},L.push({enabled:0<this.workspace.remainingCapacity(),text:he.replace("%1",z.getText()),callback:r.callbackFactory$$module$build$src$core$contextmenu(this,X)})}},onchange:function(L){L=this.getFieldValue("VAR"),L=r.getVariable$$module$build$src$core$variables(this.workspace,L),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(L.type):this.getInput("VALUE").connection.setCheck(L.type)}},l=function(L){return function(){const X=L.workspace,he=L.getField("VAR").getVariable();r.renameVariable$$module$build$src$core$variables(X,he)}},u=function(L){return function(){const X=L.workspace,he=L.getField("VAR").getVariable();X.deleteVariableById(he.getId()),X.refreshToolboxSelection()}};r.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",a),r.defineBlocks$$module$build$src$core$common(s);var d={blocks:s},h=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),f={customContextMenu:function(L){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(he={text:r.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:p(this)},z=this.getField("VAR").getText(),z={text:r.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",z),enabled:!0,callback:m(this)},L.unshift(he),L.unshift(z));else{if(this.type==="variables_get")var X="variables_set",he=r.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else X="variables_get",he=r.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var z=this.getField("VAR");X={type:X,fields:{VAR:z.saveState(!0)}},L.push({enabled:0<this.workspace.remainingCapacity(),text:he.replace("%1",z.getText()),callback:r.callbackFactory$$module$build$src$core$contextmenu(this,X)})}}},p=function(L){return function(){const X=L.workspace,he=L.getField("VAR").getVariable();r.renameVariable$$module$build$src$core$variables(X,he)}},m=function(L){return function(){const X=L.workspace,he=L.getField("VAR").getVariable();X.deleteVariableById(he.getId()),X.refreshToolboxSelection()}};r.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",f),r.defineBlocks$$module$build$src$core$common(h);var v={blocks:h},y=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),$={init:function(){this.WHERE_OPTIONS_1=[[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");var X=this.getInput("AT1")instanceof r.ValueInput$$module$build$src$core$inputs$value_input;return L.setAttribute("at1",`${X}`),X=this.getInput("AT2")instanceof r.ValueInput$$module$build$src$core$inputs$value_input,L.setAttribute("at2",`${X}`),L},domToMutation:function(L){const X=L.getAttribute("at1")==="true";L=L.getAttribute("at2")==="true",this.updateAt_(1,X),this.updateAt_(2,L)},updateAt_:function(L,X){this.removeInput("AT"+L),this.removeInput("ORDINAL"+L,!0),X?(this.appendValueInput("AT"+L).setCheck("Number"),r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+L).appendField(r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+L),L===2&&r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(r.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const he=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+L]});he.setValidator(function(z){const be=z==="FROM_START"||z==="FROM_END";if(be!==X){const nt=this.getSourceBlock();return nt.updateAt_(L,be),nt.setFieldValue(z,"WHERE"+L),null}}),this.getInput("AT"+L).appendField(he,"WHERE"+L),L===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};y.text_getSubstring=$,y.text_changeCase={init:function(){const L=[[r.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[r.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[r.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(r.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(r.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},y.text_trim={init:function(){const L=[[r.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[r.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[r.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(r.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(r.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},y.text_print={init:function(){this.jsonInit({message0:r.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:r.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:r.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var E={updateType_:function(L){this.outputConnection.setCheck(L==="NUMBER"?"Number":"String")},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("type",this.getFieldValue("TYPE")),L},domToMutation:function(L){this.updateType_(L.getAttribute("type"))}};y.text_prompt_ext=Object.assign({},E,{init:function(){var L=[[r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(r.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),L.setValidator(X=>{this.updateType_(X)}),this.appendValueInput("TEXT").appendField(L,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});var S=Object.assign({},E,{init:function(){this.mixin(A);var L=[[r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(r.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),L.setValidator(X=>{this.updateType_(X)}),this.appendDummyInput().appendField(L,"TYPE").appendField(this.newQuote_(!0)).appendField(r.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:r.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});y.text_prompt=S,y.text_count={init:function(){this.jsonInit({message0:r.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:r.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:r.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},y.text_replace={init:function(){this.jsonInit({message0:r.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:r.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:r.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},y.text_reverse={init:function(){this.jsonInit({message0:r.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:r.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:r.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var A={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(L){for(let X=0,he;he=this.inputList[X];X++)for(let z=0,be;be=he.fieldRow[z];z++)if(L===be.name){he.insertFieldAt(z,this.newQuote_(!0)),he.insertFieldAt(z+2,this.newQuote_(!1));return}console.warn('field named "'+L+'" not found in '+this.toDevString())},newQuote_:function(L){return L=this.RTL?!L:L,r.fromJson$$module$build$src$core$field_registry({type:"field_image",src:L?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:L?"":""})}},C=function(){this.mixin(A),this.quoteField_("TEXT")},x={itemCount_:0,mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("items",`${this.itemCount_}`),L},domToMutation:function(L){this.itemCount_=parseInt(L.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(L){this.itemCount_=L.itemCount,this.updateShape_()},decompose:function(L){const X=L.newBlock("text_create_join_container");X.initSvg();let he=X.getInput("STACK").connection;for(let z=0;z<this.itemCount_;z++){const be=L.newBlock("text_create_join_item");be.initSvg(),he.connect(be.previousConnection),he=be.nextConnection}return X},compose:function(L){var X=L.getInputTargetBlock("STACK");for(L=[];X;)X.isInsertionMarker()||L.push(X.valueConnection_),X=X.getNextBlock();for(X=0;X<this.itemCount_;X++){const he=this.getInput("ADD"+X).connection.targetConnection;he&&!L.includes(he)&&he.disconnect()}for(this.itemCount_=L.length,this.updateShape_(),X=0;X<this.itemCount_;X++){let he;(he=L[X])==null||he.reconnect(this,"ADD"+X)}},saveConnections:function(L){L=L.getInputTargetBlock("STACK");let X=0;for(;L;){if(L.isInsertionMarker()){L=L.getNextBlock();continue}const he=this.getInput("ADD"+X);L.valueConnection_=he&&he.connection.targetConnection,L=L.getNextBlock(),X++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var L=0;L<this.itemCount_;L++)if(!this.getInput("ADD"+L)){const X=this.appendValueInput("ADD"+L).setAlign(r.Align$$module$build$src$core$inputs$align.RIGHT);L===0&&X.appendField(r.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(L=this.itemCount_;this.getInput("ADD"+L);L++)this.removeInput("ADD"+L)}},I=function(){this.mixin(A),this.itemCount_=2,this.updateShape_(),this.setMutator(new r.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};r.register$$module$build$src$core$extensions("text_append_tooltip",r.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var O=function(){this.setTooltip(()=>r.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))},F={isAt_:!1,mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("at",`${this.isAt_}`),L},domToMutation:function(L){L=L.getAttribute("at")!=="false",this.updateAt_(L)},updateAt_:function(L){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),L&&(this.appendValueInput("AT").setCheck("Number"),r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),r.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(r.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=L}},k=function(){this.getField("WHERE").setValidator(function(L){L=L==="FROM_START"||L==="FROM_END";const X=this.getSourceBlock();L!==X.isAt_&&X.updateAt_(L)}),this.updateAt_(!0),this.setTooltip(()=>{var L=this.getFieldValue("WHERE");let X=r.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return(L==="FROM_START"||L==="FROM_END")&&(L=L==="FROM_START"?r.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:r.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(X+="  "+L.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),X})};r.register$$module$build$src$core$extensions("text_indexOf_tooltip",O),r.register$$module$build$src$core$extensions("text_quotes",C),r.registerMixin$$module$build$src$core$extensions("quote_image_mixin",A),r.registerMutator$$module$build$src$core$extensions("text_join_mutator",x,I),r.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",F,k),r.defineBlocks$$module$build$src$core$common(y);var D={blocks:y},U={},ce={setStatements_:function(L){this.hasStatements_!==L&&(L?(this.appendStatementInput("STACK").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=L)},updateParams_:function(){let L="";this.arguments_.length&&(L=r.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),r.disable$$module$build$src$core$events$utils();try{this.setFieldValue(L,"PARAMS")}finally{r.enable$$module$build$src$core$events$utils()}},mutationToDom:function(L){const X=r.createElement$$module$build$src$core$utils$xml("mutation");L&&X.setAttribute("name",this.getFieldValue("NAME"));for(let he=0;he<this.argumentVarModels_.length;he++){const z=r.createElement$$module$build$src$core$utils$xml("arg"),be=this.argumentVarModels_[he];z.setAttribute("name",be.name),z.setAttribute("varid",be.getId()),L&&this.paramIds_&&z.setAttribute("paramId",this.paramIds_[he]),X.appendChild(z)}return this.hasStatements_||X.setAttribute("statements","false"),X},domToMutation:function(L){this.arguments_=[],this.argumentVarModels_=[];for(let he=0,z;z=L.childNodes[he];he++)if(z.nodeName.toLowerCase()==="arg"){var X=z;const be=X.getAttribute("name");X=X.getAttribute("varid")||X.getAttribute("varId"),this.arguments_.push(be),X=r.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,X,be,""),X!==null?this.argumentVarModels_.push(X):console.log(`Failed to create a variable named "${be}", ignoring.`)}this.updateParams_(),r.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(L.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const L=Object.create(null);if(this.argumentVarModels_.length){L.params=[];for(let X=0;X<this.argumentVarModels_.length;X++)L.params.push({name:this.argumentVarModels_[X].name,id:this.argumentVarModels_[X].getId()})}return this.hasStatements_||(L.hasStatements=!1),L},loadExtraState:function(L){if(this.arguments_=[],this.argumentVarModels_=[],L.params)for(let he=0;he<L.params.length;he++){var X=L.params[he];X=r.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,X.id,X.name,""),this.arguments_.push(X.name),this.argumentVarModels_.push(X)}this.updateParams_(),r.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(L.hasStatements!==!1)},decompose:function(L){const X=r.createElement$$module$build$src$core$utils$xml("block");X.setAttribute("type","procedures_mutatorcontainer");var he=r.createElement$$module$build$src$core$utils$xml("statement");he.setAttribute("name","STACK"),X.appendChild(he);for(let be=0;be<this.arguments_.length;be++){const nt=r.createElement$$module$build$src$core$utils$xml("block");nt.setAttribute("type","procedures_mutatorarg");var z=r.createElement$$module$build$src$core$utils$xml("field");z.setAttribute("name","NAME");const Ee=r.createTextNode$$module$build$src$core$utils$xml(this.arguments_[be]);z.appendChild(Ee),nt.appendChild(z),z=r.createElement$$module$build$src$core$utils$xml("next"),nt.appendChild(z),he.appendChild(nt),he=z}return L=r.domToBlock$$module$build$src$core$xml(X,L),this.type==="procedures_defreturn"?L.setFieldValue(this.hasStatements_,"STATEMENTS"):L.removeInput("STATEMENT_INPUT"),r.mutateCallers$$module$build$src$core$procedures(this),L},compose:function(L){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let X=L.getInputTargetBlock("STACK");for(;X&&!X.isInsertionMarker();){var he=X.getFieldValue("NAME");this.arguments_.push(he),he=this.workspace.getVariable(he,""),this.argumentVarModels_.push(he),this.paramIds_.push(X.id),X=X.nextConnection&&X.nextConnection.targetBlock()}if(this.updateParams_(),r.mutateCallers$$module$build$src$core$procedures(this),L=L.getFieldValue("STATEMENTS"),L!==null&&(L=L==="TRUE",this.hasStatements_!==L))if(L){this.setStatements_(!0);var z;(z=this.statementConnection_)==null||z.reconnect(this,"STACK"),this.statementConnection_=null}else z=this.getInput("STACK").connection,(this.statementConnection_=z.targetConnection)&&(z=z.targetBlock(),z.unplug(),z.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(L,X){var he=this.workspace.getVariableById(L);if(he.type===""){he=he.name,X=this.workspace.getVariableById(X);var z=!1;for(let be=0;be<this.argumentVarModels_.length;be++)this.argumentVarModels_[be].getId()===L&&(this.arguments_[be]=X.name,this.argumentVarModels_[be]=X,z=!0);z&&(this.displayRenamedVar_(he,X.name),r.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(L){const X=L.name;let he=!1,z;for(let be=0;be<this.argumentVarModels_.length;be++)this.argumentVarModels_[be].getId()===L.getId()&&(z=this.arguments_[be],this.arguments_[be]=X,he=!0);he&&(this.displayRenamedVar_(z,X),r.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(L,X){this.updateParams_();var he=this.getIcon(r.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(he&&he.bubbleIsVisible()){he=he.getWorkspace().getAllBlocks(!1);for(let z=0,be;be=he[z];z++)be.type==="procedures_mutatorarg"&&r.Names$$module$build$src$core$names.equals(L,be.getFieldValue("NAME"))&&be.setFieldValue(X,"NAME")}},customContextMenu:function(L){if(!this.isInFlyout){var X=this.getFieldValue("NAME"),he={type:this.callType_,extraState:{name:X,params:this.arguments_}};if(L.push({enabled:!0,text:r.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",X),callback:r.callbackFactory$$module$build$src$core$contextmenu(this,he)}),!this.isCollapsed())for(X=0;X<this.argumentVarModels_.length;X++){he=this.argumentVarModels_[X];const z={type:"variables_get",fields:{VAR:{name:he.name,id:he.getId(),type:he.type}}};L.push({enabled:!0,text:r.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",he.name),callback:r.callbackFactory$$module$build$src$core$contextmenu(this,z)})}}}};U.procedures_defnoreturn=Object.assign({},ce,{init:function(){var L=r.findLegalName$$module$build$src$core$procedures("",this);L=r.fromJson$$module$build$src$core$field_registry({type:"field_input",text:L}),L.setValidator(r.rename$$module$build$src$core$procedures),L.setSpellcheck(!1),this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(L,"NAME").appendField("","PARAMS"),this.setMutator(new r.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),U.procedures_defreturn=Object.assign({},ce,{init:function(){var L=r.findLegalName$$module$build$src$core$procedures("",this);L=r.fromJson$$module$build$src$core$field_registry({type:"field_input",text:L}),L.setValidator(r.rename$$module$build$src$core$procedures),L.setSpellcheck(!1),this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(L,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(r.Align$$module$build$src$core$inputs$align.RIGHT).appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new r.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var re={init:function(){this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(r.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(r.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};U.procedures_mutatorcontainer=re;var ae={init:function(){const L=r.fromJson$$module$build$src$core$field_registry({type:"field_input",text:r.DEFAULT_ARG$$module$build$src$core$procedures});L.setValidator(this.validator_),L.oldShowEditorFn_=L.showEditor_,L.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(L,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(r.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,L.onFinishEditing_=this.deleteIntermediateVars_,L.createdVariables_=[],L.onFinishEditing_("x")},validator_:function(L){var X=this.getSourceBlock();const he=X.workspace.getRootWorkspace();if(L=L.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!L)return null;const z=(X.workspace.targetWorkspace||X.workspace).getAllBlocks(!1),be=L.toLowerCase();for(let nt=0;nt<z.length;nt++){if(z[nt].id===this.getSourceBlock().id)continue;const Ee=z[nt].getFieldValue("NAME");if(Ee&&Ee.toLowerCase()===be)return null}return X.isInFlyout||((X=he.getVariable(L,""))&&X.name!==L&&he.renameVariableById(X.getId(),L),X||(X=he.createVariable(L,""))&&this.createdVariables_&&this.createdVariables_.push(X)),L},deleteIntermediateVars_:function(L){const X=this.getSourceBlock().workspace.getRootWorkspace();if(X)for(let he=0;he<this.createdVariables_.length;he++){const z=this.createdVariables_[he];z.name!==L&&X.deleteVariableById(z.getId())}}};U.procedures_mutatorarg=ae;var ne="DISABLED_PROCEDURE_DEFINITION",de={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(L,X){r.Names$$module$build$src$core$names.equals(L,this.getProcedureCall())&&(this.setFieldValue(X,"NAME"),this.setTooltip((this.outputConnection?r.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:r.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",X)))},setProcedureParameters_:function(L,X){var he=r.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((he=(he=he&&he.getIcon(r.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&he.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),L.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=X;else{if(X.length!==L.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let be=0;be<this.arguments_.length;be++){var z=this.getInput("ARG"+be);z&&(z=z.connection.targetConnection,this.quarkConnections_[this.quarkIds_[be]]=z,he&&z&&!X.includes(this.quarkIds_[be])&&(z.disconnect(),z.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(L),this.argumentVarModels_=[],L=0;L<this.arguments_.length;L++)he=r.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[L],""),this.argumentVarModels_.push(he);if(this.updateShape_(),this.quarkIds_=X){for(X=0;X<this.arguments_.length;X++)if(L=this.quarkIds_[X],L in this.quarkConnections_){let be;(be=this.quarkConnections_[L])!=null&&be.reconnect(this,"ARG"+X)||delete this.quarkConnections_[L]}}}},updateShape_:function(){for(var L=0;L<this.arguments_.length;L++){var X=this.getField("ARGNAME"+L);if(X){r.disable$$module$build$src$core$events$utils();try{X.setValue(this.arguments_[L])}finally{r.enable$$module$build$src$core$events$utils()}}else X=r.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[L]}),this.appendValueInput("ARG"+L).setAlign(r.Align$$module$build$src$core$inputs$align.RIGHT).appendField(X,"ARGNAME"+L)}for(L=this.arguments_.length;this.getInput("ARG"+L);L++)this.removeInput("ARG"+L);(L=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||L.appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&L.removeField("WITH"))},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");L.setAttribute("name",this.getProcedureCall());for(let X=0;X<this.arguments_.length;X++){const he=r.createElement$$module$build$src$core$utils$xml("arg");he.setAttribute("name",this.arguments_[X]),L.appendChild(he)}return L},domToMutation:function(L){var X=L.getAttribute("name");this.renameProcedure(this.getProcedureCall(),X),X=[];const he=[];for(let z=0,be;be=L.childNodes[z];z++)be.nodeName.toLowerCase()==="arg"&&(X.push(be.getAttribute("name")),he.push(be.getAttribute("paramId")));this.setProcedureParameters_(X,he)},saveExtraState:function(){const L=Object.create(null);return L.name=this.getProcedureCall(),this.arguments_.length&&(L.params=this.arguments_),L},loadExtraState:function(L){if(this.renameProcedure(this.getProcedureCall(),L.name),L=L.params){const X=[];X.length=L.length,X.fill(null),this.setProcedureParameters_(L,X)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(L){if(this.workspace&&!this.workspace.isFlyout&&L.recordUndo)if(L.type===r.CREATE$$module$build$src$core$events$utils&&L.ids.includes(this.id)){var X=this.getProcedureCall();if(X=r.getDefinition$$module$build$src$core$procedures(X,this.workspace),!X||X.type===this.defType_&&JSON.stringify(X.getVars())===JSON.stringify(this.arguments_)||(X=null),!X){r.setGroup$$module$build$src$core$events$utils(L.group),L=r.createElement$$module$build$src$core$utils$xml("xml"),X=r.createElement$$module$build$src$core$utils$xml("block"),X.setAttribute("type",this.defType_);var he=this.getRelativeToSurfaceXY(),z=he.y+2*r.config$$module$build$src$core$config.snapRadius;X.setAttribute("x",`${he.x+r.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),X.setAttribute("y",`${z}`),he=this.mutationToDom(),X.appendChild(he),he=r.createElement$$module$build$src$core$utils$xml("field"),he.setAttribute("name","NAME"),z=this.getProcedureCall();const be=r.findLegalName$$module$build$src$core$procedures(z,this);z!==be&&this.renameProcedure(z,be),he.appendChild(r.createTextNode$$module$build$src$core$utils$xml(z)),X.appendChild(he),L.appendChild(X),r.domToWorkspace$$module$build$src$core$xml(L,this.workspace),r.setGroup$$module$build$src$core$events$utils(!1)}}else L.type===r.DELETE$$module$build$src$core$events$utils?(X=this.getProcedureCall(),r.getDefinition$$module$build$src$core$procedures(X,this.workspace)||(r.setGroup$$module$build$src$core$events$utils(L.group),this.dispose(!0),r.setGroup$$module$build$src$core$events$utils(!1))):L.type===r.CHANGE$$module$build$src$core$events$utils&&L.element==="disabled"&&(X=this.getProcedureCall(),(z=r.getDefinition$$module$build$src$core$procedures(X,this.workspace))&&z.id===L.blockId&&((he=r.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),r.setGroup$$module$build$src$core$events$utils(L.group),L=z.isEnabled(),this.setDisabledReason(!L,ne),this.setWarningText(L?null:r.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",X)),r.setGroup$$module$build$src$core$events$utils(he)))},customContextMenu:function(L){if(this.workspace.isMovable()){var X=this.getProcedureCall(),he=this.workspace;L.push({enabled:!0,text:r.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const z=r.getDefinition$$module$build$src$core$procedures(X,he);z&&(he.centerOnBlock(z.id),r.setSelected$$module$build$src$core$common(z))}})}}};U.procedures_callnoreturn=Object.assign({},de,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(r.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),U.procedures_callreturn=Object.assign({},de,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(r.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});var ue="UNPARENTED_IFRETURN",Re={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(r.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(r.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(r.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("value",String(Number(this.hasReturnValue_))),L},domToMutation:function(L){this.hasReturnValue_=L.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(L){if(!(this.workspace.isDragging&&this.workspace.isDragging()||L.type!==r.MOVE$$module$build$src$core$events$utils&&L.type!==r.CREATE$$module$build$src$core$events$utils)){L=!1;var X=this;do{if(this.FUNCTION_TYPES.includes(X.type)){L=!0;break}X=X.getSurroundParent()}while(X);if(L?(X.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):X.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(r.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(r.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{r.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!L,ue)}finally{r.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};U.procedures_ifreturn=Re,r.defineBlocks$$module$build$src$core$common(U);var G={blocks:U},Z=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),K={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};r.register$$module$build$src$core$extensions("math_op_tooltip",r.buildTooltipForDropdown$$module$build$src$core$extensions("OP",K));var se={mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation"),X=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return L.setAttribute("divisor_input",String(X)),L},domToMutation:function(L){L=L.getAttribute("divisor_input")==="true",this.updateShape_(L)},updateShape_:function(L){const X=this.getInput("DIVISOR");L?X||this.appendValueInput("DIVISOR").setCheck("Number"):X&&this.removeInput("DIVISOR")}},Y=function(){this.getField("PROPERTY").setValidator(function(L){L=L==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(L)})};r.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",se,Y),r.register$$module$build$src$core$extensions("math_change_tooltip",r.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var me={updateType_:function(L){L==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("op",this.getFieldValue("OP")),L},domToMutation:function(L){if(L=L.getAttribute("op"),L===null)throw new TypeError("xmlElement had no op attribute");this.updateType_(L)}},fe=function(){this.getField("OP").setValidator((function(L){this.updateType_(L)}).bind(this))};r.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",me,fe),r.defineBlocks$$module$build$src$core$common(Z);var Ae={blocks:Z},Ce=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),Ie={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};r.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",r.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",Ie));var We={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};r.register$$module$build$src$core$extensions("controls_flow_tooltip",r.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",We));var ut={customContextMenu:function(L){if(!this.isInFlyout){var X=this.getField("VAR"),he=X.getVariable().name;this.isCollapsed()||he===null||(X={type:"variables_get",fields:{VAR:X.saveState(!0)}},L.push({enabled:!0,text:r.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",he),callback:r.callbackFactory$$module$build$src$core$contextmenu(this,X)}))}}};r.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",ut),r.register$$module$build$src$core$extensions("controls_for_tooltip",r.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),r.register$$module$build$src$core$extensions("controls_forEach_tooltip",r.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var Ye=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),we="CONTROL_FLOW_NOT_IN_LOOP",Q={getSurroundLoop:function(){let L=this;do{if(Ye.has(L.type))return L;L=L.getSurroundParent()}while(L);return null},onchange:function(L){const X=this.workspace;if(X.isDragging&&!X.isDragging()&&(L.type===r.MOVE$$module$build$src$core$events$utils||L.type===r.CREATE$$module$build$src$core$events$utils)&&(L=!!this.getSurroundLoop(),this.setWarningText(L?null:r.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{r.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!L,we)}finally{r.setRecordUndo$$module$build$src$core$events$utils(!0)}}};r.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",Q),r.defineBlocks$$module$build$src$core$common(Ce);var Ge={blocks:Ce,loopTypes:Ye},Oe=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),Ve={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};r.register$$module$build$src$core$extensions("logic_op_tooltip",r.buildTooltipForDropdown$$module$build$src$core$extensions("OP",Ve));var Fe={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const L=r.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&L.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&L.setAttribute("else","1"),L},domToMutation:function(L){this.elseifCount_=parseInt(L.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(L.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const L=Object.create(null);return this.elseifCount_&&(L.elseIfCount=this.elseifCount_),this.elseCount_&&(L.hasElse=!0),L},loadExtraState:function(L){this.elseifCount_=L.elseIfCount||0,this.elseCount_=L.hasElse?1:0,this.updateShape_()},decompose:function(L){const X=L.newBlock("controls_if_if");X.initSvg();let he=X.nextConnection;for(let z=1;z<=this.elseifCount_;z++){const be=L.newBlock("controls_if_elseif");be.initSvg(),he.connect(be.previousConnection),he=be.nextConnection}return this.elseCount_&&(L=L.newBlock("controls_if_else"),L.initSvg(),he.connect(L.previousConnection)),X},compose:function(L){L=L.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const X=[null],he=[null];let z=null;for(;L;){if(!L.isInsertionMarker())switch(L.type){case"controls_if_elseif":this.elseifCount_++,X.push(L.valueConnection_),he.push(L.statementConnection_);break;case"controls_if_else":this.elseCount_++,z=L.statementConnection_;break;default:throw TypeError("Unknown block type: "+L.type)}L=L.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(X,he,z)},saveConnections:function(L){L=L.nextConnection.targetBlock();let X=1;for(;L;){if(!L.isInsertionMarker())switch(L.type){case"controls_if_elseif":var he=this.getInput("IF"+X);const z=this.getInput("DO"+X);L.valueConnection_=he&&he.connection.targetConnection,L.statementConnection_=z&&z.connection.targetConnection,X++;break;case"controls_if_else":he=this.getInput("ELSE"),L.statementConnection_=he&&he.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+L.type)}L=L.getNextBlock()}},rebuildShape_:function(){const L=[null],X=[null];let he=null;this.getInput("ELSE")&&(he=this.getInput("ELSE").connection.targetConnection);for(let z=1;this.getInput("IF"+z);z++){const be=this.getInput("IF"+z),nt=this.getInput("DO"+z);L.push(be.connection.targetConnection),X.push(nt.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(L,X,he)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var L=1;this.getInput("IF"+L);L++)this.removeInput("IF"+L),this.removeInput("DO"+L);for(L=1;L<=this.elseifCount_;L++)this.appendValueInput("IF"+L).setCheck("Boolean").appendField(r.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+L).appendField(r.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(r.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(L,X,he){for(let z=1;z<=this.elseifCount_;z++){let be;(be=L[z])==null||be.reconnect(this,"IF"+z);let nt;(nt=X[z])==null||nt.reconnect(this,"DO"+z)}he==null||he.reconnect(this,"ELSE")}};r.registerMutator$$module$build$src$core$extensions("controls_if_mutator",Fe,null,["controls_if_elseif","controls_if_else"]);var tt=function(){this.setTooltip((function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return r.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return r.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return r.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4}else return r.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1;return""}).bind(this))};r.register$$module$build$src$core$extensions("controls_if_tooltip",tt);var Ue={onchange:function(L){this.prevBlocks_||(this.prevBlocks_=[null,null]);var X=this.getInputTargetBlock("A");const he=this.getInputTargetBlock("B");X&&he&&!this.workspace.connectionChecker.doTypeChecks(X.outputConnection,he.outputConnection)&&(r.setGroup$$module$build$src$core$events$utils(L.group),L=this.prevBlocks_[0],L!==X&&(X.unplug(),!L||L.isDisposed()||L.isShadow()||this.getInput("A").connection.connect(L.outputConnection)),X=this.prevBlocks_[1],X!==he&&(he.unplug(),!X||X.isDisposed()||X.isShadow()||this.getInput("B").connection.connect(X.outputConnection)),this.bumpNeighbours(),r.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},Je=function(){this.mixin(Ue)};r.register$$module$build$src$core$extensions("logic_compare",Je);var ve={prevParentConnection_:null,onchange:function(L){const X=this.getInputTargetBlock("THEN"),he=this.getInputTargetBlock("ELSE"),z=this.outputConnection.targetConnection;if((X||he)&&z)for(let be=0;2>be;be++){const nt=be===1?X:he;nt&&!nt.workspace.connectionChecker.doTypeChecks(nt.outputConnection,z)&&(r.setGroup$$module$build$src$core$events$utils(L.group),z===this.prevParentConnection_?(this.unplug(),z.getSourceBlock().bumpNeighbours()):(nt.unplug(),nt.bumpNeighbours()),r.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=z}};r.registerMixin$$module$build$src$core$extensions("logic_ternary",ve),r.defineBlocks$$module$build$src$core$common(Oe);var Me={blocks:Oe},vt=r.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),oe={init:function(){this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new r.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("items",String(this.itemCount_)),L},domToMutation:function(L){if(L=L.getAttribute("items"),!L)throw new TypeError("element did not have items");this.itemCount_=parseInt(L,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(L){this.itemCount_=L.itemCount,this.updateShape_()},decompose:function(L){const X=L.newBlock("lists_create_with_container");X.initSvg();let he=X.getInput("STACK").connection;for(let z=0;z<this.itemCount_;z++){const be=L.newBlock("lists_create_with_item");if(be.initSvg(),!be.previousConnection)throw Error("itemBlock has no previousConnection");he.connect(be.previousConnection),he=be.nextConnection}return X},compose:function(L){var X=L.getInputTargetBlock("STACK");for(L=[];X;)X.isInsertionMarker()||L.push(X.valueConnection_),X=X.getNextBlock();for(X=0;X<this.itemCount_;X++){const he=this.getInput("ADD"+X).connection.targetConnection;he&&!L.includes(he)&&he.disconnect()}for(this.itemCount_=L.length,this.updateShape_(),X=0;X<this.itemCount_;X++){let he;(he=L[X])==null||he.reconnect(this,"ADD"+X)}},saveConnections:function(L){L=L.getInputTargetBlock("STACK");let X=0;for(;L;){if(L.isInsertionMarker()){L=L.getNextBlock();continue}const he=this.getInput("ADD"+X);let z;L.valueConnection_=(z=he)==null?void 0:z.connection.targetConnection,L=L.getNextBlock(),X++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(r.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var L=0;L<this.itemCount_;L++)if(!this.getInput("ADD"+L)){const X=this.appendValueInput("ADD"+L).setAlign(r.Align$$module$build$src$core$inputs$align.RIGHT);L===0&&X.appendField(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(L=this.itemCount_;this.getInput("ADD"+L);L++)this.removeInput("ADD"+L)}};vt.lists_create_with=oe;var ee={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};vt.lists_create_with_container=ee;var W={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};vt.lists_create_with_item=W;var ot={init:function(){var L=[[r.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[r.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(r.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),!L)throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(L,"END"),this.setInputsInline(!0),this.setTooltip(()=>r.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}};vt.lists_indexOf=ot;var je={init:function(){var L=[[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),L.setValidator(function(X){X=X==="REMOVE",this.getSourceBlock().updateStatement_(X)}),this.appendValueInput("VALUE").setCheck("Array").appendField(r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(L,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const X=this.getFieldValue("MODE"),he=this.getFieldValue("WHERE");let z="";switch(X+" "+he){case"GET FROM_START":case"GET FROM_END":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":z=r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(he==="FROM_START"||he==="FROM_END")&&(z+="  "+(he==="FROM_START"?r.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:r.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),z})},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");L.setAttribute("statement",String(!this.outputConnection));const X=this.getInput("AT")instanceof r.ValueInput$$module$build$src$core$inputs$value_input;return L.setAttribute("at",String(X)),L},domToMutation:function(L){const X=L.getAttribute("statement")==="true";this.updateStatement_(X),L=L.getAttribute("at")!=="false",this.updateAt_(L)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(L){L.isStatement?this.updateStatement_(!0):typeof L=="string"&&this.domToMutation(r.textToDom$$module$build$src$core$utils$xml(L))},updateStatement_:function(L){L!==!this.outputConnection&&(this.unplug(!0,!0),L?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(L){this.removeInput("AT"),this.removeInput("ORDINAL",!0),L?(this.appendValueInput("AT").setCheck("Number"),r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const X=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});X.setValidator(function(he){const z=he==="FROM_START"||he==="FROM_END";if(z!==L){const be=this.getSourceBlock();return be.updateAt_(z),be.setFieldValue(he,"WHERE"),null}}),this.getInput("AT").appendField(X,"WHERE"),r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};vt.lists_getIndex=je;var Qe={init:function(){var L=[[r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[r.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:L}),this.appendDummyInput().appendField(L,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const X=this.getFieldValue("MODE"),he=this.getFieldValue("WHERE");let z="";switch(X+" "+he){case"SET FROM_START":case"SET FROM_END":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":z=r.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(he==="FROM_START"||he==="FROM_END")&&(z+="  "+r.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),z})},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation"),X=this.getInput("AT")instanceof r.ValueInput$$module$build$src$core$inputs$value_input;return L.setAttribute("at",String(X)),L},domToMutation:function(L){L=L.getAttribute("at")!=="false",this.updateAt_(L)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(L){this.removeInput("AT"),this.removeInput("ORDINAL",!0),L?(this.appendValueInput("AT").setCheck("Number"),r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const X=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});X.setValidator(function(he){const z=he==="FROM_START"||he==="FROM_END";if(z!==L){const be=this.getSourceBlock();return be.updateAt_(z),be.setFieldValue(he,"WHERE"),null}}),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(X,"WHERE")}};vt.lists_setIndex=Qe;var ht={init:function(){this.WHERE_OPTIONS_1=[[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");var X=this.getInput("AT1")instanceof r.ValueInput$$module$build$src$core$inputs$value_input;return L.setAttribute("at1",String(X)),X=this.getInput("AT2")instanceof r.ValueInput$$module$build$src$core$inputs$value_input,L.setAttribute("at2",String(X)),L},domToMutation:function(L){const X=L.getAttribute("at1")==="true";L=L.getAttribute("at2")==="true",this.updateAt_(1,X),this.updateAt_(2,L)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(L,X){this.removeInput("AT"+L),this.removeInput("ORDINAL"+L,!0),X?(this.appendValueInput("AT"+L).setCheck("Number"),r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+L).appendField(r.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+L);const he=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+L]});he.setValidator(function(z){const be=z==="FROM_START"||z==="FROM_END";if(be!==X){const nt=this.getSourceBlock();return nt.updateAt_(L,be),nt.setFieldValue(z,"WHERE"+L),null}}),this.getInput("AT"+L).appendField(he,"WHERE"+L),L===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),r.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};vt.lists_getSublist=ht,vt.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},vt.lists_split={init:function(){const L=r.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[r.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[r.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!L)throw Error("field_dropdown not found");L.setValidator(X=>{this.updateType_(X)}),this.setHelpUrl(r.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(L,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(r.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const X=this.getFieldValue("MODE");if(X==="SPLIT")return r.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if(X==="JOIN")return r.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+X)})},updateType_:function(L){if(this.getFieldValue("MODE")!==L){const X=this.getInput("INPUT").connection;X.setShadowDom(null);const he=X.targetBlock();he&&(X.disconnect(),he.isShadow()?he.dispose(!1):this.bumpNeighbours())}L==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const L=r.createElement$$module$build$src$core$utils$xml("mutation");return L.setAttribute("mode",this.getFieldValue("MODE")),L},domToMutation:function(L){this.updateType_(L.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},r.defineBlocks$$module$build$src$core$common(vt);var ft={blocks:vt},He=Object.assign({},vt,Oe,Ce,Z,U,y,h,s),St={blocks:He,lists:ft,logic:Me,loops:Ge,math:Ae,procedures:G,texts:D,variables:v,variablesDynamic:d};return St.__namespace__=r,St})})(Roe);const xoe=()=>{Pn.forBlock.takeoff=function(){return"flyUp(5, 'CM');"},Pn.forBlock.takeoff_after_seconds=function(i){return`setWaitTime(${i.getFieldValue("SECONDS")}, true);`},Pn.forBlock.capture_image=function(){return"captureImage();"},Pn.forBlock.set_speed=function(i){return`setDroneSpeed(${i.getFieldValue("SPEED")});`},Pn.forBlock.wait=function(i){return`setWaitTime(${i.getFieldValue("SECONDS")}, false);`},Pn.forBlock.flying_forward_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyForward(${e}, '${n}');`},Pn.forBlock.flying_forward_time=function(i){return`flyForward(${i.getFieldValue("SECONDS")}, 'SECONDS');`},Pn.forBlock.flying_backward_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyBackward(${e},'${n}');`},Pn.forBlock.flying_backward_time=function(i){return`flyBackward(${i.getFieldValue("SECONDS")}, 'SECONDS');`},Pn.forBlock.flying_left_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyLeft(${e}, '${n}');`},Pn.forBlock.flying_left_time=function(i){return`flyLeft(${i.getFieldValue("SECONDS")},'SECONDS');`},Pn.forBlock.flying_right_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyRight(${e}, '${n}');`},Pn.forBlock.flying_right_time=function(i){return`flyRight(${i.getFieldValue("SECONDS")},'SECONDS');`},Pn.forBlock.flying_up_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyUp(${e}, '${n}');`},Pn.forBlock.flying_up_time=function(i){return`flyUp(${i.getFieldValue("SECONDS")},'SECONDS');`},Pn.forBlock.flying_down_distance=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`flyDown(${e}, '${n}');`},Pn.forBlock.flying_down_time=function(i){return`flyDown(${i.getFieldValue("SECONDS")},'SECONDS');`},Pn.forBlock.set_speed=function(i){return`setSpeed(${i.getFieldValue("SPEED")});`},Pn.forBlock.fly=function(i){const e=i.getFieldValue("x"),n=i.getFieldValue("y"),r=i.getFieldValue("z"),s=i.getFieldValue("UNIT");return`moveTo(${e}, ${n}, ${r}, '${s}');`},Pn.forBlock.circle_left=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`rotateDrone('CIRCLE_LEFT', 360, ${e}, '${n}'); `},Pn.forBlock.circle_right=function(i){const e=i.getFieldValue("DISTANCE"),n=i.getFieldValue("UNIT");return`rotateDrone('CIRCLE_RIGHT', 360, ${e}, '${n}'); `},Pn.forBlock.yaw_left=function(i){return`rotateDrone('LEFT', ${i.getFieldValue("DEGREE")}, null, null); `},Pn.forBlock.yaw_right=function(i){return`rotateDrone('RIGHT', ${i.getFieldValue("DEGREE")}, null, null); `},Pn.forBlock.arc_left=function(i){const e=i.getFieldValue("DEGREE"),n=i.getFieldValue("DISTANCE"),r=i.getFieldValue("UNIT");return`rotateDrone('ARC_LEFT', ${e}, ${n}, '${r}'); `},Pn.forBlock.arc_right=function(i){const e=i.getFieldValue("DEGREE"),n=i.getFieldValue("DISTANCE"),r=i.getFieldValue("UNIT");return`rotateDrone('ARC_RIGHT', ${e}, ${n}, '${r}'); `},Pn.forBlock.land=function(){return"flyDown(-Infinity, 'CM');"},Pn.forBlock.land_for_seconds=function(i){return`flyDown(-Infinity, 'WAIT,${i.getFieldValue("SECONDS")}');`},Pn.forBlock.flip_left=function(){return"flip('LEFT');"},Pn.forBlock.flip_right=function(){return"flip('RIGHT');"},Pn.forBlock.flip_forward=function(){return"flip('FORWARD');"},Pn.forBlock.flip_backward=function(){return"flip('BACKWARD');"},Pn.forBlock.pickup_object=function(i){return`pickupObject('${i.getFieldValue("OBJECT_NAME")}');`},Pn.forBlock.drop_object=function(i){return`dropObject('${i.getFieldValue("OBJECT_NAME")}');`},Pn.forBlock.spray_object=function(i){return`sprayObject('${i.getFieldValue("OBJECT_NAME")}');`},Pn.forBlock.advertise_text=function(i){return`advertiseText('${i.getFieldValue("ADV_TEXT")}');`}},Vt={TAKEOFF:"#3a86ff",NAVIGATION:"#8338ec",LAND:"#fb5607",FLIP:"#3a86ff",LOGIC:"#4ecdc4",LOOPS:"#00bbf9",MATH:"#ffd166",TEXT:"#f15bb5",LISTS:"#9b5de5",VARIABLE:"#08979d",FUNCTIONS:"#0d3b66",ACTIONS:"#ef476f"};xoe();const woe={kind:"categoryToolbox",contents:[{kind:"category",name:"Takeoff",categorystyle:"takeoff_category",contents:[{kind:"block",type:"takeoff"},{kind:"block",type:"takeoff_after_seconds"}]},{kind:"category",name:"Camera",categorystyle:"camera_category",contents:[{kind:"block",type:"capture_image"}]},{kind:"category",name:"Navigation",categorystyle:"navigation_category",contents:[{kind:"block",type:"set_speed"},{kind:"block",type:"wait"},{kind:"block",type:"flying_forward_distance"},{kind:"block",type:"flying_backward_distance"},{kind:"block",type:"flying_left_distance"},{kind:"block",type:"flying_right_distance"},{kind:"block",type:"flying_up_distance"},{kind:"block",type:"flying_down_distance"},{kind:"block",type:"fly"},{kind:"block",type:"arc_left"},{kind:"block",type:"arc_right"},{kind:"block",type:"yaw_left"},{kind:"block",type:"yaw_right"}]},{kind:"category",name:"Flip",categorystyle:"flip_category",contents:[{kind:"block",type:"flip_forward"},{kind:"block",type:"flip_backward"},{kind:"block",type:"flip_left"},{kind:"block",type:"flip_right"}]},{kind:"category",name:"Land",categorystyle:"land_category",contents:[{kind:"block",type:"land"},{kind:"block",type:"land_for_seconds"}]},{kind:"sep"},{kind:"category",name:"Actions",categorystyle:"actions_category",contents:[{kind:"block",type:"pickup_object"},{kind:"block",type:"drop_object"},{kind:"block",type:"spray_object"},{kind:"block",type:"advertise_text"}]},{kind:"category",name:"Logic",categorystyle:"logic_category",contents:[{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare",fields:{OP:"EQ"}},{kind:"block",type:"logic_operation",fields:{OP:"AND"}},{kind:"block",type:"logic_negate"},{kind:"block",type:"logic_boolean",fields:{BOOL:"TRUE"}}]},{kind:"category",name:"Loops",categorystyle:"loop_category",contents:[{kind:"block",type:"controls_repeat_ext",inputs:{TIMES:{shadow:{kind:"block",type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"controls_whileUntil",fields:{MODE:"WHILE"}}]},{kind:"category",name:"Math",categorystyle:"math_category",contents:[{kind:"block",type:"math_number",fields:{NUM:123}},{kind:"block",type:"math_arithmetic",fields:{OP:"ADD"},inputs:{A:{shadow:{kind:"block",type:"math_number",fields:{NUM:1}}},B:{shadow:{kind:"block",type:"math_number",fields:{NUM:1}}}}},{kind:"block",type:"math_single",fields:{OP:"ROOT"},inputs:{NUM:{shadow:{kind:"block",type:"math_number",fields:{NUM:9}}}}},{kind:"block",type:"math_trig",fields:{OP:"SIN"},inputs:{NUM:{shadow:{kind:"block",type:"math_number",fields:{NUM:45}}}}},{kind:"block",type:"math_constant",fields:{CONSTANT:"PI"}},{kind:"block",type:"math_number_property",fields:{PROPERTY:"EVEN"},inputs:{NUMBER_TO_CHECK:{shadow:{kind:"block",type:"math_number",fields:{NUM:0}}}}},{kind:"block",type:"math_round",fields:{OP:"ROUND"},inputs:{NUM:{shadow:{kind:"block",type:"math_number",fields:{NUM:3.1}}}}},{kind:"block",type:"math_on_list",fields:{OP:"SUM"}},{kind:"block",type:"math_modulo",inputs:{DIVIDEND:{shadow:{kind:"block",type:"math_number",fields:{NUM:64}}},DIVISOR:{shadow:{kind:"block",type:"math_number",fields:{NUM:10}}}}},{kind:"block",type:"math_constrain",inputs:{VALUE:{shadow:{kind:"block",type:"math_number",fields:{NUM:50}}},LOW:{shadow:{kind:"block",type:"math_number",fields:{NUM:1}}},HIGH:{shadow:{kind:"block",type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_int",inputs:{FROM:{shadow:{kind:"block",type:"math_number",fields:{NUM:1}}},TO:{shadow:{kind:"block",type:"math_number",fields:{NUM:100}}}}},{kind:"block",type:"math_random_float"}]},{kind:"category",name:"Text",categorystyle:"text_category",contents:[{kind:"block",type:"text",fields:{TEXT:""}},{kind:"block",type:"text_length"},{kind:"block",type:"text_print"}]},{kind:"category",name:"Lists",categorystyle:"list_category",contents:[{kind:"block",type:"lists_create_with"},{kind:"block",type:"lists_create_with"},{kind:"block",type:"lists_repeat",inputs:{NUM:{shadow:{kind:"block",type:"math_number",fields:{NUM:5}}}}},{kind:"block",type:"lists_length"},{kind:"block",type:"lists_isEmpty"},{kind:"block",type:"lists_indexOf",fields:{END:"FIRST"},inputs:{VALUE:{block:{kind:"block",type:"variables_get",fields:{VAR:{name:"list"}}}}}},{type:"lists_split",kind:"block",fields:{MODE:"SPLIT"},inputs:{DELIM:{shadow:{type:"text",fields:{TEXT:","}}}}},{type:"lists_sort",kind:"block",fields:{TYPE:"NUMERIC",DIRECTION:"1"}}]},{kind:"sep"},{kind:"category",name:"Variables",custom:"VARIABLE",categorystyle:"variable_category"},{kind:"category",name:"Functions",custom:"PROCEDURE",categorystyle:"functions_category"}]},Moe=i=>{i.Blocks.takeoff={init:function(){this.appendDummyInput().appendField("Take off"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.TAKEOFF),this.setTooltip("Command to take off"),this.setHelpUrl("")}},i.Blocks.takeoff_after_seconds={init:function(){this.appendDummyInput().appendField("take off after").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.TAKEOFF),this.setTooltip("Command to take off after a specific number of seconds"),this.setHelpUrl("")}},i.Blocks.capture_image={init:function(){this.appendDummyInput().appendField("capture"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.TAKEOFF),this.setTooltip("Command to take image"),this.setHelpUrl("")}},i.Blocks.set_speed={init:function(){this.appendDummyInput().appendField("set speed").appendField(new i.FieldDropdown([["25","1"],["50","2"],["75","3"],["100","4"]]),"SPEED").appendField("cm/s"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set drone speed"),this.setHelpUrl("")}},i.Blocks.wait={init:function(){this.appendDummyInput().appendField("wait").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_forward_distance={init:function(){this.appendDummyInput().appendField("fly forward").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly forward a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_forward_time={init:function(){this.appendDummyInput().appendField("fly forward").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_backward_distance={init:function(){this.appendDummyInput().appendField("fly backward").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly backward a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_backward_time={init:function(){this.appendDummyInput().appendField("fly backward").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_left_distance={init:function(){this.appendDummyInput().appendField("fly left").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly left a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_left_time={init:function(){this.appendDummyInput().appendField("fly left").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_right_distance={init:function(){this.appendDummyInput().appendField("fly right").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly right a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_right_time={init:function(){this.appendDummyInput().appendField("fly right").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_up_distance={init:function(){this.appendDummyInput().appendField("fly up").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly up a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_up_time={init:function(){this.appendDummyInput().appendField("fly up").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.flying_down_distance={init:function(){this.appendDummyInput().appendField("fly down").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly down a certain distance in inches or cm"),this.setHelpUrl("")}},i.Blocks.flying_down_time={init:function(){this.appendDummyInput().appendField("fly down").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.fly={init:function(){this.appendDummyInput().appendField("fly x").appendField(new i.FieldNumber(0,-1/0,null),"x").appendField("y").appendField(new i.FieldNumber(0,-1/0,null),"y").appendField("z").appendField(new i.FieldNumber(0,-1/0,null),"z").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to set wait time for drone"),this.setHelpUrl("")}},i.Blocks.arc_left={init:function(){this.appendDummyInput().appendField("arc left").appendField(new i.FieldNumber(0,0,null),"DEGREE").appendField(" degrees with ").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT").appendField(" radius"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to arc left a certain number of degrees and distance with radius in inches or cm"),this.setHelpUrl("")}},i.Blocks.arc_right={init:function(){this.appendDummyInput().appendField("arc right").appendField(new i.FieldNumber(0,0,null),"DEGREE").appendField(" degrees with ").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT").appendField(" radius"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to arc right a certain number of degrees and distance with radius in inches or cm"),this.setHelpUrl("")}},i.Blocks.circle_left={init:function(){this.appendDummyInput().appendField("circle left with ").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT").appendField(" radius"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly in a circle to the left with a given radius in inches or cm"),this.setHelpUrl("")}},i.Blocks.circle_right={init:function(){this.appendDummyInput().appendField("circle right with ").appendField(new i.FieldNumber(0,0,null),"DISTANCE").appendField(new i.FieldDropdown([["inches","INCHES"],["cm","CM"]]),"UNIT").appendField(" radius"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to fly in a circle to the right with a given radius in inches or cm"),this.setHelpUrl("")}},i.Blocks.yaw_left={init:function(){this.appendDummyInput().appendField("yaw left").appendField(new i.FieldNumber(0,0,null),"DEGREE").appendField(" degrees"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to yaw left by a certain number of degrees"),this.setHelpUrl("")}},i.Blocks.yaw_right={init:function(){this.appendDummyInput().appendField("yaw right").appendField(new i.FieldNumber(0,0,null),"DEGREE").appendField(" degrees"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.NAVIGATION),this.setTooltip("Command to yaw right by a certain number of degrees"),this.setHelpUrl("")}},i.Blocks.flip_left={init:function(){this.appendDummyInput().appendField("flip left"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.FLIP),this.setTooltip("Command to flip left"),this.setHelpUrl("")}},i.Blocks.flip_right={init:function(){this.appendDummyInput().appendField("flip right"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.FLIP),this.setTooltip("Command to flip right"),this.setHelpUrl("")}},i.Blocks.flip_forward={init:function(){this.appendDummyInput().appendField("flip forward"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.FLIP),this.setTooltip("Command to flip forward"),this.setHelpUrl("")}},i.Blocks.flip_backward={init:function(){this.appendDummyInput().appendField("flip backward"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.FLIP),this.setTooltip("Command to flip backward"),this.setHelpUrl("")}},i.Blocks.land={init:function(){this.appendDummyInput().appendField("land"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.LAND),this.setTooltip("Command to land"),this.setHelpUrl("")}},i.Blocks.land_for_seconds={init:function(){this.appendDummyInput().appendField("land for ").appendField(new i.FieldNumber(0,0,60),"SECONDS").appendField("seconds then takeoff"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.LAND),this.setTooltip("Command to take off after a specific number of seconds"),this.setHelpUrl("")}},i.Blocks.pickup_object={init:function(){this.appendDummyInput().appendField("pick up object").appendField(new i.FieldTextInput("book1"),"OBJECT_NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.ACTIONS),this.setTooltip("Pick up an object by name"),this.setHelpUrl("")}},i.Blocks.drop_object={init:function(){this.appendDummyInput().appendField("drop object").appendField(new i.FieldTextInput("book1"),"OBJECT_NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.ACTIONS),this.setTooltip("Drop an object by name"),this.setHelpUrl("")}},i.Blocks.spray_object={init:function(){this.appendDummyInput().appendField("spray").appendField(new i.FieldTextInput("watercan"),"OBJECT_NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.ACTIONS),this.setTooltip("Spray water or pesticide from a can"),this.setHelpUrl("")}},i.Blocks.advertise_text={init:function(){this.appendDummyInput().appendField("advertise").appendField(new i.FieldTextInput("Sale"),"ADV_TEXT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(Vt.ACTIONS),this.setTooltip("Text for drone flyer"),this.setHelpUrl("")}}},Ioe=R2.defineTheme("modern",{base:x2.Classic,blockStyles:{list_blocks:{colourPrimary:Vt.LISTS,colourSecondary:Vt.LISTS,colourTertiary:Vt.LISTS},logic_blocks:{colourPrimary:Vt.LOGIC,colourSecondary:Vt.LOGIC,colourTertiary:Vt.LOGIC},loop_blocks:{colourPrimary:Vt.LOOPS,colourSecondary:Vt.LOOPS,colourTertiary:Vt.LOOPS},math_blocks:{colourPrimary:Vt.MATH,colourSecondary:Vt.MATH,colourTertiary:Vt.MATH},procedure_blocks:{colourPrimary:Vt.FUNCTIONS,colourSecondary:Vt.FUNCTIONS,colourTertiary:Vt.FUNCTIONS},text_blocks:{colourPrimary:Vt.TEXT,colourSecondary:Vt.TEXT,colourTertiary:Vt.TEXT},variable_blocks:{colourPrimary:Vt.VARIABLE,colourSecondary:Vt.VARIABLE,colourTertiary:Vt.VARIABLE}},categoryStyles:{takeoff_category:{colour:Vt.TAKEOFF},camera_category:{colour:Vt.LAND},navigation_category:{colour:Vt.NAVIGATION},land_category:{colour:Vt.LAND},flip_category:{colour:Vt.FLIP},logic_category:{colour:Vt.LOGIC},loop_category:{colour:Vt.LOOPS},math_category:{colour:Vt.MATH},text_category:{colour:Vt.TEXT},list_category:{colour:Vt.LISTS},variable_category:{colour:Vt.VARIABLE},functions_category:{colour:Vt.FUNCTIONS},actions_category:{colour:Vt.ACTIONS}},componentStyles:{flyoutOpacity:.4},startHats:null});var O2={exports:{}};const Ooe={},Loe=Object.freeze(Object.defineProperty({__proto__:null,default:Ooe},Symbol.toStringTag,{value:"Module"})),Noe=WG(Loe);(function(i,e){(function(r,s){i.exports=s()})(tp,()=>(()=>{var n={"./original-repo/interpreter.js":function(l,u,d){/**
 * @license
 * Copyright 2013 Neil Fraser
 * SPDX-License-Identifier: Apache-2.0
 */var h=function(f,p){typeof f=="string"&&(f=this.parse_(f,"code"));var m=f.constructor;this.newNode=function(){return new m({options:{}})};var v=this.newNode();for(var y in f)v[y]=y==="body"?f[y].slice():f[y];this.ast=v,this.tasks=[],this.initFunc_=p,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var $=/^step([A-Z]\w*)$/,E;for(var S in this)typeof this[S]=="function"&&(E=S.match($))&&(this.stepFunctions_[E[1]]=this[S].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=this.parse_(this.polyfills_.join(`
`),"polyfills"),this.polyfills_=void 0,h.stripLocations_(this.ast,void 0,void 0);var A=new h.State(this.ast,this.globalScope);A.done=!1,this.stateStack=[A],this.run(),this.value=void 0,this.ast=v,A=new h.State(this.ast,this.globalScope),A.done=!1,this.stateStack.length=0,this.stateStack[0]=A};h.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},h.Status={DONE:0,STEP:1,TASK:2,ASYNC:3},h.PARSE_OPTIONS={locations:!0,ecmaVersion:5},h.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},h.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},h.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},h.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},h.STEP_ERROR={STEP_ERROR:!0},h.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},h.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},h.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},h.toStringCycles_=[],h.vm=null,h.currentInterpreter_=null,h.nativeGlobal=typeof globalThis>"u"?this||window:globalThis,h.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","close();","};"],h.legalArrayLength=function(f){var p=f>>>0;return p===Number(f)?p:NaN},h.legalArrayIndex=function(f){var p=f>>>0;return String(p)===String(f)&&p!==4294967295?p:NaN},h.stripLocations_=function(f,p,m){p?f.start=p:delete f.start,m?f.end=m:delete f.end;for(var v in f)if(v!=="loc"&&f.hasOwnProperty(v)){var y=f[v];y&&typeof y=="object"&&h.stripLocations_(y,p,m)}},h.prototype.REGEXP_MODE=2,h.prototype.REGEXP_THREAD_TIMEOUT=1e3,h.prototype.POLYFILL_TIMEOUT=1e3,h.prototype.getterStep_=!1,h.prototype.setterStep_=!1,h.prototype.appendCodeNumber_=0,h.prototype.taskCodeNumber_=0,h.prototype.parse_=function(f,p){var m={};for(var v in h.PARSE_OPTIONS)m[v]=h.PARSE_OPTIONS[v];return m.sourceFile=p,h.nativeGlobal.acorn.parse(f,m)},h.prototype.appendCode=function(f){var p=this.stateStack[0];if(!p||p.node.type!=="Program")throw Error("Expecting original AST to start with a Program node");if(typeof f=="string"&&(f=this.parse_(f,"appendCode"+this.appendCodeNumber_++)),!f||f.type!=="Program")throw Error("Expecting new AST to start with a Program node");this.populateScope_(f,p.scope),Array.prototype.push.apply(p.node.body,f.body),p.node.body.variableCache_=null,p.done=!1},h.prototype.step=function(){var f=this.stateStack,p;do{var m=f[f.length-1];if(this.paused_)return!0;if(!m||m.node.type==="Program"&&m.done){if(!this.tasks.length)return!1;if(m=this.nextTask_(),!m)return!0}var v=m.node,y=h.currentInterpreter_;h.currentInterpreter_=this;try{var $=this.stepFunctions_[v.type](f,m,v)}catch(E){if(E!==h.STEP_ERROR)throw this.value!==E&&(this.value=void 0),E}finally{h.currentInterpreter_=y}if($&&f.push($),this.getterStep_)throw this.value=void 0,Error("Getter not supported in this context");if(this.setterStep_)throw this.value=void 0,Error("Setter not supported in this context");!p&&!v.end&&(p=Date.now()+this.POLYFILL_TIMEOUT)}while(!v.end&&p>Date.now());return!0},h.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},h.prototype.getStatus=function(){if(this.paused_)return h.Status.ASYNC;var f=this.stateStack,p=f[f.length-1];if(p&&(p.node.type!=="Program"||!p.done))return h.Status.STEP;var m=this.tasks[0];return m?m.time>Date.now()?h.Status.TASK:h.Status.STEP:h.Status.DONE},h.prototype.initGlobal=function(f){this.setProperty(f,"NaN",NaN,h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"Infinity",1/0,h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"undefined",void 0,h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"window",f,h.READONLY_DESCRIPTOR),this.setProperty(f,"this",f,h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"self",f),this.OBJECT_PROTO=new h.Object(null),this.FUNCTION_PROTO=new h.Object(this.OBJECT_PROTO),this.initFunction(f),this.initObject(f),f.proto=this.OBJECT_PROTO,this.setProperty(f,"constructor",this.OBJECT,h.NONENUMERABLE_DESCRIPTOR),this.initArray(f),this.initString(f),this.initBoolean(f),this.initNumber(f),this.initDate(f),this.initRegExp(f),this.initError(f),this.initMath(f),this.initJSON(f);var p=this,m,v=this.createNativeFunction(function(E){throw EvalError("Can't happen")},!1);v.eval=!0,this.setProperty(f,"eval",v,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"parseInt",this.createNativeFunction(parseInt,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"parseFloat",this.createNativeFunction(parseFloat,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"isNaN",this.createNativeFunction(isNaN,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"isFinite",this.createNativeFunction(isFinite,!1),h.NONENUMERABLE_DESCRIPTOR);for(var y=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],$=0;$<y.length;$++)m=function(E){return function(S){try{return E(S)}catch(A){p.throwException(p.URI_ERROR,A.message)}}}(y[$][0]),this.setProperty(f,y[$][1],this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR);m=function(S){return p.createTask_(!1,arguments)},this.setProperty(f,"setTimeout",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function(S){return p.createTask_(!0,arguments)},this.setProperty(f,"setInterval",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function(S){p.deleteTask_(S)},this.setProperty(f,"clearTimeout",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function(S){p.deleteTask_(S)},this.setProperty(f,"clearInterval",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),this.OBJECT=this.OBJECT,this.OBJECT_PROTO=this.OBJECT_PROTO,this.FUNCTION=this.FUNCTION,this.FUNCTION_PROTO=this.FUNCTION_PROTO,this.ARRAY=this.ARRAY,this.ARRAY_PROTO=this.ARRAY_PROTO,this.REGEXP=this.REGEXP,this.REGEXP_PROTO=this.REGEXP_PROTO,this.DATE=this.DATE,this.DATE_PROTO=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,f)},h.prototype.functionCodeNumber_=0,h.prototype.initFunction=function(f){var p=this,m,v=/^[A-Za-z_$][\w$]*$/;m=function($){if(arguments.length)var E=String(arguments[arguments.length-1]);else var E="";var S=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(S){for(var A=S.split(/\s*,\s*/),C=0;C<A.length;C++){var x=A[C];v.test(x)||p.throwException(p.SYNTAX_ERROR,"Invalid function argument: "+x)}S=A.join(", ")}try{var I=p.parse_("(function("+S+") {"+E+"})","function"+p.functionCodeNumber_++)}catch(F){p.throwException(p.SYNTAX_ERROR,"Invalid code: "+F.message)}I.body.length!==1&&p.throwException(p.SYNTAX_ERROR,"Invalid code in function body");var O=I.body[0].expression;return p.createFunction(O,p.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(m,!0),this.setProperty(f,"Function",this.FUNCTION,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,h.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",m=function($,E,S){var A=p.stateStack[p.stateStack.length-1];A.func_=$,A.funcThis_=E,A.arguments_=[],S!=null&&(S instanceof h.Object?A.arguments_=Array.from(S.properties):p.throwException(p.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),A.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"apply",m),this.polyfills_.push("(function() {","var apply_ = Function.prototype.apply;","Function.prototype.apply = function apply(thisArg, args) {","var a2 = [];","for (var i = 0; i < args.length; i++) {","a2[i] = args[i];","}","return apply_(this, thisArg, a2);","};","})();"),m=function($){var E=p.stateStack[p.stateStack.length-1];E.func_=this,E.funcThis_=$,E.arguments_=[];for(var S=1;S<arguments.length;S++)E.arguments_.push(arguments[S]);E.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",m),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),m=function(){return String(this)},this.setNativeFunctionPrototype(this.FUNCTION,"toString",m),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function(){return this.valueOf()},this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",m),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR)},h.prototype.initObject=function(f){var p=this,m;m=function($){if($==null)return p.calledWithNew()?this:p.createObjectProto(p.OBJECT_PROTO);if(!($ instanceof h.Object)){var E=p.createObjectProto(p.getPrototype($));return E.data=$,E}return $},this.OBJECT=this.createNativeFunction(m,!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"Object",this.OBJECT,h.NONENUMERABLE_DESCRIPTOR);var v=function(y){y==null&&p.throwException(p.TYPE_ERROR,"Cannot convert '"+y+"' to object")};m=function($){v($);var E=$ instanceof h.Object?$.properties:$;return p.nativeToPseudo(Object.getOwnPropertyNames(E))},this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function($){return v($),$ instanceof h.Object&&($=$.properties),p.nativeToPseudo(Object.keys($))},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function($){return $===null?p.createObjectProto(null):($ instanceof h.Object||p.throwException(p.TYPE_ERROR,"Object prototype may only be an Object or null, not "+$),p.createObjectProto($))},this.setProperty(this.OBJECT,"create",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),m=function($,E,S){return E=String(E),$ instanceof h.Object||p.throwException(p.TYPE_ERROR,"Object.defineProperty called on non-object: "+$),S instanceof h.Object||p.throwException(p.TYPE_ERROR,"Property description must be an object"),$.preventExtensions&&!(E in $.properties)&&p.throwException(p.TYPE_ERROR,"Can't define property '"+E+"', object is not extensible"),p.setProperty($,E,h.VALUE_IN_DESCRIPTOR,S.properties),$},this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),m=function($,E){if($ instanceof h.Object||p.throwException(p.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object: "+$),E=String(E),E in $.properties){var S=Object.getOwnPropertyDescriptor($.properties,E),A=$.getter[E],C=$.setter[E],x=p.createObjectProto(p.OBJECT_PROTO);return A||C?(p.setProperty(x,"get",A),p.setProperty(x,"set",C)):(p.setProperty(x,"value",S.value),p.setProperty(x,"writable",S.writable)),p.setProperty(x,"configurable",S.configurable),p.setProperty(x,"enumerable",S.enumerable),x}},this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function($){return v($),p.getPrototype($)},this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function($){return!!$&&!$.preventExtensions},this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),m=function($){return $ instanceof h.Object&&($.preventExtensions=!0),$},this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",h.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",h.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",h.Object.prototype.valueOf),m=function($){return v(this),this instanceof h.Object?String($)in this.properties:this.hasOwnProperty($)},this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",m),m=function($){return v(this),this instanceof h.Object?Object.prototype.propertyIsEnumerable.call(this.properties,$):this.propertyIsEnumerable($)},this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",m),m=function($){for(;;){if($=p.getPrototype($),!$)return!1;if($===this)return!0}},this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",m)},h.prototype.initArray=function(f){var p=this,m;m=function(y){if(p.calledWithNew())var $=this;else var $=p.createArray();var E=arguments[0];if(arguments.length===1&&typeof E=="number")isNaN(h.legalArrayLength(E))&&p.throwException(p.RANGE_ERROR,"Invalid array length: "+E),$.properties.length=E;else{for(var S=0;S<arguments.length;S++)$.properties[S]=arguments[S];$.properties.length=S}return $},this.ARRAY=this.createNativeFunction(m,!0),this.ARRAY_PROTO=this.ARRAY.properties.prototype,this.setProperty(f,"Array",this.ARRAY,h.NONENUMERABLE_DESCRIPTOR),m=function(y){return y&&y.class==="Array"},this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("(function() {","function createArrayMethod_(name, func) {","Object.defineProperty(func, 'name', {value: name});","Object.defineProperty(Array.prototype, name,","{configurable: true, writable: true, value: func});","}","createArrayMethod_('pop',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}",");","createArrayMethod_('push',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}",");","createArrayMethod_('shift',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","if ((i + 1) in o) {","o[i] = o[i + 1];","} else {","delete o[i];","}","}","delete o[i];","o.length = len - 1;","return value;","}",");","createArrayMethod_('unshift',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","if (i in o) {","o[i + arguments.length] = o[i];","} else {","delete o[i + arguments.length];","}","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return (o.length = len + arguments.length);","}",");","createArrayMethod_('reverse',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","var hasX = i in o;","if ((len - i - 1) in o) {","o[i] = o[len - i - 1];","} else {","delete o[i];","}","if (hasX) {","o[len - i - 1] = x;","} else {","delete o[len - i - 1];","}","}","return o;","}",");","createArrayMethod_('indexOf',","function(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}",");","createArrayMethod_('lastIndexOf',","function(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}",");","createArrayMethod_('slice',","function(start, end) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = new Array(size);","for (var i = 0; i < size; i++) {","if ((start + i) in o) {","cloned[i] = o[start + i];","}","}","return cloned;","}",");","createArrayMethod_('splice',","function(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 2) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","if (i in o) {","removed.push(o[i]);","} else {","removed.length++;","}","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","if ((i + deleteCount) in o) {","o[i] = o[i + deleteCount];","} else {","delete o[i];","}","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","if (arguments.length > 2) {","var arl = arguments.length - 2;","for (var i = len - 1; i >= start; i--) {","if (i in o) {","o[i + arl] = o[i];","} else {","delete o[i + arl];","}","}","len += arl;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","}","o.length = len;","return removed;","}",");","createArrayMethod_('concat',","function(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","for (var j = 0, l = value.length; j < l; j++) {","if (j in value) {","cloned.push(value[j]);","} else {","cloned.length++;","}","}","} else {","cloned.push(value);","}","}","return cloned;","}",");","createArrayMethod_('join',","function(opt_separator) {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < len; i++) {","if (i && sep) str += sep;","str += (o[i] === null || o[i] === undefined) ? '' : o[i];","}","return str;","}",");","createArrayMethod_('every',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o && !callback.call(t, o[k], k, o)) return false;","k++;","}","return true;","}",");","createArrayMethod_('filter',","function(callback, var_args) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (callback.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}",");","createArrayMethod_('forEach',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}",");","createArrayMethod_('map',","function(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k = 0;","var o = Object(this), len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","var a = new Array(len);","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}",");","createArrayMethod_('reduce',","function(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_('reduceRight',","function(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}",");","createArrayMethod_('some',","function(callback /*, thisArg*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && callback.call(thisArg, o[i], i, o)) return true;","}","return false;","}",");","createArrayMethod_('sort',","function(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","var hasSwap = j in this;","if ((j + 1) in this) {","this[j] = this[j + 1];","} else {","delete this[j];","}","if (hasSwap) {","this[j + 1] = swap;","} else {","delete this[j + 1];","}","changes++;","}","}","if (!changes) break;","}","return this;","}",");","createArrayMethod_('toLocaleString',","function() {","if (!this) throw TypeError();","var o = Object(this), len = o.length >>> 0;","var out = [];","for (var i = 0; i < len; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}",");","})();","")},h.prototype.initString=function(f){var p=this,m;m=function(E){return E=arguments.length?h.nativeGlobal.String(E):"",p.calledWithNew()?(this.data=E,this):E},this.STRING=this.createNativeFunction(m,!0),this.setProperty(f,"String",this.STRING,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),h.NONENUMERABLE_DESCRIPTOR);for(var v=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],y=0;y<v.length;y++)this.setNativeFunctionPrototype(this.STRING,v[y],String.prototype[v[y]]);m=function(E,S,A){S=p.pseudoToNative(S),A=p.pseudoToNative(A);try{return String(this).localeCompare(E,S,A)}catch(C){p.throwException(p.ERROR,"localeCompare: "+C.message)}},this.setNativeFunctionPrototype(this.STRING,"localeCompare",m),m=function(E,S,A){var C=String(this);if(S=S?Number(S):void 0,p.isa(E,p.REGEXP)&&(E=E.data,p.maybeThrowRegExp(E,A),p.REGEXP_MODE===2)){if(h.vm){var x={string:C,separator:E,limit:S},I="string.split(separator, limit)",k=p.vmCall(I,x,E,A);k!==h.REGEXP_TIMEOUT&&A(p.nativeToPseudo(k))}else{var O=p.createWorker(),F=p.regExpTimeout(E,O,A);O.onmessage=function(D){clearTimeout(F),A(p.nativeToPseudo(D.data))},O.postMessage(["split",C,E,S])}return}var k=C.split(E,S);A(p.nativeToPseudo(k))},this.setAsyncFunctionPrototype(this.STRING,"split",m),m=function(E,S){var A=String(this);if(E=p.isa(E,p.REGEXP)?E.data:new RegExp(E),p.maybeThrowRegExp(E,S),p.REGEXP_MODE===2){if(h.vm){var C={string:A,regexp:E},x="string.match(regexp)",F=p.vmCall(x,C,E,S);F!==h.REGEXP_TIMEOUT&&S(F&&p.matchToPseudo_(F))}else{var I=p.createWorker(),O=p.regExpTimeout(E,I,S);I.onmessage=function(k){clearTimeout(O),S(k.data&&p.matchToPseudo_(k.data))},I.postMessage(["match",A,E])}return}var F=A.match(E);S(F&&p.matchToPseudo_(F))},this.setAsyncFunctionPrototype(this.STRING,"match",m),m=function(E,S){var A=String(this);if(p.isa(E,p.REGEXP)?E=E.data:E=new RegExp(E),p.maybeThrowRegExp(E,S),p.REGEXP_MODE===2){if(h.vm){var C={string:A,regexp:E},x="string.search(regexp)",I=p.vmCall(x,C,E,S);I!==h.REGEXP_TIMEOUT&&S(I)}else{var O=p.createWorker(),F=p.regExpTimeout(E,O,S);O.onmessage=function(k){clearTimeout(F),S(k.data)},O.postMessage(["search",A,E])}return}S(A.search(E))},this.setAsyncFunctionPrototype(this.STRING,"search",m),m=function(E,S,A){var C=String(this);if(S=String(S),p.isa(E,p.REGEXP)&&(E=E.data,p.maybeThrowRegExp(E,A),p.REGEXP_MODE===2)){if(h.vm){var x={string:C,substr:E,newSubstr:S},I="string.replace(substr, newSubstr)",O=p.vmCall(I,x,E,A);O!==h.REGEXP_TIMEOUT&&A(O)}else{var F=p.createWorker(),k=p.regExpTimeout(E,F,A);F.onmessage=function(D){clearTimeout(k),A(D.data)},F.postMessage(["replace",C,E,S])}return}A(C.replace(E,S))},this.setAsyncFunctionPrototype(this.STRING,"replace",m),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + ","str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + ","str.substring(i + substr.length);","}","}","return str;","};","})();","")},h.prototype.initBoolean=function(f){var p=this,m;m=function(y){return y=h.nativeGlobal.Boolean(y),p.calledWithNew()?(this.data=y,this):y},this.BOOLEAN=this.createNativeFunction(m,!0),this.setProperty(f,"Boolean",this.BOOLEAN,h.NONENUMERABLE_DESCRIPTOR)},h.prototype.initNumber=function(f){var p=this,m;m=function(E){return E=arguments.length?h.nativeGlobal.Number(E):0,p.calledWithNew()?(this.data=E,this):E},this.NUMBER=this.createNativeFunction(m,!0),this.setProperty(f,"Number",this.NUMBER,h.NONENUMERABLE_DESCRIPTOR);for(var v=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],y=0;y<v.length;y++)this.setProperty(this.NUMBER,v[y],Number[v[y]],h.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);m=function(E){try{return Number(this).toExponential(E)}catch(S){p.throwException(p.ERROR,S.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toExponential",m),m=function(E){try{return Number(this).toFixed(E)}catch(S){p.throwException(p.ERROR,S.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toFixed",m),m=function(E){try{return Number(this).toPrecision(E)}catch(S){p.throwException(p.ERROR,S.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",m),m=function(E){try{return Number(this).toString(E)}catch(S){p.throwException(p.ERROR,S.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toString",m),m=function(E,S){E=E?p.pseudoToNative(E):void 0,S=S?p.pseudoToNative(S):void 0;try{return Number(this).toLocaleString(E,S)}catch(A){p.throwException(p.ERROR,"toLocaleString: "+A.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",m)},h.prototype.initDate=function(f){var p=this,m;m=function(E,S){if(!p.calledWithNew())return h.nativeGlobal.Date();var A=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(h.nativeGlobal.Date,A)),this},this.DATE=this.createNativeFunction(m,!0),this.DATE_PROTO=this.DATE.properties.prototype,this.setProperty(f,"Date",this.DATE,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),h.NONENUMERABLE_DESCRIPTOR);for(var v=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],y=0;y<v.length;y++)m=function($){return function(E){var S=this.data;S instanceof Date||p.throwException(p.TYPE_ERROR,$+" not called on a Date");for(var A=[],C=0;C<arguments.length;C++)A[C]=p.pseudoToNative(arguments[C]);return S[$].apply(S,A)}}(v[y]),this.setNativeFunctionPrototype(this.DATE,v[y],m);m=function(){try{return this.data.toISOString()}catch(E){p.throwException(p.RANGE_ERROR,"toISOString: "+E.message)}},this.setNativeFunctionPrototype(this.DATE,"toISOString",m)},h.prototype.initRegExp=function(f){var p=this,m;m=function(y,$){if(p.calledWithNew())var E=this;else{if($===void 0&&p.isa(y,p.REGEXP))return y;var E=p.createObjectProto(p.REGEXP_PROTO)}y=y===void 0?"":String(y),$=$?String($):"",/^[gmi]*$/.test($)||p.throwException(p.SYNTAX_ERROR,"Invalid regexp flag: "+$);try{var S=new h.nativeGlobal.RegExp(y,$)}catch(A){p.throwException(p.SYNTAX_ERROR,A.message)}return p.populateRegExp(E,S),E},this.REGEXP=this.createNativeFunction(m,!0),this.REGEXP_PROTO=this.REGEXP.properties.prototype,this.setProperty(f,"RegExp",this.REGEXP,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"global",void 0,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"ignoreCase",void 0,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"multiline",void 0,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"source","(?:)",h.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return !!this.exec(str);","}","});"),m=function(y,$){var E=this.data;if(y=String(y),E.lastIndex=Number(p.getProperty(this,"lastIndex")),p.maybeThrowRegExp(E,$),p.REGEXP_MODE===2){if(h.vm){var S={string:y,regexp:E},A="regexp.exec(string)",O=p.vmCall(A,S,E,$);O!==h.REGEXP_TIMEOUT&&(p.setProperty(this,"lastIndex",E.lastIndex),$(p.matchToPseudo_(O)))}else{var C=p.createWorker(),x=p.regExpTimeout(E,C,$),I=this;C.onmessage=function(F){clearTimeout(x),p.setProperty(I,"lastIndex",F.data[1]),$(p.matchToPseudo_(F.data[0]))},C.postMessage(["exec",E,E.lastIndex,y])}return}var O=E.exec(y);p.setProperty(this,"lastIndex",E.lastIndex),$(p.matchToPseudo_(O))},this.setAsyncFunctionPrototype(this.REGEXP,"exec",m)},h.prototype.matchToPseudo_=function(f){if(f){for(var p=Object.getOwnPropertyNames(f),m=0;m<p.length;m++){var v=p[m];isNaN(Number(v))&&v!=="length"&&v!=="input"&&v!=="index"&&delete f[v]}return this.nativeToPseudo(f)}return null},h.prototype.initError=function(f){var p=this;this.ERROR=this.createNativeFunction(function(y){if(p.calledWithNew())var $=this;else var $=p.createObject(p.ERROR);return p.populateError($,y),$},!0),this.setProperty(f,"Error",this.ERROR,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"message","",h.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"name","Error",h.NONENUMERABLE_DESCRIPTOR);var m=function(v){var y=p.createNativeFunction(function($){if(p.calledWithNew())var E=this;else var E=p.createObject(y);return p.populateError(E,$),E},!0);return p.setProperty(y,"prototype",p.createObject(p.ERROR),h.NONENUMERABLE_DESCRIPTOR),p.setProperty(y.properties.prototype,"name",v,h.NONENUMERABLE_DESCRIPTOR),p.setProperty(f,v,y,h.NONENUMERABLE_DESCRIPTOR),y};this.EVAL_ERROR=m("EvalError"),this.RANGE_ERROR=m("RangeError"),this.REFERENCE_ERROR=m("ReferenceError"),this.SYNTAX_ERROR=m("SyntaxError"),this.TYPE_ERROR=m("TypeError"),this.URI_ERROR=m("URIError")},h.prototype.initMath=function(f){var p=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(f,"Math",p,h.NONENUMERABLE_DESCRIPTOR);for(var m=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],v=0;v<m.length;v++)this.setProperty(p,m[v],Math[m[v]],h.READONLY_NONENUMERABLE_DESCRIPTOR);for(var y=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"],v=0;v<y.length;v++)this.setProperty(p,y[v],this.createNativeFunction(Math[y[v]],!1),h.NONENUMERABLE_DESCRIPTOR)},h.prototype.initJSON=function(f){var p,m=this,v=m.createObjectProto(this.OBJECT_PROTO);this.setProperty(f,"JSON",v,h.NONENUMERABLE_DESCRIPTOR),p=function($){try{var E=JSON.parse(String($))}catch(S){m.throwException(m.SYNTAX_ERROR,S.message)}return m.nativeToPseudo(E)},this.setProperty(v,"parse",this.createNativeFunction(p,!1)),p=function($,E,S){E&&E.class==="Function"?m.throwException(m.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):E&&E.class==="Array"?(E=m.pseudoToNative(E),E=E.filter(function(x){return typeof x=="string"||typeof x=="number"})):E=null,typeof S!="string"&&typeof S!="number"&&(S=void 0);var A=m.pseudoToNative($);try{var C=JSON.stringify(A,E,S)}catch(x){m.throwException(m.TYPE_ERROR,x.message)}return C},this.setProperty(v,"stringify",this.createNativeFunction(p,!1))},h.prototype.isa=function(f,p){if(f==null||!p)return!1;var m=p.properties.prototype;if(f===m)return!0;for(f=this.getPrototype(f);f;){if(f===m)return!0;f=f.proto}return!1},h.prototype.populateRegExp=function(f,p){f.data=new RegExp(p.source,p.flags),this.setProperty(f,"lastIndex",p.lastIndex,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"source",p.source,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"global",p.global,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"ignoreCase",p.ignoreCase,h.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(f,"multiline",p.multiline,h.READONLY_NONENUMERABLE_DESCRIPTOR)},h.prototype.populateError=function(f,p){p&&this.setProperty(f,"message",String(p),h.NONENUMERABLE_DESCRIPTOR);for(var m=[],v=this.stateStack.length-1;v>=0;v--){var y=this.stateStack[v],$=y.node;if($.type==="CallExpression"){var E=y.func_;E&&m.length&&(m[m.length-1].datumName=this.getProperty(E,"name"))}$.loc&&(!m.length||$.type==="CallExpression")&&m.push({datumLoc:$.loc})}for(var S=String(this.getProperty(f,"name")),A=String(this.getProperty(f,"message")),C=S+": "+A+`
`,v=0;v<m.length;v++){var x=m[v].datumLoc,I=m[v].datumName,O=x.source+":"+x.start.line+":"+x.start.column;I?C+="  at "+I+" ("+O+`)
`:C+="  at "+O+`
`}this.setProperty(f,"stack",C.trim(),h.NONENUMERABLE_DESCRIPTOR)},h.prototype.createWorker=function(){var f=this.createWorker.blob_;return f||(f=new Blob([h.WORKER_CODE.join(`
`)],{type:"application/javascript"}),this.createWorker.blob_=f),new Worker(URL.createObjectURL(f))},h.prototype.vmCall=function(f,p,m,v){var y={timeout:this.REGEXP_THREAD_TIMEOUT};try{return h.vm.runInNewContext(f,p,y)}catch{v(null),this.throwException(this.ERROR,"RegExp Timeout: "+m)}return h.REGEXP_TIMEOUT},h.prototype.maybeThrowRegExp=function(f,p){var m;if(this.REGEXP_MODE===0)m=!1;else if(this.REGEXP_MODE===1)m=!0;else if(h.vm)m=!0;else if(typeof Worker=="function"&&typeof URL=="function")m=!0;else{try{h.vm=d("vm")}catch{}m=!!h.vm}m||(p(null),this.throwException(this.ERROR,"Regular expressions not supported: "+f))},h.prototype.regExpTimeout=function(f,p,m){var v=this;return setTimeout(function(){p.terminate(),m(null);try{v.throwException(v.ERROR,"RegExp Timeout: "+f)}catch{}},this.REGEXP_THREAD_TIMEOUT)},h.prototype.createObject=function(f){return this.createObjectProto(f&&f.properties.prototype)},h.prototype.createObjectProto=function(f){if(typeof f!="object")throw Error("Non object prototype");var p=new h.Object(f);return this.isa(p,this.ERROR)&&(p.class="Error"),p},h.prototype.createArray=function(){var f=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(f,"length",0,{configurable:!1,enumerable:!1,writable:!0}),f.class="Array",f},h.prototype.createFunctionBase_=function(f,p){var m=this.createObjectProto(this.FUNCTION_PROTO);if(p){var v=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(m,"prototype",v,h.NONENUMERABLE_DESCRIPTOR),this.setProperty(v,"constructor",m,h.NONENUMERABLE_DESCRIPTOR)}else m.illegalConstructor=!0;return this.setProperty(m,"length",f,h.READONLY_NONENUMERABLE_DESCRIPTOR),m.class="Function",m},h.prototype.createFunction=function(f,p,m){var v=this.createFunctionBase_(f.params.length,!0);v.parentScope=p,v.node=f;var y=f.id?String(f.id.name):m||"";return this.setProperty(v,"name",y,h.READONLY_NONENUMERABLE_DESCRIPTOR),v},h.prototype.createNativeFunction=function(f,p){var m=this.createFunctionBase_(f.length,p);return m.nativeFunc=f,f.id=this.functionCounter_++,this.setProperty(m,"name",f.name,h.READONLY_NONENUMERABLE_DESCRIPTOR),m},h.prototype.createAsyncFunction=function(f){var p=this.createFunctionBase_(f.length,!0);return p.asyncFunc=f,f.id=this.functionCounter_++,this.setProperty(p,"name",f.name,h.READONLY_NONENUMERABLE_DESCRIPTOR),p},h.prototype.nativeToPseudo=function(f,p){if(f==null||f===!0||f===!1||typeof f=="string"||typeof f=="number")return f;if(f instanceof h.Object)throw Error("Object is already pseudo");var m=p||{pseudo:[],native:[]},v=m.native.indexOf(f);if(v!==-1)return m.pseudo[v];if(m.native.push(f),f instanceof RegExp){var y=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(y,f),m.pseudo.push(y),y}if(f instanceof Date){var $=this.createObjectProto(this.DATE_PROTO);return $.data=new Date(f.valueOf()),m.pseudo.push($),$}if(typeof f=="function"){var E=this,S=function(){var O=Array.prototype.slice.call(arguments).map(function(k){return E.pseudoToNative(k)}),F=f.apply(E,O);return E.nativeToPseudo(F)},A=Object.getOwnPropertyDescriptor(f,"prototype"),C=this.createNativeFunction(S,!!A);return m.pseudo.push(C),C}var x;Array.isArray(f)?x=this.createArray():x=this.createObjectProto(this.OBJECT_PROTO),m.pseudo.push(x);for(var I in f)this.setProperty(x,I,this.nativeToPseudo(f[I],m));return x},h.prototype.pseudoToNative=function(f,p){if(f==null||f===!0||f===!1||typeof f=="string"||typeof f=="number")return f;if(!(f instanceof h.Object))throw Error("Object is not pseudo");var m=p||{pseudo:[],native:[]},v=m.pseudo.indexOf(f);if(v!==-1)return m.native[v];if(m.pseudo.push(f),this.isa(f,this.REGEXP)){var y=new RegExp(f.data.source,f.data.flags);return y.lastIndex=f.data.lastIndex,m.native.push(y),y}if(this.isa(f,this.DATE)){var $=new Date(f.data.valueOf());return m.native.push($),$}var E=this.isa(f,this.ARRAY)?[]:{};m.native.push(E);var S;for(var A in f.properties)S=this.pseudoToNative(f.properties[A],m),Object.defineProperty(E,A,{value:S,writable:!0,enumerable:!0,configurable:!0});return E},h.prototype.getPrototype=function(f){switch(typeof f){case"number":return this.NUMBER.properties.prototype;case"boolean":return this.BOOLEAN.properties.prototype;case"string":return this.STRING.properties.prototype}return f?f.proto:null},h.prototype.getProperty=function(f,p){if(this.getterStep_)throw Error("Getter not supported in that context");if(p=String(p),f==null&&this.throwException(this.TYPE_ERROR,"Cannot read property '"+p+"' of "+f),typeof f=="object"&&!(f instanceof h.Object))throw TypeError("Expecting native value or pseudo object");if(p==="length"){if(this.isa(f,this.STRING))return String(f).length}else if(p.charCodeAt(0)<64&&this.isa(f,this.STRING)){var m=h.legalArrayIndex(p);if(!isNaN(m)&&m<String(f).length)return String(f)[m]}do if(f.properties&&p in f.properties){var v=f.getter[p];return v?(this.getterStep_=!0,v):f.properties[p]}while(f=this.getPrototype(f))},h.prototype.hasProperty=function(f,p){if(!(f instanceof h.Object))throw TypeError("Primitive data type has no properties");if(p=String(p),p==="length"&&this.isa(f,this.STRING))return!0;if(this.isa(f,this.STRING)){var m=h.legalArrayIndex(p);if(!isNaN(m)&&m<String(f).length)return!0}do if(f.properties&&p in f.properties)return!0;while(f=this.getPrototype(f));return!1},h.prototype.setProperty=function(f,p,m,v){if(this.setterStep_)throw Error("Setter not supported in that context");if(p=String(p),f==null&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+p+"' of "+f),typeof f=="object"&&!(f instanceof h.Object))throw TypeError("Expecting native value or pseudo object");v&&("get"in v||"set"in v)&&("value"in v||"writable"in v)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var y=!this.stateStack||this.getScope().strict;if(!(f instanceof h.Object)){y&&this.throwException(this.TYPE_ERROR,"Can't create property '"+p+"' on '"+f+"'");return}if(this.isa(f,this.STRING)){var $=h.legalArrayIndex(p);if(p==="length"||!isNaN($)&&$<String(f).length){y&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+p+"' of String '"+f.data+"'");return}}if(f.class==="Array"){var E=f.properties.length,S;if(p==="length"){if(v){if(!("value"in v))return;m=v.value}if(m=h.legalArrayLength(m),isNaN(m)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),m<E)for(S in f.properties)S=h.legalArrayIndex(S),!isNaN(S)&&m<=S&&delete f.properties[S]}else isNaN(S=h.legalArrayIndex(p))||(f.properties.length=Math.max(E,S+1))}if(f.preventExtensions&&!(p in f.properties)){y&&this.throwException(this.TYPE_ERROR,"Can't add property '"+p+"', object is not extensible");return}if(v){var A={};"get"in v&&v.get&&(f.getter[p]=v.get,A.get=this.setProperty.placeholderGet_),"set"in v&&v.set&&(f.setter[p]=v.set,A.set=this.setProperty.placeholderSet_),"configurable"in v&&(A.configurable=v.configurable),"enumerable"in v&&(A.enumerable=v.enumerable),"writable"in v&&(A.writable=v.writable,delete f.getter[p],delete f.setter[p]),"value"in v?(A.value=v.value,delete f.getter[p],delete f.setter[p]):m!==h.VALUE_IN_DESCRIPTOR&&(A.value=m,delete f.getter[p],delete f.setter[p]);try{Object.defineProperty(f.properties,p,A)}catch{this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+p)}"get"in v&&!v.get&&delete f.getter[p],"set"in v&&!v.set&&delete f.setter[p]}else{if(m===h.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified");for(var C=f;!(p in C.properties);)if(C=this.getPrototype(C),!C){C=f;break}if(C.setter&&C.setter[p])return this.setterStep_=!0,C.setter[p];if(C.getter&&C.getter[p])y&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+p+"' of object '"+f+"' which only has a getter");else try{f.properties[p]=m}catch{y&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+p+"' of object '"+f+"'")}}},h.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},h.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},h.prototype.setNativeFunctionPrototype=function(f,p,m){this.setProperty(f.properties.prototype,p,this.createNativeFunction(m,!1),h.NONENUMERABLE_DESCRIPTOR)},h.prototype.setAsyncFunctionPrototype=function(f,p,m){this.setProperty(f.properties.prototype,p,this.createAsyncFunction(m),h.NONENUMERABLE_DESCRIPTOR)},h.prototype.getScope=function(){var f=this.stateStack[this.stateStack.length-1].scope;if(!f)throw Error("No scope found");return f},h.prototype.createScope=function(f,p){var m=!1;if(p&&p.strict)m=!0;else{var v=f.body&&f.body[0];v&&v.expression&&v.expression.type==="Literal"&&v.expression.value==="use strict"&&(m=!0)}var y=this.createObjectProto(null),$=new h.Scope(p,m,y);return p||this.initGlobal($.object),this.populateScope_(f,$),$},h.prototype.createSpecialScope=function(f,p){if(!f)throw Error("parentScope required");var m=p||this.createObjectProto(null);return new h.Scope(f,f.strict,m)},h.prototype.getValueFromScope=function(f){for(var p=this.getScope();p&&p!==this.globalScope;){if(f in p.object.properties)return p.object.properties[f];p=p.parentScope}if(p===this.globalScope&&this.hasProperty(p.object,f))return this.getProperty(p.object,f);var m=this.stateStack[this.stateStack.length-1].node;m.type==="UnaryExpression"&&m.operator==="typeof"||this.throwException(this.REFERENCE_ERROR,f+" is not defined")},h.prototype.setValueToScope=function(f,p){for(var m=this.getScope(),v=m.strict;m&&m!==this.globalScope;){if(f in m.object.properties){try{m.object.properties[f]=p}catch{v&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only variable '"+f+"'")}return}m=m.parentScope}if(m===this.globalScope&&(!v||this.hasProperty(m.object,f)))return this.setProperty(m.object,f,p);this.throwException(this.REFERENCE_ERROR,f+" is not defined")},h.prototype.populateScope_=function(f,p){var m;if(f.variableCache_)m=f.variableCache_;else{switch(m=Object.create(null),f.type){case"VariableDeclaration":for(var v=0;v<f.declarations.length;v++)m[f.declarations[v].id.name]=!0;break;case"FunctionDeclaration":m[f.id.name]=f;break;case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"Program":case"SwitchCase":case"SwitchStatement":case"TryStatement":case"WithStatement":case"WhileStatement":var y=f.constructor;for(var $ in f)if($!=="loc"){var E=f[$];if(E&&typeof E=="object"){var S;if(Array.isArray(E)){for(var v=0;v<E.length;v++)if(E[v]&&E[v].constructor===y){S=this.populateScope_(E[v],p);for(var $ in S)m[$]=S[$]}}else if(E.constructor===y){S=this.populateScope_(E,p);for(var $ in S)m[$]=S[$]}}}}f.variableCache_=m}for(var $ in m)m[$]===!0?this.setProperty(p.object,$,void 0,h.VARIABLE_DESCRIPTOR):this.setProperty(p.object,$,this.createFunction(m[$],p),h.VARIABLE_DESCRIPTOR);return m},h.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},h.prototype.getValue=function(f){return f[0]===h.SCOPE_REFERENCE?this.getValueFromScope(f[1]):this.getProperty(f[0],f[1])},h.prototype.setValue=function(f,p){return f[0]===h.SCOPE_REFERENCE?this.setValueToScope(f[1],p):this.setProperty(f[0],f[1],p)},h.prototype.throwException=function(f,p){if(!this.globalScope)throw p===void 0?f:p;if(p===void 0||!(f instanceof h.Object))var m=f;else{var m=this.createObject(f);this.populateError(m,p)}throw this.unwind(h.Completion.THROW,m,void 0),h.STEP_ERROR},h.prototype.unwind=function(f,p,m){if(f===h.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");e:for(var v=this.stateStack;v.length>0;v.pop()){var y=v[v.length-1];switch(y.node.type){case"TryStatement":y.cv={type:f,value:p,label:m};return;case"CallExpression":case"NewExpression":if(f===h.Completion.RETURN){y.value=p;return}else if(f===h.Completion.BREAK||f===h.Completion.CONTINUE)throw Error("Unsyntactic break/continue not rejected by Acorn");break;case"Program":if(f===h.Completion.RETURN)return;y.done=!0;break e}if(f===h.Completion.BREAK){if(m?y.labels&&y.labels.indexOf(m)!==-1:y.isLoop||y.isSwitch){v.pop();return}}else if(f===h.Completion.CONTINUE&&(m?y.labels&&y.labels.indexOf(m)!==-1:y.isLoop))return}var $;if(this.isa(p,this.ERROR)){var E={EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},S=String(this.getProperty(p,"name")),A=this.getProperty(p,"message").valueOf(),C=E[S]||Error;$=C(A),$.stack=String(this.getProperty(p,"stack"))}else $=String(p);throw this.value=$,$},h.prototype.nodeSummary=function(f){switch(f.type){case"ArrayExpression":return"[...]";case"BinaryExpression":case"LogicalExpression":return this.nodeSummary(f.left)+" "+f.operator+" "+this.nodeSummary(f.right);case"CallExpression":return this.nodeSummary(f.callee)+"(...)";case"ConditionalExpression":return this.nodeSummary(f.test)+" ? "+this.nodeSummary(f.consequent)+" : "+this.nodeSummary(f.alternate);case"Identifier":return f.name;case"Literal":return f.raw;case"MemberExpression":var p=this.nodeSummary(f.object),m=this.nodeSummary(f.property);return f.computed?p+"["+m+"]":p+"."+m;case"NewExpression":return"new "+this.nodeSummary(f.callee)+"(...)";case"ObjectExpression":return"{...}";case"ThisExpression":return"this";case"UnaryExpression":return f.operator+" "+this.nodeSummary(f.argument);case"UpdateExpression":var v=this.nodeSummary(f.argument);return f.prefix?f.operator+v:v+f.operator}return"???"},h.prototype.createTask_=function(f,p){var m=this.stateStack[this.stateStack.length-1],v=Array.from(p),y=v.shift(),$=Math.max(Number(v.shift()||0),0),E=this.newNode(),S,A,C;if(y instanceof h.Object&&y.class==="Function")A=y,E.type="CallExpression",S=m.scope;else{try{C=this.parse_(String(y),"taskCode"+this.taskCodeNumber_++)}catch(k){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+k.message)}E.type="EvalProgram_",E.body=C.body;var x=m.node.arguments[0],I=x?x.start:void 0,O=x?x.end:void 0;h.stripLocations_(E,I,O),S=this.globalScope,v.length=0}var F=new h.Task(A,v,S,E,f?$:-1);return this.scheduleTask_(F,$),F.pid},h.prototype.scheduleTask_=function(f,p){f.time=Date.now()+p,this.tasks.push(f),this.tasks.sort(function(m,v){return m.time-v.time})},h.prototype.deleteTask_=function(f){for(var p=0;p<this.tasks.length;p++)if(this.tasks[p].pid==f){this.tasks.splice(p,1);break}},h.prototype.nextTask_=function(){var f=this.tasks[0];if(!f||f.time>Date.now())return null;this.tasks.shift(),f.interval>=0&&this.scheduleTask_(f,f.interval);var p=new h.State(f.node,f.scope);return f.functionRef&&(p.doneCallee_=2,p.funcThis_=this.globalObject,p.func_=f.functionRef,p.doneArgs_=!0,p.arguments_=f.argsArray),p},h.prototype.createGetter_=function(f,p){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var m=Array.isArray(p)?p[0]:p,v=this.newNode();v.type="CallExpression";var y=new h.State(v,this.stateStack[this.stateStack.length-1].scope);return y.doneCallee_=2,y.funcThis_=m,y.func_=f,y.doneArgs_=!0,y.arguments_=[],y},h.prototype.createSetter_=function(f,p,m){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var v=Array.isArray(p)?p[0]:this.globalObject,y=this.newNode();y.type="CallExpression";var $=new h.State(y,this.stateStack[this.stateStack.length-1].scope);return $.doneCallee_=2,$.funcThis_=v,$.func_=f,$.doneArgs_=!0,$.arguments_=[m],$},h.prototype.boxThis_=function(f){if(f==null)return this.globalObject;if(!(f instanceof h.Object)){var p=this.createObjectProto(this.getPrototype(f));return p.data=f,p}return f},h.prototype.getGlobalScope=function(){return this.globalScope},h.prototype.setGlobalScope=function(f){this.globalScope=f,this.stateStack[0].scope=f},h.prototype.getStateStack=function(){return this.stateStack},h.prototype.setStateStack=function(f){this.stateStack=f},h.Value,h.State=function(f,p){this.node=f,this.scope=p},h.Scope=function(f,p,m){this.parentScope=f,this.strict=p,this.object=m},h.Object=function(f){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=f},h.Object.prototype.proto=null,h.Object.prototype.class="Object",h.Object.prototype.data=null,h.Object.prototype.toString=function(){if(!h.currentInterpreter_)return"[object Interpreter.Object]";if(!(this instanceof h.Object))return String(this);if(this.class==="Array"){var f=h.toStringCycles_;f.push(this);try{var p=[],m=this.properties.length,v=!1;m>1024&&(m=1e3,v=!0);for(var y=0;y<m;y++){var $=this.properties[y];p[y]=$ instanceof h.Object&&f.indexOf($)!==-1?"...":$}v&&p.push("...")}finally{f.pop()}return p.join(",")}if(this.class==="Error"){var f=h.toStringCycles_;if(f.indexOf(this)!==-1)return"[object Error]";var E,S,A=this;do if("name"in A.properties){E=A.properties.name;break}while(A=A.proto);A=this;do if("message"in A.properties){S=A.properties.message;break}while(A=A.proto);f.push(this);try{E=E&&String(E),S=S&&String(S)}finally{f.pop()}return S?E+": "+S:String(E)}return this.data!==null?String(this.data):"[object "+this.class+"]"},h.Object.prototype.valueOf=function(){return h.currentInterpreter_?this.data===void 0||this.data===null||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data:this},h.Task=function(f,p,m,v,y){this.functionRef=f,this.argsArray=p,this.scope=m,this.node=v,this.interval=y,this.pid=++h.Task.pid,this.time=0},h.Task.pid=0,h.prototype.stepArrayExpression=function(f,p,m){var v=m.elements,y=p.n_||0;for(p.array_?(this.setProperty(p.array_,y,p.value),y++):(p.array_=this.createArray(),p.array_.properties.length=v.length);y<v.length;){if(v[y])return p.n_=y,new h.State(v[y],p.scope);y++}f.pop(),f[f.length-1].value=p.array_},h.prototype.stepAssignmentExpression=function(f,p,m){if(!p.doneLeft_){p.doneLeft_=!0;var v=new h.State(m.left,p.scope);return v.components=!0,v}if(!p.doneRight_){if(p.leftReference_||(p.leftReference_=p.value),p.doneGetter_&&(p.leftValue_=p.value),!p.doneGetter_&&m.operator!=="="){var y=this.getValue(p.leftReference_);if(p.leftValue_=y,this.getterStep_){p.doneGetter_=!0;var $=y;return this.createGetter_($,p.leftReference_)}}return p.doneRight_=!0,m.operator==="="&&m.left.type==="Identifier"&&(p.destinationName=m.left.name),new h.State(m.right,p.scope)}if(p.doneSetter_){f.pop(),f[f.length-1].value=p.setterValue_;return}var E=p.leftValue_,S=p.value;switch(m.operator){case"=":E=S;break;case"+=":E+=S;break;case"-=":E-=S;break;case"*=":E*=S;break;case"/=":E/=S;break;case"%=":E%=S;break;case"<<=":E<<=S;break;case">>=":E>>=S;break;case">>>=":E>>>=S;break;case"&=":E&=S;break;case"^=":E^=S;break;case"|=":E|=S;break;default:throw SyntaxError("Unknown assignment expression: "+m.operator)}var A=this.setValue(p.leftReference_,E);if(A)return p.doneSetter_=!0,p.setterValue_=E,this.createSetter_(A,p.leftReference_,E);f.pop(),f[f.length-1].value=E},h.prototype.stepBinaryExpression=function(f,p,m){if(!p.doneLeft_)return p.doneLeft_=!0,new h.State(m.left,p.scope);if(!p.doneRight_)return p.doneRight_=!0,p.leftValue_=p.value,new h.State(m.right,p.scope);f.pop();var v=p.leftValue_,y=p.value,$;switch(m.operator){case"==":$=v==y;break;case"!=":$=v!=y;break;case"===":$=v===y;break;case"!==":$=v!==y;break;case">":$=v>y;break;case">=":$=v>=y;break;case"<":$=v<y;break;case"<=":$=v<=y;break;case"+":$=v+y;break;case"-":$=v-y;break;case"*":$=v*y;break;case"/":$=v/y;break;case"%":$=v%y;break;case"&":$=v&y;break;case"|":$=v|y;break;case"^":$=v^y;break;case"<<":$=v<<y;break;case">>":$=v>>y;break;case">>>":$=v>>>y;break;case"in":y instanceof h.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+y+"'"),$=this.hasProperty(y,v);break;case"instanceof":this.isa(y,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"'instanceof' expects an object, not '"+y+"'"),$=v instanceof h.Object?this.isa(v,y):!1;break;default:throw SyntaxError("Unknown binary operator: "+m.operator)}f[f.length-1].value=$},h.prototype.stepBlockStatement=function(f,p,m){var v=p.n_||0,y=m.body[v];if(y)return p.n_=v+1,new h.State(y,p.scope);f.pop()},h.prototype.stepBreakStatement=function(f,p,m){var v=m.label&&m.label.name;this.unwind(h.Completion.BREAK,void 0,v)},h.prototype.evalCodeNumber_=0,h.prototype.stepCallExpression=function(f,p,m){if(!p.doneCallee_){p.doneCallee_=1;var v=new h.State(m.callee,p.scope);return v.components=!0,v}if(p.doneCallee_===1){p.doneCallee_=2;var y=p.value;if(Array.isArray(y)){if(p.func_=this.getValue(y),y[0]===h.SCOPE_REFERENCE?p.directEval_=y[1]==="eval":p.funcThis_=y[0],y=p.func_,this.getterStep_)return p.doneCallee_=1,this.createGetter_(y,p.value)}else p.func_=y;p.arguments_=[],p.n_=0}var y=p.func_;if(!p.doneArgs_){if(p.n_!==0&&p.arguments_.push(p.value),m.arguments[p.n_])return new h.State(m.arguments[p.n_++],p.scope);if(m.type==="NewExpression"){if((!(y instanceof h.Object)||y.illegalConstructor)&&this.throwException(this.TYPE_ERROR,this.nodeSummary(m.callee)+" is not a constructor"),y===this.ARRAY)p.funcThis_=this.createArray();else{var $=y.properties.prototype;(typeof $!="object"||$===null)&&($=this.OBJECT_PROTO),p.funcThis_=this.createObjectProto($)}p.isConstructor=!0}p.doneArgs_=!0}if(p.doneExec_)f.pop(),p.isConstructor&&typeof p.value!="object"?f[f.length-1].value=p.funcThis_:f[f.length-1].value=p.value;else{p.doneExec_=!0,y instanceof h.Object||this.throwException(this.TYPE_ERROR,this.nodeSummary(m.callee)+" is not a function");var E=y.node;if(E){for(var S=this.createScope(E.body,y.parentScope),A=this.createArray(),C=0;C<p.arguments_.length;C++)this.setProperty(A,C,p.arguments_[C]);this.setProperty(S.object,"arguments",A);for(var C=0;C<E.params.length;C++){var x=E.params[C].name,I=p.arguments_.length>C?p.arguments_[C]:void 0;this.setProperty(S.object,x,I)}return S.strict||(p.funcThis_=this.boxThis_(p.funcThis_)),this.setProperty(S.object,"this",p.funcThis_,h.READONLY_DESCRIPTOR),p.value=void 0,new h.State(E.body,S)}else if(y.eval){var O=p.arguments_[0];if(typeof O!="string")p.value=O;else{try{var F=this.parse_(String(O),"eval"+this.evalCodeNumber_++)}catch(ne){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+ne.message)}var k=this.newNode();k.type="EvalProgram_",k.body=F.body,h.stripLocations_(k,m.start,m.end);var S=p.directEval_?p.scope:this.globalScope;return S.strict?S=this.createScope(F,S):this.populateScope_(F,S),this.value=void 0,new h.State(k,S)}}else if(y.nativeFunc)p.scope.strict||(p.funcThis_=this.boxThis_(p.funcThis_)),p.value=y.nativeFunc.apply(p.funcThis_,p.arguments_);else if(y.asyncFunc){var D=this,U=function(ae){p.value=ae,D.paused_=!1},ce=y.asyncFunc.length-1,re=p.arguments_.concat(new Array(ce)).slice(0,ce);re.push(U),this.paused_=!0,p.scope.strict||(p.funcThis_=this.boxThis_(p.funcThis_)),y.asyncFunc.apply(p.funcThis_,re);return}else this.throwException(this.TYPE_ERROR,this.nodeSummary(m.callee)+" is not callable")}},h.prototype.stepConditionalExpression=function(f,p,m){var v=p.mode_||0;if(v===0)return p.mode_=1,new h.State(m.test,p.scope);if(v===1){p.mode_=2;var y=!!p.value;if(y&&m.consequent)return new h.State(m.consequent,p.scope);if(!y&&m.alternate)return new h.State(m.alternate,p.scope);this.value=void 0}f.pop(),m.type==="ConditionalExpression"&&(f[f.length-1].value=p.value)},h.prototype.stepContinueStatement=function(f,p,m){var v=m.label&&m.label.name;this.unwind(h.Completion.CONTINUE,void 0,v)},h.prototype.stepDebuggerStatement=function(f,p,m){f.pop()},h.prototype.stepDoWhileStatement=function(f,p,m){if(m.type==="DoWhileStatement"&&p.test_===void 0&&(p.value=!0,p.test_=!0),!p.test_)return p.test_=!0,new h.State(m.test,p.scope);if(!p.value)f.pop();else if(m.body)return p.test_=!1,p.isLoop=!0,new h.State(m.body,p.scope)},h.prototype.stepEmptyStatement=function(f,p,m){f.pop()},h.prototype.stepEvalProgram_=function(f,p,m){var v=p.n_||0,y=m.body[v];if(y)return p.n_=v+1,new h.State(y,p.scope);f.pop(),f[f.length-1].value=this.value},h.prototype.stepExpressionStatement=function(f,p,m){if(!p.done_)return this.value=void 0,p.done_=!0,new h.State(m.expression,p.scope);f.pop(),this.value=p.value},h.prototype.stepForInStatement=function(f,p,m){if(!p.doneInit_&&(p.doneInit_=!0,m.left.declarations&&m.left.declarations[0].init))return p.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer"),new h.State(m.left,p.scope);if(!p.doneObject_)return p.doneObject_=!0,p.variable_||(p.variable_=p.value),new h.State(m.right,p.scope);if(p.isLoop||(p.isLoop=!0,p.object_=p.value,p.visited_=Object.create(null)),p.name_===void 0)e:for(;;){if(p.object_ instanceof h.Object)for(p.props_||(p.props_=Object.getOwnPropertyNames(p.object_.properties));;){var v=p.props_.shift();if(v===void 0)break;if(Object.prototype.hasOwnProperty.call(p.object_.properties,v)&&!p.visited_[v]&&(p.visited_[v]=!0,!!Object.prototype.propertyIsEnumerable.call(p.object_.properties,v))){p.name_=v;break e}}else if(p.object_!==null&&p.object_!==void 0)for(p.props_||(p.props_=Object.getOwnPropertyNames(p.object_));;){var v=p.props_.shift();if(v===void 0)break;if(p.visited_[v]=!0,!!Object.prototype.propertyIsEnumerable.call(p.object_,v)){p.name_=v;break e}}if(p.object_=this.getPrototype(p.object_),p.props_=null,p.object_===null){f.pop();return}}if(!p.doneVariable_){p.doneVariable_=!0;var y=m.left;if(y.type==="VariableDeclaration")p.variable_=[h.SCOPE_REFERENCE,y.declarations[0].id.name];else{p.variable_=null;var $=new h.State(y,p.scope);return $.components=!0,$}}if(p.variable_||(p.variable_=p.value),!p.doneSetter_){p.doneSetter_=!0;var E=p.name_,S=this.setValue(p.variable_,E);if(S)return this.createSetter_(S,p.variable_,E)}if(p.name_=void 0,p.doneVariable_=!1,p.doneSetter_=!1,m.body)return new h.State(m.body,p.scope)},h.prototype.stepForStatement=function(f,p,m){switch(p.mode_){default:if(p.mode_=1,m.init)return new h.State(m.init,p.scope);break;case 1:if(p.mode_=2,m.test)return new h.State(m.test,p.scope);break;case 2:if(p.mode_=3,m.test&&!p.value)f.pop();else return p.isLoop=!0,new h.State(m.body,p.scope);break;case 3:if(p.mode_=1,m.update)return new h.State(m.update,p.scope);break}},h.prototype.stepFunctionDeclaration=function(f,p,m){f.pop()},h.prototype.stepFunctionExpression=function(f,p,m){f.pop(),p=f[f.length-1];var v=p.scope;m.id&&(v=this.createSpecialScope(v)),p.value=this.createFunction(m,v,p.destinationName),m.id&&this.setProperty(v.object,m.id.name,p.value,h.READONLY_DESCRIPTOR)},h.prototype.stepIdentifier=function(f,p,m){if(f.pop(),p.components){f[f.length-1].value=[h.SCOPE_REFERENCE,m.name];return}var v=this.getValueFromScope(m.name);if(this.getterStep_){var y=v;return this.createGetter_(y,this.globalObject)}f[f.length-1].value=v},h.prototype.stepIfStatement=h.prototype.stepConditionalExpression,h.prototype.stepLabeledStatement=function(f,p,m){f.pop();var v=p.labels||[];v.push(m.label.name);var y=new h.State(m.body,p.scope);return y.labels=v,y},h.prototype.stepLiteral=function(f,p,m){f.pop();var v=m.value;if(v instanceof RegExp){var y=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(y,v),v=y}f[f.length-1].value=v},h.prototype.stepLogicalExpression=function(f,p,m){if(m.operator!=="&&"&&m.operator!=="||")throw SyntaxError("Unknown logical operator: "+m.operator);if(!p.doneLeft_)return p.doneLeft_=!0,new h.State(m.left,p.scope);if(p.doneRight_)f.pop(),f[f.length-1].value=p.value;else if(m.operator==="&&"&&!p.value||m.operator==="||"&&p.value)f.pop(),f[f.length-1].value=p.value;else return p.doneRight_=!0,new h.State(m.right,p.scope)},h.prototype.stepMemberExpression=function(f,p,m){if(!p.doneObject_)return p.doneObject_=!0,new h.State(m.object,p.scope);var v;if(!m.computed)p.object_=p.value,v=m.property.name;else if(p.doneProperty_)v=p.value;else return p.object_=p.value,p.doneProperty_=!0,new h.State(m.property,p.scope);if(f.pop(),p.components)f[f.length-1].value=[p.object_,v];else{var y=this.getProperty(p.object_,v);if(this.getterStep_){var $=y;return this.createGetter_($,p.object_)}f[f.length-1].value=y}},h.prototype.stepNewExpression=h.prototype.stepCallExpression,h.prototype.stepObjectExpression=function(f,p,m){var v=p.n_||0,y=m.properties[v];if(!p.object_)p.object_=this.createObjectProto(this.OBJECT_PROTO),p.properties_=Object.create(null);else{var $=p.destinationName;p.properties_[$]||(p.properties_[$]={}),p.properties_[$][y.kind]=p.value,p.n_=++v,y=m.properties[v]}if(y){var E=y.key;if(E.type==="Identifier")var $=E.name;else if(E.type==="Literal")var $=E.value;else throw SyntaxError("Unknown object structure: "+E.type);return p.destinationName=$,new h.State(y.value,p.scope)}for(var E in p.properties_){var S=p.properties_[E];if("get"in S||"set"in S){var A={configurable:!0,enumerable:!0,get:S.get,set:S.set};this.setProperty(p.object_,E,h.VALUE_IN_DESCRIPTOR,A)}else this.setProperty(p.object_,E,S.init)}f.pop(),f[f.length-1].value=p.object_},h.prototype.stepProgram=function(f,p,m){var v=m.body.shift();if(v)return p.done=!1,new h.State(v,p.scope);p.done=!0},h.prototype.stepReturnStatement=function(f,p,m){if(m.argument&&!p.done_)return p.done_=!0,new h.State(m.argument,p.scope);this.unwind(h.Completion.RETURN,p.value,void 0)},h.prototype.stepSequenceExpression=function(f,p,m){var v=p.n_||0,y=m.expressions[v];if(y)return p.n_=v+1,new h.State(y,p.scope);f.pop(),f[f.length-1].value=p.value},h.prototype.stepSwitchStatement=function(f,p,m){if(!p.test_)return p.test_=1,new h.State(m.discriminant,p.scope);for(p.test_===1&&(p.test_=2,p.switchValue_=p.value,p.defaultCase_=-1);;){var v=p.index_||0,y=m.cases[v];if(!p.matched_&&y&&!y.test){p.defaultCase_=v,p.index_=v+1;continue}if(!y&&!p.matched_&&p.defaultCase_!==-1){p.matched_=!0,p.index_=p.defaultCase_;continue}if(y){if(!p.matched_&&!p.tested_&&y.test)return p.tested_=!0,new h.State(y.test,p.scope);if(p.matched_||p.value===p.switchValue_){p.matched_=!0;var $=p.n_||0;if(y.consequent[$])return p.isSwitch=!0,p.n_=$+1,new h.State(y.consequent[$],p.scope)}p.tested_=!1,p.n_=0,p.index_=v+1}else{f.pop();return}}},h.prototype.stepThisExpression=function(f,p,m){f.pop(),f[f.length-1].value=this.getValueFromScope("this")},h.prototype.stepThrowStatement=function(f,p,m){if(p.done_)this.throwException(p.value);else return p.done_=!0,new h.State(m.argument,p.scope)},h.prototype.stepTryStatement=function(f,p,m){if(!p.doneBlock_)return p.doneBlock_=!0,new h.State(m.block,p.scope);if(p.cv&&p.cv.type===h.Completion.THROW&&!p.doneHandler_&&m.handler){p.doneHandler_=!0;var v=this.createSpecialScope(p.scope);return this.setProperty(v.object,m.handler.param.name,p.cv.value),p.cv=void 0,new h.State(m.handler.body,v)}if(!p.doneFinalizer_&&m.finalizer)return p.doneFinalizer_=!0,new h.State(m.finalizer,p.scope);f.pop(),p.cv&&this.unwind(p.cv.type,p.cv.value,p.cv.label)},h.prototype.stepUnaryExpression=function(f,p,m){if(!p.done_){p.done_=!0;var v=new h.State(m.argument,p.scope);return v.components=m.operator==="delete",v}f.pop();var y=p.value;switch(m.operator){case"-":y=-y;break;case"+":y=+y;break;case"!":y=!y;break;case"~":y=~y;break;case"delete":var $=!0;if(Array.isArray(y)){var E=y[0];E===h.SCOPE_REFERENCE&&(E=p.scope);var S=String(y[1]);try{delete E.properties[S]}catch{p.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+S+"' of '"+E+"'"):$=!1}}y=$;break;case"typeof":y=y&&y.class==="Function"?"function":typeof y;break;case"void":y=void 0;break;default:throw SyntaxError("Unknown unary operator: "+m.operator)}f[f.length-1].value=y},h.prototype.stepUpdateExpression=function(f,p,m){if(!p.doneLeft_){p.doneLeft_=!0;var v=new h.State(m.argument,p.scope);return v.components=!0,v}if(p.leftSide_||(p.leftSide_=p.value),p.doneGetter_&&(p.leftValue_=p.value),!p.doneGetter_){var $=this.getValue(p.leftSide_);if(p.leftValue_=$,this.getterStep_){p.doneGetter_=!0;var y=$;return this.createGetter_(y,p.leftSide_)}}if(p.doneSetter_){f.pop(),f[f.length-1].value=p.setterValue_;return}var $=Number(p.leftValue_),E;if(m.operator==="++")E=$+1;else if(m.operator==="--")E=$-1;else throw SyntaxError("Unknown update expression: "+m.operator);var S=m.prefix?E:$,A=this.setValue(p.leftSide_,E);if(A)return p.doneSetter_=!0,p.setterValue_=S,this.createSetter_(A,p.leftSide_,E);f.pop(),f[f.length-1].value=S},h.prototype.stepVariableDeclaration=function(f,p,m){var v=m.declarations,y=p.n_||0,$=v[y];for(p.init_&&$&&(this.setValueToScope($.id.name,p.value),p.init_=!1,$=v[++y]);$;){if($.init)return p.n_=y,p.init_=!0,p.destinationName=$.id.name,new h.State($.init,p.scope);$=v[++y]}f.pop()},h.prototype.stepWithStatement=function(f,p,m){if(!p.doneObject_)return p.doneObject_=!0,new h.State(m.object,p.scope);f.pop();var v=this.createSpecialScope(p.scope,p.value);return new h.State(m.body,v)},h.prototype.stepWhileStatement=h.prototype.stepDoWhileStatement,h.nativeGlobal.Interpreter=h,h.prototype.step=h.prototype.step,h.prototype.run=h.prototype.run,h.prototype.appendCode=h.prototype.appendCode,h.prototype.createObject=h.prototype.createObject,h.prototype.createObjectProto=h.prototype.createObjectProto,h.prototype.createAsyncFunction=h.prototype.createAsyncFunction,h.prototype.createNativeFunction=h.prototype.createNativeFunction,h.prototype.getProperty=h.prototype.getProperty,h.prototype.setProperty=h.prototype.setProperty,h.prototype.getStatus=h.prototype.getStatus,h.prototype.nativeToPseudo=h.prototype.nativeToPseudo,h.prototype.pseudoToNative=h.prototype.pseudoToNative,h.prototype.getGlobalScope=h.prototype.getGlobalScope,h.prototype.setGlobalScope=h.prototype.setGlobalScope,h.prototype.getStateStack=h.prototype.getStateStack,h.prototype.setStateStack=h.prototype.setStateStack,h.VALUE_IN_DESCRIPTOR=h.VALUE_IN_DESCRIPTOR,h.Status=h.Status,l.exports={Interpreter:h}},"./original-repo/acorn.js":function(l,u){(function(d,h){return h(u)})(typeof globalThis>"u"?this||window:globalThis,function(d){d.version="0.5.0";var h,f="",p,m;d.parse=function(Te,Ne){return f=String(Te),p=f.length,y(Ne),pt(),us(h.program)};var v={strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function y(Te){h=Te||{};for(var Ne in v)Object.prototype.hasOwnProperty.call(h,Ne)||(h[Ne]=v[Ne]);m=h.sourceFile}var $=function(Te,Ne){for(var lt=1,Et=0;;){Ze.lastIndex=Et;var _n=Ze.exec(Te);if(_n&&_n.index<Ne)++lt,Et=_n.index+_n[0].length;else break}return{line:lt,column:Ne-Et}},E=0,S=0,A=0,C,x,I,O,F,k,D,U=0,ce=0,re,ae,ne,de;function ue(Te,Ne){var lt=$(f,Te);Ne+=" ("+lt.line+":"+lt.column+")";var Et=new SyntaxError(Ne);throw Et.pos=Te,Et.loc=lt,Et.raisedAt=E,Et}var Re=[],G={type:"num"},Z={type:"regexp"},K={type:"string"},se={type:"name"},Y={type:"eof"},me={keyword:"break"},fe={keyword:"case",beforeExpr:!0},Ae={keyword:"catch"},Ce={keyword:"continue"},Ie={keyword:"debugger"},We={keyword:"default"},ut={keyword:"do",isLoop:!0},Ye={keyword:"else",beforeExpr:!0},we={keyword:"finally"},Q={keyword:"for",isLoop:!0},Ge={keyword:"function"},Oe={keyword:"if"},Ve={keyword:"return",beforeExpr:!0},Fe={keyword:"switch"},tt={keyword:"throw",beforeExpr:!0},Ue={keyword:"try"},Je={keyword:"var"},ve={keyword:"while",isLoop:!0},Me={keyword:"with"},vt={keyword:"new",beforeExpr:!0},oe={keyword:"this"},ee={keyword:"null",atomValue:null},W={keyword:"true",atomValue:!0},ot={keyword:"false",atomValue:!1},je={keyword:"in",binop:7,beforeExpr:!0},Qe={break:me,case:fe,catch:Ae,continue:Ce,debugger:Ie,default:We,do:ut,else:Ye,finally:we,for:Q,function:Ge,if:Oe,return:Ve,switch:Fe,throw:tt,try:Ue,var:Je,while:ve,with:Me,null:ee,true:W,false:ot,new:vt,in:je,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:oe,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ht={type:"[",beforeExpr:!0},ft={type:"]"},He={type:"{",beforeExpr:!0},St={type:"}"},L={type:"(",beforeExpr:!0},X={type:")"},he={type:",",beforeExpr:!0},z={type:";",beforeExpr:!0},be={type:":",beforeExpr:!0},nt={type:"."},Ee={type:"?",beforeExpr:!0},Le={binop:10,beforeExpr:!0},Be={isAssign:!0,beforeExpr:!0},N={isAssign:!0,beforeExpr:!0},j={postfix:!0,prefix:!0,isUpdate:!0},ge={prefix:!0,beforeExpr:!0},xe={binop:1,beforeExpr:!0},Ke={binop:2,beforeExpr:!0},gt={binop:3,beforeExpr:!0},$t={binop:4,beforeExpr:!0},un={binop:5,beforeExpr:!0},an={binop:6,beforeExpr:!0},ei={binop:7,beforeExpr:!0},fi={binop:8,beforeExpr:!0},Ki={binop:9,prefix:!0,beforeExpr:!0},Ci={binop:10,beforeExpr:!0};function _i(Te){for(var Ne=Te.split(" "),lt=Object.create(null),Et=0;Et<Ne.length;Et++)lt[Ne[Et]]=!0;return function(_n){return lt[_n]||!1}}var Ti=_i("class enum extends super const export import"),nn=_i("implements interface let package private protected public static yield"),pi=_i("eval arguments"),yr=_i("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),J=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,B="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",le="------------------------------------------------------------------------------------------------------------------------------------------",_e=new RegExp("["+B+"]"),pe=new RegExp("["+B+le+"]"),ye=/[\n\r\u2028\u2029]/,Ze=/\r\n|[\n\r\u2028\u2029]/g,qe=function(Te){return Te<65?Te===36:Te<91?!0:Te<97?Te===95:Te<123?!0:Te>=170&&_e.test(String.fromCharCode(Te))},at=function(Te){return Te<48?Te===36:Te<58?!0:Te<65?!1:Te<91?!0:Te<97?Te===95:Te<123?!0:Te>=170&&pe.test(String.fromCharCode(Te))};function rt(){this.line=k,this.column=E-D}function pt(){k=1,E=D=0,F=!0,wt()}function ke(Te,Ne){A=E,h.locations&&(x=new rt),I=Te,wt(),O=Ne,F=Te.beforeExpr}function It(){var Te=h.onComment&&h.locations&&new rt,Ne=E,lt=f.indexOf("*/",E+=2);if(lt===-1&&ue(E-2,"Unterminated comment"),E=lt+2,h.locations){Ze.lastIndex=Ne;for(var Et;(Et=Ze.exec(f))&&Et.index<E;)++k,D=Et.index+Et[0].length}h.onComment&&h.onComment(!0,f.slice(Ne+2,lt),Ne,E,Te,h.locations&&new rt)}function Ct(){for(var Te=E,Ne=h.onComment&&h.locations&&new rt,lt=f.charCodeAt(E+=2);E<p&&lt!==10&&lt!==13&&lt!==8232&&lt!==8233;)++E,lt=f.charCodeAt(E);h.onComment&&h.onComment(!1,f.slice(Te+2,E),Te,E,Ne,h.locations&&new rt)}function wt(){for(;E<p;){var Te=f.charCodeAt(E);if(Te===32)++E;else if(Te===13){++E;var Ne=f.charCodeAt(E);Ne===10&&++E,h.locations&&(++k,D=E)}else if(Te===10||Te===8232||Te===8233)++E,h.locations&&(++k,D=E);else if(Te>8&&Te<14)++E;else if(Te===47){var Ne=f.charCodeAt(E+1);if(Ne===42)It();else if(Ne===47)Ct();else break}else if(Te===160)++E;else if(Te>=5760&&J.test(String.fromCharCode(Te)))++E;else break}}function Ht(){var Te=f.charCodeAt(E+1);Te>=48&&Te<=57?zn(!0):(++E,ke(nt))}function Zt(){var Te=f.charCodeAt(E+1);F?(++E,Un()):Te===61?tn(N,2):tn(Le,1)}function jt(){var Te=f.charCodeAt(E+1);Te===61?tn(N,2):tn(Ci,1)}function Ot(Te){var Ne=f.charCodeAt(E+1);Ne===Te?tn(Te===124?xe:Ke,2):Ne===61?tn(N,2):tn(Te===124?gt:un,1)}function qt(){var Te=f.charCodeAt(E+1);Te===61?tn(N,2):tn($t,1)}function Ft(Te){var Ne=f.charCodeAt(E+1);if(Ne===Te){if(Ne===45&&f.charCodeAt(E+2)===62&&ye.test(f.slice(ce,E))){E+=3,Ct(),wt(),$n();return}tn(j,2)}else Ne===61?tn(N,2):tn(Ki,1)}function ln(Te){var Ne=f.charCodeAt(E+1),lt=1;if(Ne===Te){lt=Te===62&&f.charCodeAt(E+2)===62?3:2,f.charCodeAt(E+lt)===61?tn(N,lt+1):tn(fi,lt);return}if(Ne===33&&Te===60&&f.charCodeAt(E+2)===45&&f.charCodeAt(E+3)===45){E+=4,Ct(),wt(),$n();return}Ne===61&&(lt=f.charCodeAt(E+2)===61?3:2),tn(ei,lt)}function Fn(Te){var Ne=f.charCodeAt(E+1);Ne===61?tn(an,f.charCodeAt(E+2)===61?3:2):tn(Te===61?Be:ge,1)}function sn(Te){switch(Te){case 46:return Ht();case 40:return++E,ke(L);case 41:return++E,ke(X);case 59:return++E,ke(z);case 44:return++E,ke(he);case 91:return++E,ke(ht);case 93:return++E,ke(ft);case 123:return++E,ke(He);case 125:return++E,ke(St);case 58:return++E,ke(be);case 63:return++E,ke(Ee);case 48:var Ne=f.charCodeAt(E+1);if(Ne===120||Ne===88)return hn();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return zn(!1);case 34:case 39:return In(Te);case 47:return Zt();case 37:case 42:return jt();case 124:case 38:return Ot(Te);case 94:return qt();case 43:case 45:return Ft(Te);case 60:case 62:return ln(Te);case 61:case 33:return Fn(Te);case 126:return tn(ge,1)}return!1}function $n(Te){if(Te?E=S+1:S=E,h.locations&&(C=new rt),Te)return Un();if(E>=p)return ke(Y);var Ne=f.charCodeAt(E);if(qe(Ne)||Ne===92)return Ri();var lt=sn(Ne);if(lt===!1){var Et=String.fromCharCode(Ne);if(Et==="\\"||_e.test(Et))return Ri();ue(E,"Unexpected character '"+Et+"'")}}function tn(Te,Ne){var lt=f.slice(E,E+Ne);E+=Ne,ke(Te,lt)}function Un(){for(var Te,Ne,lt=E;;){E>=p&&ue(lt,"Unterminated regexp");var Et=f.charAt(E);if(ye.test(Et)&&ue(lt,"Unterminated regexp"),Te)Te=!1;else{if(Et==="[")Ne=!0;else if(Et==="]"&&Ne)Ne=!1;else if(Et==="/"&&!Ne)break;Te=Et==="\\"}++E}var _n=f.slice(lt,E);++E;var fn=Sr();fn&&!/^[gmi]*$/.test(fn)&&ue(lt,"Invalid regexp flag");try{var Qt=new RegExp(_n,fn)}catch(yn){throw yn instanceof SyntaxError&&ue(lt,yn.message),yn}ke(Z,Qt)}function Rn(Te,Ne){for(var lt=E,Et=0,_n=Ne===void 0?1/0:Ne,fn=0;fn<_n;++fn){var Qt=f.charCodeAt(E),yn;if(Qt>=97?yn=Qt-97+10:Qt>=65?yn=Qt-65+10:Qt>=48&&Qt<=57?yn=Qt-48:yn=1/0,yn>=Te)break;++E,Et=Et*Te+yn}return E===lt||Ne!==void 0&&E-lt!==Ne?null:Et}function hn(){E+=2;var Te=Rn(16);Te===null&&ue(S+2,"Expected hexadecimal number"),qe(f.charCodeAt(E))&&ue(E,"Identifier directly after number"),ke(G,Te)}function zn(Te){var Ne=E,lt=!1,Et=f.charCodeAt(E)===48;!Te&&Rn(10)===null&&ue(Ne,"Invalid number"),f.charCodeAt(E)===46&&(++E,Rn(10),lt=!0);var _n=f.charCodeAt(E);(_n===69||_n===101)&&(_n=f.charCodeAt(++E),(_n===43||_n===45)&&++E,Rn(10)===null&&ue(Ne,"Invalid number"),lt=!0),qe(f.charCodeAt(E))&&ue(E,"Identifier directly after number");var fn=f.slice(Ne,E),Qt;lt?Qt=parseFloat(fn):!Et||fn.length===1?Qt=parseInt(fn,10):/[89]/.test(fn)||de?ue(Ne,"Invalid number"):Qt=parseInt(fn,8),ke(G,Qt)}function In(Te){E++;for(var Ne="";;){E>=p&&ue(S,"Unterminated string constant");var lt=f.charCodeAt(E);if(lt===Te){++E,ke(K,Ne);return}if(lt===92){lt=f.charCodeAt(++E);var Et=/^[0-7]+/.exec(f.slice(E,E+3));for(Et&&(Et=Et[0]);Et&&parseInt(Et,8)>255;)Et=Et.slice(0,-1);if(Et==="0"&&(Et=null),++E,Et)de&&ue(E-2,"Octal literal in strict mode"),Ne+=String.fromCharCode(parseInt(Et,8)),E+=Et.length-1;else switch(lt){case 110:Ne+=`
`;break;case 114:Ne+="\r";break;case 120:Ne+=String.fromCharCode(Kt(2));break;case 117:Ne+=String.fromCharCode(Kt(4));break;case 85:Ne+=String.fromCharCode(Kt(8));break;case 116:Ne+="	";break;case 98:Ne+="\b";break;case 118:Ne+="\v";break;case 102:Ne+="\f";break;case 48:Ne+="\0";break;case 13:f.charCodeAt(E)===10&&++E;case 10:h.locations&&(D=E,++k);break;default:Ne+=String.fromCharCode(lt);break}}else(lt===13||lt===10||lt===8232||lt===8233)&&ue(S,"Unterminated string constant"),Ne+=String.fromCharCode(lt),++E}}function Kt(Te){var Ne=Rn(16,Te);return Ne===null&&ue(S,"Bad character escape sequence"),Ne}var An;function Sr(){An=!1;for(var Te,Ne=!0,lt=E;;){var Et=f.charCodeAt(E);if(at(Et))An&&(Te+=f.charAt(E)),++E;else if(Et===92){An||(Te=f.slice(lt,E)),An=!0,f.charCodeAt(++E)!==117&&ue(E,"Expecting Unicode escape sequence \\uXXXX"),++E;var _n=Kt(4),fn=String.fromCharCode(_n);fn||ue(E-1,"Invalid Unicode escape"),(Ne?qe(_n):at(_n))||ue(E-4,"Invalid Unicode escape"),Te+=fn}else break;Ne=!1}return An?Te:f.slice(lt,E)}function Ri(){var Te=Sr(),Ne=se;!An&&yr(Te)&&(Ne=Qe[Te]),ke(Ne,Te)}function mn(){U=S,ce=A,re=x,$n()}function cs(Te){if(de=Te,E=S,h.locations)for(;E<D;)D=f.lastIndexOf(`
`,D-2)+1,--k;wt(),$n()}function Xs(){this.type=null,this.start=S,this.end=null}function Cs(){this.start=C,this.end=null,m&&(this.source=m)}function hi(){var Te=new Xs;return h.locations&&(Te.loc=new Cs),h.directSourceFile&&(Te.sourceFile=h.directSourceFile),h.ranges&&(Te.range=[S,0]),Te}function Rs(Te){var Ne=new Xs;return Ne.start=Te.start,h.locations&&(Ne.loc=new Cs,Ne.loc.start=Te.loc.start),h.ranges&&(Ne.range=[Te.range[0],0]),Ne}function dn(Te,Ne){return Te.type=Ne,Te.end=ce,h.locations&&(Te.loc.end=re),h.ranges&&(Te.range[1]=ce),Te}function Pr(Te){return Te.type==="ExpressionStatement"&&Te.expression.type==="Literal"&&Te.expression.value==="use strict"}function jn(Te){return I===Te?(mn(),!0):!1}function ts(){return!h.strictSemicolons&&(I===Y||I===St||ye.test(f.slice(ce,S)))}function Dr(){!jn(z)&&!ts()&&rn()}function ti(Te){I===Te?mn():rn()}function rn(){ue(S,"Unexpected token")}function vi(Te){Te.type!=="Identifier"&&Te.type!=="MemberExpression"&&ue(Te.start,"Assigning to rvalue"),de&&Te.type==="Identifier"&&pi(Te.name)&&ue(Te.start,"Assigning to "+Te.name+" in strict mode")}function us(Te){U=ce=E,h.locations&&(re=new rt),ae=de=!1,ne=[],$n();var Ne=Te||hi(),lt=!0;for(Te||(Ne.body=[]);I!==Y;){var Et=Br();Ne.body.push(Et),lt&&Pr(Et)&&cs(!0),lt=!1}return dn(Ne,"Program")}var zi={kind:"loop"},Gl={kind:"switch"};function Br(){(I===Le||I===N&&O==="/=")&&$n(!0);var Te=I,Ne=hi();switch(Te){case me:case Ce:mn();var lt=Te===me;jn(z)||ts()?Ne.label=null:I!==se?rn():(Ne.label=Oi(),Dr());for(var Et=0;Et<ne.length;++Et){var _n=ne[Et];if((Ne.label===null||_n.name===Ne.label.name)&&(_n.kind!==null&&(lt||_n.kind==="loop")||Ne.label&&lt))break}return Et===ne.length&&ue(Ne.start,"Unsyntactic "+Te.keyword),dn(Ne,lt?"BreakStatement":"ContinueStatement");case Ie:return mn(),Dr(),dn(Ne,"DebuggerStatement");case ut:return mn(),ne.push(zi),Ne.body=Br(),ne.pop(),ti(ve),Ne.test=ai(),Dr(),dn(Ne,"DoWhileStatement");case Q:if(mn(),ne.push(zi),ti(L),I===z)return Qa(Ne,null);if(I===Je){var fn=hi();return mn(),el(fn,!0),dn(fn,"VariableDeclaration"),fn.declarations.length===1&&jn(je)?mr(Ne,fn):Qa(Ne,fn)}var fn=xi(!1,!0);return jn(je)?(vi(fn),mr(Ne,fn)):Qa(Ne,fn);case Ge:return mn(),po(Ne,!0);case Oe:return mn(),Ne.test=ai(),Ne.consequent=Br(),Ne.alternate=jn(Ye)?Br():null,dn(Ne,"IfStatement");case Ve:return!ae&&!h.allowReturnOutsideFunction&&ue(S,"'return' outside of function"),mn(),jn(z)||ts()?Ne.argument=null:(Ne.argument=xi(),Dr()),dn(Ne,"ReturnStatement");case Fe:mn(),Ne.discriminant=ai(),Ne.cases=[],ti(He),ne.push(Gl);for(var Qt,yn;I!==St;)if(I===fe||I===We){var li=I===fe;Qt&&dn(Qt,"SwitchCase"),Ne.cases.push(Qt=hi()),Qt.consequent=[],mn(),li?Qt.test=xi():(yn&&ue(U,"Multiple default clauses"),yn=!0,Qt.test=null),ti(be)}else Qt||rn(),Qt.consequent.push(Br());return Qt&&dn(Qt,"SwitchCase"),mn(),ne.pop(),dn(Ne,"SwitchStatement");case tt:return mn(),ye.test(f.slice(ce,S))&&ue(ce,"Illegal newline after throw"),Ne.argument=xi(),Dr(),dn(Ne,"ThrowStatement");case Ue:if(mn(),Ne.block=xs(),Ne.handler=null,I===Ae){var ci=hi();mn(),ti(L),ci.param=Oi(),de&&pi(ci.param.name)&&ue(ci.param.start,"Binding "+ci.param.name+" in strict mode"),ti(X),ci.body=xs(),Ne.handler=dn(ci,"CatchClause")}return Ne.finalizer=jn(we)?xs():null,!Ne.handler&&!Ne.finalizer&&ue(Ne.start,"Missing catch or finally clause"),dn(Ne,"TryStatement");case Je:return mn(),el(Ne),Dr(),dn(Ne,"VariableDeclaration");case ve:return mn(),Ne.test=ai(),ne.push(zi),Ne.body=Br(),ne.pop(),dn(Ne,"WhileStatement");case Me:return de&&ue(S,"'with' in strict mode"),mn(),Ne.object=ai(),Ne.body=Br(),dn(Ne,"WithStatement");case He:return xs();case z:return mn(),dn(Ne,"EmptyStatement");default:var br=O,hs=xi();if(Te===se&&hs.type==="Identifier"&&jn(be)){for(var Et=0;Et<ne.length;++Et)ne[Et].name===br&&ue(hs.start,"Label '"+br+"' is already declared");var Ic=I.isLoop?"loop":I===Fe?"switch":null;return ne.push({name:br,kind:Ic}),Ne.body=Br(),ne.pop(),Ne.label=hs,dn(Ne,"LabeledStatement")}else return Ne.expression=hs,Dr(),dn(Ne,"ExpressionStatement")}}function ai(){ti(L);var Te=xi();return ti(X),Te}function xs(Te){var Ne=hi(),lt=!0,Et=!1,_n;for(Ne.body=[],ti(He);!jn(St);){var fn=Br();Ne.body.push(fn),lt&&Te&&Pr(fn)&&(_n=Et,cs(Et=!0)),lt=!1}return Et&&!_n&&cs(!1),dn(Ne,"BlockStatement")}function Qa(Te,Ne){return Te.init=Ne,ti(z),Te.test=I===z?null:xi(),ti(z),Te.update=I===X?null:xi(),ti(X),Te.body=Br(),ne.pop(),dn(Te,"ForStatement")}function mr(Te,Ne){return Te.left=Ne,Te.right=xi(),ti(X),Te.body=Br(),ne.pop(),dn(Te,"ForInStatement")}function el(Te,Ne){for(Te.declarations=[],Te.kind="var";;){var lt=hi();if(lt.id=Oi(),de&&pi(lt.id.name)&&ue(lt.id.start,"Binding "+lt.id.name+" in strict mode"),lt.init=jn(Be)?xi(!0,Ne):null,Te.declarations.push(dn(lt,"VariableDeclarator")),!jn(he))break}}function xi(Te,Ne){var lt=Ii(Ne);if(!Te&&I===he){var Et=Rs(lt);for(Et.expressions=[lt];jn(he);)Et.expressions.push(Ii(Ne));return dn(Et,"SequenceExpression")}return lt}function Ii(Te){var Ne=fo(Te);if(I.isAssign){var lt=Rs(Ne);return lt.operator=O,lt.left=Ne,mn(),lt.right=Ii(Te),vi(Ne),dn(lt,"AssignmentExpression")}return Ne}function fo(Te){var Ne=Hl(Te);if(jn(Ee)){var lt=Rs(Ne);return lt.test=Ne,lt.consequent=xi(!0),ti(be),lt.alternate=xi(!0,Te),dn(lt,"ConditionalExpression")}return Ne}function Hl(Te){return $r(sr(),-1,Te)}function $r(Te,Ne,lt){var Et=I.binop;if(Et!==null&&(!lt||I!==je)&&Et>Ne){var _n=Rs(Te);_n.left=Te,_n.operator=O;var fn=I;mn(),_n.right=$r(sr(),Et,lt);var Qt=dn(_n,fn===xe||fn===Ke?"LogicalExpression":"BinaryExpression");return $r(Qt,Ne,lt)}return Te}function sr(){if(I.prefix){var Te=hi(),Ne=I.isUpdate;return Te.operator=O,Te.prefix=!0,F=!0,mn(),Te.argument=sr(),Ne?vi(Te.argument):de&&Te.operator==="delete"&&Te.argument.type==="Identifier"&&ue(Te.start,"Deleting local variable in strict mode"),dn(Te,Ne?"UpdateExpression":"UnaryExpression")}for(var lt=js();I.postfix&&!ts();){var Te=Rs(lt);Te.operator=O,Te.prefix=!1,Te.argument=lt,vi(lt),mn(),lt=dn(Te,"UpdateExpression")}return lt}function js(){return gr(da())}function gr(Te,Ne){var lt;return jn(nt)?(lt=Rs(Te),lt.object=Te,lt.property=Oi(!0),lt.computed=!1,gr(dn(lt,"MemberExpression"),Ne)):jn(ht)?(lt=Rs(Te),lt.object=Te,lt.property=xi(),lt.computed=!0,ti(ft),gr(dn(lt,"MemberExpression"),Ne)):!Ne&&jn(L)?(lt=Rs(Te),lt.callee=Te,lt.arguments=Ys(X,!1),gr(dn(lt,"CallExpression"),Ne)):Te}function da(){var Te;switch(I){case oe:return Te=hi(),mn(),dn(Te,"ThisExpression");case se:return Oi();case G:case K:case Z:return Te=hi(),Te.value=O,Te.raw=f.slice(S,A),mn(),dn(Te,"Literal");case ee:case W:case ot:return Te=hi(),Te.value=I.atomValue,Te.raw=I.keyword,mn(),dn(Te,"Literal");case L:var Ne=C,lt=S;mn();var Et=xi();return Et.start=lt,Et.end=A,h.locations&&(Et.loc.start=Ne,Et.loc.end=x),h.ranges&&(Et.range=[lt,A]),ti(X),Et;case ht:return Te=hi(),mn(),Te.elements=Ys(ft,!0,!0),dn(Te,"ArrayExpression");case He:return Fr();case Ge:return Te=hi(),mn(),po(Te,!1);case vt:return Vl()}rn()}function Vl(){var Te=hi();return mn(),Te.callee=gr(da(),!0),Te.arguments=jn(L)?Ys(X,!1):Re,dn(Te,"NewExpression")}function Fr(){var Te=hi(),Ne=!0,lt=!1;for(Te.properties=[],mn();!jn(St);){if(Ne)Ne=!1;else if(ti(he),h.allowTrailingCommas&&jn(St))break;var Et={key:Oo()},_n=!1,fn;if(jn(be)?(Et.value=xi(!0),fn=Et.kind="init"):Et.key.type==="Identifier"&&(Et.key.name==="get"||Et.key.name==="set")?(_n=lt=!0,fn=Et.kind=Et.key.name,Et.key=Oo(),I!==L&&rn(),Et.value=po(hi(),!1)):rn(),Et.key.type==="Identifier"&&(de||lt))for(var Qt=0;Qt<Te.properties.length;++Qt){var yn=Te.properties[Qt];if(yn.key.name===Et.key.name){var li=fn===yn.kind||_n&&yn.kind==="init"||fn==="init"&&(yn.kind==="get"||yn.kind==="set");li&&!de&&fn==="init"&&yn.kind==="init"&&(li=!1),li&&ue(Et.key.start,"Redefinition of property")}}Te.properties.push(Et)}return dn(Te,"ObjectExpression")}function Oo(){return I===G||I===K?da():Oi(!0)}function po(Te,Ne){I===se?Te.id=Oi():Ne?rn():Te.id=null,Te.params=[];var lt=!0;for(ti(L);!jn(X);)lt?lt=!1:ti(he),Te.params.push(Oi());var Et=ae,_n=ne;if(ae=!0,ne=[],Te.body=xs(!0),ae=Et,ne=_n,de||Te.body.body.length&&Pr(Te.body.body[0]))for(var fn=Te.id?-1:0;fn<Te.params.length;++fn){var Qt=fn<0?Te.id:Te.params[fn];if((nn(Qt.name)||pi(Qt.name))&&ue(Qt.start,"Defining '"+Qt.name+"' in strict mode"),fn>=0)for(var yn=0;yn<fn;++yn)Qt.name===Te.params[yn].name&&ue(Qt.start,"Argument name clash in strict mode")}return dn(Te,Ne?"FunctionDeclaration":"FunctionExpression")}function Ys(Te,Ne,lt){for(var Et=[],_n=!0;!jn(Te);){if(_n)_n=!1;else if(ti(he),Ne&&h.allowTrailingCommas&&jn(Te))break;Et.push(lt&&I===he?null:xi(!0))}return Et}function Oi(Te){var Ne=hi();return Te&&h.forbidReserved==="everywhere"&&(Te=!1),I===se?(!Te&&(h.forbidReserved&&Ti(O)||de&&nn(O))&&f.slice(S,A).indexOf("\\")===-1&&ue(S,"The keyword '"+O+"' is reserved"),Ne.name=O):Te&&I.keyword?Ne.name=I.keyword:rn(),F=!1,mn(),dn(Ne,"Identifier")}})},vm:l=>{l.exports=Noe}},r={};function s(l){var u=r[l];if(u!==void 0)return u.exports;var d=r[l]={exports:{}};return n[l].call(d.exports,d,d.exports,s),d.exports}s.d=(l,u)=>{for(var d in u)s.o(u,d)&&!s.o(l,d)&&Object.defineProperty(l,d,{enumerable:!0,get:u[d]})},s.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),s.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var a={};return(()=>{/*!*******************************!*\
  !*** ./src/js-interpreter.js ***!
  \*******************************/s.r(a),s.d(a,{default:()=>d});const l=s("./original-repo/acorn.js");globalThis.acorn=l;const{Interpreter:u}=s("./original-repo/interpreter.js"),d=u})(),a=a.default,a})())})(O2);var koe=O2.exports;const Z0=pd(koe),Poe=i=>/if\s*\(.*\)/.test(i),Doe=i=>/for\s*\(.*\)/.test(i),Boe=i=>{const e=/for\s*\(\s*var\s+(\w+)\s*=\s*(\d+);\s*\1\s*<\s*(\d+);\s*\1\+\+\s*\)/,n=i.match(e);if(!n)throw new Error("Invalid for loop format");const r=parseInt(n[3],10),s=i.match(/\{([^}]*)\}/);let a="";return s?(a=s[1].trim(),console.log("Contents inside the loop: ",a)):console.log("No content found inside braces."),{count:r,content:a}};M2(Coe);const ua=()=>{const[i,e]=q.useState(!1),[n,r]=q.useState(!1),s=()=>{e(!i)},a=q.useRef();let l=q.useRef();const[u,d]=q.useState(!1),h=()=>{cg().clear()},f=()=>{bt.emit("resetSimulationEnv")},p=()=>{d(G=>{const Z=!G;return bt.emit("mouseControlEnabled",Z),r(Z),Z})},m=()=>{var G=Pn.workspaceToCode(cg().current);console.log(G);const Z=new Z0(G,S),K=()=>{Z.step()?requestAnimationFrame(K):console.log("Simulation completed")};K()},v=()=>{const G=Pn.workspaceToCode(cg().current),Z=Boe(G),K=fe=>new Promise(Ae=>setTimeout(Ae,fe)),se=async fe=>{for(const Ae of fe){console.log(`Executing command: ${Ae.trim()}`);const Ce=new Z0(Ae,S),Ie=()=>{Ce.step()?requestAnimationFrame(Ie):console.log("Command execution completed")};Ie(),await K(1e4)}},Y=async(fe,Ae)=>{for(let Ce=0;Ce<fe;Ce++)console.log(`Iteration ${Ce+1} of ${fe}`),await se(Ae);console.log("Mission Completed")},me=Z.content.split(";").map(fe=>fe.trim()).filter(fe=>fe);Y(Z.count,me)},y=G=>{const Z=G.split(";"),K=Y=>new Promise(me=>setTimeout(me,Y));(async Y=>{for(let me=0;me<Y;me++){const fe=Z[me];console.log(fe);const Ae=new Z0(fe,S),Ce=()=>{Ae.step()?requestAnimationFrame(Ce):console.log("Simulation completed")};Ce(),await K(5e3)}console.log("Mission Completed")})(Z.length)},$=()=>{var G=Pn.workspaceToCode(cg().current);if(G.includes("function")){console.log("Executing Function Simulator..."),console.log(G);const Z=new Z0(G,S),K=()=>{Z.step()?setTimeout(K,500):console.log("Function Execution Completed")};K()}else console.log("No function found, skipping function simulator.")},E=()=>{var G=Pn.workspaceToCode(cg().current);G.includes("function")?$():Poe(G)?m():Doe(G)?v():y(G)},S=(G,Z)=>{const K=Y=>(me,fe,Ae,Ce)=>Y(me,fe,Ae,Ce),se=Y=>{window.alert(Y?Y.toString():"")};G.setProperty(Z,"alert",G.createNativeFunction(se)),G.setProperty(Z,"flyForward",G.createNativeFunction(K(k))),G.setProperty(Z,"flyBackward",G.createNativeFunction(K(ce))),G.setProperty(Z,"flyDown",G.createNativeFunction(K(ne))),G.setProperty(Z,"flyUp",G.createNativeFunction(K(F))),G.setProperty(Z,"flyLeft",G.createNativeFunction(K(re))),G.setProperty(Z,"flyRight",G.createNativeFunction(K(ae))),G.setProperty(Z,"setSpeed",G.createNativeFunction(K(U))),G.setProperty(Z,"setWaitTime",G.createNativeFunction(K(D))),G.setProperty(Z,"rotateDrone",G.createNativeFunction(K(ue))),G.setProperty(Z,"moveTo",G.createNativeFunction(K(de))),G.setProperty(Z,"captureImage",G.createNativeFunction(K(O))),G.setProperty(Z,"flip",G.createNativeFunction(K(Re))),G.setProperty(Z,"pickupObject",G.createNativeFunction(A)),G.setProperty(Z,"dropObject",G.createNativeFunction(C)),G.setProperty(Z,"sprayObject",G.createNativeFunction(x)),G.setProperty(Z,"advertiseText",G.createNativeFunction(I))},A=G=>{bt.emit("commandPickupObject",G)},C=G=>{bt.emit("commandDropObject",G)},x=G=>{bt.emit("commandSpray",G)},I=G=>{bt.emit("commandAdvertiseText",G)},O=()=>{bt.emit("commandTakeScreenShot")},F=(G,Z)=>{bt.emit("commandFlyUp",[G,Z])},k=(G,Z)=>{bt.emit("commandFlyFoward",[G,Z])},D=(G,Z)=>{bt.emit("commandSetWaitTime",[G,Z])},U=G=>{bt.emit("commandSetSpeed",[G])},ce=(G,Z)=>{bt.emit("commandFlyBackward",[G,Z])},re=(G,Z)=>{bt.emit("commandFlyLeft",[G,Z])},ae=(G,Z)=>{bt.emit("commandFlyRight",[G,Z])},ne=(G,Z)=>{bt.emit("commandFlyDown",[G,Z])},de=(G,Z,K,se)=>{bt.emit("commandFlyTo",[G,Z,K,se])},ue=(G,Z,K,se)=>{bt.emit("commandRotate",[G,Z,K,se])},Re=G=>{bt.emit("commandFlip",[G])};return q.useEffect(()=>{const G=woe;Moe(kq),l.current=w2(a.current,{toolbox:G,theme:Ioe,zoom:{controls:!0,wheel:!0,startScale:.9},grid:{spacing:20,length:3,colour:"#ccc",snap:!0},trashcan:!0,move:!0})},[]),V.jsxs("div",{className:"blockpad-wrapper",children:[V.jsxs("div",{className:"button-bar",children:[V.jsx(Sg,{onClick:h,title:"Clear Workspace",green:!0,medium:!0}),V.jsx(Sg,{onClick:E,title:"Launch Simulation",medium:!0}),V.jsx(Sg,{onClick:f,title:"Reset Simulation",medium:!0,children:"/"}),V.jsxs("label",{className:"toggle-switch",children:[V.jsx("input",{type:"checkbox",checked:u,onChange:p}),V.jsx("span",{className:"slider",children:" Mouse Control "})]})]}),V.jsx("div",{ref:a,className:"blockly-area"}),n&&V.jsxs("div",{className:"note-box",children:[V.jsxs("p",{children:[" ",V.jsx("strong",{children:"Note:"})," Enabling mouse control disables the default camera perspective of the drone."]}),V.jsx("button",{className:"close-btn",onClick:()=>r(!1),children:""})]}),i&&V.jsx("div",{className:"blockly-modal",children:V.jsxs("div",{className:"blockly-modal-content",children:[V.jsx("div",{className:"blockly-modal-close",children:V.jsx(Sg,{onClick:s,title:"Close",small:!0,children:"/"})}),V.jsx("h2",{children:"Select a Lesson"}),V.jsx("div",{className:"blockly-lesson-buttons"})]})})]})};ua.propTypes={};const Foe=i=>-Math.ceil(i*(180/Math.PI))%360,ha=({dronePosition:i,disableMeasurementView:e})=>{const[n,r]=q.useState(!1),s=()=>{r(a=>{const l=!a;return console.log("value changed to ",l),bt.emit("measurementViewEnabled",l),l})};return V.jsx("div",{className:"toolbar",children:V.jsxs("div",{className:"row",children:[V.jsxs("div",{className:"column",children:[V.jsxs("span",{className:"coordinate",children:["X: ",Math.ceil(i.xPos)," cm "]}),V.jsxs("span",{className:"coordinate",children:["Z: ",Math.ceil(i.zPos)," cm "]})]}),V.jsxs("div",{className:"column",children:[V.jsxs("span",{className:"coordinate",children:["Altitude: ",Math.ceil(i.yPos)," cm "]}),V.jsxs("span",{className:"rotation",children:["Yaw: ",Foe(i.yRot),""]})]}),V.jsx("div",{className:"column",children:!e&&V.jsxs("label",{className:"toggle-switch",children:[V.jsx("input",{type:"checkbox",checked:n,onChange:s}),V.jsx("span",{className:"slider",children:"Measurement View"})]})})]})})};ha.propTypes={dronePosition:zt.shape({xPos:zt.number.isRequired,yPos:zt.number.isRequired,zPos:zt.number.isRequired,xRot:zt.number.isRequired,yRot:zt.number.isRequired,zRot:zt.number.isRequired,disableMeasurementView:zt.bool}).isRequired};const Uoe=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{console.log(p),s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(A2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})};function Z$(i){const e=new Map,n=new Map,r=i.clone();return L2(i,r,function(s,a){e.set(a,s),n.set(s,a)}),r.traverse(function(s){if(!s.isSkinnedMesh)return;const a=s,l=e.get(s),u=l.skeleton.bones;a.skeleton=l.skeleton.clone(),a.bindMatrix.copy(l.bindMatrix),a.skeleton.bones=u.map(function(d){return n.get(d)}),a.bind(a.skeleton,a.bindMatrix)}),r}function L2(i,e,n){n(i,e);for(let r=0;r<i.children.length;r++)L2(i.children[r],e.children[r],n)}const bn=q.forwardRef(({path:i,position:e,rotation:n=[0,0,0],scale:r=1,name:s,enableMeasurement:a},l)=>{const{scene:u}=es(i),d=q.useRef(),[h,f]=q.useState(!1),p=q.useMemo(()=>Z$(u),[u]);return q.useImperativeHandle(l,()=>d.current),q.useEffect(()=>{d.current&&(d.current.name=s)},[s]),V.jsxs(V.Fragment,{children:[V.jsx("group",{position:e,rotation:n,scale:r,onPointerOver:()=>f(!0),onPointerOut:()=>f(!1),children:V.jsx("primitive",{object:p,ref:d})}),h&&V.jsx(Fi,{position:[e[0]-6,e[1]+5,e[2]+3],fontSize:1,color:"black",anchorX:"center",anchorY:"center",rotation:a?[Math.PI/2,Math.PI,0]:[0,Math.PI,0],children:s})]})}),Goe=new Io;let uI,ZS,ev=null,Hoe="white",Voe="black",zoe="yellow";const Woe=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(0,450,-200),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),uI=e,ZS=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Xoe=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Voe})]}),joe=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,uI);const h=d.intersectObject(ZS,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),ev==null&&(ev=r.current.position.clone()),ev.distanceTo(f);const p=[ev,f],m=new on().setFromPoints(p),v=new Ai({color:Hoe}),y=new pr(m,v);ZS.add(y),ev.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;Yoe($,f)}}},Yoe=(i,e)=>{Goe.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:4,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:"black"}),a=new Bn(r,s);r.computeBoundingBox();const l=r.boundingBox,u=l.max.x-l.min.x,d=l.max.y-l.min.y;a.position.set(-u/2,0,0);const h=.5,f=new ja(u+h,d+h),p=new oi({color:"white",transparent:!1}),m=new Bn(f,p);m.position.set(0,d/2,-.1);const v=new ta;v.add(m),v.add(a),v.position.set(e.x,e.y+50,e.z),v.lookAt(uI.position),ZS.add(v)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Koe=()=>{const{scene:i}=es("assets/models/architecture/museum.glb"),e=[50,-70,-130],n=[0,220,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:15})},Joe=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},N2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef(),f=q.useRef();return V.jsxs(Ka,{shadows:!0,onClick:p=>joe(p,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(Koe,{}),e?V.jsxs(V.Fragment,{children:[V.jsx(Rl,{children:V.jsx(Fi,{position:[60,-150,140],fontSize:7,color:"black",children:"The Serving Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[50,-40,140],fontSize:7,color:"black",children:"The Dining Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[20,20,140],fontSize:7,color:"black",children:"The Upper Vestibule"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-10,-50,50],fontSize:5,color:"black",children:"The Lower Vestibule"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[30,130,160],fontSize:7,color:"black",children:"The Small Drawing Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-60,20,160],fontSize:5,color:"black",children:"The Morning Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-60,130,160],fontSize:7,color:"black",children:"The Great Drawing Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-150,130,160],fontSize:5,color:"black",children:"The Smoking Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-130,40,140],fontSize:7,color:"black",children:"The Armoury"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-150,-60,140],fontSize:7,color:"black",children:"The Billiard Room"})}),V.jsx(Rl,{children:V.jsx(Fi,{position:[-150,-150,140],fontSize:7,color:"black",children:"The Porcelain Room"})})]}):V.jsxs(V.Fragment,{children:[V.jsx(Fi,{position:[-80,30,-200],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Serving Room"}),V.jsx(Fi,{position:[-80,30,-100],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Dining Room"}),V.jsx(Fi,{position:[-10,30,50],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Upper Vestibule"}),V.jsx(Fi,{position:[-10,-50,50],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Lower Vestibule"}),V.jsx(Fi,{position:[-50,30,160],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Small Drawing Room"}),V.jsx(Fi,{position:[80,30,40],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Morning Room"}),V.jsx(Fi,{position:[80,30,140],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Great Drawing Room"}),V.jsx(Fi,{position:[230,20,140],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Smoking Room"}),V.jsx(Fi,{position:[200,20,40],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Armoury"}),V.jsx(Fi,{position:[210,20,-100],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Billiard Room"}),V.jsx(Fi,{position:[200,10,-200],fontSize:5,color:"black",rotation:[0,Math.PI,0],children:"The Porcelain Room"})]}),s.map((p,m)=>V.jsx(Xoe,{position:p},m)),V.jsx(Woe,{measurementViewEnabled:e}),V.jsx(Joe,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.6,cameraOffset:[0,10,-13],lineColor:zoe,droneSpeed:.4}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/architecture/child.glb",position:[160,-5,-200],scale:20,enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/architecture/first_aid.glb",position:[-35,10,-200],rotation:[0,Math.PI/2,0],scale:40,enableMeasurement:e}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/architecture/frame.glb",position:[0,-10,70],rotation:[-90,0,0],scale:2,enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/hospitality/wallet.glb",position:[170,10,70],rotation:[0,0,0],scale:.4,enableMeasurement:e}),V.jsx(bn,{ref:f,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/fire.glb",position:[3,20,170],rotation:[0,140,0],scale:.03,enableMeasurement:e})]})};N2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const Zoe=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(N2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},qoe=new Io;let k2,qS,tv=null,Qoe="white",eae="black",tae="yellow",nae="yellow";const iae=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(0,100,-3),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),k2=e,qS=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},rae=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:eae})]}),sae=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,k2);const h=d.intersectObject(qS,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),tv==null&&(tv=r.current.position.clone()),tv.distanceTo(f);const p=[tv,f],m=new on().setFromPoints(p),v=new Ai({color:Qoe}),y=new pr(m,v);qS.add(y),tv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;oae($,f)}}},oae=(i,e)=>{qoe.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:nae}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.rotation.x=-Math.PI/2,qS.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},aae=()=>{const{scene:i}=es("assets/models/transportation/future_city_compressed.glb"),e=[-200,-5,90],n=[0,0,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:1})},P2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),s=q.useRef(),[a,l]=q.useState([]);return V.jsxs(Ka,{shadows:!0,onClick:u=>sae(u,l,e,i),children:[V.jsx("color",{attach:"background",args:["#fffffff"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(aae,{}),a.map((u,d)=>V.jsx(rae,{position:u},d)),V.jsx(iae,{measurementViewEnabled:e}),V.jsx(UE,{droneCameraRef:s,environment:"transportation"}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.3,cameraOffset:[0,5,-20],lineColor:tae,droneCameraRef:s})]})};P2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const qk=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(P2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},lae=new Io;let D2,QS,nv=null,cae="white",uae="black",hae="yellow",dae="black",fae="Sale";const pae=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(-350,100,300),e.lookAt(new ie(400,50,-200)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),D2=e,QS=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},mae=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:uae})]}),gae=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,D2);const h=d.intersectObject(QS,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),nv==null&&(nv=r.current.position.clone());const p=nv.distanceTo(f),m=[nv,f],v=new on().setFromPoints(m),y=new Ai({color:cae}),$=new pr(v,y);QS.add($),nv.copy(f),_ae(`${p.toFixed(2)} cm`,f)}}},_ae=(i,e)=>{lae.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:dae}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.rotation.x=-Math.PI/2,QS.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Tae=()=>{const{scene:i}=es("assets/models/business/farm_scene.glb"),e=[200,-20,-130],n=[0,400,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:50})},B2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),s=q.useRef(),[a,l]=q.useState([]);return V.jsxs(Ka,{shadows:!0,onClick:u=>gae(u,l,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(Tae,{}),a.map((u,d)=>V.jsx(mae,{position:u},d)),V.jsx(pae,{measurementViewEnabled:e}),V.jsx(UE,{droneCameraRef:s,environment:"mountain"}),V.jsx(Mo,{flyerText:fae,ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:5,cameraOffset:[0,50,-80],lineColor:hae,droneCameraRef:s})]})};B2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const vae=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(B2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},Eae=new Io;let hI,pp,iv=null,yae="white",Sae="black",$ae="yellow",bae="black";const Aae=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(5,18,-5),e.lookAt(new ie(-2,-3,11)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),hI=e,pp=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Cae=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Sae})]}),Rae=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,hI);const h=d.intersectObject(pp,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),iv==null&&(iv=r.current.position.clone()),iv.distanceTo(f);const p=[iv,f],m=new on().setFromPoints(p),v=new Ai({color:yae}),y=new pr(m,v);pp.add(y),iv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;xae($,f)}}},xae=(i,e)=>{Eae.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:bae}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.lookAt(hI.position),pp.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},wae=()=>{const{scene:i}=es("assets/models/education/classroom2.glb"),e=[35,-11,13],n=[0,240,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:9})},Mae=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},F2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef();return q.useEffect(()=>{const f=m=>{const v=i.current,y=pp.getObjectByName(m);if(!v||!y)return;const $=new ie,E=new ie;v.getWorldPosition($),y.getWorldPosition(E),$.distanceTo(E)<15?(v.attach(y),y.position.set(0,2,0),console.log(`Picked up ${m}`)):console.log(`${m} too far to pick up.`)},p=m=>{const v=i.current,y=pp.getObjectByName(m);if(!v||!y)return;pp.attach(y);const $=new ie;v.getWorldPosition($),y.position.copy($),console.log(`Dropped ${m}`)};return bt.on("commandPickupObject",f),bt.on("commandDropObject",p),()=>{bt.off("commandPickupObject",f),bt.off("commandDropObject",p)}},[]),V.jsxs(Ka,{shadows:!0,onClick:f=>Rae(f,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(wae,{}),s.map((f,p)=>V.jsx(Cae,{position:f},p)),V.jsx(Aae,{measurementViewEnabled:e}),V.jsx(Mae,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.8,cameraOffset:[5,9,-12],lineColor:$ae,droneSpeed:.4}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/education/book.glb",position:[7,-3,18],scale:1,name:"book1",enableMeasurement:e}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/education/book.glb",position:[12,-1.5,47],scale:1,name:"book2",enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/education/books.glb",position:[3,-1.5,1],scale:.6,name:"book3",enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/education/books.glb",position:[3,-1.5,-.5],scale:.6,name:"book4",enableMeasurement:e}),V.jsx(bn,{path:"/drone-simulation-cte-alpha/assets/models/education/pen.glb",position:[-14,-8,20],scale:.3,name:"pen1",enableMeasurement:e}),V.jsx(bn,{path:"/drone-simulation-cte-alpha/assets/models/infotech/trashcan.glb",position:[-9,-10,-2],scale:4,name:"trashcan",enableMeasurement:e}),V.jsx(bn,{path:"/drone-simulation-cte-alpha/assets/models/infotech/paper.glb",position:[-7,-10,48],scale:1,name:"trash1",enableMeasurement:e}),V.jsx(bn,{path:"/drone-simulation-cte-alpha/assets/models/infotech/paper.glb",position:[-27,-10,3],scale:1,name:"trash2",enableMeasurement:e})]})};F2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const Iae=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(F2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},Oae=new Io;let U2,e$,rv=null,Lae="white",Nae="black",Qk="yellow",kae="black";const Pae=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(5,100,-3),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),U2=e,e$=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Dae=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Nae})]}),Bae=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,U2);const h=d.intersectObject(e$,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),rv==null&&(rv=r.current.position.clone());const p=rv.distanceTo(f),m=[rv,f],v=new on().setFromPoints(m),y=new Ai({color:Lae}),$=new pr(v,y);e$.add($),rv.copy(f),Fae(`${p.toFixed(2)} cm`,f)}}},Fae=(i,e)=>{Oae.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:kae}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.rotation.x=-Math.PI/2,e$.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Uae=()=>{const{scene:i}=es("assets/models/communication/environment.glb"),e=[0,0,0],n=[0,-48.7,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:.5})},G2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),s=q.useRef(),[a,l]=q.useState([]);return V.jsxs(Ka,{shadows:!0,onClick:u=>Bae(u,l,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(Uae,{}),a.map((u,d)=>V.jsx(Dae,{position:u},d)),V.jsx(Pae,{measurementViewEnabled:e}),V.jsx(UE,{droneCameraRef:s,environment:"communication"}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.3,cameraOffset:[0,5,-18],lineColor:Qk,droneCameraRef:s}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.3,cameraOffset:[0,5,-18],lineColor:Qk,droneInitialPosition:[1,1,1]})]})};G2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const Gae=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(G2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},Hae=new Io;let H2,t$,sv=null,Vae="white",zae="black",Wae="yellow",Xae="black";const jae=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(5,100,-3),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),H2=e,t$=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Yae=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:zae})]}),Kae=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,H2);const h=d.intersectObject(t$,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),sv==null&&(sv=r.current.position.clone());const p=sv.distanceTo(f),m=[sv,f],v=new on().setFromPoints(m),y=new Ai({color:Vae}),$=new pr(v,y);t$.add($),sv.copy(f),Jae(`${p.toFixed(2)} cm`,f)}}},Jae=(i,e)=>{Hae.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:Xae}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.rotation.x=-Math.PI/2,t$.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Zae=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},qae=({start:i,end:e,label:n})=>V.jsxs("group",{children:[V.jsx(eI,{points:[i,e],color:"black",lineWidth:1,dashed:!1}),V.jsxs("mesh",{position:e,children:[V.jsx("sphereGeometry",{args:[.3,16,16]}),V.jsx("meshStandardMaterial",{color:"red"})]}),V.jsx(fY,{position:[e[0]+.5,e[1]+.5,e[2]+0],style:{background:"white",padding:"5px 20px",borderRadius:"12px",fontSize:"40px",color:"black",fontWeight:"bold",boxShadow:"0px 0px 8px rgba(0,0,0,0.5)",whiteSpace:"nowrap",textAlign:"center",marginBottom:"20px"},center:!0,distanceFactor:10,children:n})]}),Qae=[{start:[5,2.7,3],end:[5,6,3],label:"Propeller"},{start:[3.5,2.2,2.5],end:[10,0,0],label:"Brushless Motors"},{start:[3.5,1,2.5],end:[10,-5,0],label:"Landing Gear"},{start:[0,3,2],end:[0,0,5],label:"Front Camera"},{start:[0,1,1],end:[-5,0,5],label:"Stabilizer"},{start:[0,3,0],end:[0,8,0],label:"Battery Power and Cover"},{start:[0,1.2,0],end:[-6,0,0],label:"Micro SD"},{start:[0,.5,-1],end:[0,0,-6],label:"Battery Indicator"},{start:[0,2,0],end:[-6,3,0],label:"Infrared Sensor"}],V2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{var h,f,p;const r=q.useRef(),[s,a]=q.useState([]),l=((h=i.current)==null?void 0:h.position.x)||0,u=((f=i.current)==null?void 0:f.position.y)||0,d=((p=i.current)==null?void 0:p.position.z)||0;return V.jsxs(Ka,{shadows:!0,onClick:m=>Kae(m,a,e,i),children:[V.jsx("color",{attach:"background",args:["#ffffff"]}),V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)}),V.jsx(Za,{preset:"sunset",intensity:.5}),s.map((m,v)=>V.jsx(Yae,{position:m},v)),V.jsx(jae,{measurementViewEnabled:e}),V.jsx(Zae,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:2,cameraOffset:[0,20,-18],lineColor:Wae}),Qae.map((m,v)=>V.jsx(qae,{start:[l+m.start[0],u+m.start[1],d+m.start[2]],end:[l+m.end[0],u+m.end[1],d+m.end[2]],label:m.label},v))]})};V2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const ele=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a,disableMeasurementView:!0}),V.jsx(V2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})};new Io;zt.object.isRequired,zt.bool,zt.bool;new Io;zt.object.isRequired,zt.bool,zt.bool;const tle=new Io;let dI,Yh,ov=null,nle="white",ile="black",rle="yellow",sle="black";const ole=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(20,70,-40),e.lookAt(new ie(20,20,10)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),dI=e,Yh=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},ale=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:ile})]}),lle=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,dI);const h=d.intersectObject(Yh,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),ov==null&&(ov=r.current.position.clone()),ov.distanceTo(f);const p=[ov,f],m=new on().setFromPoints(p),v=new Ai({color:nle}),y=new pr(m,v);Yh.add(y),ov.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;cle($,f)}}},cle=(i,e)=>{tle.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:sle}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.lookAt(dI.position),Yh.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},ule=()=>{const{scene:i}=es("assets/models/infotech/office1.glb"),e=[-105,-18,45],n=[0,90,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:20})},hle=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},z2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef(),f=q.useRef(),p=q.useRef(),m=q.useRef(),v=q.useRef(),y=q.useRef();return q.useEffect(()=>{const $=S=>{const A=i.current,C=Yh.getObjectByName(S);if(!A||!C)return;const x=new ie,I=new ie;A.getWorldPosition(x),C.getWorldPosition(I),x.distanceTo(I)<20?(A.attach(C),C.position.set(0,2,-3),console.log(`Picked up ${S}`)):console.log(`${S} too far to pick up.`)},E=S=>{const A=i.current,C=Yh.getObjectByName(S);if(!A||!C)return;Yh.attach(C);const x=new ie;A.getWorldPosition(x);const I=Yh.worldToLocal(worldPosition.clone());C.position.copy(I),console.log("Drone world position at drop:",worldPosition),console.log("Book local position after conversion:",I),console.log(`Dropped ${S}`)};return bt.on("commandPickupObject",$),bt.on("commandDropObject",E),()=>{bt.off("commandPickupObject",$),bt.off("commandDropObject",E)}},[]),V.jsxs(Ka,{shadows:!0,onClick:$=>lle($,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(ule,{}),s.map(($,E)=>V.jsx(ale,{position:$},E)),V.jsx(ole,{measurementViewEnabled:e}),V.jsx(hle,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.5,cameraOffset:[-5.5,5,-9],lineColor:rle,droneSpeed:.9}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/infotech/desktop.glb",position:[32,-6,6],rotation:[0,Math.PI+45,0],scale:2,name:"desktop1",enableMeasurement:e}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/infotech/shelf.glb",position:[35,-17,4],rotation:[0,Math.PI/4,0],scale:15,enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/infotech/desktop.glb",position:[32,1,6],rotation:[0,Math.PI+45,0],scale:2,name:"desktop2",enableMeasurement:e}),V.jsx(bn,{ref:f,path:"/drone-simulation-cte-alpha/assets/models/infotech/trashcan.glb",position:[30,-18,10],rotation:[0,Math.PI/2,0],scale:9,enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/infotech/desk.glb",position:[-3,-5,80],rotation:[0,Math.PI/5,0],scale:5,enableMeasurement:e}),V.jsx(bn,{ref:p,path:"/drone-simulation-cte-alpha/assets/models/infotech/banana.glb",position:[15,-1,10],rotation:[0,Math.PI/2,0],scale:9,name:"peel",enableMeasurement:e}),V.jsx(bn,{ref:m,path:"/drone-simulation-cte-alpha/assets/models/infotech/paper.glb",position:[28,-18,5],scale:2,name:"paper",enableMeasurement:e}),V.jsx(bn,{ref:v,path:"/drone-simulation-cte-alpha/assets/models/infotech/alphabet1.glb",position:[-2.5,.5,96.5],scale:7,enableMeasurement:e}),V.jsx(bn,{ref:y,path:"/drone-simulation-cte-alpha/assets/models/infotech/alphabet2.glb",position:[27,0,138.3],rotation:[0,110,0],scale:7,enableMeasurement:e})]})};z2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const dle=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(z2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})};function eP(i,e){if(e===fM)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===bp||e===yE){let n=i.getIndex();if(n===null){const l=[],u=i.getAttribute("position");if(u!==void 0){for(let d=0;d<u.count;d++)l.push(d);i.setIndex(l),n=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const r=n.count-2,s=[];if(e===bp)for(let l=1;l<=r;l++)s.push(n.getX(0)),s.push(n.getX(l)),s.push(n.getX(l+1));else for(let l=0;l<r;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=i.clone();return a.setIndex(s),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}class fle extends ls{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Tle(n)}),this.register(function(n){return new Cle(n)}),this.register(function(n){return new Rle(n)}),this.register(function(n){return new xle(n)}),this.register(function(n){return new Ele(n)}),this.register(function(n){return new yle(n)}),this.register(function(n){return new Sle(n)}),this.register(function(n){return new $le(n)}),this.register(function(n){return new _le(n)}),this.register(function(n){return new ble(n)}),this.register(function(n){return new vle(n)}),this.register(function(n){return new Ale(n)}),this.register(function(n){return new mle(n)}),this.register(function(n){return new wle(n)}),this.register(function(n){return new Mle(n)})}load(e,n,r,s){const a=this;let l;this.resourcePath!==""?l=this.resourcePath:this.path!==""?l=this.path:l=Pl.extractUrlBase(e),this.manager.itemStart(e);const u=function(h){s?s(h):console.error(h),a.manager.itemError(e),a.manager.itemEnd(e)},d=new Nr(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(h){try{a.parse(h,l,function(f){n(f),a.manager.itemEnd(e)},u)}catch(f){u(f)}},r,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,s){let a;const l={},u={},d=new TextDecoder;if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===W2){try{l[qn.KHR_BINARY_GLTF]=new Ile(e)}catch(p){s&&s(p);return}a=JSON.parse(l[qn.KHR_BINARY_GLTF].content)}else a=JSON.parse(d.decode(e));else a=e;if(a.asset===void 0||a.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new zle(a,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const p=this.pluginCallbacks[f](h);u[p.name]=p,l[p.name]=!0}if(a.extensionsUsed)for(let f=0;f<a.extensionsUsed.length;++f){const p=a.extensionsUsed[f],m=a.extensionsRequired||[];switch(p){case qn.KHR_MATERIALS_UNLIT:l[p]=new gle;break;case qn.KHR_DRACO_MESH_COMPRESSION:l[p]=new Ole(a,this.dracoLoader);break;case qn.KHR_TEXTURE_TRANSFORM:l[p]=new Lle;break;case qn.KHR_MESH_QUANTIZATION:l[p]=new Nle;break;default:m.indexOf(p)>=0&&u[p]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+p+'".')}}h.setExtensions(l),h.setPlugins(u),h.parse(r,s)}parseAsync(e,n){const r=this;return new Promise(function(s,a){r.parse(e,n,s,a)})}}function ple(){let i={};return{get:function(e){return i[e]},add:function(e,n){i[e]=n},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const qn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class mle{constructor(e){this.parser=e,this.name=qn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let r=0,s=n.length;r<s;r++){const a=n[r];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let s=n.cache.get(r);if(s)return s;const a=n.json,d=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let h;const f=new xt(16777215);d.color!==void 0&&f.fromArray(d.color);const p=d.range!==void 0?d.range:0;switch(d.type){case"directional":h=new W$(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new z$(f),h.distance=p;break;case"spot":h=new V$(f),h.distance=p,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,h.angle=d.spot.outerConeAngle,h.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return h.position.set(0,0,0),h.decay=2,Gh(h,d),d.intensity!==void 0&&(h.intensity=d.intensity),h.name=n.createUniqueName(d.name||"light_"+e),s=Promise.resolve(h),n.cache.add(r,s),s}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,r=this.parser,a=r.json.nodes[e],u=(a.extensions&&a.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(d){return r._getNodeRef(n.cache,u,d)})}}class gle{constructor(){this.name=qn.KHR_MATERIALS_UNLIT}getMaterialType(){return oi}extendParams(e,n,r){const s=[];e.color=new xt(1,1,1),e.opacity=1;const a=n.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const l=a.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}a.baseColorTexture!==void 0&&s.push(r.assignTexture(e,"map",a.baseColorTexture,vn))}return Promise.all(s)}}class _le{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name].emissiveStrength;return a!==void 0&&(n.emissiveIntensity=a),Promise.resolve()}}class Tle{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];if(l.clearcoatFactor!==void 0&&(n.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&a.push(r.assignTexture(n,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&a.push(r.assignTexture(n,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(a.push(r.assignTexture(n,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const u=l.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new mt(u,u)}return Promise.all(a)}}class vle{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.iridescenceFactor!==void 0&&(n.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&a.push(r.assignTexture(n,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(n.iridescenceIOR=l.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&a.push(r.assignTexture(n,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(a)}}class Ele{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];n.sheenColor=new xt(0,0,0),n.sheenRoughness=0,n.sheen=1;const l=s.extensions[this.name];return l.sheenColorFactor!==void 0&&n.sheenColor.fromArray(l.sheenColorFactor),l.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&a.push(r.assignTexture(n,"sheenColorMap",l.sheenColorTexture,vn)),l.sheenRoughnessTexture!==void 0&&a.push(r.assignTexture(n,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(a)}}class yle{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.transmissionFactor!==void 0&&(n.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&a.push(r.assignTexture(n,"transmissionMap",l.transmissionTexture)),Promise.all(a)}}class Sle{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];n.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&a.push(r.assignTexture(n,"thicknessMap",l.thicknessTexture)),n.attenuationDistance=l.attenuationDistance||1/0;const u=l.attenuationColor||[1,1,1];return n.attenuationColor=new xt(u[0],u[1],u[2]),Promise.all(a)}}class $le{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=s.extensions[this.name];return n.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}}class ble{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];n.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&a.push(r.assignTexture(n,"specularIntensityMap",l.specularTexture));const u=l.specularColorFactor||[1,1,1];return n.specularColor=new xt(u[0],u[1],u[2]),l.specularColorTexture!==void 0&&a.push(r.assignTexture(n,"specularColorMap",l.specularColorTexture,vn)),Promise.all(a)}}class Ale{constructor(e){this.parser=e,this.name=qn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:kr}extendMaterialParams(e,n){const r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[],l=s.extensions[this.name];return l.anisotropyStrength!==void 0&&(n.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(n.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&a.push(r.assignTexture(n,"anisotropyMap",l.anisotropyTexture)),Promise.all(a)}}class Cle{constructor(e){this.parser=e,this.name=qn.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const a=s.extensions[this.name],l=n.options.ktx2Loader;if(!l){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,a.source,l)}}class Rle{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,s=r.json,a=s.textures[e];if(!a.extensions||!a.extensions[n])return null;const l=a.extensions[n],u=s.images[l.source];let d=r.textureLoader;if(u.uri){const h=r.options.manager.getHandler(u.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,l.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class xle{constructor(e){this.parser=e,this.name=qn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,s=r.json,a=s.textures[e];if(!a.extensions||!a.extensions[n])return null;const l=a.extensions[n],u=s.images[l.source];let d=r.textureLoader;if(u.uri){const h=r.options.manager.getHandler(u.uri);h!==null&&(d=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,l.source,d);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class wle{constructor(e){this.name=qn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,r=n.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const s=r.extensions[this.name],a=this.parser.getDependency("buffer",s.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(u){const d=s.byteOffset||0,h=s.byteLength||0,f=s.count,p=s.byteStride,m=new Uint8Array(u,d,h);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,p,m,s.mode,s.filter).then(function(v){return v.buffer}):l.ready.then(function(){const v=new ArrayBuffer(f*p);return l.decodeGltfBuffer(new Uint8Array(v),f,p,m,s.mode,s.filter),v})})}else return null}}class Mle{constructor(e){this.name=qn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const s=n.meshes[r.mesh];for(const h of s.primitives)if(h.mode!==ka.TRIANGLES&&h.mode!==ka.TRIANGLE_STRIP&&h.mode!==ka.TRIANGLE_FAN&&h.mode!==void 0)return null;const l=r.extensions[this.name].attributes,u=[],d={};for(const h in l)u.push(this.parser.getDependency("accessor",l[h]).then(f=>(d[h]=f,d[h])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(h=>{const f=h.pop(),p=f.isGroup?f.children:[f],m=h[0].count,v=[];for(const y of p){const $=new pn,E=new ie,S=new Er,A=new ie(1,1,1),C=new P$(y.geometry,y.material,m);for(let x=0;x<m;x++)d.TRANSLATION&&E.fromBufferAttribute(d.TRANSLATION,x),d.ROTATION&&S.fromBufferAttribute(d.ROTATION,x),d.SCALE&&A.fromBufferAttribute(d.SCALE,x),C.setMatrixAt(x,$.compose(E,S,A));for(const x in d)x!=="TRANSLATION"&&x!=="ROTATION"&&x!=="SCALE"&&y.geometry.setAttribute(x,d[x]);Xn.prototype.copy.call(C,y),this.parser.assignFinalMaterial(C),v.push(C)}return f.isGroup?(f.clear(),f.add(...v),f):v[0]}))}}const W2="glTF",av=12,tP={JSON:1313821514,BIN:5130562};class Ile{constructor(e){this.name=qn.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,av),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==W2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-av,a=new DataView(e,av);let l=0;for(;l<s;){const u=a.getUint32(l,!0);l+=4;const d=a.getUint32(l,!0);if(l+=4,d===tP.JSON){const h=new Uint8Array(e,av+l,u);this.content=r.decode(h)}else if(d===tP.BIN){const h=av+l;this.body=e.slice(h,h+u)}l+=u}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ole{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const r=this.json,s=this.dracoLoader,a=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,u={},d={},h={};for(const f in l){const p=nw[f]||f.toLowerCase();u[p]=l[f]}for(const f in e.attributes){const p=nw[f]||f.toLowerCase();if(l[f]!==void 0){const m=r.accessors[e.attributes[f]],v=Pg[m.componentType];h[p]=v.name,d[p]=m.normalized===!0}}return n.getDependency("bufferView",a).then(function(f){return new Promise(function(p){s.decodeDracoFile(f,function(m){for(const v in m.attributes){const y=m.attributes[v],$=d[v];$!==void 0&&(y.normalized=$)}p(m)},u,h)})})}}class Lle{constructor(){this.name=qn.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class Nle{constructor(){this.name=qn.KHR_MESH_QUANTIZATION}}class X2 extends kp{constructor(e,n,r,s){super(e,n,r,s)}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=e*s*3+s;for(let l=0;l!==s;l++)n[l]=r[a+l];return n}interpolate_(e,n,r,s){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,d=u*2,h=u*3,f=s-n,p=(r-n)/f,m=p*p,v=m*p,y=e*h,$=y-h,E=-2*v+3*m,S=v-m,A=1-E,C=S-m+p;for(let x=0;x!==u;x++){const I=l[$+x+u],O=l[$+x+d]*f,F=l[y+x+u],k=l[y+x]*f;a[x]=A*I+C*O+E*F+S*k}return a}}const kle=new Er;class Ple extends X2{interpolate_(e,n,r,s){const a=super.interpolate_(e,n,r,s);return kle.fromArray(a).normalize().toArray(a),a}}const ka={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Pg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nP={9728:er,9729:Dn,9984:Wg,9985:EE,9986:op,9987:Wa},iP={33071:Pi,33648:yp,10497:Bl},oR={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Bh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Dle={CUBICSPLINE:void 0,LINEAR:Nu,STEP:$p},aR={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ble(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Np({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:za})),i.DefaultMaterial}function Df(i,e,n){for(const r in n.extensions)i[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function Gh(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Fle(i,e,n){let r=!1,s=!1,a=!1;for(let h=0,f=e.length;h<f;h++){const p=e[h];if(p.POSITION!==void 0&&(r=!0),p.NORMAL!==void 0&&(s=!0),p.COLOR_0!==void 0&&(a=!0),r&&s&&a)break}if(!r&&!s&&!a)return Promise.resolve(i);const l=[],u=[],d=[];for(let h=0,f=e.length;h<f;h++){const p=e[h];if(r){const m=p.POSITION!==void 0?n.getDependency("accessor",p.POSITION):i.attributes.position;l.push(m)}if(s){const m=p.NORMAL!==void 0?n.getDependency("accessor",p.NORMAL):i.attributes.normal;u.push(m)}if(a){const m=p.COLOR_0!==void 0?n.getDependency("accessor",p.COLOR_0):i.attributes.color;d.push(m)}}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(d)]).then(function(h){const f=h[0],p=h[1],m=h[2];return r&&(i.morphAttributes.position=f),s&&(i.morphAttributes.normal=p),a&&(i.morphAttributes.color=m),i.morphTargetsRelative=!0,i})}function Ule(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let n=0,r=e.weights.length;n<r;n++)i.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(i.morphTargetInfluences.length===n.length){i.morphTargetDictionary={};for(let r=0,s=n.length;r<s;r++)i.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Gle(i){let e;const n=i.extensions&&i.extensions[qn.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+lR(n.attributes):e=i.indices+":"+lR(i.attributes)+":"+i.mode,i.targets!==void 0)for(let r=0,s=i.targets.length;r<s;r++)e+=":"+lR(i.targets[r]);return e}function lR(i){let e="";const n=Object.keys(i).sort();for(let r=0,s=n.length;r<s;r++)e+=n[r]+":"+i[n[r]]+";";return e}function iw(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Hle(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Vle=new pn;class zle{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new ple,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=!1,a=-1;typeof navigator<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,a=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||s&&a<98?this.textureLoader=new BM(this.options.manager):this.textureLoader=new UM(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Nr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const r=this,s=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(l){const u={scene:l[0][s.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:s.asset,parser:r,userData:{}};Df(a,u,s),Gh(u,s),Promise.all(r._invokeAll(function(d){return d.afterRoot&&d.afterRoot(u)})).then(function(){e(u)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[];for(let s=0,a=n.length;s<a;s++){const l=n[s].joints;for(let u=0,d=l.length;u<d;u++)e[l[u]].isBone=!0}for(let s=0,a=e.length;s<a;s++){const l=e[s];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(r[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,r){if(e.refs[n]<=1)return r;const s=r.clone(),a=(l,u)=>{const d=this.associations.get(l);d!=null&&this.associations.set(u,d);for(const[h,f]of l.children.entries())a(f,u.children[h])};return a(r,s),s.name+="_instance_"+e.uses[n]++,s}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let r=0;r<n.length;r++){const s=e(n[r]);if(s)return s}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const r=[];for(let s=0;s<n.length;s++){const a=e(n[s]);a&&r.push(a)}return r}getDependency(e,n){const r=e+":"+n;let s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(a){return a.loadNode&&a.loadNode(n)});break;case"mesh":s=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,n)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(r,s)}return s}getDependencies(e){let n=this.cache.get(e);if(!n){const r=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(a,l){return r.getDependency(e,l)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],r=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[qn.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(a,l){r.load(Pl.resolveURL(n.uri,s.path),a,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(r){const s=n.byteLength||0,a=n.byteOffset||0;return r.slice(a,a+s)})}loadAccessor(e){const n=this,r=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const l=oR[s.type],u=Pg[s.componentType],d=s.normalized===!0,h=new u(s.count*l);return Promise.resolve(new Qn(h,l,d))}const a=[];return s.bufferView!==void 0?a.push(this.getDependency("bufferView",s.bufferView)):a.push(null),s.sparse!==void 0&&(a.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(a).then(function(l){const u=l[0],d=oR[s.type],h=Pg[s.componentType],f=h.BYTES_PER_ELEMENT,p=f*d,m=s.byteOffset||0,v=s.bufferView!==void 0?r.bufferViews[s.bufferView].byteStride:void 0,y=s.normalized===!0;let $,E;if(v&&v!==p){const S=Math.floor(m/v),A="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+S+":"+s.count;let C=n.cache.get(A);C||($=new h(u,S*v,s.count*v/f),C=new n_($,v/f),n.cache.add(A,C)),E=new oo(C,d,m%v/f,y)}else u===null?$=new h(s.count*d):$=new h(u,m,s.count*d),E=new Qn($,d,y);if(s.sparse!==void 0){const S=oR.SCALAR,A=Pg[s.sparse.indices.componentType],C=s.sparse.indices.byteOffset||0,x=s.sparse.values.byteOffset||0,I=new A(l[1],C,s.sparse.count*S),O=new h(l[2],x,s.sparse.count*d);u!==null&&(E=new Qn(E.array.slice(),E.itemSize,E.normalized));for(let F=0,k=I.length;F<k;F++){const D=I[F];if(E.setX(D,O[F*d]),d>=2&&E.setY(D,O[F*d+1]),d>=3&&E.setZ(D,O[F*d+2]),d>=4&&E.setW(D,O[F*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return E})}loadTexture(e){const n=this.json,r=this.options,a=n.textures[e].source,l=n.images[a];let u=this.textureLoader;if(l.uri){const d=r.manager.getHandler(l.uri);d!==null&&(u=d)}return this.loadTextureImage(e,a,u)}loadTextureImage(e,n,r){const s=this,a=this.json,l=a.textures[e],u=a.images[n],d=(u.uri||u.bufferView)+":"+l.sampler;if(this.textureCache[d])return this.textureCache[d];const h=this.loadImageSource(n,r).then(function(f){f.flipY=!1,f.name=l.name||u.name||"",f.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(f.name=u.uri);const m=(a.samplers||{})[l.sampler]||{};return f.magFilter=nP[m.magFilter]||Dn,f.minFilter=nP[m.minFilter]||Wa,f.wrapS=iP[m.wrapS]||Bl,f.wrapT=iP[m.wrapT]||Bl,s.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[d]=h,h}loadImageSource(e,n){const r=this,s=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const l=s.images[e],u=self.URL||self.webkitURL;let d=l.uri||"",h=!1;if(l.bufferView!==void 0)d=r.getDependency("bufferView",l.bufferView).then(function(p){h=!0;const m=new Blob([p],{type:l.mimeType});return d=u.createObjectURL(m),d});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(d).then(function(p){return new Promise(function(m,v){let y=m;n.isImageBitmapLoader===!0&&(y=function($){const E=new ni($);E.needsUpdate=!0,m(E)}),n.load(Pl.resolveURL(p,a.path),y,void 0,v)})}).then(function(p){return h===!0&&u.revokeObjectURL(d),p.userData.mimeType=l.mimeType||Hle(l.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),p});return this.sourceCache[e]=f,f}assignTexture(e,n,r,s){const a=this;return this.getDependency("texture",r.index).then(function(l){if(!l)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(l=l.clone(),l.channel=r.texCoord),a.extensions[qn.KHR_TEXTURE_TRANSFORM]){const u=r.extensions!==void 0?r.extensions[qn.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const d=a.associations.get(l);l=a.extensions[qn.KHR_TEXTURE_TRANSFORM].extendTexture(l,u),a.associations.set(l,d)}}return s!==void 0&&(l.colorSpace=s),e[n]=l,l})}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const s=n.attributes.tangent===void 0,a=n.attributes.color!==void 0,l=n.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+r.uuid;let d=this.cache.get(u);d||(d=new CE,ir.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,d.sizeAttenuation=!1,this.cache.add(u,d)),r=d}else if(e.isLine){const u="LineBasicMaterial:"+r.uuid;let d=this.cache.get(u);d||(d=new Ai,ir.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,this.cache.add(u,d)),r=d}if(s||a||l){let u="ClonedMaterial:"+r.uuid+":";s&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),l&&(u+="flat-shading:");let d=this.cache.get(u);d||(d=r.clone(),a&&(d.vertexColors=!0),l&&(d.flatShading=!0),s&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(u,d),this.associations.set(d,this.associations.get(r))),r=d}e.material=r}getMaterialType(){return Np}loadMaterial(e){const n=this,r=this.json,s=this.extensions,a=r.materials[e];let l;const u={},d=a.extensions||{},h=[];if(d[qn.KHR_MATERIALS_UNLIT]){const p=s[qn.KHR_MATERIALS_UNLIT];l=p.getMaterialType(),h.push(p.extendParams(u,a,n))}else{const p=a.pbrMetallicRoughness||{};if(u.color=new xt(1,1,1),u.opacity=1,Array.isArray(p.baseColorFactor)){const m=p.baseColorFactor;u.color.fromArray(m),u.opacity=m[3]}p.baseColorTexture!==void 0&&h.push(n.assignTexture(u,"map",p.baseColorTexture,vn)),u.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,u.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(h.push(n.assignTexture(u,"metalnessMap",p.metallicRoughnessTexture)),h.push(n.assignTexture(u,"roughnessMap",p.metallicRoughnessTexture))),l=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,u)})))}a.doubleSided===!0&&(u.side=$s);const f=a.alphaMode||aR.OPAQUE;if(f===aR.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,f===aR.MASK&&(u.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&l!==oi&&(h.push(n.assignTexture(u,"normalMap",a.normalTexture)),u.normalScale=new mt(1,1),a.normalTexture.scale!==void 0)){const p=a.normalTexture.scale;u.normalScale.set(p,p)}return a.occlusionTexture!==void 0&&l!==oi&&(h.push(n.assignTexture(u,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&l!==oi&&(u.emissive=new xt().fromArray(a.emissiveFactor)),a.emissiveTexture!==void 0&&l!==oi&&h.push(n.assignTexture(u,"emissiveMap",a.emissiveTexture,vn)),Promise.all(h).then(function(){const p=new l(u);return a.name&&(p.name=a.name),Gh(p,a),n.associations.set(p,{materials:e}),a.extensions&&Df(s,p,a),p})}createUniqueName(e){const n=Zn.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,r=this.extensions,s=this.primitiveCache;function a(u){return r[qn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,n).then(function(d){return rP(d,u,n)})}const l=[];for(let u=0,d=e.length;u<d;u++){const h=e[u],f=Gle(h),p=s[f];if(p)l.push(p.promise);else{let m;h.extensions&&h.extensions[qn.KHR_DRACO_MESH_COMPRESSION]?m=a(h):m=rP(new on,h,n),s[f]={primitive:h,promise:m},l.push(m)}}return Promise.all(l)}loadMesh(e){const n=this,r=this.json,s=this.extensions,a=r.meshes[e],l=a.primitives,u=[];for(let d=0,h=l.length;d<h;d++){const f=l[d].material===void 0?Ble(this.cache):this.getDependency("material",l[d].material);u.push(f)}return u.push(n.loadGeometries(l)),Promise.all(u).then(function(d){const h=d.slice(0,d.length-1),f=d[d.length-1],p=[];for(let v=0,y=f.length;v<y;v++){const $=f[v],E=l[v];let S;const A=h[v];if(E.mode===ka.TRIANGLES||E.mode===ka.TRIANGLE_STRIP||E.mode===ka.TRIANGLE_FAN||E.mode===void 0)S=a.isSkinnedMesh===!0?new k$($,A):new Bn($,A),S.isSkinnedMesh===!0&&S.normalizeSkinWeights(),E.mode===ka.TRIANGLE_STRIP?S.geometry=eP(S.geometry,yE):E.mode===ka.TRIANGLE_FAN&&(S.geometry=eP(S.geometry,bp));else if(E.mode===ka.LINES)S=new Ya($,A);else if(E.mode===ka.LINE_STRIP)S=new pr($,A);else if(E.mode===ka.LINE_LOOP)S=new D$($,A);else if(E.mode===ka.POINTS)S=new B$($,A);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+E.mode);Object.keys(S.geometry.morphAttributes).length>0&&Ule(S,a),S.name=n.createUniqueName(a.name||"mesh_"+e),Gh(S,a),E.extensions&&Df(s,S,E),n.assignFinalMaterial(S),p.push(S)}for(let v=0,y=p.length;v<y;v++)n.associations.set(p[v],{meshes:e,primitives:v});if(p.length===1)return a.extensions&&Df(s,p[0],a),p[0];const m=new ta;a.extensions&&Df(s,m,a),n.associations.set(m,{meshes:e});for(let v=0,y=p.length;v<y;v++)m.add(p[v]);return m})}loadCamera(e){let n;const r=this.json.cameras[e],s=r[r.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?n=new Gi(lp.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):r.type==="orthographic"&&(n=new sa(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),Gh(n,r),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],r=[];for(let s=0,a=n.joints.length;s<a;s++)r.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",n.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(s){const a=s.pop(),l=s,u=[],d=[];for(let h=0,f=l.length;h<f;h++){const p=l[h];if(p){u.push(p);const m=new pn;a!==null&&m.fromArray(a.array,h*16),d.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[h])}return new i_(u,d)})}loadAnimation(e){const r=this.json.animations[e],s=r.name?r.name:"animation_"+e,a=[],l=[],u=[],d=[],h=[];for(let f=0,p=r.channels.length;f<p;f++){const m=r.channels[f],v=r.samplers[m.sampler],y=m.target,$=y.node,E=r.parameters!==void 0?r.parameters[v.input]:v.input,S=r.parameters!==void 0?r.parameters[v.output]:v.output;y.node!==void 0&&(a.push(this.getDependency("node",$)),l.push(this.getDependency("accessor",E)),u.push(this.getDependency("accessor",S)),d.push(v),h.push(y))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(d),Promise.all(h)]).then(function(f){const p=f[0],m=f[1],v=f[2],y=f[3],$=f[4],E=[];for(let S=0,A=p.length;S<A;S++){const C=p[S],x=m[S],I=v[S],O=y[S],F=$[S];if(C===void 0)continue;C.updateMatrix();let k;switch(Bh[F.path]){case Bh.weights:k=dd;break;case Bh.rotation:k=wc;break;case Bh.position:case Bh.scale:default:k=fd;break}const D=C.name?C.name:C.uuid,U=O.interpolation!==void 0?Dle[O.interpolation]:Nu,ce=[];Bh[F.path]===Bh.weights?C.traverse(function(ae){ae.morphTargetInfluences&&ce.push(ae.name?ae.name:ae.uuid)}):ce.push(D);let re=I.array;if(I.normalized){const ae=iw(re.constructor),ne=new Float32Array(re.length);for(let de=0,ue=re.length;de<ue;de++)ne[de]=re[de]*ae;re=ne}for(let ae=0,ne=ce.length;ae<ne;ae++){const de=new k(ce[ae]+"."+Bh[F.path],x.array,re,U);O.interpolation==="CUBICSPLINE"&&(de.createInterpolant=function(Re){const G=this instanceof wc?Ple:X2;return new G(this.times,this.values,this.getValueSize()/3,Re)},de.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),E.push(de)}}return new Cp(s,void 0,E)})}createNodeMesh(e){const n=this.json,r=this,s=n.nodes[e];return s.mesh===void 0?null:r.getDependency("mesh",s.mesh).then(function(a){const l=r._getNodeRef(r.meshCache,s.mesh,a);return s.weights!==void 0&&l.traverse(function(u){if(u.isMesh)for(let d=0,h=s.weights.length;d<h;d++)u.morphTargetInfluences[d]=s.weights[d]}),l})}loadNode(e){const n=this.json,r=this,s=n.nodes[e],a=r._loadNodeShallow(e),l=[],u=s.children||[];for(let h=0,f=u.length;h<f;h++)l.push(r.getDependency("node",u[h]));const d=s.skin===void 0?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([a,Promise.all(l),d]).then(function(h){const f=h[0],p=h[1],m=h[2];m!==null&&f.traverse(function(v){v.isSkinnedMesh&&v.bind(m,Vle)});for(let v=0,y=p.length;v<y;v++)f.add(p[v]);return f})}_loadNodeShallow(e){const n=this.json,r=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=n.nodes[e],l=a.name?s.createUniqueName(a.name):"",u=[],d=s._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return d&&u.push(d),a.camera!==void 0&&u.push(s.getDependency("camera",a.camera).then(function(h){return s._getNodeRef(s.cameraCache,a.camera,h)})),s._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){u.push(h)}),this.nodeCache[e]=Promise.all(u).then(function(h){let f;if(a.isBone===!0?f=new AE:h.length>1?f=new ta:h.length===1?f=h[0]:f=new Xn,f!==h[0])for(let p=0,m=h.length;p<m;p++)f.add(h[p]);if(a.name&&(f.userData.name=a.name,f.name=l),Gh(f,a),a.extensions&&Df(r,f,a),a.matrix!==void 0){const p=new pn;p.fromArray(a.matrix),f.applyMatrix4(p)}else a.translation!==void 0&&f.position.fromArray(a.translation),a.rotation!==void 0&&f.quaternion.fromArray(a.rotation),a.scale!==void 0&&f.scale.fromArray(a.scale);return s.associations.has(f)||s.associations.set(f,{}),s.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const n=this.extensions,r=this.json.scenes[e],s=this,a=new ta;r.name&&(a.name=s.createUniqueName(r.name)),Gh(a,r),r.extensions&&Df(n,a,r);const l=r.nodes||[],u=[];for(let d=0,h=l.length;d<h;d++)u.push(s.getDependency("node",l[d]));return Promise.all(u).then(function(d){for(let f=0,p=d.length;f<p;f++)a.add(d[f]);const h=f=>{const p=new Map;for(const[m,v]of s.associations)(m instanceof ir||m instanceof ni)&&p.set(m,v);return f.traverse(m=>{const v=s.associations.get(m);v!=null&&p.set(m,v)}),p};return s.associations=h(a),a})}}function Wle(i,e,n){const r=e.attributes,s=new zs;if(r.POSITION!==void 0){const u=n.json.accessors[r.POSITION],d=u.min,h=u.max;if(d!==void 0&&h!==void 0){if(s.set(new ie(d[0],d[1],d[2]),new ie(h[0],h[1],h[2])),u.normalized){const f=iw(Pg[u.componentType]);s.min.multiplyScalar(f),s.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const u=new ie,d=new ie;for(let h=0,f=a.length;h<f;h++){const p=a[h];if(p.POSITION!==void 0){const m=n.json.accessors[p.POSITION],v=m.min,y=m.max;if(v!==void 0&&y!==void 0){if(d.setX(Math.max(Math.abs(v[0]),Math.abs(y[0]))),d.setY(Math.max(Math.abs(v[1]),Math.abs(y[1]))),d.setZ(Math.max(Math.abs(v[2]),Math.abs(y[2]))),m.normalized){const $=iw(Pg[m.componentType]);d.multiplyScalar($)}u.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(u)}i.boundingBox=s;const l=new Ws;s.getCenter(l.center),l.radius=s.min.distanceTo(s.max)/2,i.boundingSphere=l}function rP(i,e,n){const r=e.attributes,s=[];function a(l,u){return n.getDependency("accessor",l).then(function(d){i.setAttribute(u,d)})}for(const l in r){const u=nw[l]||l.toLowerCase();u in i.attributes||s.push(a(r[l],u))}if(e.indices!==void 0&&!i.index){const l=n.getDependency("accessor",e.indices).then(function(u){i.setIndex(u)});s.push(l)}return Gh(i,e),Wle(i,e,n),Promise.all(s).then(function(){return e.targets!==void 0?Fle(i,e.targets,n):i})}const Xle=new Io;let fI,bu,lv=null,jle="white",Yle="black",Kle="yellow",Jle="black";const Zle=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(5,100,-5),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),fI=e,bu=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},qle=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Yle})]}),Qle=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,fI);const h=d.intersectObject(bu,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),lv==null&&(lv=r.current.position.clone()),lv.distanceTo(f);const p=[lv,f],m=new on().setFromPoints(p),v=new Ai({color:jle}),y=new pr(m,v);bu.add(y),lv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;ece($,f)}}},ece=(i,e)=>{Xle.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:2,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:Jle}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.quaternion.copy(fI.quaternion),bu.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},tce=()=>{const{scene:i}=es("assets/models/agriculture/sunflowers.glb"),e=[60,20,175],n=[0,29,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:20})},nce=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},j2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef(),f=q.useRef(),p=q.useRef(),m=q.useRef(),v=q.useRef(),y=q.useRef();return q.useEffect(()=>{const $=A=>{const C=i.current,x=bu.getObjectByName(A);if(!C||!x)return;const I=new ie,O=new ie;C.getWorldPosition(I),x.getWorldPosition(O),I.distanceTo(O)<15?(C.attach(x),x.position.set(0,2,0),console.log(`Picked up ${A}`)):console.log(`${A} too far to pick up.`)},E=A=>{const C=i.current,x=bu.getObjectByName(A);if(!C||!x)return;bu.attach(x);const I=new ie;C.getWorldPosition(I),x.position.copy(I),console.log(`Dropped ${A}`)},S=()=>{const A=f.current;if(!A)return;new fle().load("/drone-simulation-cte-alpha/assets/models/agriculture/water.glb",x=>{const I=x.scene,O=new ie;A.getWorldPosition(O),I.position.set(O.x+3,O.y,O.z),I.scale.set(30,30,30),I.visible=!0,bu.add(I);const F=.09,k=setInterval(()=>{I.position.y-=F,console.log("Droplet falling at Y position: ",I.position.y),I.position.y<-4&&(bu.remove(I),clearInterval(k))},16)},void 0,x=>{console.error("Failed to load water droplet model:",x)})};return bt.on("commandPickupObject",$),bt.on("commandDropObject",E),bt.on("commandSpray",S),()=>{bt.off("commandPickupObject",$),bt.off("commandDropObject",E),bt.off("commandSpray",S)}},[]),q.useEffect(()=>{const $=[u,d,h],E=new Map,S=new Map,C=setInterval(()=>{const x=i.current;if(!x)return;const I=new ie;x.getWorldPosition(I),$.forEach((O,F)=>{const k=O.current;if(!k||E.get(F))return;const D=new ie;if(k.getWorldPosition(D),I.distanceTo(D)<20&&!E.get(F)){E.set(F,!0);const ce=.15,re=setInterval(()=>{k.position.y+=ce,k.position.x+=ce*.5,k.position.y>40&&(clearInterval(re),S.delete(F))},16);S.set(F,re)}})},1e3);return()=>{clearInterval(C),S.forEach(x=>clearInterval(x))}},[i,u,d,h]),V.jsxs(Ka,{shadows:!0,onClick:$=>Qle($,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(tce,{}),s.map(($,E)=>V.jsx(qle,{position:$},E)),V.jsx(Zle,{measurementViewEnabled:e}),V.jsx(nce,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.9,cameraOffset:[-4,8,-18],lineColor:Kle,droneSpeed:.6}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/agriculture/bird.glb",position:[15,18,55],scale:5,name:"bird1",enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/agriculture/bird.glb",position:[-45,18,45],scale:5,name:"bird2",enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/agriculture/bird.glb",position:[-15,18,75],scale:5,name:"bird3",enableMeasurement:e}),V.jsx(bn,{ref:f,path:"/drone-simulation-cte-alpha/assets/models/agriculture/can.glb",position:[14,-1,1],rotation:[0,Math.PI/2,0],scale:5,name:"watercan",enableMeasurement:e}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/agriculture/barn.glb",position:[18,-2,4],scale:40,enableMeasurement:e}),V.jsx(bn,{ref:p,path:"/drone-simulation-cte-alpha/assets/models/agriculture/pesticides.glb",position:[-30.43,-1.53,18.13],rotation:[0,Math.PI/2,0],scale:6,name:"pesticide1",enableMeasurement:e}),V.jsx(bn,{ref:m,path:"/drone-simulation-cte-alpha/assets/models/agriculture/pesticides.glb",position:[47.91,.27,13.75],rotation:[0,Math.PI/2,0],scale:6,name:"pesticide2",enableMeasurement:e}),V.jsx(bn,{ref:v,path:"/drone-simulation-cte-alpha/assets/models/agriculture/pollen.glb",position:[5.5,8.5,16],rotation:[0,Math.PI/2,Math.PI/2],scale:.1,name:"pollen1",enableMeasurement:e}),V.jsx(bn,{ref:y,path:"/drone-simulation-cte-alpha/assets/models/agriculture/pollen.glb",position:[-9,11,24],rotation:[0,Math.PI/2,Math.PI/2],scale:.1,name:"pollen2",enableMeasurement:e})]})};j2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const ice=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(j2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},rce=new Io;let pI,Kh,cv=null,sce="white",oce="black",ace="yellow",lce="black";const cce=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(10,100,-50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),pI=e,Kh=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},uce=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:oce})]}),hce=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,pI);const h=d.intersectObject(Kh,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),cv==null&&(cv=r.current.position.clone()),cv.distanceTo(f);const p=[cv,f],m=new on().setFromPoints(p),v=new Ai({color:sce}),y=new pr(m,v);Kh.add(y),cv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;dce($,f)}}},dce=(i,e)=>{rce.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:lce}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.lookAt(pI.position),Kh.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},fce=()=>{const{scene:i}=es("assets/models/manufacturing/workshop.glb"),e=[0,0,60],n=[0,188,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:20})},pce=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`transportation_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},Y2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef(),f=q.useRef(),p=q.useRef(),m=q.useRef();return q.useEffect(()=>{const v=$=>{const E=i.current,S=Kh.getObjectByName($);if(!E||!S)return;const A=new ie,C=new ie;E.getWorldPosition(A),S.getWorldPosition(C);const x=A.distanceTo(C);console.log(x,"peel position",C,"drone position",A),x<20?(E.attach(S),S.position.set(0,2,0),console.log(`Picked up ${$}`)):console.log(`${$} too far to pick up.`)},y=$=>{const E=i.current,S=Kh.getObjectByName($);if(!E||!S)return;Kh.attach(S);const A=new ie;E.getWorldPosition(A);const C=Kh.worldToLocal(worldPosition.clone());S.position.copy(C),console.log("Drone world position at drop:",worldPosition),console.log("Book local position after conversion:",C),console.log(`Dropped ${$}`)};return bt.on("commandPickupObject",v),bt.on("commandDropObject",y),()=>{bt.off("commandPickupObject",v),bt.off("commandDropObject",y)}},[]),V.jsxs(Ka,{shadows:!0,onClick:v=>hce(v,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(fce,{}),s.map((v,y)=>V.jsx(uce,{position:v},y)),V.jsx(cce,{measurementViewEnabled:e}),V.jsx(pce,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.9,cameraOffset:[25,25,-35],lineColor:ace,droneSpeed:.4}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/car.glb",position:[-30,16,30],rotation:[0,Math.PI-10,0],scale:.09,enableMeasurement:e}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/fire.glb",position:[17,16,80],rotation:[0,Math.PI-10,0],scale:.02,enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/mask.glb",position:[-80,30,20],rotation:[0,Math.PI,0],scale:30,enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/infotech/trashcan.glb",position:[-68,0,0],rotation:[0,Math.PI/2,0],scale:12,enableMeasurement:e}),V.jsx(bn,{ref:f,path:"/drone-simulation-cte-alpha/assets/models/infotech/banana.glb",position:[-30,0,-40],rotation:[0,Math.PI/2,0],scale:15,name:"peel",enableMeasurement:e}),V.jsx(bn,{ref:p,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/saw.glb",position:[-10,0,80],rotation:[0,Math.PI/2,0],scale:2,name:"saw",enableMeasurement:e}),V.jsx(bn,{ref:m,path:"/drone-simulation-cte-alpha/assets/models/manufacturing/screwdriver.glb",position:[15,10,10],rotation:[0,Math.PI/8,0],scale:10,name:"screwdriver",enableMeasurement:e})]})};Y2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const mce=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(Y2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},gce=new Io;let mI,mp,uv=null,_ce="white",Tce="black",vce="yellow",Ece="black";const yce=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(5,50,-3),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(5,5,20),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),mI=e,mp=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Sce=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Tce})]}),$ce=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,mI);const h=d.intersectObject(mp,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),uv==null&&(uv=r.current.position.clone()),uv.distanceTo(f);const p=[uv,f],m=new on().setFromPoints(p),v=new Ai({color:_ce}),y=new pr(m,v);mp.add(y),uv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;bce($,f)}}},bce=(i,e)=>{gce.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:1,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:Ece}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.lookAt(mI.position),mp.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Ace=()=>{const{scene:i}=es("assets/models/hospitality/room1.glb");console.log("Loaded GLB scene:",i);const e=[0,-80,10],n=[0,180,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:50})},Cce=()=>{const{gl:i}=Mn(),e=()=>{const n=i.domElement.toDataURL("image/png"),r=new Date().toISOString().replace(/[:.]/g,"-"),s=document.createElement("a");s.href=n,s.download=`hospitality_${r}.png`,s.click()};return q.useEffect(()=>{const n=()=>{e()};return bt.on("commandTakeScreenShot",n),()=>{bt.off("commandTakeScreenShot",n)}},[]),null},K2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),[s,a]=q.useState([]),l=q.useRef(),u=q.useRef(),d=q.useRef(),h=q.useRef(),f=q.useRef(),p=q.useRef();return q.useEffect(()=>{const m=y=>{const $=i.current,E=mp.getObjectByName(y);if(!$||!E)return;const S=new ie,A=new ie;$.getWorldPosition(S),E.getWorldPosition(A);const C=S.distanceTo(A);C<20?($.attach(E),E.position.set(0,2,0),console.log(`Picked up ${y}`)):(console.log(C),console.log(`${y} too far to pick up.`))},v=y=>{const $=i.current,E=mp.getObjectByName(y);if(!$||!E)return;mp.attach(E);const S=new ie;$.getWorldPosition(S),E.position.copy(S),console.log(`Dropped ${y}`)};return bt.on("commandPickupObject",m),bt.on("commandDropObject",v),()=>{bt.off("commandPickupObject",m),bt.off("commandDropObject",v)}},[]),V.jsxs(Ka,{shadows:!0,onClick:m=>$ce(m,a,e,i),children:[V.jsx("color",{attach:"background",args:["#87CEEB"]}),V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)}),V.jsx(Za,{preset:"sunset",intensity:.5}),V.jsx(Ace,{}),s.map((m,v)=>V.jsx(Sce,{position:m},v)),V.jsx(yce,{measurementViewEnabled:e}),V.jsx(Cce,{}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:2,cameraOffset:[10,20,-20],lineColor:vce,droneSpeed:.4}),V.jsx(bn,{ref:l,path:"/drone-simulation-cte-alpha/assets/models/hospitality/cushion.glb",position:[-20,-30,6],rotation:[0,Math.PI+45,0],scale:20,name:"cushion1",enableMeasurement:e}),V.jsx(bn,{ref:d,path:"/drone-simulation-cte-alpha/assets/models/hospitality/wallet.glb",position:[20,-10,50],rotation:[0,Math.PI/4,0],scale:.5,name:"wallet",enableMeasurement:e}),V.jsx(bn,{ref:u,path:"/drone-simulation-cte-alpha/assets/models/hospitality/cushion.glb",position:[-45,-30,6],rotation:[0,Math.PI+45,0],scale:20,name:"cushion2",enableMeasurement:e}),V.jsx(bn,{ref:h,path:"/drone-simulation-cte-alpha/assets/models/infotech/trashcan.glb",position:[0,-35,50],rotation:[0,Math.PI/2,0],scale:20,enableMeasurement:e}),V.jsx(bn,{ref:f,path:"/drone-simulation-cte-alpha/assets/models/infotech/banana.glb",position:[-30,-35,50],rotation:[0,Math.PI/2,0],scale:15,name:"peel",enableMeasurement:e}),V.jsx(bn,{ref:p,path:"/drone-simulation-cte-alpha/assets/models/hospitality/lost.glb",position:[-20,-30,80],rotation:[0,Math.PI/2,0],scale:70,name:"LostandFound",enableMeasurement:e})]})};K2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const Rce=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(K2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})},xce=new Io;let J2,n$,hv=null,wce="white",Mce="black",Ice="yellow",Oce="yellow";const Lce=({measurementViewEnabled:i})=>{const{camera:e,gl:n,scene:r}=Mn(),s=q.useRef();return q.useEffect(()=>{i?(e.position.set(0,100,-3),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI/2,s.current.minPolarAngle=Math.PI/2,s.current.enableRotate=!1)):(e.position.set(50,50,50),e.lookAt(new ie(0,0,0)),e.updateProjectionMatrix(),s.current&&(s.current.maxPolarAngle=Math.PI,s.current.minPolarAngle=0,s.current.enableRotate=!0)),J2=e,n$=r},[i,e]),V.jsx(V.Fragment,{children:!i&&V.jsx(Ja,{ref:s,args:[e,n.domElement]})})},Nce=({position:i})=>V.jsxs("mesh",{position:i,children:[V.jsx("sphereGeometry",{args:[.5,16,16]}),V.jsx("meshStandardMaterial",{color:Mce})]}),kce=(i,e,n,r)=>{if(n){const s=i.target.getBoundingClientRect(),a=(i.clientX-s.left)/s.width*2-1,l=-((i.clientY-s.top)/s.height)*2+1,u=new ie(a,l,.5),d=new ho;d.setFromCamera(u,J2);const h=d.intersectObject(n$,!0);if(h.length>0){const f=h[0].point;e(E=>[...E,f]),hv==null&&(hv=r.current.position.clone()),hv.distanceTo(f);const p=[hv,f],m=new on().setFromPoints(p),v=new Ai({color:wce}),y=new pr(m,v);n$.add(y),hv.copy(f);const $=`X: ${f.x.toFixed(2)} cm, Y: ${f.y.toFixed(2)} cm, Z: ${f.z.toFixed(2)} cm`;Pce($,f)}}},Pce=(i,e)=>{xce.load("assets/helvetiker_regular.typeface.json",n=>{const r=new qa(i,{font:n,size:.9,height:.09,curveSegments:1,bevelEnabled:!1,bevelThickness:0,bevelSize:.03,bevelSegments:2}),s=new oi({color:Oce}),a=new Bn(r,s);a.position.set(e.x,e.y+.4,e.z),a.rotation.x=-Math.PI/2,n$.add(a)},void 0,n=>{console.error("An error occurred loading the font:",n)})},Dce=()=>{const{scene:i}=es("assets/models/transportation/future_city_compressed.glb"),e=[-200,-5,90],n=[0,0,0];return i.rotation.set(n[0],n[1],n[2]),V.jsx("primitive",{object:i,position:e,scale:1})},_u=({position:i,rotation:e,scale:n=.02,text:r="0",type:s="car"})=>{let a;s==="truck"?a=es("assets/models/transportation/truck.glb").scene:a=es("assets/models/transportation/tesla.glb").scene;const l=q.useMemo(()=>{const h=Z$(a);return h.rotation.set(e[0],e[1],e[2]),h},[a,e]),u=[i[0],i[1]+5,i[2]],d=i;return V.jsxs(V.Fragment,{children:[V.jsx(eI,{points:[u,d],color:"white",lineWidth:2}),V.jsx(Fi,{position:[u[0],u[1]+3,u[2]],rotation:[0,90,0],fontSize:3,color:"red",anchorX:"center",anchorY:"middle",children:r}),V.jsx("primitive",{object:l,position:i,scale:n})]})},dv=({position:i,rotation:e,scale:n=.02})=>{const{scene:r}=es("assets/models/transportation/tesla.glb"),s=Z$(r);return s.rotation.set(e[0],e[1],e[2]),V.jsx("primitive",{object:s,position:i,scale:n})},sP=({position:i,rotation:e,scale:n=3})=>{const{scene:r}=es("assets/models/transportation/truck.glb"),s=Z$(r);return s.rotation.set(e[0],e[1],e[2]),V.jsx("primitive",{object:s,position:i,scale:n})},Z2=({droneRef:i,measurementViewEnabled:e,mouseControlEnabled:n})=>{const r=q.useRef(),s=q.useRef(),[a,l]=q.useState([]);return V.jsxs(Ka,{shadows:!0,onClick:u=>kce(u,l,e,i),children:[V.jsx("color",{attach:"background",args:["#000000"]})," ",V.jsx("ambientLight",{intensity:.4,color:new xt(16761248)})," ",V.jsx(Za,{preset:"sunset",intensity:.5})," ",V.jsx(Dce,{}),a.map((u,d)=>V.jsx(Nce,{position:u},d)),V.jsx(Lce,{measurementViewEnabled:e}),V.jsx(UE,{droneCameraRef:s,environment:"law"}),V.jsx(Mo,{ref:i,controlsRef:r,measurementViewEnabled:e,mouseControlEnabled:n,droneScale:.3,cameraOffset:[0,5,-20],lineColor:Ice,droneCameraRef:s}),V.jsx(dv,{position:[0,-5,91],rotation:[0,110,0]}),V.jsx(dv,{position:[25,-5,91],rotation:[0,110,0]}),V.jsx(dv,{position:[6,-5,95],rotation:[0,0,0]}),V.jsx(dv,{position:[37,-5,40],rotation:[0,17.3,0]}),V.jsx(sP,{position:[33,-3.4,60],rotation:[0,0,0]}),V.jsx(dv,{position:[-30,-5,40],rotation:[0,17.3,0]}),V.jsx(sP,{position:[-30,-3.4,60],rotation:[0,0,0]}),V.jsx(_u,{position:[-50,-5,40],rotation:[0,17.3,0],text:"0"}),V.jsx(_u,{position:[-55,-5,40],rotation:[0,17.3,0],text:"15"}),V.jsx(_u,{position:[-60,-5,40],rotation:[0,17.3,0],text:"30"}),V.jsx(_u,{position:[-65,-5,40],rotation:[0,17.3,0],text:"6"}),V.jsx(_u,{position:[-70,-5,40],rotation:[0,17.3,0],text:"2"}),V.jsx(_u,{position:[-75,-5,40],rotation:[0,17.3,0],text:"50"}),V.jsx(_u,{position:[-50,-3.4,20],rotation:[0,0,0],text:"30",type:"truck",scale:3}),V.jsx(_u,{position:[-57,-3.4,20],rotation:[0,0,0],text:"0",type:"truck",scale:3}),V.jsx(_u,{position:[-64,-3.4,20],rotation:[0,0,0],text:"51",type:"truck",scale:3})]})};Z2.propTypes={droneRef:zt.object.isRequired,mouseControlEnabled:zt.bool,measurementViewEnabled:zt.bool};const Bce=()=>{window.gtag("event","page_view",{page_path:window.location.pathname});const i=q.useRef(),[e,n]=q.useState(!1),[r,s]=q.useState(!1),[a,l]=q.useState({xPos:0,yPos:0,zPos:0,xRot:0,yRot:0,zRot:0});return q.useEffect(()=>{const u=p=>{n(p)},d=p=>{s(p)};bt.on("measurementViewEnabled",u),bt.on("mouseControlEnabled",d);const f=setInterval(()=>{i.current&&l({xPos:i.current.position.x,yPos:i.current.position.y,zPos:i.current.position.z,xRot:i.current.rotation.x,yRot:i.current.rotation.y,zRot:i.current.rotation.z})},100);return()=>clearInterval(f)},[]),V.jsx(ca,{children:V.jsxs("div",{className:"simulation-container",children:[V.jsx("div",{className:"blockpad-container",children:V.jsx(ua,{})}),V.jsxs("div",{className:"transportation-canvas-container",children:[V.jsx(ha,{dronePosition:a}),V.jsx(Z2,{droneRef:i,measurementViewEnabled:e,mouseControlEnabled:r})]})]})})};ix.createRoot(document.getElementById("root")).render(V.jsx(lw.StrictMode,{children:V.jsx(dz,{children:V.jsxs(cz,{children:[V.jsx(Eo,{path:"/",element:V.jsx(qk,{})}),V.jsx(Eo,{path:"/transportation",element:V.jsx(qk,{})}),V.jsx(Eo,{path:"/architecture",element:V.jsx(Zoe,{})}),V.jsx(Eo,{path:"/business",element:V.jsx(vae,{})}),V.jsx(Eo,{path:"/education",element:V.jsx(Iae,{})}),V.jsx(Eo,{path:"/communication",element:V.jsx(Gae,{})}),V.jsx(Eo,{path:"/engineering",element:V.jsx(ele,{})}),V.jsx(Eo,{path:"/hospitality",element:V.jsx(Rce,{})}),V.jsx(Eo,{path:"/information-technology",element:V.jsx(dle,{})}),V.jsx(Eo,{path:"/agriculture",element:V.jsx(ice,{})}),V.jsx(Eo,{path:"/slate",element:V.jsx(Uoe,{})}),V.jsx(Eo,{path:"/manufacturing",element:V.jsx(mce,{})}),V.jsx(Eo,{path:"/law",element:V.jsx(Bce,{})})]})})}));
